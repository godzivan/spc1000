                  ;
                  ; IOCS
                  ;
                  ; SAMSUNG 8bit Personal Computer SPC-1000
                  ; Old ROM Assembler Source 
                  ; Reconstructed by Miso Kim
                  ;
                  ; 2014.04.16 1st Released
                  ; 
        ORG 0                           ;                  
ENTRY   EQU 0FB00H                      ;fb00              
BOOT:                                   ;                  
JT1:    JP  ENTRY                       ;0000  c3 00 fb    
JT2:    JP  INPUTF                      ;0003  c3 a4 06    
JT3:    JP  CR1                         ;0006  c3 43 08    
JT4:    JP  CR2                         ;0009  c3 23 08    
JT5:    JP  SPPRT                       ;000c  c3 62 08    
JT6:    JP  TABPRT                      ;000f  c3 02 08    
JT7:    JP  ACCPRT                      ;0012  c3 64 08    
JT8:    JP  DEPRT                       ;0015  c3 f3 07    
JT9:    JP  DEPRT                       ;0018  c3 f3 07    
JT10:   JP  ASCGET                      ;001b  c3 62 0c    
JT11:   JP  BRKEY                       ;001e  c3 5b 0c    ;ZERO=1 RET
JT12:   JP  FSAVE                       ;0021  c3 80 00    
JT13:   JP  MSAVE                       ;0024  c3 b6 00    
JT14:   JP  FLOAD                       ;0027  c3 14 01    
JT15:   JP  MLOAD                       ;002a  c3 34 01    
JT16:   JP  MVRFY                       ;002d  c3 b9 01    
JT17:   JP  MUSIC                       ;0030  c3 cd 0e    ;MELDY
JT18:   JP  NOPRET                      ;0033  c3 61 00    ;CLKSET
TICONT: DEFW    17                      ;0036  11 00       
JT19:   JP  COUNTR                      ;0038  c3 74 00    
JT20:   JP  NOPRET                      ;003b  c3 61 00    ;CLKRD
JT21:   JP  BELL                        ;003e  c3 ca 06    ;BELL
JT22:   JP  XTEMPO                      ;0041  c3 95 10    ;TEMPO
JT23:   JP  SOUNDS                      ;0044  c3 99 10    ;MSTA
JT24:   JP  SOUNDS                      ;0047  c3 99 10    ;MSTAS
                                        ;                  ;004A
MAIN:   LD  SP,00000h                   ;004a  31 00 00    
    IM  1                               ;004d  ed 56       
    EI                                  ;004f  fb          
    CALL    INITSB                      ;0050  cd 56 00    
    JP  $BASIC                          ;0053  c3 18 14    
                  ;
INITSB: LD  A,0                         ;0056  3e 00       
    CALL    IO20SB                      ;0058  cd 62 00    
    CALL    IO60SB                      ;005b  cd 6b 00    
    CALL    CLR2                        ;005e  cd d5 0a    
NOPRET: RET                             ;0061  c9          
                  ;
IO20SB: LD  BC,02000h                   ;0062  01 00 20    
    OUT (C),A                           ;0065  ed 79       
    LD  (IO2000),A                      ;0067  32 ea 11    
    RET                                 ;006a  c9          
                  ;
IO60SB: LD  BC,06000h                   ;006b  01 00 60    
    OUT (C),A                           ;006e  ed 79       
    LD  (IO6000),A                      ;0070  32 e9 11    
    RET                                 ;0073  c9          
                  ;
                  ;
COUNTR: PUSH    HL                      ;0074  e5          
    LD  HL,(TICONT)                     ;0075  2a 36 00    
    INC HL                              ;0078  23          
    LD  (TICONT),HL                     ;0079  22 36 00    
    POP HL                              ;007c  e1          
    EI                                  ;007d  fb          
    RETI                                ;007e  ed 4d       
                  ;
                  ;
                  ;
                  ; FILE INFORMATION SAVE
                  ;
                  ; START ADR=FILMOD
                  ; LENGTH   =128 BYTES
                  ;   CARRY FLAG: BREAK KEY IN
                  ;
FSAVE:  DI                              ;0080  f3          
    PUSH    DE                          ;0081  d5          
    PUSH    BC                          ;0082  c5          
    PUSH    HL                          ;0083  e5          
    LD  D,0D7h                          ;0084  16 d7       
    LD  E,0CCh                          ;0086  1e cc       
    LD  HL,FILMOD                       ;0088  21 96 13    
    LD  BC,00080H                       ;008b  01 80 00    
                  ;
FSAVE0: CALL    CKSUM                   ;008e  cd 9e 03    
    CALL    MOTON                       ;0091  cd e0 02    
    JP  C,CLOAD4                        ;0094  da 9d 01    
    LD  A,E                             ;0097  7b          
    CP  0CCh                            ;0098  fe cc       
    JR  NZ,FSAVE1                       ;009a  20 11       
    CALL    CR2                         ;009c  cd 23 08    
    PUSH    DE                          ;009f  d5          
    LD  DE,WRITEM                       ;00a0  11 75 03    
    CALL    DEPRT                       ;00a3  cd f3 07    ;'WRITING '
    LD  DE,FILNAM                       ;00a6  11 97 13    
    CALL    DEPRT                       ;00a9  cd f3 07    ;FILE NAME
    POP DE                              ;00ac  d1          
                  ;
FSAVE1: CALL    WRMRK                   ;00ad  cd 22 04    ;GAP
    CALL    SAVE                        ;00b0  cd ce 00    ;STADR=HL/LEN=BC
    JP  CLOAD4                          ;00b3  c3 9d 01    
                  ;
                  ;
                  ;
                  ; BODY SAVE
                  ; START ADR	= (MTADRS=13AAH)
                  ; LENGTH	= (MTBYTE=13A8H)
                  ; CARRY FLAG	= 0... OK
                  ; CARRY FLAG	= 1... BREAK IN
                  ;
MSAVE:  DI                              ;00b6  f3          
    PUSH    DE                          ;00b7  d5          
    PUSH    BC                          ;00b8  c5          
    PUSH    HL                          ;00b9  e5          
    LD  D,0D7h                          ;00ba  16 d7       
    LD  E,053h                          ;00bc  1e 53       
    LD  HL,(MTBYTE)                     ;00be  2a a8 13    
    PUSH    HL                          ;00c1  e5          
    POP BC                              ;00c2  c1          
    LD  HL,(MTADRS)                     ;00c3  2a aa 13    
    LD  A,B                             ;00c6  78          
    OR  C                               ;00c7  b1          
    JP  Z,SAVE4                         ;00c8  ca 10 01    
    JP  FSAVE0                          ;00cb  c3 8e 00    
                  ;
SAVE:   PUSH    DE                      ;00ce  d5          
    PUSH    BC                          ;00cf  c5          
    PUSH    HL                          ;00d0  e5          
    LD  D,002h                          ;00d1  16 02       ;원래값은 002h
SAVE1:  LD  A,(HL)                      ;00d3  7e          ;~
    CALL    WRACC                       ;00d4  cd 0f 04    ;1BYTE WRITE
    LD  A,080h                          ;00d7  3e 80       ;8000H
    IN  A,(000h)                        ;00d9  db 00       
    AND 012h                            ;00db  e6 12       ;BREAK+SHIFT
    JR  NZ,SAVE0                        ;00dd  20 04       
    SCF                                 ;00df  37          
    JP  SAVE4                           ;00e0  c3 10 01    
                  ;
SAVE0:  INC HL                          ;00e3  23          
    DEC BC                              ;00e4  0b          ;BC BYTES CHECK
    LD  A,B                             ;00e5  78          
    OR  C                               ;00e6  b1          
    JP  NZ,SAVE1                        ;00e7  c2 d3 00    
    LD  HL,(CKSMF1)                     ;00ea  2a e3 11    ;CHECK SUM WRITE
    LD  A,H                             ;00ed  7c          
    CALL    WRACC                       ;00ee  cd 0f 04    
    LD  A,L                             ;00f1  7d          
    CALL    WRACC                       ;00f2  cd 0f 04    
    CALL    WRITEL                      ;00f5  cd ed 03    ;BIT 1 WRITE
    DEC D                               ;00f8  15          
    JP  NZ,SAVE2                        ;00f9  c2 00 01    
    OR  A                               ;00fc  b7          
    JP  SAVE4                           ;00fd  c3 10 01    
                  ;
SAVE2:  LD  B,000h                      ;0100  06 00       
SAVE3:  CALL    WRITES                  ;0102  cd cb 03    
    DEC B                               ;0105  05          
    JP  NZ,SAVE3                        ;0106  c2 02 01    
    POP HL                              ;0109  e1          
    POP BC                              ;010a  c1          
    PUSH    BC                          ;010b  c5          
    PUSH    HL                          ;010c  e5          
    JP  SAVE1                           ;010d  c3 d3 00    
                  ;
SAVE4:  POP HL                          ;0110  e1          
    POP BC                              ;0111  c1          
    POP DE                              ;0112  d1          
    RET                                 ;0113  c9          
                  ;
FLOAD:  DI                              ;0114  f3          
    PUSH    DE                          ;0115  d5          
    PUSH    BC                          ;0116  c5          
    PUSH    HL                          ;0117  e5          
    LD  D,0D2h                          ;0118  16 d2       
    LD  E,0CCh                          ;011a  1e cc       
    LD  BC,FSAVE                        ;011c  01 80 00    
    LD  HL,FILMOD                       ;011f  21 96 13    
                  ;
FLOAD1: CALL    MOTON                   ;0122  cd e0 02    
    JP  C,CLOAD5                        ;0125  da b3 01    
    CALL    MKRD                        ;0128  cd 91 02    
    JP  C,CLOAD5                        ;012b  da b3 01    
    CALL    CLOAD                       ;012e  cd 4c 01    
    JP  CLOAD4                          ;0131  c3 9d 01    
                  ;
MLOAD:  DI                              ;0134  f3          
    PUSH    DE                          ;0135  d5          
    PUSH    BC                          ;0136  c5          
    PUSH    HL                          ;0137  e5          
    LD  D,0D2h                          ;0138  16 d2       
    LD  E,053h                          ;013a  1e 53       
    LD  HL,(MTBYTE)                     ;013c  2a a8 13    
    PUSH    HL                          ;013f  e5          
    POP BC                              ;0140  c1          
    LD  HL,(MTADRS)                     ;0141  2a aa 13    
    LD  A,B                             ;0144  78          
    OR  C                               ;0145  b1          
    JP  Z,CLOAD4                        ;0146  ca 9d 01    
    JP  FLOAD1                          ;0149  c3 22 01    
                  ;
CLOAD:  PUSH    DE                      ;014c  d5          
    PUSH    BC                          ;014d  c5          
    PUSH    HL                          ;014e  e5          
    LD  H,002h                          ;014f  26 02       ;원래값은 002h - 소스 수정
                  ;
CLOAD7: LD  BC,04000h                   ;0151  01 00 40    
    LD  A,14                            ;0154  3e 0e       
    OUT (C),A                           ;0156  ed 79       
                  ;
CLOAD0: CALL    EDGE                    ;0158  cd 30 02    
    JP  C,CLOAD5                        ;015b  da b3 01    
    CALL    WAITR                       ;015e  cd c4 03    
    LD  A,040h                          ;0161  3e 40       
    IN  A,(1)                           ;0163  db 01       ;IN A,(4001H)
    AND 080h                            ;0165  e6 80       
    JP  Z,CLOAD0                        ;0167  ca 58 01    
    LD  D,H                             ;016a  54          
    LD  HL,00000h                       ;016b  21 00 00    
    LD  (CKSMF1),HL                     ;016e  22 e3 11    
    POP HL                              ;0171  e1          
    POP BC                              ;0172  c1          
    PUSH    BC                          ;0173  c5          
    PUSH    HL                          ;0174  e5          
                  ;
CLOAD1: CALL    VBLOAD                  ;0175  cd 59 02    
    JP  C,CLOAD5                        ;0178  da b3 01    
    LD  (HL),A                          ;017b  77          
    INC HL                              ;017c  23          
    DEC BC                              ;017d  0b          
    LD  A,B                             ;017e  78          
    OR  C                               ;017f  b1          
    JP  NZ,CLOAD1                       ;0180  c2 75 01    
    LD  HL,(CKSMF1)                     ;0183  2a e3 11    
    CALL    VBLOAD                      ;0186  cd 59 02    
    JP  C,CLOAD5                        ;0189  da b3 01    
    LD  E,A                             ;018c  5f          
    CALL    VBLOAD                      ;018d  cd 59 02    
    JP  C,CLOAD5                        ;0190  da b3 01    
    CP  L                               ;0193  bd          
    JP  NZ,CLOAD2                       ;0194  c2 a5 01    
    LD  A,E                             ;0197  7b          
    CP  H                               ;0198  bc          
    JP  NZ,CLOAD2                       ;0199  c2 a5 01    
                  ;
CLOAD8: XOR A                           ;019c  af          
                  ;
CLOAD4: POP HL                          ;019d  e1          
    POP BC                              ;019e  c1          
    POP DE                              ;019f  d1          
    CALL    MOTCH                       ;01a0  cd 44 03    
    EI                                  ;01a3  fb          
    RET                                 ;01a4  c9          
                  ;
CLOAD2: DEC D                           ;01a5  15          
    JP  Z,CLOAD3                        ;01a6  ca ad 01    
    LD  H,D                             ;01a9  62          
    JP  CLOAD7                          ;01aa  c3 51 01    
                  ;
CLOAD3: LD  A,001h                      ;01ad  3e 01       
    SCF                                 ;01af  37          
    JP  CLOAD4                          ;01b0  c3 9d 01    
                  ;
CLOAD5: LD  A,002h                      ;01b3  3e 02       
    SCF                                 ;01b5  37          
    JP  CLOAD4                          ;01b6  c3 9d 01    
                  ;
MVRFY:  DI                              ;01b9  f3          
    PUSH    DE                          ;01ba  d5          
    PUSH    BC                          ;01bb  c5          
    PUSH    HL                          ;01bc  e5          
    LD  HL,(MTBYTE)                     ;01bd  2a a8 13    
    PUSH    HL                          ;01c0  e5          
    POP BC                              ;01c1  c1          
    LD  HL,(MTADRS)                     ;01c2  2a aa 13    
    LD  D,0D2h                          ;01c5  16 d2       
    LD  E,053h                          ;01c7  1e 53       
    LD  A,B                             ;01c9  78          
    OR  C                               ;01ca  b1          
    JP  Z,CLOAD4                        ;01cb  ca 9d 01    
    CALL    CKSUM                       ;01ce  cd 9e 03    
    CALL    MOTON                       ;01d1  cd e0 02    
    JP  C,CLOAD5                        ;01d4  da b3 01    
    CALL    MKRD                        ;01d7  cd 91 02    
    JP  C,CLOAD5                        ;01da  da b3 01    
    CALL    MVRFY1                      ;01dd  cd e3 01    
    JP  CLOAD4                          ;01e0  c3 9d 01    
                  ;
MVRFY1: PUSH    DE                      ;01e3  d5          
    PUSH    BC                          ;01e4  c5          
    PUSH    HL                          ;01e5  e5          
    LD  H,002h                          ;01e6  26 02       
                  ;
MVRFYN: LD  BC,04000h                   ;01e8  01 00 40    
    LD  A,14                            ;01eb  3e 0e       
    OUT (C),A                           ;01ed  ed 79       
                  ;
MVRFY2: CALL    EDGE                    ;01ef  cd 30 02    
    JP  C,CLOAD5                        ;01f2  da b3 01    
    CALL    WAITR                       ;01f5  cd c4 03    
    LD  A,040h                          ;01f8  3e 40       
    IN  A,(1)                           ;01fa  db 01       
    AND 080h                            ;01fc  e6 80       
    JP  Z,MVRFY2                        ;01fe  ca ef 01    
    LD  D,H                             ;0201  54          
    POP HL                              ;0202  e1          
    POP BC                              ;0203  c1          
    PUSH    BC                          ;0204  c5          
    PUSH    HL                          ;0205  e5          
                  ;
MVRFY3: CALL    VBLOAD                  ;0206  cd 59 02    
    JP  C,CLOAD5                        ;0209  da b3 01    
    CP  (HL)                            ;020c  be          
    JP  NZ,CLOAD3                       ;020d  c2 ad 01    
    INC HL                              ;0210  23          
    DEC BC                              ;0211  0b          
    LD  A,B                             ;0212  78          
    OR  C                               ;0213  b1          
    JP  NZ,MVRFY3                       ;0214  c2 06 02    
    LD  HL,(CKSMF2)                     ;0217  2a e5 11    
    CALL    VBLOAD                      ;021a  cd 59 02    
    CP  H                               ;021d  bc          
    JP  NZ,CLOAD3                       ;021e  c2 ad 01    
    CALL    VBLOAD                      ;0221  cd 59 02    
    CP  L                               ;0224  bd          
    JP  NZ,CLOAD3                       ;0225  c2 ad 01    
    DEC D                               ;0228  15          
    JP  Z,CLOAD8                        ;0229  ca 9c 01    
    LD  H,D                             ;022c  62          
    JP  MVRFYN                          ;022d  c3 e8 01    
                  ;
EDGE:                                   ;                  
MVRFY4: LD  A,080h                      ;0230  3e 80       
    IN  A,(0)                           ;0232  db 00       ;IN A,(8000H)
    AND 012h                            ;0234  e6 12       
    JP  NZ,MVRFY5                       ;0236  c2 3b 02    
    SCF                                 ;0239  37          
    RET                                 ;023a  c9          
                  ;
MVRFY5: LD  A,040h                      ;023b  3e 40       
    IN  A,(1)                           ;023d  db 01       ;IN A,(4001H)
    AND 080h                            ;023f  e6 80       
    JP  NZ,MVRFY4                       ;0241  c2 30 02    
                  ;
MVRFY6: LD  A,080h                      ;0244  3e 80       
    IN  A,(0)                           ;0246  db 00       ;IN A,(8001H)
    AND 012h                            ;0248  e6 12       
    JP  NZ,MVRFY7                       ;024a  c2 4f 02    
    SCF                                 ;024d  37          
    RET                                 ;024e  c9          
                  ;
MVRFY7: LD  A,040h                      ;024f  3e 40       
    IN  A,(1)                           ;0251  db 01       ;IN A,(4001H)
    AND 080h                            ;0253  e6 80       
    JP  Z,MVRFY6                        ;0255  ca 44 02    
    RET                                 ;0258  c9          
                  ;
VBLOAD: PUSH    BC                      ;0259  c5          
    PUSH    DE                          ;025a  d5          
    PUSH    HL                          ;025b  e5          
    LD  HL,00800h                       ;025c  21 00 08    
    LD  BC,04000h                       ;025f  01 00 40    
    LD  A,14                            ;0262  3e 0e       
    OUT (C),A                           ;0264  ed 79       
VBLOD1: CALL    EDGE                    ;0266  cd 30 02    
    JP  C,VBLOD3                        ;0269  da 8d 02    
    CALL    WAITR                       ;026c  cd c4 03    
    LD  A,040h                          ;026f  3e 40       
    IN  A,(1)                           ;0271  db 01       ;IN A,(4001H)
    AND 080h                            ;0273  e6 80       
    JP  Z,VBLOD2                        ;0275  ca 82 02    
    PUSH    HL                          ;0278  e5          
    LD  HL,(CKSMF1)                     ;0279  2a e3 11    
    INC HL                              ;027c  23          
    LD  (CKSMF1),HL                     ;027d  22 e3 11    
    POP HL                              ;0280  e1          
    SCF                                 ;0281  37          
                  ;
VBLOD2: LD  A,L                         ;0282  7d          
    RLA                                 ;0283  17          
    LD  L,A                             ;0284  6f          
    DEC H                               ;0285  25          
    JP  NZ,VBLOD1                       ;0286  c2 66 02    
    CALL    EDGE                        ;0289  cd 30 02    
    LD  A,L                             ;028c  7d          
                  ;
VBLOD3: POP HL                          ;028d  e1          
    POP DE                              ;028e  d1          
    POP BC                              ;028f  c1          
    RET                                 ;0290  c9          
                  ;
MKRD:   PUSH    BC                      ;0291  c5          
    PUSH    DE                          ;0292  d5          
    PUSH    HL                          ;0293  e5          
    LD  HL,02828h                       ;0294  21 28 28    
    LD  A,E                             ;0297  7b          
    CP  0CCh                            ;0298  fe cc       
    JP  Z,MKRD1                         ;029a  ca a0 02    
    LD  HL,01414h                       ;029d  21 14 14    
                  ;
MKRD1:  LD  (MKLEN),HL                  ;02a0  22 e7 11    
    LD  BC,04000h                       ;02a3  01 00 40    
    LD  A,14                            ;02a6  3e 0e       
    OUT (C),A                           ;02a8  ed 79       
MKRD4:  LD  HL,(MKLEN)                  ;02aa  2a e7 11    
                  ;
MKRD5:  CALL    EDGE                    ;02ad  cd 30 02    
    JP  C,MKRD3                         ;02b0  da dc 02    
    CALL    WAITR                       ;02b3  cd c4 03    
    LD  A,040h                          ;02b6  3e 40       
    IN  A,(1)                           ;02b8  db 01       ;IN A,(4001H)
    AND 080h                            ;02ba  e6 80       
    JP  Z,MKRD4                         ;02bc  ca aa 02    
    DEC H                               ;02bf  25          
    JP  NZ,MKRD5                        ;02c0  c2 ad 02    
                  ;
MKRD2:  CALL    EDGE                    ;02c3  cd 30 02    
    JP  C,MKRD3                         ;02c6  da dc 02    
    CALL    WAITR                       ;02c9  cd c4 03    
    LD  A,040h                          ;02cc  3e 40       
    IN  A,(1)                           ;02ce  db 01       ;IN A,(4001H)
    AND 080h                            ;02d0  e6 80       
    JP  NZ,MKRD4                        ;02d2  c2 aa 02    
    DEC L                               ;02d5  2d          
    JP  NZ,MKRD2                        ;02d6  c2 c3 02    
    CALL    EDGE                        ;02d9  cd 30 02    
                  ;
MKRD3:  POP HL                          ;02dc  e1          
    POP DE                              ;02dd  d1          
    POP BC                              ;02de  c1          
    RET                                 ;02df  c9          
                  ;
MOTON:  PUSH    BC                      ;02e0  c5          
    PUSH    DE                          ;02e1  d5          
    PUSH    HL                          ;02e2  e5          
    LD  BC,04000h                       ;02e3  01 00 40    
    LD  A,14                            ;02e6  3e 0e       ;A PORT SELECT
    OUT (C),A                           ;02e8  ed 79       
    LD  L,00Ah                          ;02ea  2e 0a       
    LD  BC,06000h                       ;02ec  01 00 60    
MOTON1: LD  A,040h                      ;02ef  3e 40       
    IN  A,(1)                           ;02f1  db 01       ;IN A,(4001H)
    AND 040h                            ;02f3  e6 40       
    JP  NZ,MOTON5                       ;02f5  c2 fd 02    
                  ;
MOTON6: XOR A                           ;02f8  af          
                  ;
MOTON4: POP HL                          ;02f9  e1          
    POP DE                              ;02fa  d1          
    POP BC                              ;02fb  c1          
    RET                                 ;02fc  c9          
                  ;
MOTON5: LD  A,(IO6000)                  ;02fd  3a e9 11    
    RES 1,A                             ;0300  cb 8f       
    OUT (C),A                           ;0302  ed 79       
    SET 1,A                             ;0304  cb cf       
    OUT (C),A                           ;0306  ed 79       
    LD  (IO6000),A                      ;0308  32 e9 11    
    DEC L                               ;030b  2d          
    JP  NZ,MOTON1                       ;030c  c2 ef 02    
    CALL    CR2                         ;030f  cd 23 08    
    LD  A,D                             ;0312  7a          
    CP  0D7h                            ;0313  fe d7       
    JR  Z,MOTON2                        ;0315  28 08       
    LD  DE,MBUF6                        ;0317  11 7e 03    
    CALL    DEPRT                       ;031a  cd f3 07    
    JR  MOTON3                          ;031d  18 0c       
                  ;
MOTON2: LD  DE,MBUF7                    ;031f  11 8f 03    
    CALL    DEPRT                       ;0322  cd f3 07    
    LD  DE,MBUF6A                       ;0325  11 83 03    
    CALL    DEPRT                       ;0328  cd f3 07    
                  ;
MOTON3: CALL    CR2                     ;032b  cd 23 08    
    LD  A,040h                          ;032e  3e 40       
    IN  A,(1)                           ;0330  db 01       ;IN A,(4001H)
    AND 040h                            ;0332  e6 40       
    JP  Z,MOTON6                        ;0334  ca f8 02    
    LD  A,080h                          ;0337  3e 80       
    IN  A,(0)                           ;0339  db 00       ;IN A,(8000H)
    AND 012h                            ;033b  e6 12       
    JP  NZ,MOTON3                       ;033d  c2 2b 03    
    SCF                                 ;0340  37          
    JP  MOTON4                          ;0341  c3 f9 02    
                  ;
MOTCH:  PUSH    AF                      ;0344  f5          
    PUSH    BC                          ;0345  c5          
    PUSH    DE                          ;0346  d5          
    LD  D,00Ah                          ;0347  16 0a       
    LD  BC,04000h                       ;0349  01 00 40    
    LD  A,14                            ;034c  3e 0e       
    OUT (C),A                           ;034e  ed 79       
    LD  BC,06000h                       ;0350  01 00 60    
MOTCH1: LD  A,040h                      ;0353  3e 40       
    IN  A,(1)                           ;0355  db 01       ;IN A,(4001H)
    AND 040h                            ;0357  e6 40       
    JR  Z,MOTCH2                        ;0359  28 04       
    POP DE                              ;035b  d1          
    POP BC                              ;035c  c1          
    POP AF                              ;035d  f1          
    RET                                 ;035e  c9          
                  ;
MOTCH2: LD  A,(IO6000)                  ;035f  3a e9 11    
    RES 1,A                             ;0362  cb 8f       
    OUT (C),A                           ;0364  ed 79       
    SET 1,A                             ;0366  cb cf       
    OUT (C),A                           ;0368  ed 79       
    LD  (IO6000),A                      ;036a  32 e9 11    
    DEC D                               ;036d  15          
    JP  NZ,MOTCH1                       ;036e  c2 53 03    
    POP DE                              ;0371  d1          
    POP BC                              ;0372  c1          
    POP AF                              ;0373  f1          
    RET                                 ;0374  c9          
                  ;
                  ;
WRITEM: DEFM    'WRITING '              ;0375  57 52 49 54 
                                        ;0379  49 4e 47 20    518    519
    DEFB    0                           ;037d  00          
                  ;
MBUF6:  DEFM    'PUSH '                 ;037e  50 55 53 48 
                                        ;0382  20             521    523
MBUF6A: DEFM    'PLAY BUTTON'           ;0383  50 4c 41 59 
                                        ;0387  20 42 55 54    522    525
                                        ;038b  54 4f 4e       522    526
    DEFB    0                           ;038e  00          
                  ;
MBUF7:  DEFM    'PUSH '                 ;038f  50 55 53 48 
                                        ;0393  20             525    530
    DEFM    'RECORD & '                 ;0394  52 45 43 4f 
                                        ;0398  52 44 20 26    526    532
                                        ;039c  20             526    533
                  
    DEFB    0                           ;039d  00          
                  ;
CKSUM:  PUSH    BC                      ;039e  c5          
    PUSH    DE                          ;039f  d5          
    PUSH    HL                          ;03a0  e5          
    LD  DE,00000h                       ;03a1  11 00 00    
                  ;
SUM1:   LD  A,B                         ;03a4  78          
    OR  C                               ;03a5  b1          
    JR  NZ,SUM2                         ;03a6  20 0b       
    EX  DE,HL                           ;03a8  eb          
    LD  (CKSMF1),HL                     ;03a9  22 e3 11    
    LD  (CKSMF2),HL                     ;03ac  22 e5 11    
    POP HL                              ;03af  e1          
    POP DE                              ;03b0  d1          
    POP BC                              ;03b1  c1          
    RET                                 ;03b2  c9          
                  ;
SUM2:   LD  A,(HL)                      ;03b3  7e          
    PUSH    HL                          ;03b4  e5          
    LD  H,008h                          ;03b5  26 08       
                  ;
SUM3:   RLCA                            ;03b7  07          
    JR  NC,SUM4                         ;03b8  30 01       
    INC DE                              ;03ba  13          
                  ;
SUM4:   DEC H                           ;03bb  25          
    JR  NZ,SUM3                         ;03bc  20 f9       
    POP HL                              ;03be  e1          
    INC HL                              ;03bf  23          
    DEC BC                              ;03c0  0b          
    JP  SUM1                            ;03c1  c3 a4 03    
                  ;
                  ;
                  ;WAITR:	RET			;★원래는 이 자리가 3E
                  ;	LD	E,D			;★원래는 LD A,90
WAITR:                                  ;                  
    LD  A,90                            ;03c4  3e 5a       ; 원래는 90
WAIT2:  DEC A                           ;03c6  3d          
    JP  NZ,WAIT2                        ;03c7  c2 c6 03    
    RET                                 ;03ca  c9          
                  ;
WRITES: PUSH    AF                      ;03cb  f5          
    PUSH    BC                          ;03cc  c5          
    LD  BC,06000h                       ;03cd  01 00 60    
    LD  A,(IO6000)                      ;03d0  3a e9 11    
    SET 0,A                             ;03d3  cb c7       
    OUT (C),A                           ;03d5  ed 79       
    PUSH    AF                          ;03d7  f5          
    LD  A,60                            ;03d8  3e 3c       ;MSX는 38
    CALL    WAIT2                       ;03da  cd c6 03    
    POP AF                              ;03dd  f1          
    RES 0,A                             ;03de  cb 87       
    OUT (C),A                           ;03e0  ed 79       
    LD  (IO6000),A                      ;03e2  32 e9 11    
    LD  A,55                            ;03e5  3e 37       ;MSX는 45
    CALL    WAIT2                       ;03e7  cd c6 03    
    POP BC                              ;03ea  c1          
    POP AF                              ;03eb  f1          
    RET                                 ;03ec  c9          
                  ;
WRITEL: PUSH    AF                      ;03ed  f5          
    PUSH    BC                          ;03ee  c5          
    LD  BC,06000h                       ;03ef  01 00 60    
    LD  A,(IO6000)                      ;03f2  3a e9 11    
    SET 0,A                             ;03f5  cb c7       
    OUT (C),A                           ;03f7  ed 79       
    PUSH    AF                          ;03f9  f5          
    LD  A,120                           ;03fa  3e 78       ;MSX는 83
    CALL    WAIT2                       ;03fc  cd c6 03    
    POP AF                              ;03ff  f1          
    RES 0,A                             ;0400  cb 87       
    OUT (C),A                           ;0402  ed 79       
    LD  (IO6000),A                      ;0404  32 e9 11    
    LD  A,115                           ;0407  3e 73       ;MSX는 92
    CALL    WAIT2                       ;0409  cd c6 03    
    POP BC                              ;040c  c1          
    POP AF                              ;040d  f1          
    RET                                 ;040e  c9          
                  ;
WRACC:  PUSH    BC                      ;040f  c5          
    LD  B,008h                          ;0410  06 08       
    CALL    WRITEL                      ;0412  cd ed 03    ;BIT 1 WRITE
                  ;
WRACC1: RLCA                            ;0415  07          
    CALL    C,WRITEL                    ;0416  dc ed 03    
    CALL    NC,WRITES                   ;0419  d4 cb 03    
    DEC B                               ;041c  05          
    JP  NZ,WRACC1                       ;041d  c2 15 04    
    POP BC                              ;0420  c1          
    RET                                 ;0421  c9          
                  ;
WRMRK:  PUSH    BC                      ;0422  c5          
    PUSH    DE                          ;0423  d5          
    LD  A,E                             ;0424  7b          
    LD  BC,055F0h                       ;0425  01 f0 55    
    LD  DE,02828h                       ;0428  11 28 28    
    CP  0CCh                            ;042b  fe cc       
    JP  Z,WMRK1                         ;042d  ca 36 04    
    LD  BC,02AF8h                       ;0430  01 f8 2a    
    LD  DE,01414h                       ;0433  11 14 14    
                  ;
WMRK1:  CALL    WRITES                  ;0436  cd cb 03    
    DEC BC                              ;0439  0b          
    LD  A,B                             ;043a  78          
    OR  C                               ;043b  b1          
    JR  NZ,WMRK1                        ;043c  20 f8       
                  ;
WMRK2:  CALL    WRITEL                  ;043e  cd ed 03    
    DEC D                               ;0441  15          
    JR  NZ,WMRK2                        ;0442  20 fa       
                  ;
WMRK3:  CALL    WRITES                  ;0444  cd cb 03    
    DEC E                               ;0447  1d          
    JR  NZ,WMRK3                        ;0448  20 fa       
    CALL    WRITEL                      ;044a  cd ed 03    
    POP DE                              ;044d  d1          
    POP BC                              ;044e  c1          
    RET                                 ;044f  c9          
                  ;
                  ;    MON (MONITOR)
                  ;
                  ;
MONOP:  PUSH    HL                      ;0450  e5          
    LD  (MONSTK),SP                     ;0451  ed 73 83 04 
MONCOM: CALL    CR2                     ;0455  cd 23 08    
    LD  A,'*'                           ;0458  3e 2a       ;02AH
    CALL    ACCPRT                      ;045a  cd 64 08    
MONINP: CALL    MONEDT                  ;045d  cd e1 04    
    JR  NC,MONINP                       ;0460  30 fb       
    LD  BC,MONCOM                       ;0462  01 55 04    
    PUSH    BC                          ;0465  c5          
    LD  A,(DE)                          ;0466  1a          
    INC DE                              ;0467  13          
    CP  '*'                             ;0468  fe 2a       ;02AH
    RET NZ                              ;046a  c0          
    CALL    DESMAL                      ;046b  cd 53 05    
    CP  'G'                             ;046e  fe 47       ;047H
    JR  Z,CALLAD                        ;0470  28 2c       ;★원래는 ADJUMP
    CP  'D'                             ;0472  fe 44       ;044H
    JR  Z,MEMDMP                        ;0474  28 2d       
    CP  'M'                             ;0476  fe 4d       ;04DH
    JR  Z,MEMWRT                        ;0478  28 0d       
    CP  'S'                             ;047a  fe 53       ;053H
    JP  Z,MONSAH                        ;047c  ca 8e 05    
    CP  'R'                             ;047f  fe 52       ;052H
    RET NZ                              ;0481  c0          
    DEFB    031h                        ;0482  31          ;LD SP,HHHH
MONSTK: DEFW    00000h                  ;0483  00 00       
    POP HL                              ;0485  e1          
    RET                                 ;0486  c9          
                  ;
MEMWRT: CALL    HLSET                   ;0487  cd 09 05    
WRTLP:  CALL    CRHLDS                  ;048a  cd 80 05    
    CALL    HLINDS                      ;048d  cd 5e 05    
    PUSH    HL                          ;0490  e5          
    CALL    LEFT                        ;0491  cd 48 0b    
    CALL    LEFT                        ;0494  cd 48 0b    
    POP HL                              ;0497  e1          
    CALL    MONEDT                      ;0498  cd e1 04    
    JR  NC,WRTLP                        ;049b  30 ed       
    RET                                 ;049d  c9          
                  ;
CALLAD: CALL    HLSET                   ;049e  cd 09 05    ;★원래는 ADJUMP
    RET C                               ;04a1  d8          
    JP  (HL)                            ;04a2  e9          
                  ;
                  ;
MEMDMP: CALL    HLSET                   ;04a3  cd 09 05    
    PUSH    HL                          ;04a6  e5          
    CALL    HLSET                       ;04a7  cd 09 05    
    JR  NC,HLSTOK                       ;04aa  30 06       
    POP HL                              ;04ac  e1          
    PUSH    HL                          ;04ad  e5          
    LD  BC,0003Fh                       ;04ae  01 3f 00    
    ADD HL,BC                           ;04b1  09          
HLSTOK: LD  (HLEND),HL                  ;04b2  22 bb 04    
    POP HL                              ;04b5  e1          
MEMDPL: CALL    DMPSUB                  ;04b6  cd c8 04    
    RET Z                               ;04b9  c8          
    DEFB    011h                        ;04ba  11          ;LD DE,HHHH
HLEND:  DEFW    0FFFFh                  ;04bb  ff ff       ;★원래는 0000H
    EX  DE,HL                           ;04bd  eb          
    OR  A                               ;04be  b7          
    SBC HL,DE                           ;04bf  ed 52       
    EX  DE,HL                           ;04c1  eb          
    JR  NC,MEMDPL                       ;04c2  30 f2       
    RET                                 ;04c4  c9          
                  ;
                  ;
MONDPS: LD  B,C                         ;04c5  41          
    JR  DMPSB2                          ;04c6  18 02       
DMPSUB: DEFB    006h                    ;04c8  06          ;LD B,008H
LINCNT: DEFB    008h                    ;04c9  08          
DMPSB2: CALL    CRHLDS                  ;04ca  cd 80 05    
MEMLP2: CALL    HLINDS                  ;04cd  cd 5e 05    
    INC HL                              ;04d0  23          
    DJNZ    MEMLP2                      ;04d1  10 fa       
SPCSTP: LD  A,080h                      ;04d3  3e 80       
    IN  A,(001h)                        ;04d5  db 01       
    AND 004h                            ;04d7  e6 04       
    JR  Z,SPCSTP                        ;04d9  28 f8       
    CALL    CR2                         ;04db  cd 23 08    
    JP  BRKEY                           ;04de  c3 5b 0c    
                  ;
MONEDT: LD  DE,KEYBUF                   ;04e1  11 4f 7a    
    CALL    INPUTF                      ;04e4  cd a4 06    
    CALL    HLSET                       ;04e7  cd 09 05    
    RET C                               ;04ea  d8          
    INC DE                              ;04eb  13          
DATAST: INC DE                          ;04ec  13          
    CALL    ACCSET                      ;04ed  cd f6 04    
    CCF                                 ;04f0  3f          
    RET NC                              ;04f1  d0          
    LD  (HL),A                          ;04f2  77          
    INC HL                              ;04f3  23          
    JR  DATAST                          ;04f4  18 f6       
                  ;
ACCSET: LD  A,(DE)                      ;04f6  1a          
    CP  '                               ;04f7  fe 3b       ;'		;03BH
    JR  NZ,AHEXIN                       ;04f9  20 05       
    INC DE                              ;04fb  13          
    LD  A,(DE)                          ;04fc  1a          
    INC DE                              ;04fd  13          
    OR  A                               ;04fe  b7          
    RET                                 ;04ff  c9          
AHEXIN: PUSH    DE                      ;0500  d5          
    CALL    HEX2IN                      ;0501  cd 2c 05    ;★원래는 2HEXIN인데 라벨이 숫자부터 시작이 가능했었나보다.
    POP DE                              ;0504  d1          
    RET C                               ;0505  d8          
    INC DE                              ;0506  13          
    INC DE                              ;0507  13          
    RET                                 ;0508  c9          
                  ;
HLSET:  LD  A,(DE)                      ;0509  1a          
    INC DE                              ;050a  13          
    CP  020h                            ;050b  fe 20       
    JR  Z,HLSET                         ;050d  28 fa       
    DEC DE                              ;050f  1b          
    PUSH    HL                          ;0510  e5          
    CALL    HEX4IN                      ;0511  cd 1f 05    ;★원래는 4HEXIN인데 라벨이 숫자부터 시작이 가능했었나보다.
    JR  C,HLHOLD                        ;0514  38 07       
    POP AF                              ;0516  f1          
    INC DE                              ;0517  13          
    INC DE                              ;0518  13          
    INC DE                              ;0519  13          
    INC DE                              ;051a  13          
    OR  A                               ;051b  b7          
    RET                                 ;051c  c9          
HLHOLD: POP HL                          ;051d  e1          
    RET                                 ;051e  c9          
                  ;
HEX4IN: PUSH    DE                      ;051f  d5          
    CALL    HEX2IN                      ;0520  cd 2c 05    
    JR  C,HEX4ER                        ;0523  38 05       ;★원래는 4HEXER인데 라벨이 숫자부터 시작이 가능했었나보다.
    LD  H,A                             ;0525  67          
    CALL    HEX2IN                      ;0526  cd 2c 05    
    LD  L,A                             ;0529  6f          
HEX4ER: POP DE                          ;052a  d1          
    RET                                 ;052b  c9          
                  ;
HEX2IN: CALL    BHEXIN                  ;052c  cd 40 05    
    RET C                               ;052f  d8          
    PUSH    BC                          ;0530  c5          
    RLCA                                ;0531  07          
    RLCA                                ;0532  07          
    RLCA                                ;0533  07          
    RLCA                                ;0534  07          
    LD  C,A                             ;0535  4f          
    CALL    BHEXIN                      ;0536  cd 40 05    
    PUSH    AF                          ;0539  f5          
    OR  C                               ;053a  b1          
    LD  C,A                             ;053b  4f          
    POP AF                              ;053c  f1          
    LD  A,C                             ;053d  79          
    POP BC                              ;053e  c1          
    RET                                 ;053f  c9          
                  ;
BHEXIN: CALL    DESMAL                  ;0540  cd 53 05    
    SUB 030h                            ;0543  d6 30       
    RET C                               ;0545  d8          
    CP  00Ah                            ;0546  fe 0a       
    CCF                                 ;0548  3f          
    RET NC                              ;0549  d0          
    CP  011h                            ;054a  fe 11       
    RET C                               ;054c  d8          
    SUB 007h                            ;054d  d6 07       
    CP  010h                            ;054f  fe 10       
    CCF                                 ;0551  3f          
    RET                                 ;0552  c9          
                  ;
DESMAL: LD  A,(DE)                      ;0553  1a          
    INC DE                              ;0554  13          
    CP  'a'                             ;0555  fe 61       ;061h
    RET C                               ;0557  d8          
    CP  'z'+1                           ;0558  fe 7b       ;07Bh
    RET NC                              ;055a  d0          
    SUB ' '                             ;055b  d6 20       ;020h
    RET                                 ;055d  c9          
                  ;
                  ;
                  ;
HLINDS: CALL    SPPRT                   ;055e  cd 62 08    
    LD  A,(HL)                          ;0561  7e          
HEX2PR: PUSH    AF                      ;0562  f5          ;★원래는 2HEXPR인데 라벨이 숫자부터 시작이 가능했었나보다.
    AND 0F0h                            ;0563  e6 f0       
    RRCA                                ;0565  0f          
    RRCA                                ;0566  0f          
    RRCA                                ;0567  0f          
    RRCA                                ;0568  0f          
    CALL    ASCSET                      ;0569  cd 78 05    
    CALL    ACCPRT                      ;056c  cd 64 08    
    POP AF                              ;056f  f1          
    AND 00Fh                            ;0570  e6 0f       
    CALL    ASCSET                      ;0572  cd 78 05    
    JP  ACCPRT                          ;0575  c3 64 08    
ASCSET: ADD A,'0'                       ;0578  c6 30       ;030h
    CP  '9'+1                           ;057a  fe 3a       ;03Ah
    RET C                               ;057c  d8          
    ADD A,007h                          ;057d  c6 07       
    RET                                 ;057f  c9          
                  ;
CRHLDS: CALL    CR2                     ;0580  cd 23 08    
    LD  A,H                             ;0583  7c          
    CALL    HEX2PR                      ;0584  cd 62 05    
    LD  A,L                             ;0587  7d          
    CALL    HEX2PR                      ;0588  cd 62 05    
    JP  SPPRT                           ;058b  c3 62 08    
MONSAH: CALL    HLSET                   ;058e  cd 09 05    
    RET C                               ;0591  d8          
    PUSH    HL                          ;0592  e5          
    CALL    HLSET                       ;0593  cd 09 05    
    POP BC                              ;0596  c1          
    RET C                               ;0597  d8          
    PUSH    HL                          ;0598  e5          
    PUSH    BC                          ;0599  c5          
    LD  HL,KEYBUF                       ;059a  21 4f 7a    
    CALL    DATAST                      ;059d  cd ec 04    
    LD  DE,KEYBUF                       ;05a0  11 4f 7a    
    OR  A                               ;05a3  b7          
    SBC HL,DE                           ;05a4  ed 52       
    LD  C,L                             ;05a6  4d          
    POP HL                              ;05a7  e1          
    PUSH    HL                          ;05a8  e5          
    EXX                                 ;05a9  d9          
    POP HL                              ;05aa  e1          
    POP DE                              ;05ab  d1          
    EXX                                 ;05ac  d9          
    RET Z                               ;05ad  c8          
MNSHLP: CALL    HLDECK                  ;05ae  cd c2 05    
    CALL    Z,MONDPS                    ;05b1  cc c5 04    
    RET Z                               ;05b4  c8          
    EXX                                 ;05b5  d9          
    INC HL                              ;05b6  23          
    PUSH    HL                          ;05b7  e5          
    SCF                                 ;05b8  37          
    SBC HL,DE                           ;05b9  ed 52       
    POP HL                              ;05bb  e1          
    RET NC                              ;05bc  d0          
    PUSH    HL                          ;05bd  e5          
    EXX                                 ;05be  d9          
    POP HL                              ;05bf  e1          
    JR  MNSHLP                          ;05c0  18 ec       
                  ;
HLDECK: LD  A,(DE)                      ;05c2  1a          
    CP  (HL)                            ;05c3  be          
    RET NZ                              ;05c4  c0          
    PUSH    BC                          ;05c5  c5          
    PUSH    DE                          ;05c6  d5          
    PUSH    HL                          ;05c7  e5          
    LD  B,C                             ;05c8  41          
HLDEC1: LD  A,(DE)                      ;05c9  1a          
    CP  (HL)                            ;05ca  be          
    JR  NZ,HLDEC2                       ;05cb  20 05       
    INC DE                              ;05cd  13          
    INC HL                              ;05ce  23          
    DJNZ    HLDEC1                      ;05cf  10 f8       
    XOR A                               ;05d1  af          
HLDEC2: POP HL                          ;05d2  e1          
    POP DE                              ;05d3  d1          
    POP BC                              ;05d4  c1          
    RET                                 ;05d5  c9          
                  ;
SCRNBC: LD  A,C                         ;05d6  79          ;SCREEN B,C
    CP  5                               ;05d7  fe 05       
    RET NC                              ;05d9  d0          
    OR  A                               ;05da  b7          
    LD  HL,SCRN00                       ;05db  21 68 06    
    JR  Z,SCRNS0                        ;05de  28 13       
    LD  A,B                             ;05e0  78          
    LD  B,0                             ;05e1  06 00       
    DEC C                               ;05e3  0d          
    LD  HL,SCRNTB                       ;05e4  21 60 06    
    RL  C                               ;05e7  cb 11       
    ADD HL,BC                           ;05e9  09          
    LD  E,(HL)                          ;05ea  5e          
    INC HL                              ;05eb  23          
    LD  D,(HL)                          ;05ec  56          
    EX  DE,HL                           ;05ed  eb          
    DEC A                               ;05ee  3d          
    RLCA                                ;05ef  07          
    RLCA                                ;05f0  07          
    RLCA                                ;05f1  07          
    RLCA                                ;05f2  07          
SCRNS0: LD  E,A                         ;05f3  5f          
    LD  A,(IO2000)                      ;05f4  3a ea 11    
    AND 0CFh                            ;05f7  e6 cf       
    OR  E                               ;05f9  b3          
    CALL    IO20SB                      ;05fa  cd 62 00    
    LD  E,(HL)                          ;05fd  5e          
    INC HL                              ;05fe  23          
    LD  D,(HL)                          ;05ff  56          
    INC HL                              ;0600  23          
    EX  DE,HL                           ;0601  eb          
    LD  (LINEFR),HL                     ;0602  22 fa 0a    
    EX  DE,HL                           ;0605  eb          
    LD  E,(HL)                          ;0606  5e          
    INC HL                              ;0607  23          
    LD  D,(HL)                          ;0608  56          
    INC HL                              ;0609  23          
    EX  DE,HL                           ;060a  eb          
    LD  (PAGE16+1),HL                   ;060b  22 02 0a    
    EX  DE,HL                           ;060e  eb          
    LD  E,(HL)                          ;060f  5e          
    INC HL                              ;0610  23          
    LD  D,(HL)                          ;0611  56          
    INC HL                              ;0612  23          
    EX  DE,HL                           ;0613  eb          
    LD  (PAGE11+1),HL                   ;0614  22 b3 09    
    LD  (PAGE17+1),HL                   ;0617  22 08 0a    
    LD  BC,2                            ;061a  01 02 00    ;★이 2줄 4바이트는
    ADD HL,BC                           ;061d  09          ;INC HL 두 번 2바이트면 가능하다.
    LD  A,L                             ;061e  7d          
    LD  (PAGE23+1),A                    ;061f  32 fd 0a    
    EX  DE,HL                           ;0622  eb          
    LD  E,(HL)                          ;0623  5e          
    INC HL                              ;0624  23          
    LD  D,(HL)                          ;0625  56          
    INC HL                              ;0626  23          
    EX  DE,HL                           ;0627  eb          
    LD  (CHRSTA),HL                     ;0628  22 d6 0a    
    LD  (PAGE05+1),HL                   ;062b  22 47 09    
    PUSH    HL                          ;062e  e5          
    SET 3,H                             ;062f  cb dc       
    LD  (ATRSTA),HL                     ;0631  22 e6 0a    
    EX  DE,HL                           ;0634  eb          
    LD  E,(HL)                          ;0635  5e          
    INC HL                              ;0636  23          
    LD  D,(HL)                          ;0637  56          
    INC HL                              ;0638  23          
    EX  DE,HL                           ;0639  eb          
    LD  (CHRLEN),HL                     ;063a  22 e9 0a    
    LD  BC,0FFE0h                       ;063d  01 e0 ff    
    ADD HL,BC                           ;0640  09          
    LD  (CHRLE2),HL                     ;0641  22 fc 09    
    POP BC                              ;0644  c1          
    ADD HL,BC                           ;0645  09          
    LD  BC,0001Fh                       ;0646  01 1f 00    
    ADD HL,BC                           ;0649  09          
    LD  (PAGE12+1),HL                   ;064a  22 ef 09    
    SET 3,H                             ;064d  cb dc       
    LD  (PAGE14+1),HL                   ;064f  22 f9 09    
    EX  DE,HL                           ;0652  eb          
    LD  E,(HL)                          ;0653  5e          
    INC HL                              ;0654  23          
    LD  D,(HL)                          ;0655  56          
    EX  DE,HL                           ;0656  eb          
    LD  (PAGE02+1),HL                   ;0657  22 09 09    
    SET 3,H                             ;065a  cb dc       
    LD  (PAGE04+1),HL                   ;065c  22 16 09    
    RET                                 ;065f  c9          
                  ;
                  ;
                  ;
SCRNTB: DEFW    SCRN01                  ;0660  74 06       
    DEFW    SCRN02                      ;0662  80 06       
    DEFW    SCRN03                      ;0664  8c 06       
    DEFW    SCRN04                      ;0666  98 06       
                  ;
SCRN00: DEFW    LINEF                   ;0668  a2 11       ;LINEFR
    DEFW    LINEF+63                    ;066a  e1 11       ;PAGE16
    DEFW    63                          ;066c  3f 00       ;PAGE11
    DEFW    00000h                      ;066e  00 00       ;CHRSTA
    DEFW    00800h                      ;0670  00 08       ;CHRLEN
    DEFW    00200h                      ;0672  00 02       ;PAGE02
                  ;
SCRN01: DEFW    LINEF                   ;0674  a2 11       ;LINEFR
    DEFW    LINEF+15                    ;0676  b1 11       ;PAGE16
    DEFW    15                          ;0678  0f 00       ;PAGE11
    DEFW    00000h                      ;067a  00 00       ;CHRSTA
    DEFW    00200h                      ;067c  00 02       ;CHRLEN
    DEFW    00000h                      ;067e  00 00       ;PAGE02
                  ;
SCRN02: DEFW    LINEF+16                ;0680  b2 11       ;LINEFR
    DEFW    LINEF+31                    ;0682  c1 11       ;PAGE16
    DEFW    15                          ;0684  0f 00       ;PAGE11
    DEFW    00200h                      ;0686  00 02       ;CHRSTA
    DEFW    00200h                      ;0688  00 02       ;CHRLEN
    DEFW    00200h                      ;068a  00 02       ;PAGE02
                  ;
SCRN03: DEFW    LINEF+32                ;068c  c2 11       ;LINEFR
    DEFW    LINEF+47                    ;068e  d1 11       ;PAGE16
    DEFW    015                         ;0690  0f 00       ;PAGE11
    DEFW    00400h                      ;0692  00 04       ;CHRSTA
    DEFW    00200h                      ;0694  00 02       ;CHRLEN
    DEFW    00400h                      ;0696  00 04       ;PAGE02
                  ;
SCRN04: DEFW    LINEF+48                ;0698  d2 11       ;LINEFR
    DEFW    LINEF+63                    ;069a  e1 11       ;PAGE16
    DEFW    015                         ;069c  0f 00       ;PAGE11
    DEFW    00600h                      ;069e  00 06       ;CHRSTA
    DEFW    00200h                      ;06a0  00 02       ;CHRLEN
    DEFW    00600h                      ;06a2  00 06       ;PAGE02
                  ;DE INPUT ASCII(END=0D 00)
INPUTF: PUSH    AF                      ;06a4  f5          
    PUSH    BC                          ;06a5  c5          
    PUSH    HL                          ;06a6  e5          
    PUSH    DE                          ;06a7  d5          
    LD  A,1                             ;06a8  3e 01       
    LD  (FLASHF),A                      ;06aa  32 7f 0c    
INKYLP: LD  HL,INKYLP                   ;06ad  21 ad 06    
    PUSH    HL                          ;06b0  e5          
    CALL    ASCGET                      ;06b1  cd 62 0c    
    PUSH    AF                          ;06b4  f5          
    LD  A,(BELLFG)                      ;06b5  3a 7f 11    
    OR  A                               ;06b8  b7          
    CALL    NZ,BELL2                    ;06b9  c4 d2 06    
    POP AF                              ;06bc  f1          
    DEFB    0FEh                        ;06bd  fe          ;CP 03H
BREAKI: DEFB    003h                    ;06be  03          
    JP  Z,BRKJOB                        ;06bf  ca 4c 07    
    CP  00Dh                            ;06c2  fe 0d       
    JP  Z,CRJOB                         ;06c4  ca 5f 07    
    JP  ACCOUT                          ;06c7  c3 d9 08    
                  ;
BELL:   LD  DE,BELLT2                   ;06ca  11 48 07    
    LD  HL,01000h                       ;06cd  21 00 10    
    JR  BELL3                           ;06d0  18 06       
                  ;
BELL2:  LD  DE,BELLTB                   ;06d2  11 44 07    
    LD  HL,000C0h                       ;06d5  21 c0 00    
BELL3:  LD  BC,04000h                   ;06d8  01 00 40    
    PUSH    HL                          ;06db  e5          
    LD  HL,BELLBF                       ;06dc  21 40 07    
    XOR A                               ;06df  af          
    OUT (C),A                           ;06e0  ed 79       
    INC C                               ;06e2  0c          
    IN  A,(C)                           ;06e3  ed 78       
    LD  (HL),A                          ;06e5  77          
    LD  A,(DE)                          ;06e6  1a          
    OUT (C),A                           ;06e7  ed 79       
    DEC C                               ;06e9  0d          
    INC DE                              ;06ea  13          
    INC HL                              ;06eb  23          
    LD  A,1                             ;06ec  3e 01       
    OUT (C),A                           ;06ee  ed 79       
    INC C                               ;06f0  0c          
    IN  A,(C)                           ;06f1  ed 78       
    LD  (HL),A                          ;06f3  77          
    LD  A,(DE)                          ;06f4  1a          
    OUT (C),A                           ;06f5  ed 79       
    DEC C                               ;06f7  0d          
    INC DE                              ;06f8  13          
    INC HL                              ;06f9  23          
    LD  A,8                             ;06fa  3e 08       
    OUT (C),A                           ;06fc  ed 79       
    INC C                               ;06fe  0c          
    IN  A,(C)                           ;06ff  ed 78       
    LD  (HL),A                          ;0701  77          
    LD  A,(DE)                          ;0702  1a          
    OUT (C),A                           ;0703  ed 79       
    DEC C                               ;0705  0d          
    INC DE                              ;0706  13          
    INC HL                              ;0707  23          
    LD  A,7                             ;0708  3e 07       
    OUT (C),A                           ;070a  ed 79       
    INC C                               ;070c  0c          
    IN  A,(C)                           ;070d  ed 78       
    LD  (HL),A                          ;070f  77          
    LD  A,(DE)                          ;0710  1a          
    OUT (C),A                           ;0711  ed 79       
    DEC C                               ;0713  0d          
    POP DE                              ;0714  d1          
L0715:  DEC DE                          ;0715  1b          
    LD  A,D                             ;0716  7a          
    OR  E                               ;0717  b3          
    JR  NZ,L0715                        ;0718  20 fb       
    LD  A,7                             ;071a  3e 07       
    OUT (C),A                           ;071c  ed 79       
    INC C                               ;071e  0c          
    LD  A,(HL)                          ;071f  7e          
    OUT (C),A                           ;0720  ed 79       
    DEC C                               ;0722  0d          
    DEC HL                              ;0723  2b          
    LD  A,8                             ;0724  3e 08       
    OUT (C),A                           ;0726  ed 79       
    INC C                               ;0728  0c          
    LD  A,(HL)                          ;0729  7e          
    OUT (C),A                           ;072a  ed 79       
    DEC C                               ;072c  0d          
    DEC HL                              ;072d  2b          
    LD  A,1                             ;072e  3e 01       
    OUT (C),A                           ;0730  ed 79       
    INC C                               ;0732  0c          
    LD  A,(HL)                          ;0733  7e          
    OUT (C),A                           ;0734  ed 79       
    DEC C                               ;0736  0d          
    DEC HL                              ;0737  2b          
    XOR A                               ;0738  af          
    OUT (C),A                           ;0739  ed 79       
    INC C                               ;073b  0c          
    LD  A,(HL)                          ;073c  7e          
    OUT (C),A                           ;073d  ed 79       
    RET                                 ;073f  c9          
                  ;
BELLBF: DEFS    4                       ;0740              
BELLTB: DEFB    208                     ;0744  d0          
    DEFB    0                           ;0745  00          
    DEFB    00Ch                        ;0746  0c          
    DEFB    07Eh                        ;0747  7e          
                  ;
BELLT2: DEFW    0007Fh                  ;0748  7f 00       
    DEFB    00Fh                        ;074a  0f          
    DEFB    07Eh                        ;074b  7e          
                  ;
BRKJOB: POP AF                          ;074c  f1          
    POP HL                              ;074d  e1          
    PUSH    HL                          ;074e  e5          
    LD  (HL),003h                       ;074f  36 03       
CRJOB2: INC HL                          ;0751  23          
    LD  (HL),00Dh                       ;0752  36 0d       
    INC HL                              ;0754  23          
    LD  (HL),000h                       ;0755  36 00       
INPEND: CALL    CTRLM                   ;0757  cd 62 0b    
ACCEND: POP DE                          ;075a  d1          
    POP HL                              ;075b  e1          
    POP BC                              ;075c  c1          
    POP AF                              ;075d  f1          
    RET                                 ;075e  c9          
                  ;
CRJOB:  POP AF                          ;075f  f1          
    CALL    BCUYST                      ;0760  cd ba 07    
    PUSH    DE                          ;0763  d5          
    CALL    ECUYS2                      ;0764  cd c8 07    
    LD  A,E                             ;0767  7b          
    POP DE                              ;0768  d1          
    SUB E                               ;0769  93          
    CP  8                               ;076a  fe 08       
    JR  C,L0770                         ;076c  38 02       
    LD  A,7                             ;076e  3e 07       
L0770:  RLCA                            ;0770  07          
    RLCA                                ;0771  07          
    RLCA                                ;0772  07          
    RLCA                                ;0773  07          
    RLCA                                ;0774  07          
    LD  D,A                             ;0775  57          
    LD  H,E                             ;0776  63          
    LD  L,0                             ;0777  2e 00       
    CALL    ADRCA2                      ;0779  cd 3b 09    
    POP HL                              ;077c  e1          
    PUSH    HL                          ;077d  e5          
CRJOBL: CALL    AINBC                   ;077e  cd 94 07    
    OR  A                               ;0781  b7          
    JR  NZ,L0786                        ;0782  20 02       
    LD  A,020h                          ;0784  3e 20       
L0786:  LD  (HL),A                      ;0786  77          
    INC HL                              ;0787  23          
    INC BC                              ;0788  03          
    DEC D                               ;0789  15          
    JR  NZ,CRJOBL                       ;078a  20 f2       
    LD  A,020h                          ;078c  3e 20       
CRJOBP: DEC HL                          ;078e  2b          
    CP  (HL)                            ;078f  be          
    JR  Z,CRJOBP                        ;0790  28 fc       
    JR  CRJOB2                          ;0792  18 bd       
                  ;
AINBC:  PUSH    BC                      ;0794  c5          ;INSERT키가 눌리면 그 라인의 TEXT 끝부터 32번
    IN  A,(C)                           ;0795  ed 78       ;COLUMN 사이에 BLANK가 있는지 확인
    AND 07Fh                            ;0797  e6 7f       
    SET 3,B                             ;0799  cb d8       
    IN  C,(C)                           ;079b  ed 48       
    BIT 2,C                             ;079d  cb 51       
    JR  Z,ALPHA                         ;079f  28 0a       
    BIT 3,C                             ;07a1  cb 59       
    JR  NZ,SEMI6                        ;07a3  20 12       
    AND 00Fh                            ;07a5  e6 0f       
    ADD A,0E0h                          ;07a7  c6 e0       
    JR  AINOK                           ;07a9  18 0a       
ALPHA:  BIT 3,C                         ;07ab  cb 59       
    JR  Z,AINOK                         ;07ad  28 06       
    CP  060h                            ;07af  fe 60       
    JR  NC,AINOK                        ;07b1  30 02       
    ADD A,080h                          ;07b3  c6 80       
AINOK:  POP BC                          ;07b5  c1          
    RET                                 ;07b6  c9          
SEMI6:  POP BC                          ;07b7  c1          
    XOR A                               ;07b8  af          
    RET                                 ;07b9  c9          
                  ;
BCUYST: CALL    CUTBHL                  ;07ba  cd d3 07    
    XOR A                               ;07bd  af          
LPBNST: CP  (HL)                        ;07be  be          
    RET Z                               ;07bf  c8          
    DEC HL                              ;07c0  2b          
    DEC E                               ;07c1  1d          
    JR  NZ,LPBNST                       ;07c2  20 fa       
    RET                                 ;07c4  c9          
                  ;
ECUYST: CALL    CUTBHL                  ;07c5  cd d3 07    
ECUYS2: INC HL                          ;07c8  23          
    INC E                               ;07c9  1c          
    LD  A,E                             ;07ca  7b          
    CP  16                              ;07cb  fe 10       ;16라인(1페이지)를 통과했는지 체크
    RET NC                              ;07cd  d0          
    XOR A                               ;07ce  af          
    CP  (HL)                            ;07cf  be          
    JR  NZ,ECUYS2                       ;07d0  20 f6       
    RET                                 ;07d2  c9          
                  ;
CUTBHL: LD  A,(CURY)                    ;07d3  3a ee 11    
ATBHL:  LD  E,A                         ;07d6  5f          
    LD  D,0                             ;07d7  16 00       
    LD  HL,(LINEFR)                     ;07d9  2a fa 0a    
    ADD HL,DE                           ;07dc  19          ;CURY+LINEFR(01 OR 00)
    RET                                 ;07dd  c9          
                  ;
                  ; OUTPUT
CR1DEP: CALL    CR1                     ;07de  cd 43 08    
                  ;
PRTSDC: PUSH    AF                      ;07e1  f5          
    PUSH    BC                          ;07e2  c5          
    PUSH    DE                          ;07e3  d5          
    LD  A,B                             ;07e4  78          
    OR  A                               ;07e5  b7          
    JR  Z,PRTSDE                        ;07e6  28 07       
PRTSDL: LD  A,(DE)                      ;07e8  1a          
    INC DE                              ;07e9  13          
    CALL    ACCPRT                      ;07ea  cd 64 08    
    DJNZ    PRTSDL                      ;07ed  10 f9       
PRTSDE: POP DE                          ;07ef  d1          
    POP BC                              ;07f0  c1          
    POP AF                              ;07f1  f1          
    RET                                 ;07f2  c9          
                  ;
DEPRT:  PUSH    AF                      ;07f3  f5          
    PUSH    DE                          ;07f4  d5          
DEPRTL: LD  A,(DE)                      ;07f5  1a          
    OR  A                               ;07f6  b7          
    JR  Z,DEPRTR                        ;07f7  28 06       
    CALL    ACCPRT                      ;07f9  cd 64 08    
    INC DE                              ;07fc  13          
    JR  DEPRTL                          ;07fd  18 f6       
DEPRTR: POP DE                          ;07ff  d1          
    POP AF                              ;0800  f1          
    RET                                 ;0801  c9          
                  ;
                  ;
TABPRT: PUSH    HL                      ;0802  e5          
    LD  A,(DISFLG)                      ;0803  3a eb 11    
    CP  2                               ;0806  fe 02       
    LD  HL,CURX                         ;0808  21 ed 11    
    JR  C,TABPRL                        ;080b  38 0c       
    LD  HL,PRINTN                       ;080d  21 ec 11    
    JR  Z,TABPRL                        ;0810  28 07       
    LD  A,','                           ;0812  3e 2c       ;02Ch
    CALL    ACCPRT                      ;0814  cd 64 08    
    POP HL                              ;0817  e1          
    RET                                 ;0818  c9          
                  ;
TABPRL: CALL    SPPRT                   ;0819  cd 62 08    
    LD  A,(HL)                          ;081c  7e          
    AND 7                               ;081d  e6 07       
    JR  NZ,TABPRL                       ;081f  20 f8       
    POP HL                              ;0821  e1          
    RET                                 ;0822  c9          
                  ;
CR2:    LD  A,(DISFLG)                  ;0823  3a eb 11    
    CP  2                               ;0826  fe 02       
    JR  C,CCR2                          ;0828  38 09       
    JR  NZ,CR1                          ;082a  20 17       
    LD  A,(PRINTN)                      ;082c  3a ec 11    
    OR  A                               ;082f  b7          
    RET Z                               ;0830  c8          
    JR  CR1                             ;0831  18 10       
CCR2:   LD  A,(CURX)                    ;0833  3a ed 11    
    OR  A                               ;0836  b7          
    JR  NZ,CR1                          ;0837  20 0a       
    PUSH    HL                          ;0839  e5          
    PUSH    DE                          ;083a  d5          
    CALL    CUTBHL                      ;083b  cd d3 07    
    LD  A,(HL)                          ;083e  7e          
    POP DE                              ;083f  d1          
    POP HL                              ;0840  e1          
    OR  A                               ;0841  b7          
    RET Z                               ;0842  c8          
                  ;
CR1:    LD  A,(DISFLG)                  ;0843  3a eb 11    
    OR  A                               ;0846  b7          
    JR  Z,CR1CTM                        ;0847  28 0f       
    CP  2                               ;0849  fe 02       
    LD  A,00Dh                          ;084b  3e 0d       
    JR  NZ,ACCPRT                       ;084d  20 15       
    LD  A,0FFh                          ;084f  3e ff       
    LD  (PRINTN),A                      ;0851  32 ec 11    
    LD  A,00Ah                          ;0854  3e 0a       
    JR  ACCPRT                          ;0856  18 0c       
                  ;
CR1CTM: PUSH    BC                      ;0858  c5          
    PUSH    DE                          ;0859  d5          
    PUSH    HL                          ;085a  e5          
    CALL    CTRLM                       ;085b  cd 62 0b    
    POP HL                              ;085e  e1          
    POP DE                              ;085f  d1          
    POP BC                              ;0860  c1          
    RET                                 ;0861  c9          
                  ;
SPPRT:  LD  A,' '                       ;0862  3e 20       ;020h
                  ;
ACCPRT: PUSH    AF                      ;0864  f5          
    PUSH    BC                          ;0865  c5          
    PUSH    DE                          ;0866  d5          
    PUSH    HL                          ;0867  e5          
    CALL    ACCOUS                      ;0868  cd 70 08    
    POP HL                              ;086b  e1          
    POP DE                              ;086c  d1          
    POP BC                              ;086d  c1          
    POP AF                              ;086e  f1          
    RET                                 ;086f  c9          
                  ;
ACCOUS: LD  HL,(DISFLG)                 ;0870  2a eb 11    
    INC L                               ;0873  2c          
    DEC L                               ;0874  2d          
    JP  Z,ACCDIS                        ;0875  ca de 08    
    DEC L                               ;0878  2d          
    JP  Z,ACCOUT                        ;0879  ca d9 08    
    DEC L                               ;087c  2d          
    JP  NZ,CTOUT                        ;087d  c2 58 45    
    LD  HL,(PRINTN)                     ;0880  2a ec 11    
    INC L                               ;0883  2c          
    LD  (PRINTN),HL                     ;0884  22 ec 11    
                  ;
PRINTR: PUSH    AF                      ;0887  f5          
    CALL    PSGST                       ;0888  cd a9 08    
    LD  E,000h                          ;088b  1e 00       
    CALL    PRTRDY                      ;088d  cd bb 08    
    LD  A,15                            ;0890  3e 0f       
    OUT (C),A                           ;0892  ed 79       
    INC C                               ;0894  0c          
    POP AF                              ;0895  f1          
    OUT (C),A                           ;0896  ed 79       
    DEC C                               ;0898  0d          
    LD  A,(IO6000)                      ;0899  3a e9 11    
    OR  004h                            ;089c  f6 04       
    CALL    IO60SB                      ;089e  cd 6b 00    
    LD  A,(IO6000)                      ;08a1  3a e9 11    
    AND 0FBh                            ;08a4  e6 fb       
    JP  IO60SB                          ;08a6  c3 6b 00    
                  ;
PSGST:  LD  BC,04000h                   ;08a9  01 00 40    
    LD  A,7                             ;08ac  3e 07       
    OUT (C),A                           ;08ae  ed 79       
    INC C                               ;08b0  0c          
    IN  A,(C)                           ;08b1  ed 78       
    AND 03Fh                            ;08b3  e6 3f       
    OR  080h                            ;08b5  f6 80       
    OUT (C),A                           ;08b7  ed 79       
    DEC C                               ;08b9  0d          
    RET                                 ;08ba  c9          
                  ;
PRTRDY: LD  HL,01000h                   ;08bb  21 00 10    
    LD  D,0                             ;08be  16 00       
    LD  A,14                            ;08c0  3e 0e       
    OUT (C),A                           ;08c2  ed 79       
WAITLP: INC C                           ;08c4  0c          
    IN  A,(C)                           ;08c5  ed 78       
    DEC C                               ;08c7  0d          
    AND 020h                            ;08c8  e6 20       
    CP  E                               ;08ca  bb          
    RET Z                               ;08cb  c8          
    DEC D                               ;08cc  15          
    JR  NZ,WAITLP                       ;08cd  20 f5       
    DEC HL                              ;08cf  2b          
    LD  A,H                             ;08d0  7c          
    OR  L                               ;08d1  b5          
    JR  NZ,WAITLP                       ;08d2  20 f0       
    LD  A,28                            ;08d4  3e 1c       
    JP  ERROR                           ;08d6  c3 96 21    
                  ;
ACCOUT: CP  ' '                         ;08d9  fe 20       ;020h
    JP  C,CTRLSB                        ;08db  da 81 0a    
ACCDIS: PUSH    AF                      ;08de  f5          
    LD  A,(GMODEF)                      ;08df  3a 06 1c    ;GMODEF 2,3 X
    CP  2                               ;08e2  fe 02       
    JR  C,ACCOL1                        ;08e4  38 09       
    CP  4                               ;08e6  fe 04       
    POP BC                              ;08e8  c1          
    RET C                               ;08e9  d8          
    CALL    GACPRT                      ;08ea  cd 4f 09    
    JR  ACCOL2                          ;08ed  18 07       
ACCOL1: CALL    ADRCAL                  ;08ef  cd 38 09    
    POP AF                              ;08f2  f1          
    CALL    BCOUTA                      ;08f3  cd 3f 0a    ; 0a3fh
ACCOL2: LD  HL,(CURX)                   ;08f6  2a ed 11    
    INC L                               ;08f9  2c          
    LD  A,L                             ;08fa  7d          
    CP  020h                            ;08fb  fe 20       ;다음줄 체크
    JR  C,CURSET                        ;08fd  38 35       
    INC H                               ;08ff  24          
    LD  B,1                             ;0900  06 01       
CTRLM?: LD  A,H                         ;0902  7c          
    CP  16                              ;0903  fe 10       
    JR  C,CURSE?                        ;0905  38 24       
    PUSH    BC                          ;0907  c5          ;16줄(1페이지) 체크
PAGE02: LD  BC,00200h                   ;0908  01 00 02    ;CLR CHR
    LD  A,000h                          ;090b  3e 00       ; 소스는 020h
    LD  D,020h                          ;090d  16 20       
SCRLC1: OUT (C),A                       ;090f  ed 79       
    INC BC                              ;0911  03          
    DEC D                               ;0912  15          
    JR  NZ,SCRLC1                       ;0913  20 fa       
PAGE04: LD  BC,00A00h                   ;0915  01 00 0a    
    LD  A,(COLORF)                      ;0918  3a 80 11    
    AND 003h                            ;091b  e6 03       
    LD  D,020h                          ;091d  16 20       
SCRLC2: OUT (C),A                       ;091f  ed 79       
    INC BC                              ;0921  03          
    DEC D                               ;0922  15          
    JR  NZ,SCRLC2                       ;0923  20 fa       
    CALL    SCRLUP                      ;0925  cd 91 09    
    LD  H,15                            ;0928  26 0f       
    POP BC                              ;092a  c1          
CURSE?: LD  A,H                         ;092b  7c          
    PUSH    HL                          ;092c  e5          
    CALL    ATBHL                       ;092d  cd d6 07    
    LD  (HL),B                          ;0930  70          
    POP HL                              ;0931  e1          
    LD  L,0                             ;0932  2e 00       
CURSET: LD  (CURX),HL                   ;0934  22 ed 11    
    RET                                 ;0937  c9          
                  ;
                  ; VIDEO RAM ADDRESS CALCULATION
ADRCAL: LD  HL,(CURX)                   ;0938  2a ed 11    
ADRCA2: XOR A                           ;093b  af          
    SRL H                               ;093c  cb 3c       
    RRA                                 ;093e  1f          
    SRL H                               ;093f  cb 3c       
    RRA                                 ;0941  1f          
    SRL H                               ;0942  cb 3c       
    RRA                                 ;0944  1f          
    OR  L                               ;0945  b5          
PAGE05: LD  BC,0                        ;0946  01 00 00    ;OFSET
    ADD A,C                             ;0949  81          
    LD  C,A                             ;094a  4f          
    LD  A,B                             ;094b  78          
    ADC A,H                             ;094c  8c          
    LD  B,A                             ;094d  47          
    RET                                 ;094e  c9          
                  ;
                  ;SEMI GRAPHIC
GACPRT: LD  A,B                         ;094f  78          
    CP  060h                            ;0950  fe 60       
    JR  C,ROMACP                        ;0952  38 07       
    AND 07Fh                            ;0954  e6 7f       
    LD  DE,$CGBUF                       ;0956  11 4a 55    ;LD DE,0554Ah
    JR  GACPR1                          ;0959  18 05       
ROMACP: SUB ' '                         ;095b  d6 20       ;020h
    LD  DE,CGCHR                        ;095d  11 4a 52    ;LD DE,0524Ah
GACPR1: LD  L,A                         ;0960  6f          
    LD  H,0                             ;0961  26 00       
    ADD HL,HL                           ;0963  29          
    ADD HL,HL                           ;0964  29          
    LD  C,L                             ;0965  4d          ;BC=A*4
    LD  B,H                             ;0966  44          
    ADD HL,HL                           ;0967  29          ;HL=A*8
    ADD HL,BC                           ;0968  09          ;HL=A*12
    ADD HL,DE                           ;0969  19          ;HL=A*12+BASE
    EX  DE,HL                           ;096a  eb          ;DE=A*12+BASE
    LD  HL,(CURX)                       ;096b  2a ed 11    
    LD  A,L                             ;096e  7d          
    LD  L,0                             ;096f  2e 00       
    LD  C,L                             ;0971  4d          
    LD  B,H                             ;0972  44          
    SRL B                               ;0973  cb 38       
    RR  C                               ;0975  cb 19       
    ADD HL,BC                           ;0977  09          
    LD  C,A                             ;0978  4f          
    LD  B,0                             ;0979  06 00       
    ADD HL,BC                           ;097b  09          
    LD  C,L                             ;097c  4d          
    LD  B,H                             ;097d  44          
    EX  DE,HL                           ;097e  eb          
    LD  E,12                            ;097f  1e 0c       
GACPRL: LD  D,(HL)                      ;0981  56          
    OUT (C),D                           ;0982  ed 51       
    INC HL                              ;0984  23          
    LD  A,020h                          ;0985  3e 20       
    ADD A,C                             ;0987  81          
    LD  C,A                             ;0988  4f          
    LD  A,0                             ;0989  3e 00       
    ADC A,B                             ;098b  88          
    LD  B,A                             ;098c  47          
    DEC E                               ;098d  1d          
    JR  NZ,GACPRL                       ;098e  20 f1       
    RET                                 ;0990  c9          
                  ;
                  ;
SCRLUP: EXX                             ;0991  d9          
    PUSH    BC                          ;0992  c5          
    PUSH    DE                          ;0993  d5          
    PUSH    HL                          ;0994  e5          
    LD  BC,(CHRSTA)                     ;0995  ed 4b d6 0a 
    LD  DE,(CHRLE2)                     ;0999  ed 5b fc 09 
    CALL    BCLDIR                      ;099d  cd be 09    
    LD  BC,(ATRSTA)                     ;09a0  ed 4b e6 0a 
    LD  DE,(CHRLE2)                     ;09a4  ed 5b fc 09 
    CALL    BCLDIR                      ;09a8  cd be 09    
                  ;LINE FLG SCROLL
    LD  DE,(LINEFR)                     ;09ab  ed 5b fa 0a 
    LD  H,D                             ;09af  62          
    LD  L,E                             ;09b0  6b          
    INC HL                              ;09b1  23          
PAGE11: LD  BC,63                       ;09b2  01 3f 00    
    LD  A,(DE)                          ;09b5  1a          
    LDIR                                ;09b6  ed b0       
    LD  (DE),A                          ;09b8  12          
    POP HL                              ;09b9  e1          
    POP DE                              ;09ba  d1          
    POP BC                              ;09bb  c1          
    EXX                                 ;09bc  d9          
    RET                                 ;09bd  c9          
                  ;
BCLDIR: PUSH    BC                      ;09be  c5          
    EXX                                 ;09bf  d9          
    POP BC                              ;09c0  c1          
    LD  HL,SCRLBF                       ;09c1  21 82 11    
    LD  E,020h                          ;09c4  1e 20       
BCLDL1: IN  A,(C)                       ;09c6  ed 78       
    LD  (HL),A                          ;09c8  77          
    INC BC                              ;09c9  03          
    INC HL                              ;09ca  23          
    DEC E                               ;09cb  1d          
    JR  NZ,BCLDL1                       ;09cc  20 f8       
BCLDL2: IN  A,(C)                       ;09ce  ed 78       
    INC BC                              ;09d0  03          
    EXX                                 ;09d1  d9          
    OUT (C),A                           ;09d2  ed 79       
    INC BC                              ;09d4  03          
    DEC DE                              ;09d5  1b          
    LD  A,D                             ;09d6  7a          
    OR  E                               ;09d7  b3          
    EXX                                 ;09d8  d9          
    JR  NZ,BCLDL2                       ;09d9  20 f3       
    EXX                                 ;09db  d9          
    LD  HL,SCRLBF                       ;09dc  21 82 11    
    LD  E,020h                          ;09df  1e 20       
BCLDL3: LD  A,(HL)                      ;09e1  7e          
    OUT (C),A                           ;09e2  ed 79       
    INC HL                              ;09e4  23          
    INC BC                              ;09e5  03          
    DEC E                               ;09e6  1d          
    JR  NZ,BCLDL3                       ;09e7  20 f8       
    RET                                 ;09e9  c9          
                  ;
                  ;
                  ;SCROLL DOWN
SCRLDW: EXX                             ;09ea  d9          
    PUSH    BC                          ;09eb  c5          
    PUSH    DE                          ;09ec  d5          
    PUSH    HL                          ;09ed  e5          
PAGE12: LD  BC,007FFh                   ;09ee  01 ff 07    ;★원래는 DEPRTR
    LD  DE,(CHRLE2)                     ;09f1  ed 5b fc 09 
    CALL    BCLDDR                      ;09f5  cd 13 0a    
PAGE14: LD  BC,00FFFh                   ;09f8  01 ff 0f    
    DEFB    11h                         ;09fb  11          ; LD DE,
CHRLE2: DEFW    007E0h                  ;09fc  e0 07       
    CALL    BCLDDR                      ;09fe  cd 13 0a    
                  ;LINE FLG SCROLL
PAGE16: LD  DE,LINEF+63                 ;0a01  11 e1 11    
    LD  L,E                             ;0a04  6b          
    LD  H,D                             ;0a05  62          
    DEC HL                              ;0a06  2b          
PAGE17: LD  BC,63                       ;0a07  01 3f 00    
    LD  A,(DE)                          ;0a0a  1a          
    LDDR                                ;0a0b  ed b8       
    LD  (DE),A                          ;0a0d  12          
    POP HL                              ;0a0e  e1          
    POP DE                              ;0a0f  d1          
    POP BC                              ;0a10  c1          
    EXX                                 ;0a11  d9          
    RET                                 ;0a12  c9          
                  ;
BCLDDR: PUSH    BC                      ;0a13  c5          
    EXX                                 ;0a14  d9          
    POP BC                              ;0a15  c1          
    LD  HL,SCRLBF+01Fh                  ;0a16  21 a1 11    
    LD  E,020h                          ;0a19  1e 20       
BCLDD1: IN  A,(C)                       ;0a1b  ed 78       
    LD  (HL),A                          ;0a1d  77          
    DEC BC                              ;0a1e  0b          
    DEC HL                              ;0a1f  2b          
    DEC E                               ;0a20  1d          
    JR  NZ,BCLDD1                       ;0a21  20 f8       
BCLDD2: IN  A,(C)                       ;0a23  ed 78       
    DEC BC                              ;0a25  0b          
    EXX                                 ;0a26  d9          
    OUT (C),A                           ;0a27  ed 79       
    DEC BC                              ;0a29  0b          
    DEC DE                              ;0a2a  1b          
    LD  A,D                             ;0a2b  7a          
    OR  E                               ;0a2c  b3          
    EXX                                 ;0a2d  d9          
    JR  NZ,BCLDD2                       ;0a2e  20 f3       
    EXX                                 ;0a30  d9          
    LD  HL,SCRLBF+01Fh                  ;0a31  21 a1 11    
    LD  E,020h                          ;0a34  1e 20       
BCLDD3: LD  A,(HL)                      ;0a36  7e          
    OUT (C),A                           ;0a37  ed 79       
    DEC HL                              ;0a39  2b          
    DEC BC                              ;0a3a  0b          
    DEC E                               ;0a3b  1d          
    JR  NZ,BCLDD3                       ;0a3c  20 f8       
    RET                                 ;0a3e  c9          
                  ;
                  ; 화면에 문자 출력
BCOUTA: CP  'a'-1                       ;0a3f  fe 60       ;060h
    JR  C,BCOTOK                        ;0a41  38 14       
    CP  0E0h                            ;0a43  fe e0       
    JR  NC,SEMIOT                       ;0a45  30 1c       
    AND 07Fh                            ;0a47  e6 7f       
    OUT (C),A                           ;0a49  ed 79       
    SET 3,B                             ;0a4b  cb d8       
    LD  A,(COLORF)                      ;0a4d  3a 80 11    
    AND 3                               ;0a50  e6 03       
    OR  8                               ;0a52  f6 08       
    OUT (C),A                           ;0a54  ed 79       
    RET                                 ;0a56  c9          
                  ;
BCOTOK: OUT (C),A                       ;0a57  ed 79       
    SET 3,B                             ;0a59  cb d8       
    LD  A,(COLORF)                      ;0a5b  3a 80 11    
    AND 3                               ;0a5e  e6 03       
    OUT (C),A                           ;0a60  ed 79       
    RET                                 ;0a62  c9          
                  ;
SEMIOT: AND 00Fh                        ;0a63  e6 0f       
    PUSH    DE                          ;0a65  d5          
    LD  D,A                             ;0a66  57          
    LD  A,(COLORF)                      ;0a67  3a 80 11    
    DEC A                               ;0a6a  3d          
    AND 7                               ;0a6b  e6 07       
    RLCA                                ;0a6d  07          
    RLCA                                ;0a6e  07          
    RLCA                                ;0a6f  07          
    RLCA                                ;0a70  07          
    OR  D                               ;0a71  b2          
    POP DE                              ;0a72  d1          
    OUT (C),A                           ;0a73  ed 79       
    SET 3,B                             ;0a75  cb d8       
    LD  A,(COLORF)                      ;0a77  3a 80 11    
    AND 3                               ;0a7a  e6 03       
    OR  4                               ;0a7c  f6 04       
    OUT (C),A                           ;0a7e  ed 79       
    RET                                 ;0a80  c9          
                  ;
CTRLSB: LD  L,A                         ;0a81  6f          
    LD  H,0                             ;0a82  26 00       
    ADD HL,HL                           ;0a84  29          
    LD  BC,CTRLTB                       ;0a85  01 3f 11    
    ADD HL,BC                           ;0a88  09          
    LD  A,(HL)                          ;0a89  7e          
    INC HL                              ;0a8a  23          
    LD  H,(HL)                          ;0a8b  66          
    LD  L,A                             ;0a8c  6f          
    JP  (HL)                            ;0a8d  e9          
                  ;
DELETE: CALL    ADRCAL                  ;0a8e  cd 38 09    
    PUSH    BC                          ;0a91  c5          
    CALL    ECUYST                      ;0a92  cd c5 07    
    LD  H,E                             ;0a95  63          
    LD  L,0                             ;0a96  2e 00       
    CALL    ADRCA2                      ;0a98  cd 3b 09    
    POP DE                              ;0a9b  d1          
    LD  L,C                             ;0a9c  69          
    LD  H,B                             ;0a9d  60          
    OR  A                               ;0a9e  b7          
    SBC HL,DE                           ;0a9f  ed 52       
    LD  D,000h                          ;0aa1  16 00       ;★구버전,신버전 00H,20H ???
    LD  A,(COLORF)                      ;0aa3  3a 80 11    
    AND 3                               ;0aa6  e6 03       
    LD  E,A                             ;0aa8  5f          
DELLP1: DEC BC                          ;0aa9  0b          
    IN  A,(C)                           ;0aaa  ed 78       
    OUT (C),D                           ;0aac  ed 51       
    LD  D,A                             ;0aae  57          
    SET 3,B                             ;0aaf  cb d8       
    IN  A,(C)                           ;0ab1  ed 78       
    OUT (C),E                           ;0ab3  ed 59       
    LD  E,A                             ;0ab5  5f          
    RES 3,B                             ;0ab6  cb 98       
    DEC HL                              ;0ab8  2b          
    LD  A,H                             ;0ab9  7c          
    OR  L                               ;0aba  b5          
    JR  NZ,DELLP1                       ;0abb  20 ec       
    LD  A,(CURX)                        ;0abd  3a ed 11    
    OR  A                               ;0ac0  b7          
    JR  NZ,DELLP2                       ;0ac1  20 08       
    PUSH    DE                          ;0ac3  d5          
    CALL    CUTBHL                      ;0ac4  cd d3 07    
    LD  A,(HL)                          ;0ac7  7e          
    POP DE                              ;0ac8  d1          
    OR  A                               ;0ac9  b7          
    RET Z                               ;0aca  c8          
DELLP2: DEC BC                          ;0acb  0b          
    OUT (C),D                           ;0acc  ed 51       
    SET 3,B                             ;0ace  cb d8       
    OUT (C),E                           ;0ad0  ed 59       
    JP  LEFT                            ;0ad2  c3 48 0b    
                  ;
CLR2:   DEFB    001h                    ;0ad5  01          ;LD BC,(CHRSTA)
CHRSTA: DEFW    00000h                  ;0ad6  00 00       ;SEMIGRAPHIC ADR.+
    LD  HL,(CHRLEN)                     ;0ad8  2a e9 0a    
    LD  D,000h                          ;0adb  16 00       ;★구버전,신버전 00H,20H ???
CLRLP:  OUT (C),D                       ;0add  ed 51       
    INC BC                              ;0adf  03          
    DEC HL                              ;0ae0  2b          
    LD  A,H                             ;0ae1  7c          
    OR  L                               ;0ae2  b5          
    JR  NZ,CLRLP                        ;0ae3  20 f8       
    DEFB    001h                        ;0ae5  01          ;LD BC,(ATRSTA)
ATRSTA: DEFW    00800h                  ;0ae6  00 08       
    DEFB    021h                        ;0ae8  21          ;LD HL,(CHRLEN)
CHRLEN: DEFW    00800h                  ;0ae9  00 08       
    LD  A,(COLORF)                      ;0aeb  3a 80 11    
    AND 3                               ;0aee  e6 03       
    LD  D,A                             ;0af0  57          
ATRCLS: OUT (C),D                       ;0af1  ed 51       
    INC BC                              ;0af3  03          
    DEC HL                              ;0af4  2b          
    LD  A,H                             ;0af5  7c          
    OR  L                               ;0af6  b5          
    JR  NZ,ATRCLS                       ;0af7  20 f8       
    DEFB    021h                        ;0af9  21          ;LD HL,(LINEFR)
LINEFR: DEFW    LINEF                   ;0afa  a2 11       
PAGE23: LD  B,65                        ;0afc  06 41       
LINCLS: LD  (HL),0                      ;0afe  36 00       
    INC HL                              ;0b00  23          
    DJNZ    LINCLS                      ;0b01  10 fb       
HOME:   LD  HL,0                        ;0b03  21 00 00    
    JP  CURST2                          ;0b06  c3 83 0b    
                  ;
INST:   CALL    ECUYST                  ;0b09  cd c5 07    
    LD  H,E                             ;0b0c  63          
    LD  L,0                             ;0b0d  2e 00       
    CALL    ADRCA2                      ;0b0f  cd 3b 09    
    DEC BC                              ;0b12  0b          
    CALL    AINBC                       ;0b13  cd 94 07    
    CP  021h                            ;0b16  fe 21       
    RET NC                              ;0b18  d0          
    PUSH    BC                          ;0b19  c5          
    CALL    ADRCAL                      ;0b1a  cd 38 09    
    POP HL                              ;0b1d  e1          
    OR  A                               ;0b1e  b7          
    SBC HL,BC                           ;0b1f  ed 42       
    LD  D,000h                          ;0b21  16 00       ;★구버전,신버전 00H,20H ???
    LD  A,(COLORF)                      ;0b23  3a 80 11    
    AND 3                               ;0b26  e6 03       
    LD  E,A                             ;0b28  5f          
    INC HL                              ;0b29  23          
INSTL1: IN  A,(C)                       ;0b2a  ed 78       
    OUT (C),D                           ;0b2c  ed 51       
    LD  D,A                             ;0b2e  57          
    SET 3,B                             ;0b2f  cb d8       
    IN  A,(C)                           ;0b31  ed 78       
    OUT (C),E                           ;0b33  ed 59       
    LD  E,A                             ;0b35  5f          
    RES 3,B                             ;0b36  cb 98       
    INC BC                              ;0b38  03          
    DEC HL                              ;0b39  2b          
    LD  A,H                             ;0b3a  7c          
    OR  L                               ;0b3b  b5          
    JR  NZ,INSTL1                       ;0b3c  20 ec       
    RET                                 ;0b3e  c9          
                  ;
LOCK:   LD  A,1                         ;0b3f  3e 01       
LOCKST: LD  (LOCKMD),A                  ;0b41  32 03 12    
    RET                                 ;0b44  c9          
                  ;
UNLOCK: XOR A                           ;0b45  af          
    JR  LOCKST                          ;0b46  18 f9       
                  ;
LEFT:   LD  HL,(CURX)                   ;0b48  2a ed 11    
    DEC L                               ;0b4b  2d          
    LD  A,L                             ;0b4c  7d          
    CP  0FFh                            ;0b4d  fe ff       
    JR  NZ,CURST2                       ;0b4f  20 32       
    LD  L,01Fh                          ;0b51  2e 1f       
UPCUR:  DEC H                           ;0b53  25          
    LD  A,H                             ;0b54  7c          
    CP  0FFh                            ;0b55  fe ff       
    JR  NZ,CURST2                       ;0b57  20 2a       
    PUSH    HL                          ;0b59  e5          
    CALL    SCRLDW                      ;0b5a  cd ea 09    
    POP HL                              ;0b5d  e1          
    LD  H,0                             ;0b5e  26 00       
    JR  CURST2                          ;0b60  18 21       
                  ;
CTRLM:  CALL    ECUYST                  ;0b62  cd c5 07    
    LD  H,E                             ;0b65  63          
    LD  B,0                             ;0b66  06 00       
    JP  CTRLM?                          ;0b68  c3 02 09    
                  ;
RIGHT:  LD  HL,(CURX)                   ;0b6b  2a ed 11    
    INC L                               ;0b6e  2c          
    LD  A,L                             ;0b6f  7d          
    CP  020h                            ;0b70  fe 20       
    JR  C,CURST2                        ;0b72  38 0f       
    LD  L,0                             ;0b74  2e 00       
DOWNLB: INC H                           ;0b76  24          
    LD  A,H                             ;0b77  7c          
    CP  16                              ;0b78  fe 10       
    JR  C,CURST2                        ;0b7a  38 07       
    PUSH    HL                          ;0b7c  e5          
    CALL    SCRLUP                      ;0b7d  cd 91 09    
    POP HL                              ;0b80  e1          
    LD  H,15                            ;0b81  26 0f       
CURST2: LD  (CURX),HL                   ;0b83  22 ed 11    
    RET                                 ;0b86  c9          
                  ;
UP: LD  HL,(CURX)                       ;0b87  2a ed 11    
    JR  UPCUR                           ;0b8a  18 c7       
                  ;
DOWN:   LD  HL,(CURX)                   ;0b8c  2a ed 11    
    JR  DOWNLB                          ;0b8f  18 e5       
                  ;
CTRLG:  LD  A,(BELLFG)                  ;0b91  3a 7f 11    
    XOR 1                               ;0b94  ee 01       
    LD  (BELLFG),A                      ;0b96  32 7f 11    
    JP  BELL                            ;0b99  c3 ca 06    
                  ;
CTRLB:  LD  DE,00000h                   ;0b9c  11 00 00    
    LD  HL,LEFT                         ;0b9f  21 48 0b    
    LD  (CTRLBF+1),HL                   ;0ba2  22 d3 0b    
CTRLB1: CALL    CBFCEK                  ;0ba5  cd ca 0b    
    RET Z                               ;0ba8  c8          
    JR  C,CTRLB1                        ;0ba9  38 fa       
CTRLB2: CALL    CBFCEK                  ;0bab  cd ca 0b    
    RET Z                               ;0bae  c8          
    JR  NC,CTRLB2                       ;0baf  30 fa       
    JP  RIGHT                           ;0bb1  c3 6b 0b    
                  ;
CTRLF:  LD  DE,00F1Fh                   ;0bb4  11 1f 0f    
    LD  HL,RIGHT                        ;0bb7  21 6b 0b    
    LD  (CTRLBF+1),HL                   ;0bba  22 d3 0b    
CTRLF1: CALL    CBFCEK                  ;0bbd  cd ca 0b    
    RET Z                               ;0bc0  c8          
    JR  NC,CTRLF1                       ;0bc1  30 fa       
CTRLF2: CALL    CBFCEK                  ;0bc3  cd ca 0b    
    RET Z                               ;0bc6  c8          
    JR  C,CTRLF2                        ;0bc7  38 fa       
    RET                                 ;0bc9  c9          
                  ;
CBFCEK: LD  HL,(CURX)                   ;0bca  2a ed 11    
    OR  A                               ;0bcd  b7          
    SBC HL,DE                           ;0bce  ed 52       
    RET Z                               ;0bd0  c8          
    PUSH    DE                          ;0bd1  d5          
CTRLBF: CALL    RIGHT                   ;0bd2  cd 6b 0b    
    CALL    ADRCAL                      ;0bd5  cd 38 09    
    CALL    AINBC                       ;0bd8  cd 94 07    
    POP DE                              ;0bdb  d1          
    CP  '0'                             ;0bdc  fe 30       ;030h
    RET C                               ;0bde  d8          
    CP  '9'+1                           ;0bdf  fe 3a       ;03Ah
    CCF                                 ;0be1  3f          
    RET NC                              ;0be2  d0          
    CP  'A'                             ;0be3  fe 41       ;041h
    RET C                               ;0be5  d8          
    CP  080h                            ;0be6  fe 80       
    JR  C,L0BEC                         ;0be8  38 02       
    OR  A                               ;0bea  b7          
    RET                                 ;0beb  c9          
L0BEC:  AND 01Fh                        ;0bec  e6 1f       
    JR  Z,L0BF4                         ;0bee  28 04       
    CP  01Bh                            ;0bf0  fe 1b       
    CCF                                 ;0bf2  3f          
    RET NC                              ;0bf3  d0          
L0BF4:  AND 1                           ;0bf4  e6 01       
    RET                                 ;0bf6  c9          
                  ;
CTRLY:  LD  D,0                         ;0bf7  16 00       ;★라벨이 빠져있었음
    JR  CTRLYT                          ;0bf9  18 02       
                  ;
CTRLT:  LD  D,1                         ;0bfb  16 01       
CTRLYT: LD  HL,(CURX)                   ;0bfd  2a ed 11    
    LD  H,0                             ;0c00  26 00       
    LD  BC,TABBUF                       ;0c02  01 46 12    
    ADD HL,BC                           ;0c05  09          
    LD  (HL),D                          ;0c06  72          
    RET                                 ;0c07  c9          
                  ;
CTRLI:  CALL    RIGHT                   ;0c08  cd 6b 0b    
    LD  A,(CURX)                        ;0c0b  3a ed 11    
    CP  31                              ;0c0e  fe 1f       
    RET Z                               ;0c10  c8          
    LD  L,A                             ;0c11  6f          
    LD  H,0                             ;0c12  26 00       
    LD  BC,TABBUF                       ;0c14  01 46 12    
    ADD HL,BC                           ;0c17  09          
    LD  A,(HL)                          ;0c18  7e          
    OR  A                               ;0c19  b7          
    JR  Z,CTRLI                         ;0c1a  28 ec       
    RET                                 ;0c1c  c9          
                  ;
CTRLE:  CALL    ECUYST                  ;0c1d  cd c5 07    
    LD  H,E                             ;0c20  63          
    LD  L,0                             ;0c21  2e 00       
    JR  CTRLEZ                          ;0c23  18 10       
                  ;
CTRLZ   CALL    CUTBHL                  ;0c25  cd d3 07    
    LD  A,16                            ;0c28  3e 10       
    SUB E                               ;0c2a  93          
    LD  B,A                             ;0c2b  47          
    INC HL                              ;0c2c  23          
CTRLZ1: LD  (HL),0                      ;0c2d  36 00       
    INC HL                              ;0c2f  23          
    DJNZ    CTRLZ1                      ;0c30  10 fb       
    LD  HL,01000h                       ;0c32  21 00 10    
CTRLEZ: CALL    ADRCA2                  ;0c35  cd 3b 09    
    DEC BC                              ;0c38  0b          
    PUSH    BC                          ;0c39  c5          
    CALL    ADRCAL                      ;0c3a  cd 38 09    
    POP HL                              ;0c3d  e1          
    LD  D,B                             ;0c3e  50          
    LD  E,C                             ;0c3f  59          
    OR  A                               ;0c40  b7          
    SBC HL,DE                           ;0c41  ed 52       
    INC HL                              ;0c43  23          
    LD  D,000h                          ;0c44  16 00       ;구버전,신버전
    LD  A,(COLORF)                      ;0c46  3a 80 11    
    AND 003h                            ;0c49  e6 03       
    LD  E,A                             ;0c4b  5f          
CTRLZE: OUT (C),D                       ;0c4c  ed 51       
    SET 3,B                             ;0c4e  cb d8       
    OUT (C),E                           ;0c50  ed 59       
    RES 3,B                             ;0c52  cb 98       
    INC BC                              ;0c54  03          
    DEC HL                              ;0c55  2b          
    LD  A,H                             ;0c56  7c          
    OR  L                               ;0c57  b5          
    JR  NZ,CTRLZE                       ;0c58  20 f2       
    RET                                 ;0c5a  c9          
                  ;
                  ; KEY GET
BRKEY:  LD  A,080h                      ;0c5b  3e 80       
    IN  A,(0)                           ;0c5d  db 00       
    AND 012h                            ;0c5f  e6 12       
    RET                                 ;0c61  c9          
                  ;
ASCGET: PUSH    BC                      ;0c62  c5          
    PUSH    DE                          ;0c63  d5          
    PUSH    HL                          ;0c64  e5          
    LD  HL,(POINT1)                     ;0c65  2a 04 12    
    LD  A,L                             ;0c68  7d          
    CP  H                               ;0c69  bc          
    JR  Z,BUFSET                        ;0c6a  28 12       
BUFCEK: INC A                           ;0c6c  3c          
    AND 03Fh                            ;0c6d  e6 3f       
    LD  (POINT1),A                      ;0c6f  32 04 12    
    LD  L,A                             ;0c72  6f          
    LD  H,0                             ;0c73  26 00       
    LD  DE,INKYBF                       ;0c75  11 06 12    
    ADD HL,DE                           ;0c78  19          
    LD  A,(HL)                          ;0c79  7e          
GETRET: POP HL                          ;0c7a  e1          
    POP DE                              ;0c7b  d1          
    POP BC                              ;0c7c  c1          
    RET                                 ;0c7d  c9          
                  ;
BUFSET: DEFB    03Eh                    ;0c7e  3e          ; LD A,
FLASHF: DEFB    001h                    ;0c7f  01          ;
    OR  A                               ;0c80  b7          
    JR  NZ,FLGET                        ;0c81  20 24       
    CALL    KEYSEN                      ;0c83  cd 7a 0d    
    CALL    BRKEY                       ;0c86  cd 5b 0c    
    JR  NZ,KEYGT                        ;0c89  20 07       
BRKGTR: CALL    NEWFLG                  ;0c8b  cd e1 0d    
    LD  A,3                             ;0c8e  3e 03       
    JR  GETRET                          ;0c90  18 e8       
KEYGT:  CALL    KEYSEN                  ;0c92  cd 7a 0d    
    JR  Z,ZERORT                        ;0c95  28 0a       
    CALL    NEWCEK                      ;0c97  cd bb 0d    
    JR  NZ,NEWKYS                       ;0c9a  20 29       
    CALL    SAMECK                      ;0c9c  cd d1 0d    
    JR  Z,REPETS                        ;0c9f  28 16       
ZERORT: CALL    NEWFLG                  ;0ca1  cd e1 0d    
ZEROR2: XOR A                           ;0ca4  af          
    JR  GETRET                          ;0ca5  18 d3       
FLGET:  CALL    FLSHGT                  ;0ca7  cd 3c 0d    
    LD  C,A                             ;0caa  4f          
    LD  A,080h                          ;0cab  3e 80       
    IN  A,(0)                           ;0cad  db 00       
    AND 012h                            ;0caf  e6 12       
    JR  Z,BRKGTR                        ;0cb1  28 d8       
    LD  A,C                             ;0cb3  79          
    OR  A                               ;0cb4  b7          
    JR  Z,NEWKYS                        ;0cb5  28 0e       
REPETS: CALL    NEWFLG                  ;0cb7  cd e1 0d    
    DEFB    021h                        ;0cba  21          ; LD HL,(KEYBFA)
KEYBFA: DEFW    0FFFEh                  ;0cbb  fe ff       ;
    DEFB    03Eh                        ;0cbd  3e          ; LD A,(KEYBFD)
KEYBFD: DEFB    000h                    ;0cbe  00          
    LD  (HL),A                          ;0cbf  77          
    LD  HL,30                           ;0cc0  21 1e 00    
    JR  KEYST2                          ;0cc3  18 06       
NEWKYS: CALL    NEWFLG                  ;0cc5  cd e1 0d    
    DEFB    021h                        ;0cc8  21          ; LD HL,300
REPTSW: DEFW    200                     ;0cc9  c8 00       ; auto repeat key duration
KEYST2: LD  (REPETF),HL                 ;0ccb  22 57 0d    
    LD  HL,NEWBUF                       ;0cce  21 f9 11    
    LD  D,0                             ;0cd1  16 00       
    LD  C,9                             ;0cd3  0e 09       
SETLP1: LD  B,8                         ;0cd5  06 08       
    LD  A,(HL)                          ;0cd7  7e          
    CPL                                 ;0cd8  2f          
    OR  A                               ;0cd9  b7          
    JR  Z,SETPL3                        ;0cda  28 09       
SETPL2: RRCA                            ;0cdc  0f          
    JP  C,KYBFST                        ;0cdd  da 35 0e    
    INC D                               ;0ce0  14          
    DJNZ    SETPL2                      ;0ce1  10 f9       
    JR  SETPL4                          ;0ce3  18 04       
SETPL3: LD  A,D                         ;0ce5  7a          
    ADD A,8                             ;0ce6  c6 08       
    LD  D,A                             ;0ce8  57          
SETPL4: INC HL                          ;0ce9  23          
    DEC C                               ;0cea  0d          
    JR  NZ,SETLP1                       ;0ceb  20 e8       
KYBFSR: LD  HL,(POINT1)                 ;0ced  2a 04 12    
    LD  A,L                             ;0cf0  7d          
    CP  H                               ;0cf1  bc          
    JP  Z,ZEROR2                        ;0cf2  ca a4 0c    
    JP  BUFCEK                          ;0cf5  c3 6c 0c    
                  ;
FLASHS: CALL    ADRCAL                  ;0cf8  cd 38 09    
    SET 3,B                             ;0cfb  cb d8       
    LD  (FLASHA),BC                     ;0cfd  ed 43 15 0d 
    IN  A,(C)                           ;0d01  ed 78       
    LD  (FLASHD),A                      ;0d03  32 18 0d    
    OR  1                               ;0d06  f6 01       
    OUT (C),A                           ;0d08  ed 79       
    LD  (FLASHO),A                      ;0d0a  32 2a 0d    
    LD  A,(TICONT)                      ;0d0d  3a 36 00    
    LD  (FLASHC+1),A                    ;0d10  32 20 0d    ;★"+1"이 빠져있었음.
    RET                                 ;0d13  c9          ;
                  ;
                  ;
FLASHG: DEFB    001h                    ;0d14  01          
FLASHA: DEFW    0                       ;0d15  00 00       
    DEFB    03Eh                        ;0d17  3e          ; LD A,
FLASHD: DEFB    000h                    ;0d18  00          ;
    AND 0FEh                            ;0d19  e6 fe       
    LD  E,A                             ;0d1b  5f          
    LD  A,(TICONT)                      ;0d1c  3a 36 00    
FLASHC: SUB 0                           ;0d1f  d6 00       ; cursor blink time
    AND 010h                            ;0d21  e6 10       
    LD  A,001h                          ;0d23  3e 01       
    JR  Z,L0D28                         ;0d25  28 01       
    XOR A                               ;0d27  af          
L0D28:  OR  E                           ;0d28  b3          
    DEFB    0FEh                        ;0d29  fe          ;CP
FLASHO: DEFB    000h                    ;0d2a  00          
    RET Z                               ;0d2b  c8          
    OUT (C),A                           ;0d2c  ed 79       
    LD  (FLASHO),A                      ;0d2e  32 2a 0d    
    RET                                 ;0d31  c9          
                  ;
FLASHE: LD  BC,(FLASHA)                 ;0d32  ed 4b 15 0d 
    LD  A,(FLASHD)                      ;0d36  3a 18 0d    
    OUT (C),A                           ;0d39  ed 79       
    RET                                 ;0d3b  c9          
                  ;
                  ;
FLSHGT: PUSH    BC                      ;0d3c  c5          
    PUSH    DE                          ;0d3d  d5          
    PUSH    HL                          ;0d3e  e5          
    CALL    FLASHS                      ;0d3f  cd f8 0c    
FLGTLP: CALL    FLASHG                  ;0d42  cd 14 0d    
    CALL    KEYSEN                      ;0d45  cd 7a 0d    
    JR  Z,FLSHL3                        ;0d48  28 1b       
    CALL    NEWCEK                      ;0d4a  cd bb 0d    
    LD  A,0                             ;0d4d  3e 00       
    JR  NZ,FLSHRT                       ;0d4f  20 20       
    CALL    SAMECK                      ;0d51  cd d1 0d    
    JR  NZ,FLGTLP                       ;0d54  20 ec       
    DEFB    021h                        ;0d56  21          ; LD HL,
REPETF: DEFW    00000h                  ;0d57  00 00       ;
    DEC HL                              ;0d59  2b          ;+
    LD  (REPETF),HL                     ;0d5a  22 57 0d    
    LD  A,H                             ;0d5d  7c          
    OR  L                               ;0d5e  b5          
    JR  NZ,FLGTLP                       ;0d5f  20 e1       
    LD  A,1                             ;0d61  3e 01       
    JR  FLSHRT                          ;0d63  18 0c       
FLSHL3: CALL    NEWFLG                  ;0d65  cd e1 0d    
FLGTL2: CALL    FLASHG                  ;0d68  cd 14 0d    
    CALL    KEYSEN                      ;0d6b  cd 7a 0d    
    JR  Z,FLGTL2                        ;0d6e  28 f8       
    XOR A                               ;0d70  af          
FLSHRT: PUSH    AF                      ;0d71  f5          
    CALL    FLASHE                      ;0d72  cd 32 0d    
    POP AF                              ;0d75  f1          
    POP HL                              ;0d76  e1          
    POP DE                              ;0d77  d1          
    POP BC                              ;0d78  c1          
    RET                                 ;0d79  c9          
                  ;
                  ;
                  ;
KEYSEN: CALL    KEYSN2                  ;0d7a  cd 8c 0d    
KEYSN0: LD  B,4                         ;0d7d  06 04       
KEYSN1: CALL    KEYSN2                  ;0d7f  cd 8c 0d    
    BIT 1,E                             ;0d82  cb 4b       
    JR  NZ,KEYSN0                       ;0d84  20 f7       
    DJNZ    KEYSN1                      ;0d86  10 f7       
    LD  A,E                             ;0d88  7b          
    AND 1                               ;0d89  e6 01       
    RET                                 ;0d8b  c9          
                  ;
KEYSN2: LD  HL,NEWBUF                   ;0d8c  21 f9 11    
    PUSH    BC                          ;0d8f  c5          
    LD  BC,08009h                       ;0d90  01 09 80    ;KEYIO
    LD  DE,00900h                       ;0d93  11 00 09    
KEYSN3: IN  A,(C)                       ;0d96  ed 78       
    XOR (HL)                            ;0d98  ae          
    JR  Z,L0D9D                         ;0d99  28 02       
    SET 1,E                             ;0d9b  cb cb       
L0D9D:  XOR (HL)                        ;0d9d  ae          
    LD  (HL),A                          ;0d9e  77          
    CPL                                 ;0d9f  2f          
    OR  A                               ;0da0  b7          
    JR  Z,L0DA5                         ;0da1  28 02       
    SET 0,E                             ;0da3  cb c3       
L0DA5:  INC HL                          ;0da5  23          
    DEC BC                              ;0da6  0b          
    DEC D                               ;0da7  15          
    JR  NZ,KEYSN3                       ;0da8  20 ec       
    IN  A,(C)                           ;0daa  ed 78       
    XOR (HL)                            ;0dac  ae          
    JR  Z,L0DB1                         ;0dad  28 02       
    SET 1,E                             ;0daf  cb cb       
L0DB1:  XOR (HL)                        ;0db1  ae          
    LD  (HL),A                          ;0db2  77          
    AND 012h                            ;0db3  e6 12       
    JR  NZ,L0DB9                        ;0db5  20 02       
    SET 0,E                             ;0db7  cb c3       
L0DB9:  POP BC                          ;0db9  c1          
    RET                                 ;0dba  c9          
                  ;
NEWCEK: LD  HL,OLDBUF                   ;0dbb  21 ef 11    
    LD  DE,NEWBUF                       ;0dbe  11 f9 11    
    LD  B,9                             ;0dc1  06 09       
NEWPL1: LD  A,(DE)                      ;0dc3  1a          
    CPL                                 ;0dc4  2f          
    AND (HL)                            ;0dc5  a6          
    RET NZ                              ;0dc6  c0          
    INC DE                              ;0dc7  13          
    INC HL                              ;0dc8  23          
    DJNZ    NEWPL1                      ;0dc9  10 f8       
    LD  A,(DE)                          ;0dcb  1a          
    CPL                                 ;0dcc  2f          
    AND (HL)                            ;0dcd  a6          
    AND 010h                            ;0dce  e6 10       
    RET                                 ;0dd0  c9          
                  ;
SAMECK: LD  HL,OLDBUF                   ;0dd1  21 ef 11    
    LD  DE,NEWBUF                       ;0dd4  11 f9 11    
    LD  B,10                            ;0dd7  06 0a       
SAMELP: LD  A,(DE)                      ;0dd9  1a          
    XOR (HL)                            ;0dda  ae          
    RET NZ                              ;0ddb  c0          
    INC DE                              ;0ddc  13          
    INC HL                              ;0ddd  23          
    DJNZ    SAMELP                      ;0dde  10 f9       
    RET                                 ;0de0  c9          
                  ;
NEWFLG: LD  HL,NEWBUF                   ;0de1  21 f9 11    
    LD  DE,OLDBUF                       ;0de4  11 ef 11    
    LD  B,9                             ;0de7  06 09       
FLGLP1: LD  A,(DE)                      ;0de9  1a          
    CPL                                 ;0dea  2f          
    OR  (HL)                            ;0deb  b6          
    LD  C,(HL)                          ;0dec  4e          
    LD  (HL),A                          ;0ded  77          
    LD  A,C                             ;0dee  79          
    LD  (DE),A                          ;0def  12          
    INC DE                              ;0df0  13          
    INC HL                              ;0df1  23          
    DJNZ    FLGLP1                      ;0df2  10 f5       
    LD  A,(HL)                          ;0df4  7e          
    LD  (DE),A                          ;0df5  12          
    LD  DE,NEWBUF                       ;0df6  11 f9 11    
    LD  HL,OLDBUF                       ;0df9  21 ef 11    
    LD  BC,00900h                       ;0dfc  01 00 09    
FLGLP2: LD  A,(DE)                      ;0dff  1a          
    CPL                                 ;0e00  2f          
    OR  A                               ;0e01  b7          
    JR  Z,FLGLP3                        ;0e02  28 0a       
    DEC C                               ;0e04  0d          
    JR  NZ,FLGLP5                       ;0e05  20 0c       
    OR  (HL)                            ;0e07  b6          
    LD  (HL),A                          ;0e08  77          
    LD  A,0FFh                          ;0e09  3e ff       
    LD  (DE),A                          ;0e0b  12          
FLGLP4: LD  C,1                         ;0e0c  0e 01       
FLGLP3: INC DE                          ;0e0e  13          
    INC HL                              ;0e0f  23          
    DJNZ    FLGLP2                      ;0e10  10 ed       
    RET                                 ;0e12  c9          
FLGLP5: PUSH    BC                      ;0e13  c5          
    LD  BC,00801h                       ;0e14  01 01 08    
FLGLP6: RRCA                            ;0e17  0f          
    JR  C,FLGLP7                        ;0e18  38 0b       
    RLC C                               ;0e1a  cb 01       
    DJNZ    FLGLP6                      ;0e1c  10 f9       
    POP BC                              ;0e1e  c1          
    JR  FLGLP4                          ;0e1f  18 eb       
FLGLP9: RRCA                            ;0e21  0f          
    CALL    C,FLGLP8                    ;0e22  dc 2c 0e    
FLGLP7: RLC C                           ;0e25  cb 01       
    DJNZ    FLGLP9                      ;0e27  10 f8       
    POP BC                              ;0e29  c1          
    JR  FLGLP4                          ;0e2a  18 e0       
                  ;
FLGLP8: PUSH    AF                      ;0e2c  f5          
    LD  A,C                             ;0e2d  79          
    OR  (HL)                            ;0e2e  b6          
    LD  (HL),A                          ;0e2f  77          
    LD  A,(DE)                          ;0e30  1a          
    OR  C                               ;0e31  b1          
    LD  (DE),A                          ;0e32  12          
    POP AF                              ;0e33  f1          
    RET                                 ;0e34  c9          
                  ;
                  ;
KYBFST: LD  A,(HL)                      ;0e35  7e          
    LD  (KEYBFA),HL                     ;0e36  22 bb 0c    
    LD  (KEYBFD),A                      ;0e39  32 be 0c    
    LD  C,D                             ;0e3c  4a          
    LD  B,0                             ;0e3d  06 00       
    LD  HL,KEYDT1                       ;0e3f  21 06 13    ;NORMAL DATA
    LD  A,(NEWMOD)                      ;0e42  3a 02 12    
    BIT 1,A                             ;0e45  cb 4f       
    JR  NZ,L0E4C                        ;0e47  20 03       
    LD  HL,KEYDT2                       ;0e49  21 4e 13    ;SHIFT DATA
L0E4C:  ADD HL,BC                       ;0e4c  09          
    LD  C,(HL)                          ;0e4d  4e          
    LD  B,A                             ;0e4e  47          
    BIT 2,B                             ;0e4f  cb 50       
    JR  NZ,CTRLNO                       ;0e51  20 09       
    LD  A,C                             ;0e53  79          
    SUB 040h                            ;0e54  d6 40       
    JR  C,NONKE?                        ;0e56  38 17       
    AND 01Fh                            ;0e58  e6 1f       
    JR  SETKY                           ;0e5a  18 0d       
CTRLNO: BIT 6,B                         ;0e5c  cb 70       
    JR  NZ,SETKY2                       ;0e5e  20 1a       
    LD  A,C                             ;0e60  79          
    SUB 040h                            ;0e61  d6 40       
    JR  C,NONKEY                        ;0e63  38 07       
    AND 01Fh                            ;0e65  e6 1f       
    ADD A,080h                          ;0e67  c6 80       
SETKY:  CALL    BFSTSB                  ;0e69  cd b1 0e    
NONKEY: JP  KYBFSR                      ;0e6c  c3 ed 0c    
NONKE?: ADD A,010h                      ;0e6f  c6 10       
    CP  004h                            ;0e71  fe 04       
    JR  NC,NONKEY                       ;0e73  30 f7       
    LD  (COLORF),A                      ;0e75  32 80 11    
    JR  NONKEY                          ;0e78  18 f2       
                  ;
                  ;
SETKY2: LD  A,C                         ;0e7a  79          
    CP  0F0h                            ;0e7b  fe f0       
    JR  NC,FUNCTN                       ;0e7d  30 16       
    LD  A,(LOCKMD)                      ;0e7f  3a 03 12    
    OR  A                               ;0e82  b7          
    LD  A,C                             ;0e83  79          
    JR  Z,SETKY                         ;0e84  28 e3       
    CP  041h                            ;0e86  fe 41       
    JR  C,SETKY                         ;0e88  38 df       
    AND 01Fh                            ;0e8a  e6 1f       
    CP  01Bh                            ;0e8c  fe 1b       
    LD  A,C                             ;0e8e  79          
    JR  NC,SETKY                        ;0e8f  30 d8       
    XOR 020h                            ;0e91  ee 20       
    JR  SETKY                           ;0e93  18 d4       
FUNCTN: SUB 0F1h                        ;0e95  d6 f1       
    LD  L,A                             ;0e97  6f          
    LD  H,0                             ;0e98  26 00       
    ADD HL,HL                           ;0e9a  29          
    ADD HL,HL                           ;0e9b  29          
    ADD HL,HL                           ;0e9c  29          
    ADD HL,HL                           ;0e9d  29          
    LD  BC,FUNBUF                       ;0e9e  01 66 12    
    ADD HL,BC                           ;0ea1  09          
    LD  B,(HL)                          ;0ea2  46          
    INC HL                              ;0ea3  23          
    LD  A,B                             ;0ea4  78          
    OR  A                               ;0ea5  b7          
    JR  Z,NONKEY                        ;0ea6  28 c4       
FUNCLP: LD  A,(HL)                      ;0ea8  7e          
    CALL    BFSTSB                      ;0ea9  cd b1 0e    
    INC HL                              ;0eac  23          
    DJNZ    FUNCLP                      ;0ead  10 f9       
    JR  NONKEY                          ;0eaf  18 bb       
BFSTSB: PUSH    HL                      ;0eb1  e5          
    PUSH    BC                          ;0eb2  c5          
    LD  C,A                             ;0eb3  4f          
    LD  HL,(POINT1)                     ;0eb4  2a 04 12    
    LD  A,H                             ;0eb7  7c          
    INC A                               ;0eb8  3c          
    AND 03Fh                            ;0eb9  e6 3f       
    CP  L                               ;0ebb  bd          
    JR  Z,NONSET                        ;0ebc  28 0c       
    LD  (POINT2),A                      ;0ebe  32 05 12    
    LD  L,A                             ;0ec1  6f          
    LD  H,0                             ;0ec2  26 00       
    LD  A,C                             ;0ec4  79          
    LD  BC,INKYBF                       ;0ec5  01 06 12    
    ADD HL,BC                           ;0ec8  09          
    LD  (HL),A                          ;0ec9  77          
NONSET: POP BC                          ;0eca  c1          
    POP HL                              ;0ecb  e1          
NORET:  RET                             ;0ecc  c9          
                  ;
                  ;
MUSIC:  PUSH    DE                      ;0ecd  d5          
MUSL1:  LD  A,(DE)                      ;0ece  1a          
    CP  ':'                             ;0ecf  fe 3a       ;03Ah
    INC DE                              ;0ed1  13          
    JR  Z,MUSL2                         ;0ed2  28 04       
    DJNZ    MUSL1                       ;0ed4  10 f8       
    JR  MUSL6                           ;0ed6  18 0e       
MUSL2:  LD  L,E                         ;0ed8  6b          
    LD  H,D                             ;0ed9  62          
MUSL4:  DJNZ    MUSL3                   ;0eda  10 02       
    JR  MUSL7                           ;0edc  18 0b       
MUSL3:  LD  A,(DE)                      ;0ede  1a          
    INC DE                              ;0edf  13          
    CP  ':'                             ;0ee0  fe 3a       ;03Ah
    JR  NZ,MUSL4                        ;0ee2  20 f6       
    JR  MUSL5                           ;0ee4  18 06       
MUSL6:  LD  HL,MUSNUL                   ;0ee6  21 00 11    
MUSL7:  LD  DE,MUSNUL                   ;0ee9  11 00 11    
MUSL5:  POP BC                          ;0eec  c1          
                  ; BC=SOUND A
                  ; HL=SOUND B
                  ; DE=SOUND C
                  ;
                  
MUSLOP: PUSH    BC                      ;0eed  c5          
    EXX                                 ;0eee  d9          
    POP DE                              ;0eef  d1          
    LD  BC,LENG?A                       ;0ef0  01 11 11    
    CALL    SOUSET                      ;0ef3  cd 2e 0f    
    PUSH    DE                          ;0ef6  d5          
    EXX                                 ;0ef7  d9          
    POP BC                              ;0ef8  c1          
    PUSH    HL                          ;0ef9  e5          
    EXX                                 ;0efa  d9          
    POP DE                              ;0efb  d1          
    LD  BC,LENG?B                       ;0efc  01 19 11    
    CALL    SOUSET                      ;0eff  cd 2e 0f    
    PUSH    DE                          ;0f02  d5          
    EXX                                 ;0f03  d9          
    POP HL                              ;0f04  e1          
    PUSH    DE                          ;0f05  d5          
    EXX                                 ;0f06  d9          
    POP DE                              ;0f07  d1          
    LD  BC,LENG?C                       ;0f08  01 21 11    
    CALL    SOUSET                      ;0f0b  cd 2e 0f    
    PUSH    DE                          ;0f0e  d5          
    EXX                                 ;0f0f  d9          
    POP DE                              ;0f10  d1          
    EXX                                 ;0f11  d9          
                  ;
    CALL    DELAYS                      ;0f12  cd 77 10    
                  ;
    LD  BC,LENG?A                       ;0f15  01 11 11    
    CALL    SOUSTP                      ;0f18  cd 3b 10    
    LD  BC,LENG?B                       ;0f1b  01 19 11    
    CALL    SOUSTP                      ;0f1e  cd 3b 10    
    LD  BC,LENG?C                       ;0f21  01 21 11    
    CALL    SOUSTP                      ;0f24  cd 3b 10    
    EXX                                 ;0f27  d9          
                  ;
    CALL    ENDCHK                      ;0f28  cd 52 10    
    JR  NZ,MUSLOP                       ;0f2b  20 c0       
    RET                                 ;0f2d  c9          
                  ;
                  ; SUB
SOUSET: LD  A,(BC)                      ;0f2e  0a          
    OR  A                               ;0f2f  b7          
    RET NZ                              ;0f30  c0          
    DEC BC                              ;0f31  0b          ;BC=OCT.A
                  ;
SOUST2: LD  A,(DE)                      ;0f32  1a          
    CP  ':'                             ;0f33  fe 3a       ;03Ah
    RET Z                               ;0f35  c8          
                  ;
    CP  'V'                             ;0f36  fe 56       ;056h VOLUME
    JR  NZ,VOLOK                        ;0f38  20 31       
    INC DE                              ;0f3a  13          
    LD  A,(DE)                          ;0f3b  1a          
    SUB '0'                             ;0f3c  d6 30       ;030h
    JR  C,SOUST2                        ;0f3e  38 f2       
    CP  10                              ;0f40  fe 0a       ;00Ah
    JR  NC,SOUST2                       ;0f42  30 ee       
    INC DE                              ;0f44  13          
    CP  1                               ;0f45  fe 01       
    JR  NZ,VOLST                        ;0f47  20 10       
    LD  A,(DE)                          ;0f49  1a          
    SUB '0'                             ;0f4a  d6 30       ;030h
    JR  C,VOLST2                        ;0f4c  38 09       
    CP  6                               ;0f4e  fe 06       
    JR  NC,VOLST2                       ;0f50  30 05       
    ADD A,10                            ;0f52  c6 0a       
    INC DE                              ;0f54  13          
    JR  VOLST                           ;0f55  18 02       
VOLST2: LD  A,1                         ;0f57  3e 01       
VOLST:  LD  L,A                         ;0f59  6f          
    INC BC                              ;0f5a  03          
    INC BC                              ;0f5b  03          
    LD  A,(BC)                          ;0f5c  0a          
    DEC BC                              ;0f5d  0b          
    DEC BC                              ;0f5e  0b          
    PUSH    BC                          ;0f5f  c5          
    LD  BC,04000h                       ;0f60  01 00 40    ;PSG ADR.
    OUT (C),A                           ;0f63  ed 79       
    INC C                               ;0f65  0c          ;PSG DATA AD.
    OUT (C),L                           ;0f66  ed 69       
    POP BC                              ;0f68  c1          
    JR  SOUST2                          ;0f69  18 c7       
                  ;
VOLOK:  CP  'O'                         ;0f6b  fe 4f       ; OCTAVE
    JP  NZ,OCTOK                        ;0f6d  c2 7e 0f    
    INC DE                              ;0f70  13          
    LD  A,(DE)                          ;0f71  1a          
    SUB '1'                             ;0f72  d6 31       ;031h
    JR  C,SOUST2                        ;0f74  38 bc       
    CP  8                               ;0f76  fe 08       
    JR  NC,SOUST2                       ;0f78  30 b8       
    LD  (BC),A                          ;0f7a  02          ;OCT. SET
    INC DE                              ;0f7b  13          
    JR  SOUST2                          ;0f7c  18 b4       
                  ;
OCTOK:  EX  AF,AF'                      ;0f7e  08          
    LD  A,(BC)                          ;0f7f  0a          ;OCT. READ
    EX  AF,AF'                          ;0f80  08          
OCTOK2: LD  A,(DE)                      ;0f81  1a          
    CP  '+'                             ;0f82  fe 2b       ;02Bh
    JR  NZ,OCTNOP                       ;0f84  20 0a       
    INC DE                              ;0f86  13          
    EX  AF,AF'                          ;0f87  08          
    CP  7                               ;0f88  fe 07       
    JR  Z,OCTNO                         ;0f8a  28 01       
    INC A                               ;0f8c  3c          
OCTNO:  EX  AF,AF'                      ;0f8d  08          
    JR  OCTOK2                          ;0f8e  18 f1       
OCTNOP: CP  '-'                         ;0f90  fe 2d       ;02Dh
    JR  NZ,OCTNOM                       ;0f92  20 08       
    INC DE                              ;0f94  13          
    EX  AF,AF'                          ;0f95  08          
    OR  A                               ;0f96  b7          
    JR  Z,L0F9A                         ;0f97  28 01       
    DEC A                               ;0f99  3d          
L0F9A:  JR  OCTNO                       ;0f9a  18 f1       
                  ;
OCTNOM: LD  HL,NUMTBL                   ;0f9c  21 23 11    
    CP  '#'                             ;0f9f  fe 23       ;023h
    JR  NZ,NUMOK                        ;0fa1  20 05       
    INC DE                              ;0fa3  13          
    LD  HL,UPTBL                        ;0fa4  21 31 11    
    LD  A,(DE)                          ;0fa7  1a          
NUMOK:  INC DE                          ;0fa8  13          
    CP  'R'                             ;0fa9  fe 52       ;052h
    JR  Z,SOUOFF                        ;0fab  28 61       
    SUB 'A'                             ;0fad  d6 41       ;041h
    JP  C,SOUST2                        ;0faf  da 32 0f    
    CP  7                               ;0fb2  fe 07       
    JP  NC,SOUST2                       ;0fb4  d2 32 0f    
    PUSH    DE                          ;0fb7  d5          
    LD  E,A                             ;0fb8  5f          
    LD  D,0                             ;0fb9  16 00       
    EX  DE,HL                           ;0fbb  eb          
    ADD HL,HL                           ;0fbc  29          
    ADD HL,DE                           ;0fbd  19          
    DEC BC                              ;0fbe  0b          ;PSG DATA7
    DEC BC                              ;0fbf  0b          ;DATA HIGH
    LD  A,(HL)                          ;0fc0  7e          
    INC HL                              ;0fc1  23          
    LD  H,(HL)                          ;0fc2  66          
    LD  L,A                             ;0fc3  6f          
    EX  AF,AF'                          ;0fc4  08          
OCTDVL: OR  A                           ;0fc5  b7          
    JR  Z,OCTDIV                        ;0fc6  28 07       
    RR  H                               ;0fc8  cb 1c       
    RR  L                               ;0fca  cb 1d       
    DEC A                               ;0fcc  3d          
    JR  NZ,OCTDVL                       ;0fcd  20 f6       
OCTDIV: EX  DE,HL                       ;0fcf  eb          
    LD  L,C                             ;0fd0  69          
    LD  H,B                             ;0fd1  60          
    LD  (HL),D                          ;0fd2  72          
    DEC HL                              ;0fd3  2b          ;DATA LOW
    LD  (HL),E                          ;0fd4  73          
    DEC HL                              ;0fd5  2b          ;DATA ADR.
    DEC HL                              ;0fd6  2b          ;LEN.A
    POP DE                              ;0fd7  d1          
    LD  A,(DE)                          ;0fd8  1a          
    SUB '0'                             ;0fd9  d6 30       ;030h
    JR  C,SOUON                         ;0fdb  38 09       
    CP  10                              ;0fdd  fe 0a       ;
    JR  NC,SOUON                        ;0fdf  30 05       
    CALL    LENGSB                      ;0fe1  cd 88 10    
    INC DE                              ;0fe4  13          
    LD  (HL),A                          ;0fe5  77          
SOUON:  PUSH    DE                      ;0fe6  d5          
    LD  E,(HL)                          ;0fe7  5e          ;LENG.?
    INC HL                              ;0fe8  23          
    LD  D,(HL)                          ;0fe9  56          ;PSG ADR.
    INC HL                              ;0fea  23          
    LD  BC,04000h                       ;0feb  01 00 40    ;PSG ADR
    LD  A,(HL)                          ;0fee  7e          
    OUT (C),D                           ;0fef  ed 51       
    INC C                               ;0ff1  0c          
    OUT (C),A                           ;0ff2  ed 79       
    INC HL                              ;0ff4  23          
    DEC C                               ;0ff5  0d          
    INC D                               ;0ff6  14          
    LD  A,(HL)                          ;0ff7  7e          
    OUT (C),D                           ;0ff8  ed 51       
    INC C                               ;0ffa  0c          
    OUT (C),A                           ;0ffb  ed 79       
    INC HL                              ;0ffd  23          
    DEC C                               ;0ffe  0d          
    LD  D,7                             ;0fff  16 07       
    OUT (C),D                           ;1001  ed 51       
    INC C                               ;1003  0c          
    IN  A,(C)                           ;1004  ed 78       
    AND (HL)                            ;1006  a6          
    OUT (C),A                           ;1007  ed 79       
    INC HL                              ;1009  23          ;OCT.A
    INC HL                              ;100a  23          ;LENG.A
    LD  (HL),E                          ;100b  73          
    POP DE                              ;100c  d1          
    RET                                 ;100d  c9          
                  ;
                  ;
SOUOFF: DEC BC                          ;100e  0b          
    DEC BC                              ;100f  0b          
    DEC BC                              ;1010  0b          
    DEC BC                              ;1011  0b          
    DEC BC                              ;1012  0b          
    LD  A,(DE)                          ;1013  1a          
    SUB '0'                             ;1014  d6 30       ;030h
    JR  C,SOUOFE                        ;1016  38 09       
    CP  10                              ;1018  fe 0a       
    JR  NC,SOUOFE                       ;101a  30 05       
    CALL    LENGSB                      ;101c  cd 88 10    
    INC DE                              ;101f  13          
    LD  (BC),A                          ;1020  02          
SOUOFE: LD  A,(BC)                      ;1021  0a          
    INC BC                              ;1022  03          
    INC BC                              ;1023  03          
    INC BC                              ;1024  03          
    INC BC                              ;1025  03          
    INC BC                              ;1026  03          
    INC BC                              ;1027  03          
    LD  (BC),A                          ;1028  02          
SOUOFS: DEC BC                          ;1029  0b          
    DEC BC                              ;102a  0b          
    LD  A,(BC)                          ;102b  0a          
    CPL                                 ;102c  2f          
    LD  BC,04000h                       ;102d  01 00 40    ;PSG ADR.
    LD  L,7                             ;1030  2e 07       
    OUT (C),L                           ;1032  ed 69       
    INC C                               ;1034  0c          
    IN  H,(C)                           ;1035  ed 60       
    OR  H                               ;1037  b4          
    OUT (C),A                           ;1038  ed 79       
    RET                                 ;103a  c9          
                  ;
SOUSTP: LD  A,(BC)                      ;103b  0a          
    OR  A                               ;103c  b7          
    JR  Z,SOUOFS                        ;103d  28 ea       
    DEC A                               ;103f  3d          
    LD  (BC),A                          ;1040  02          
    RET                                 ;1041  c9          
                  ;
BRKRET: LD  BC,04000h                   ;1042  01 00 40    
    LD  L,7                             ;1045  2e 07       
    OUT (C),L                           ;1047  ed 69       
    INC C                               ;1049  0c          
    IN  A,(C)                           ;104a  ed 78       
    OR  7                               ;104c  f6 07       
    OUT (C),A                           ;104e  ed 79       
    XOR A                               ;1050  af          
    RET                                 ;1051  c9          
                  ;
ENDCHK: LD  A,080h                      ;1052  3e 80       ;BREAK CHECK
    IN  A,(0)                           ;1054  db 00       
    AND 012h                            ;1056  e6 12       
    JR  Z,BRKRET                        ;1058  28 e8       
    LD  A,(BC)                          ;105a  0a          
    CP  ':'                             ;105b  fe 3a       
    RET NZ                              ;105d  c0          
    LD  A,(DE)                          ;105e  1a          
    CP  ':'                             ;105f  fe 3a       
    RET NZ                              ;1061  c0          
    LD  A,(HL)                          ;1062  7e          
    CP  ':'                             ;1063  fe 3a       
    RET NZ                              ;1065  c0          
    LD  A,(LENG?A)                      ;1066  3a 11 11    
    OR  A                               ;1069  b7          
    RET NZ                              ;106a  c0          
    LD  A,(LENG?B)                      ;106b  3a 19 11    
    OR  A                               ;106e  b7          
    RET NZ                              ;106f  c0          
    LD  A,(LENG?C)                      ;1070  3a 21 11    
    OR  A                               ;1073  b7          
    RET NZ                              ;1074  c0          
    JR  BRKRET                          ;1075  18 cb       
                  ;
                  ;
                  ;
DELAYS: LD  HL,(MSDT32)                 ;1077  2a fe 10    
                  ; DELAY1MS SUB
DELAY1: LD  DE,152                      ;107a  11 98 00    ;10
DELAY2: DEC DE                          ;107d  1b          ;6
    LD  A,D                             ;107e  7a          ;4
    OR  E                               ;107f  b3          ;4
    JR  NZ,DELAY2                       ;1080  20 fb       ;12
    DEC HL                              ;1082  2b          ;6
    LD  A,H                             ;1083  7c          ;4
    OR  L                               ;1084  b5          ;4
    JR  NZ,DELAY1                       ;1085  20 f3       ;12
    RET                                 ;1087  c9          
LENGSB: PUSH    BC                      ;1088  c5          
    PUSH    HL                          ;1089  e5          
    LD  C,A                             ;108a  4f          
    LD  B,0                             ;108b  06 00       
    LD  HL,LENGTB                       ;108d  21 01 11    
    ADD HL,BC                           ;1090  09          
    LD  A,(HL)                          ;1091  7e          
    POP HL                              ;1092  e1          
    POP BC                              ;1093  c1          
    RET                                 ;1094  c9          
                  ;
                  ;
XTEMPO: LD  (MSDT32),A                  ;1095  32 fe 10    
                  ;
    RET                                 ;1098  c9          
                  ;
                  ;
SOUNDS: LD  A,E                         ;1099  7b          
    OR  A                               ;109a  b7          
    LD  HL,000FEh                       ;109b  21 fe 00    
    JR  Z,SOUND1                        ;109e  28 09       
    DEC A                               ;10a0  3d          
    LD  HL,002FDh                       ;10a1  21 fd 02    
    JR  Z,SOUND1                        ;10a4  28 03       
    LD  HL,004FBh                       ;10a6  21 fb 04    
SOUND1: LD  A,D                         ;10a9  7a          
    AND 7                               ;10aa  e6 07       
    JR  Z,SOUND2                        ;10ac  28 40       
    PUSH    HL                          ;10ae  e5          
    LD  BC,NUMTBL                       ;10af  01 23 11    
    BIT 3,D                             ;10b2  cb 5a       
    JR  Z,SOUND3                        ;10b4  28 03       
    LD  BC,UPTBL                        ;10b6  01 31 11    
SOUND3: DEC A                           ;10b9  3d          
    LD  L,A                             ;10ba  6f          
    LD  H,0                             ;10bb  26 00       
    ADD HL,HL                           ;10bd  29          
    ADD HL,BC                           ;10be  09          
    LD  A,D                             ;10bf  7a          
    LD  E,(HL)                          ;10c0  5e          
    INC HL                              ;10c1  23          
    LD  D,(HL)                          ;10c2  56          
    RRCA                                ;10c3  0f          
    RRCA                                ;10c4  0f          
    RRCA                                ;10c5  0f          
    RRCA                                ;10c6  0f          
    AND 00Fh                            ;10c7  e6 0f       
    JR  Z,SOUND4                        ;10c9  28 07       
SOUND5: SRL D                           ;10cb  cb 3a       
    RR  E                               ;10cd  cb 1b       
    DEC A                               ;10cf  3d          
    JR  NZ,SOUND5                       ;10d0  20 f9       
SOUND4: POP HL                          ;10d2  e1          
    LD  BC,04000h                       ;10d3  01 00 40    
    OUT (C),H                           ;10d6  ed 61       
    INC C                               ;10d8  0c          
    OUT (C),E                           ;10d9  ed 59       
    INC H                               ;10db  24          
    DEC C                               ;10dc  0d          
    OUT (C),H                           ;10dd  ed 61       
    INC C                               ;10df  0c          
    OUT (C),D                           ;10e0  ed 51       
    DEC C                               ;10e2  0d          
    LD  A,7                             ;10e3  3e 07       
    OUT (C),A                           ;10e5  ed 79       
    INC C                               ;10e7  0c          
    IN  A,(C)                           ;10e8  ed 78       
    AND L                               ;10ea  a5          
    OUT (C),A                           ;10eb  ed 79       
    RET                                 ;10ed  c9          
                  ;
SOUND2: LD  BC,04000h                   ;10ee  01 00 40    
    LD  A,7                             ;10f1  3e 07       
    OUT (C),A                           ;10f3  ed 79       
    INC C                               ;10f5  0c          
    IN  H,(C)                           ;10f6  ed 60       
    LD  A,L                             ;10f8  7d          
    CPL                                 ;10f9  2f          
    OR  H                               ;10fa  b4          
    OUT (C),A                           ;10fb  ed 79       
    RET                                 ;10fd  c9          
                  ;
                  ;
                  ; DATA TABLE
                  ;
                  ;
MSDT32: DEFW    62                      ;10fe  3e 00       
                  ;
MUSNUL: DEFM    ':'                     ;1100  3a          ;:
                  ;
LENGTB: DEFB    1                       ;1101  01          
    DEFB    2                           ;1102  02          
    DEFB    3                           ;1103  03          
    DEFB    4                           ;1104  04          
    DEFB    6                           ;1105  06          
    DEFB    8                           ;1106  08          
    DEFB    00CH                        ;1107  0c          
    DEFB    010h                        ;1108  10          
    DEFB    018h                        ;1109  18          
    DEFB    020h                        ;110a  20          
                  ;
LEN?A:  DEFB    008h                    ;110b  08          ;R5
    DEFB    000h                        ;110c  00          
DATA?A: DEFW    00000h                  ;110d  00 00       
    DEFB    0FEh                        ;110f  fe          
OCT?A:  DEFB    003h                    ;1110  03          
LENG?A: DEFB    000h                    ;1111  00          
    DEFB    008h                        ;1112  08          
                  ;
LEN?B:  DEFB    008h                    ;1113  08          
    DEFB    002h                        ;1114  02          
DATA?B: DEFW    00000h                  ;1115  00 00       
    DEFB    0FDh                        ;1117  fd          
OCT?B:  DEFB    3                       ;1118  03          
LENG?B: DEFB    0                       ;1119  00          
    DEFB    9                           ;111a  09          
                  ;
LEN?C:  DEFB    8                       ;111b  08          
    DEFB    4                           ;111c  04          
DATA?C: DEFW    00000h                  ;111d  00 00       
    DEFB    0FBh                        ;111f  fb          
OCT?C:  DEFB    3                       ;1120  03          
LENG?C: DEFB    0                       ;1121  00          
    DEFB    10                          ;1122  0a          
                  ;
                  ;
NUMTBL: DEFW    007F2h                  ;1123  f2 07       ;A
    DEFW    00714h                      ;1125  14 07       ;B
    DEFW    00D5Dh                      ;1127  5d 0d       ;C
    DEFW    00BE7h                      ;1129  e7 0b       ;D
    DEFW    00A9Bh                      ;112b  9b 0a       ;E
    DEFW    00A02h                      ;112d  02 0a       ;F
    DEFW    008EBh                      ;112f  eb 08       ;G
                  ;
UPTBL:  DEFW    00780h                  ;1131  80 07       ;A#
    DEFW    00714h                      ;1133  14 07       ;B
    DEFW    00C9Ch                      ;1135  9c 0c       ;C#
    DEFW    00B3Ch                      ;1137  3c 0b       ;D#
    DEFW    00A9Bh                      ;1139  9b 0a       ;E
    DEFW    00973h                      ;113b  73 09       ;F#
    DEFW    0086Bh                      ;113d  6b 08       ;G#
                  ;
CTRLTB: DEFW    NORET                   ;113f  cc 0e       ;@
    DEFW    NORET                       ;1141  cc 0e       ;A
    DEFW    CTRLB                       ;1143  9c 0b       ;B
    DEFW    CTRLM                       ;1145  62 0b       ;C
    DEFW    SCRLDW                      ;1147  ea 09       ;D
    DEFW    CTRLE                       ;1149  1d 0c       ;E
    DEFW    CTRLF                       ;114b  b4 0b       ;F
    DEFW    CTRLG                       ;114d  91 0b       ;G
    DEFW    DELETE                      ;114f  8e 0a       ;H 315ah ?? 
    DEFW    CTRLI                       ;1151  08 0c       ;I
    DEFW    NORET                       ;1153  cc 0e       ;J
    DEFW    HOME                        ;1155  03 0b       ;K HOME
    DEFW    CLR2                        ;1157  d5 0a       ;L CLR
    DEFW    CTRLM                       ;1159  62 0b       ;M CR
    DEFW    NORET                       ;115b  cc 0e       ;N
    DEFW    NORET                       ;115d  cc 0e       ;O
    DEFW    NORET                       ;115f  cc 0e       ;P
    DEFW    NORET                       ;1161  cc 0e       ;Q
    DEFW    INST                        ;1163  09 0b       ;R INST
    DEFW    NORET                       ;1165  cc 0e       ;S
    DEFW    CTRLT                       ;1167  fb 0b       ;T
    DEFW    SCRLUP                      ;1169  91 09       ;U
    DEFW    LOCK                        ;116b  3f 0b       ;V LOCK
    DEFW    UNLOCK                      ;116d  45 0b       ;W UNLOCK
    DEFW    NORET                       ;116f  cc 0e       ;X
    DEFW    CTRLY                       ;1171  f7 0b       ;Y
    DEFW    CTRLZ                       ;1173  25 0c       ;Z
    DEFW    NORET                       ;1175  cc 0e       ;ESC
    DEFW    RIGHT                       ;1177  6b 0b       ;RIGHT
    DEFW    LEFT                        ;1179  48 0b       ;LEFT
    DEFW    UP                          ;117b  87 0b       ;UP
    DEFW    DOWN                        ;117d  8c 0b       ;DOWN
                  
                  
BELLFG: DEFB    0                       ;117f  00          ;CTRL-G
                  ;
COLORF: DEFB    0                       ;1180  00          ; Color Flag
GCOLOR: DEFB    0                       ;1181  00          ; Graphic Color
SCRLBF: DEFS    020h                    ;1182              ; scroll buffer
LINEF:  DEFS    65                      ;11a2              ; line return flag
                  ;
CKSMF1: DEFW    0                       ;11e3  00 00       ; checksum field
CKSMF2: DEFW    0                       ;11e5  00 00       ; checksum field
MKLEN:  DEFW    0                       ;11e7  00 00       
                  ;
IO6000: DEFB    0                       ;11e9  00          ; 6000H I/O data
IO2000: DEFB    0                       ;11ea  00          ; 2000H I/O data
DISFLG: DEFB    1                       ;11eb  01          ; output flag (console=1, printer=2)
PRINTN: DEFB    0                       ;11ec  00          ; printer header
                  ;
CURX:   DEFB    0                       ;11ed  00          ; cursor X
CURY:   DEFB    0                       ;11ee  00          ; cursor Y
OLDBUF: DEFS    10                      ;11ef              ; keyboard matrix old buffer
NEWBUF: DEFS    9                       ;11f9              ; keyboard matrix new buffer
NEWMOD: DEFB    0FFh                    ;1202  ff          ; keyboard matrix mode flag
                  ;
LOCKMD: DEFB    0                       ;1203  00          ; LOCK mode
POINT1: DEFB    0                       ;1204  00          ; key input buffer 
POINT2: DEFB    0                       ;1205  00          ; key input buffer 
INKYBF: DEFS    040h                    ;1206              ; key input buffer
TABBUF: DEFS    32                      ;1246              ; TAB flag
                  ;
                  ;
FUNBUF: DEFB    5                       ;1266  05          ; function definition
    DEFM    'AUTO'                      ;1267  41 55 54 4f 
    DEFB    00Dh                        ;126b  0d          
    DEFS    10                          ;126c              
    DEFB    6                           ;1276  06          
    DEFM    'SCREEN'                    ;1277  53 43 52 45 
                                        ;127b  45 4e         2885   2893
                  
    DEFB    0                           ;127d  00          
    DEFS    8                           ;127e              
    DEFB    3                           ;1286  03          
    DEFM    'KEY'                       ;1287  4b 45 59    
    DEFB    0                           ;128a  00          
    DEFS    11                          ;128b              
    DEFB    5                           ;1296  05          
    DEFM    'LIST'                      ;1297  4c 49 53 54 
    DEFB    00Dh                        ;129b  0d          
    DEFS    00Ah                        ;129c              
    DEFB    4                           ;12a6  04          
    DEFM    'RUN'                       ;12a7  52 55 4e    
    DEFB    00Dh                        ;12aa  0d          
    DEFS    11                          ;12ab              
    DEFB    5                           ;12b6  05          
    DEFM    'LOAD'                      ;12b7  4c 4f 41 44 
    DEFB    00Dh                        ;12bb  0d          
    DEFS    10                          ;12bc              
    DEFB    5                           ;12c6  05          
    DEFM    'BEEP'                      ;12c7  42 45 45 50 
    DEFB    00Dh                        ;12cb  0d          
    DEFS    10                          ;12cc              
    DEFB    5                           ;12d6  05          
    DEFM    'CHR$('                     ;12d7  43 48 52 24 
                                        ;12db  28            2910   2919
                  
    DEFB    0                           ;12dc  00          
    DEFS    9                           ;12dd              
    DEFB    4                           ;12e6  04          
    DEFM    'EDIT'                      ;12e7  45 44 49 54 
    DEFB    0                           ;12eb  00          
    DEFS    10                          ;12ec              
    DEFB    5                           ;12f6  05          
    DEFM    'CONT'                      ;12f7  43 4f 4e 54 
    DEFB    00Dh                        ;12fb  0d          
    DEFS    10                          ;12fc              
                  ;
KEYDT1: DEFW    0F500h                  ;1306  00 f5       ;8009  No Shift
    DEFM    '-0                         ;1308  2d 30 3b    ;'		;'
    DEFW    06F6Ch                      ;130b  6c 6f       ;LO
    DEFM    '9'                         ;130d  39          ;9
    DEFW    0F400h                      ;130e  00 f4       ;8008
    DEFB    01Fh                        ;1310  1f          
    DEFM    ':/'                        ;1311  3a 2f       ;/
    DEFW    0696Bh                      ;1313  6b 69       ;KI
    DEFM    '8'                         ;1315  38          
    DEFW    0F300h                      ;1316  00 f3       ;8007
    DEFW    0701Eh                      ;1318  1e 70       ;P
    DEFM    '.'                         ;131a  2e          ;★원래는3F(?)였음
    DEFW    0756Ah                      ;131b  6a 75       ;JU
    DEFM    '7'                         ;131d  37          
    DEFW    0F200h                      ;131e  00 f2       ;8006
    DEFW    07840h                      ;1320  40 78       ;X
    DEFM    ','                         ;1322  2c          
    DEFW    07968h                      ;1323  68 79       ;HV
    DEFM    '6'                         ;1325  36          
    DEFW    0F100h                      ;1326  00 f1       ;8005
    DEFW    05D1Dh                      ;1328  1d 5d       
    DEFW    0676Dh                      ;132a  6d 67       ;MG
    DEFW    03574h                      ;132c  74 35       ;T5
    DEFW    00000h                      ;132e  00 00       ;8004
    DEFW    07C1Ch                      ;1330  1c 7c       
    DEFW    0666Eh                      ;1332  6e 66       ;NF
    DEFW    03472h                      ;1334  72 34       ;R4
    DEFW    00008h                      ;1336  08 00       ;DEL ;8003
    DEFW    05B1Bh                      ;1338  1b 5b       
    DEFW    06462h                      ;133a  62 64       ;BD
    DEFW    03365h                      ;133c  65 33       ;E3
    DEFW    00016h                      ;133e  16 00       ;LOCK ;8002
    DEFW    05D7Ah                      ;1340  7a 5d       ;Z^
    DEFW    07376h                      ;1342  76 73       ;VS
    DEFW    03277h                      ;1344  77 32       ;W2
    DEFW    00B5Eh                      ;1346  5e 0b       ;HOME ;8001
    DEFW    00D20h                      ;1348  20 0d       
    DEFW    06163h                      ;134a  63 61       ;CA
    DEFW    03171h                      ;134c  71 31       ;Q1
                  ;
                  ;
                  ;
KEYDT2: DEFW    0FA00h                  ;134e  00 fa       ; Shift
    DEFM    '=0+LO)'                    ;1350  3d 30 2b 4c 
                                        ;1354  4f 29         2966   2976
                  
    DEFW    0F900h                      ;1356  00 f9       
    DEFB    01Fh                        ;1358  1f          
    DEFM    '*?KI('                     ;1359  2a 3f 4b 49 
                                        ;135d  28            2970   2981
                  
    DEFW    0F800h                      ;135e  00 f8       
    DEFB    01Eh                        ;1360  1e          
    DEFM    'P>JU'                      ;1361  50 3e 4a 55 
    DEFB    027h                        ;1365  27          
    DEFW    0F700h                      ;1366  00 f7       
    DEFB    060h                        ;1368  60          
    DEFM    'X<HY&'                     ;1369  58 3c 48 59 
                                        ;136d  26            2978   2990
                  
    DEFW    0F600h                      ;136e  00 f6       
    DEFW    07D1Dh                      ;1370  1d 7d       
    DEFM    'MGT%'                      ;1372  4d 47 54 25 
    DEFW    00000h                      ;1376  00 00       
    DEFW    07F1Ch                      ;1378  1c 7f       
    DEFM    'NFR$'                      ;137a  4e 46 52 24 
    DEFW    00012h                      ;137e  12 00       ;INST
    DEFW    07B1Bh                      ;1380  1b 7b       
    DEFM    'BDE#'                      ;1382  42 44 45 23 
    DEFW    00017h                      ;1386  17 00       ;LOCK
    DEFM    'Z'                         ;1388  5a          
    DEFB    07Dh                        ;1389  7d          
    DEFM    'VSW"'                      ;138a  56 53 57 22 
    DEFW    00C7Eh                      ;138e  7e 0c       ;CLR
    DEFW    00D20h                      ;1390  20 0d       
    DEFM    'CAQ!'                      ;1392  43 41 51 21 
                  ;
                  ; FILE
                  ;  CONTROL
                  ;   BLOCK
                  ;
                  ;
FILMOD: DEFB    0001h                   ;1396  01          ; 1=기계어, 2=베이직
FILNAM: DEFS    17                      ;1397              ; 프로그램 이름 17 BYTE
MTBYTE: DEFW    1                       ;13a8  01 00       ; 프로그램 크기
MTADRS: DEFW    0                       ;13aa  00 00       ; 프로그램 저장번지
MTEXEC: DEFW    0                       ;13ac  00 00       ; CP/M에서 시작번지
PROTCT: DEFW    0                       ;13ae  00 00       ; 3A 00 이 들어있으면 베이직 자동실행
    DEFS    01416h - $                  ;13b0              ; 102 BYTE
                  
                  ;
                  ; HUDSON BASIC V1.0
                  ;
                  
                  ;SPBUF   EQU  02232h
    JR  HOTENT                          ;1416  18 2e       
$BASIC:                                 ;                  
COLDST: LD  DE,KEYBUF                   ;1418  11 4f 7a    
    LD  B,64                            ;141b  06 40       
MESOFF: CALL    PRTSDC                  ;141d  cd e1 07    
    LD  A,001h                          ;1420  3e 01       
    LD  (MESOFF),A                      ;1422  32 1d 14    
    LD  HL,KEYBUF                       ;1425  21 4f 7a    
    LD  D,0FFh                          ;1428  16 ff       ;MEM.MAX
L0014:                                  ;                  
    XOR A                               ;142a  af          
    LD  (HL),A                          ;142b  77          
    CP  (HL)                            ;142c  be          
    JR  NZ,L001E                        ;142d  20 05       
    INC HL                              ;142f  23          
    LD  A,H                             ;1430  7c          
    CP  D                               ;1431  ba          
    JR  NZ,L0014                        ;1432  20 f6       
L001E:                                  ;                  
    LD  (MEMMAX),HL                     ;1434  22 49 7a    
    CALL    MEMSET                      ;1437  cd e9 33    
    CALL    GSAVES                      ;143a  cd ea 1b    ;PCG SET
START:  CALL    NEW                     ;143d  cd ac 39    
    LD  HL,00000h                       ;1440  21 00 00    
    LD  (PROTCT),HL                     ;1443  22 ae 13    ;CMT BUFF
HOTENT: CALL    CLR                     ;1446  cd 51 19    
    LD  SP,(STRTOP)                     ;1449  ed 7b 41 7a 
    LD  HL,0FFFFh                       ;144d  21 ff ff    
    PUSH    HL                          ;1450  e5          
    LD  (SPBUF),SP                      ;1451  ed 73 25 22 
    XOR A                               ;1455  af          
    LD  (CONTFG),A                      ;1456  32 08 22    
    LD  (ERRORF),A                      ;1459  32 50 22    
    LD  (FILEFG),A                      ;145c  32 83 33    
    CALL    TROFF                       ;145f  cd ea 32    
OK: CALL    CR2                         ;1462  cd 23 08    
    LD  A,1                             ;1465  3e 01       
    LD  (DISFLG),A                      ;1467  32 eb 11    
    LD  DE,OKMES                        ;146a  11 f7 21    
    LD  B,2                             ;146d  06 02       
    CALL    PRTSDC                      ;146f  cd e1 07    
    LD  B,020h                          ;1472  06 20       
    LD  A,(CONTFG)                      ;1474  3a 08 22    
    OR  A                               ;1477  b7          
    JR  Z,CONTDS                        ;1478  28 02       
    LD  B,02Eh                          ;147a  06 2e       
CONTDS: LD  A,B                         ;147c  78          
    CALL    ACCPRT                      ;147d  cd 64 08    
    LD  A,(GMODEF)                      ;1480  3a 06 1c    
    CP  2                               ;1483  fe 02       
    CALL    NC,GRAPHI                   ;1485  d4 93 1b    
                  ;
NMESOK: CALL    CR2                     ;1488  cd 23 08    
AUTOBK: LD  SP,(SPBUF)                  ;148b  ed 7b 25 22 
    CALL    SETSSP                      ;148f  cd f9 21    
KEYINP: LD  HL,KEYINP                   ;1492  21 92 14    
    PUSH    HL                          ;1495  e5          
    CALL    AUTOVC                      ;1496  cd 37 22    
MERGEV: LD  DE,KEYBUF                   ;1499  11 4f 7a    
    DEFB    0CDH                        ;149c  cd          ;CALL
LODVEC: DEFW    LININP                  ;149d  93 15       
    JP  C,AUTOFF                        ;149f  da 2a 22    
BLNKSK: LD  A,(DE)                      ;14a2  1a          
    CP  020h                            ;14a3  fe 20       
    INC DE                              ;14a5  13          
    JR  Z,BLNKSK                        ;14a6  28 fa       
    DEC DE                              ;14a8  1b          
    OR  A                               ;14a9  b7          
    RET Z                               ;14aa  c8          
    CP  027h                            ;14ab  fe 27       
    RET Z                               ;14ad  c8          
    CP  030h                            ;14ae  fe 30       
    JR  NC,L00A5                        ;14b0  30 09       
    LD  HL,0FFFFh                       ;14b2  21 ff ff    
    LD  (LNOBUF),HL                     ;14b5  22 cc 16    
    JP  SERROR                          ;14b8  c3 3a 17    
L00A5:  CP  03Ah                        ;14bb  fe 3a       
    JP  C,EDITOR                        ;14bd  da f2 30    
    POP HL                              ;14c0  e1          
    LD  HL,IMDBUF                       ;14c1  21 4e 7b    
    PUSH    HL                          ;14c4  e5          
    CALL    CVIMTX                      ;14c5  cd 25 63    
    XOR A                               ;14c8  af          
    INC HL                              ;14c9  23          
    LD  (NXTLPT),HL                     ;14ca  22 12 16    
    LD  (HL),A                          ;14cd  77          
    INC HL                              ;14ce  23          
    LD  (HL),A                          ;14cf  77          
    INC A                               ;14d0  3c          
    LD  (DISFLG),A                      ;14d1  32 eb 11    
    LD  HL,0FFFFh                       ;14d4  21 ff ff    
    LD  (LNOBUF),HL                     ;14d7  22 cc 16    
    POP HL                              ;14da  e1          
ONELIN: LD  (SPBUF),SP                  ;14db  ed 73 25 22 
SPCCUT: LD  A,(HL)                      ;14df  7e          
    CP  020h                            ;14e0  fe 20       
    INC HL                              ;14e2  23          
    JR  Z,SPCCUT                        ;14e3  28 fa       
    CP  03Ah                            ;14e5  fe 3a       
    JR  Z,SPCCUT                        ;14e7  28 f6       
    OR  A                               ;14e9  b7          
    JP  Z,NXLINE                        ;14ea  ca 11 16    
    LD  (CURTXT),HL                     ;14ed  22 7b 21    
    LD  C,A                             ;14f0  4f          
    LD  A,080h                          ;14f1  3e 80       ;BREAK CHECK
    IN  A,(0)                           ;14f3  db 00       
    AND 012h                            ;14f5  e6 12       
BREAKJ: DEFB    0CAH                    ;14f7  ca          ;JP Z,?
    DEFW    BREAK                       ;14f8  a2 16       
PAUSEP: LD  A,C                         ;14fa  79          
    LD  DE,SPCCUT                       ;14fb  11 df 14    
    PUSH    DE                          ;14fe  d5          
LETDA': CP  027h                        ;14ff  fe 27       ;'
    JP  Z,REM                           ;1501  ca 3a 18    
    CP  081h                            ;1504  fe 81       
    JP  NC,STMNTS                       ;1506  d2 20 17    
    CP  041h                            ;1509  fe 41       
    JP  C,SERROR                        ;150b  da 3a 17    
LETDAI: LD  C,L                         ;150e  4d          
    LD  B,H                             ;150f  44          
    LD  DE,(INTFAC)                     ;1510  ed 5b 4b 7a 
DAINUE: CALL    GETVAR                  ;1514  cd da 1e    
    CP  003h                            ;1517  fe 03       
    JR  Z,DAISTR                        ;1519  28 2b       
DAINV': PUSH    AF                      ;151b  f5          
    CALL    BCFTCH                      ;151c  cd c4 25    
    CP  0F5h                            ;151f  fe f5       
    JP  NZ,SERROR                       ;1521  c2 3a 17    
    EX  (SP),HL                         ;1524  e3          
    PUSH    HL                          ;1525  e5          
    CALL    FLEXPR                      ;1526  cd 99 22    
    POP AF                              ;1529  f1          
    CP  002h                            ;152a  fe 02       
    JR  Z,INTDAI                        ;152c  28 0e       
    POP DE                              ;152e  d1          
DAIMID: PUSH    BC                      ;152f  c5          
    LD  B,A                             ;1530  47          
DAITRS: LD  A,(HL)                      ;1531  7e          
    LD  (DE),A                          ;1532  12          
    INC HL                              ;1533  23          
    INC DE                              ;1534  13          
    DJNZ    DAITRS                      ;1535  10 fa       
    POP BC                              ;1537  c1          
DAIRET: LD  L,C                         ;1538  69          
    LD  H,B                             ;1539  60          
    DEC HL                              ;153a  2b          
    RET                                 ;153b  c9          
                  ;
INTDAI: CALL    HLFLTO                  ;153c  cd 97 2d    
    POP DE                              ;153f  d1          
    EX  DE,HL                           ;1540  eb          
    LD  (HL),E                          ;1541  73          
    INC HL                              ;1542  23          
    LD  (HL),D                          ;1543  72          
    JR  DAIRET                          ;1544  18 f2       
                  ;
DAISTR: CALL    BCFTCH                  ;1546  cd c4 25    
    CP  0F5h                            ;1549  fe f5       
    JP  NZ,SERROR                       ;154b  c2 3a 17    
    PUSH    HL                          ;154e  e5          
    CALL    STEXPR                      ;154f  cd b2 22    
STRMDM: CALL    CONDMZ                  ;1552  cd f6 6b    
    CALL    CVDSAD                      ;1555  cd 0e 17    
    PUSH    BC                          ;1558  c5          
    PUSH    HL                          ;1559  e5          
    OR  A                               ;155a  b7          
    JR  Z,ESKTRS                        ;155b  28 11       
    LD  C,A                             ;155d  4f          
    LD  B,0                             ;155e  06 00       
    EX  DE,HL                           ;1560  eb          
    LD  DE,KEYBUF                       ;1561  11 4f 7a    
    PUSH    DE                          ;1564  d5          
    LDIR                                ;1565  ed b0       
    POP DE                              ;1567  d1          
    POP HL                              ;1568  e1          
    PUSH    HL                          ;1569  e5          
    INC HL                              ;156a  23          
    LD  (HL),E                          ;156b  73          
    INC HL                              ;156c  23          
    LD  (HL),D                          ;156d  72          
ESKTRS: POP HL                          ;156e  e1          
    POP BC                              ;156f  c1          
    POP DE                              ;1570  d1          
INPENT: PUSH    DE                      ;1571  d5          
    EX  DE,HL                           ;1572  eb          
    CALL    CONDM'                      ;1573  cd f2 6b    
    EX  DE,HL                           ;1576  eb          
    PUSH    HL                          ;1577  e5          
    INC HL                              ;1578  23          
    LD  E,(HL)                          ;1579  5e          
    INC HL                              ;157a  23          
    LD  D,(HL)                          ;157b  56          
    LD  HL,(STRTOP)                     ;157c  2a 41 7a    
    OR  A                               ;157f  b7          
    SBC HL,DE                           ;1580  ed 52       
    CCF                                 ;1582  3f          
    JR  NC,DAIMD'                       ;1583  30 05       
    LD  HL,TEXTST                       ;1585  21 4e 7c    
    SBC HL,DE                           ;1588  ed 52       
DAIMD': POP HL                          ;158a  e1          
    POP DE                              ;158b  d1          
    CALL    NC,GETSTR                   ;158c  d4 9e 2d    
    LD  A,003h                          ;158f  3e 03       
    JR  DAIMID                          ;1591  18 9c       
                  ;
LININP: EI                              ;1593  fb          
    CALL    INPUTF                      ;1594  cd a4 06    
    LD  A,(DE)                          ;1597  1a          
    CP  3                               ;1598  fe 03       ;BREAK CODE
    SCF                                 ;159a  37          
    RET Z                               ;159b  c8          
    PUSH    DE                          ;159c  d5          
ZEROMK: LD  A,(DE)                      ;159d  1a          
    INC DE                              ;159e  13          
    CP  00Dh                            ;159f  fe 0d       
    JR  NZ,ZEROMK                       ;15a1  20 fa       
    DEC DE                              ;15a3  1b          
    XOR A                               ;15a4  af          
    PUSH    BC                          ;15a5  c5          
    LD  B,10                            ;15a6  06 0a       
KBCLLP: LD  (DE),A                      ;15a8  12          
    INC DE                              ;15a9  13          
    DJNZ    KBCLLP                      ;15aa  10 fc       
    POP BC                              ;15ac  c1          
    POP DE                              ;15ad  d1          
    RET                                 ;15ae  c9          
                  ;
ENDTXT: LD  A,(ERRORF)                  ;15af  3a 50 22    
    OR  A                               ;15b2  b7          
OKFVC:  JP  Z,OK                        ;15b3  ca 62 14    
    LD  HL,(LNOBUF)                     ;15b6  2a cc 16    
    INC HL                              ;15b9  23          
    LD  A,L                             ;15ba  7d          
    OR  H                               ;15bb  b4          
    JR  Z,OKFVC                         ;15bc  28 f5       
    LD  A,19                            ;15be  3e 13       
    JP  ERROR                           ;15c0  c3 96 21    
                  ;
RUN:    CALL    CLR                     ;15c3  cd 51 19    
    XOR A                               ;15c6  af          
    LD  (FILEFG),A                      ;15c7  32 83 33    
    LD  (CONTFG),A                      ;15ca  32 08 22    
    LD  (ERRCOD),A                      ;15cd  32 95 22    
    LD  (ERRORF),A                      ;15d0  32 50 22    
    PUSH    HL                          ;15d3  e5          
    LD  HL,TEXTST                       ;15d4  21 4e 7c    
    DEC HL                              ;15d7  2b          
    LD  (HL),A                          ;15d8  77          
    LD  (DATAPO),HL                     ;15d9  22 60 1c    
    LD  HL,LININP                       ;15dc  21 93 15    
    LD  (LODVEC),HL                     ;15df  22 9d 14    
    POP HL                              ;15e2  e1          
    LD  SP,(STRTOP)                     ;15e3  ed 7b 41 7a 
    PUSH    HL                          ;15e7  e5          
    LD  HL,0                            ;15e8  21 00 00    
    LD  (ERRLNO),HL                     ;15eb  22 65 22    
    LD  (ERRORV),HL                     ;15ee  22 83 21    
    DEC HL                              ;15f1  2b          
    EX  (SP),HL                         ;15f2  e3          
    LD  (SPBUF),SP                      ;15f3  ed 73 25 22 
    CALL    HLFTCH                      ;15f7  cd 87 29    
    CP  00Bh                            ;15fa  fe 0b       
    JR  NZ,RUNBOT                       ;15fc  20 0d       
    INC HL                              ;15fe  23          
    LD  E,(HL)                          ;15ff  5e          
    INC HL                              ;1600  23          
    LD  D,(HL)                          ;1601  56          
    EX  DE,HL                           ;1602  eb          
    CALL    LNOSER                      ;1603  cd 8e 3f    
    JP  C,UDFLNO                        ;1606  da dc 43    
    JR  RUNMID                          ;1609  18 03       
RUNBOT: LD  HL,TEXTST                   ;160b  21 4e 7c    
RUNMID: LD  (NXTLPT),HL                 ;160e  22 12 16    
NXLINE:                                 ;                  
    DEFB    021H                        ;1611  21          ;LD HL,?
NXTLPT: DEFS    2                       ;1612              
    LD  E,(HL)                          ;1614  5e          
    INC HL                              ;1615  23          
    LD  D,(HL)                          ;1616  56          
    INC HL                              ;1617  23          
    LD  A,D                             ;1618  7a          
    OR  E                               ;1619  b3          
    JR  Z,ENDTXT                        ;161a  28 93       
    LD  (NXTLPT),DE                     ;161c  ed 53 12 16 
    LD  E,(HL)                          ;1620  5e          
    INC HL                              ;1621  23          
    LD  D,(HL)                          ;1622  56          
    INC HL                              ;1623  23          
    LD  (LNOBUF),DE                     ;1624  ed 53 cc 16 
    DEFB    03EH                        ;1628  3e          ;LD A,?
TRACEF:DEFS 1                           ;1629              
    OR  A                               ;162a  b7          
    CALL    NZ,DEBUGR                   ;162b  c4 31 16    
    JP  ONELIN                          ;162e  c3 db 14    
                  ;
DEBUGR: PUSH    AF                      ;1631  f5          
    XOR A                               ;1632  af          
    LD  (DISFLG),A                      ;1633  32 eb 11    
    LD  (DEBGHL),A                      ;1636  32 9f 16    
    POP AF                              ;1639  f1          
    RRCA                                ;163a  0f          
    JR  NC,NXSPL0                       ;163b  30 18       
    LD  C,L                             ;163d  4d          
    LD  B,H                             ;163e  44          
    PUSH    HL                          ;163f  e5          
    LD  HL,(CURX)                       ;1640  2a ed 11    
    PUSH    HL                          ;1643  e5          
    LD  HL,0                            ;1644  21 00 00    
    LD  (CURX),HL                       ;1647  22 ed 11    
    LD  L,C                             ;164a  69          
    LD  H,B                             ;164b  60          
    CALL    NXSPL0                      ;164c  cd 55 16    
    POP HL                              ;164f  e1          
    LD  (CURX),HL                       ;1650  22 ed 11    
    POP HL                              ;1653  e1          
    RET                                 ;1654  c9          
                  ;
NXSPL0: PUSH    HL                      ;1655  e5          
    RRCA                                ;1656  0f          
    JR  NC,NXSPL1                       ;1657  30 0c       
    PUSH    AF                          ;1659  f5          
    LD  A,2                             ;165a  3e 02       
    LD  (DISFLG),A                      ;165c  32 eb 11    
    LD  A,023h                          ;165f  3e 23       
    LD  (DEBGHL),A                      ;1661  32 9f 16    
    POP AF                              ;1664  f1          
NXSPL1: RRCA                            ;1665  0f          
    JR  NC,NXSPL2                       ;1666  30 11       
    PUSH    AF                          ;1668  f5          
    LD  A,05Bh                          ;1669  3e 5b       
    CALL    ACCPRT                      ;166b  cd 64 08    
    EX  DE,HL                           ;166e  eb          
    CALL    FIVEPR                      ;166f  cd e5 16    
    EX  DE,HL                           ;1672  eb          
    LD  A,05Dh                          ;1673  3e 5d       
    CALL    ACCPRT                      ;1675  cd 64 08    
    POP AF                              ;1678  f1          
NXSPL2: RRCA                            ;1679  0f          
    JR  NC,NXSPL3                       ;167a  30 0f       
    POP HL                              ;167c  e1          
    PUSH    HL                          ;167d  e5          
    PUSH    AF                          ;167e  f5          
    CALL    ONELST                      ;167f  cd 28 41    
    LD  A,5                             ;1682  3e 05       
    CALL    ACCPRT                      ;1684  cd 64 08    
    CALL    CR1                         ;1687  cd 43 08    
    POP AF                              ;168a  f1          
NXSPL3: RRCA                            ;168b  0f          
    PUSH    AF                          ;168c  f5          
    CALL    C,FLSHGT                    ;168d  dc 3c 0d    
    POP AF                              ;1690  f1          
    RRCA                                ;1691  0f          
    LD  HL,DEBGHL                       ;1692  21 9f 16    
    CALL    C,DUMP                      ;1695  dc 2f 3d    
    LD  A,1                             ;1698  3e 01       
    LD  (DISFLG),A                      ;169a  32 eb 11    
    POP HL                              ;169d  e1          
    RET                                 ;169e  c9          
                  ;
DEBGHL: DEFS    1                       ;169f              
                  ;
                  ;
BREAK$: POP BC                          ;16a0  c1          
    INC HL                              ;16a1  23          
BREAK:  DEC HL                          ;16a2  2b          
    LD  (BTEXTP),HL                     ;16a3  22 22 22    
    LD  HL,(LNOBUF)                     ;16a6  2a cc 16    
    LD  A,H                             ;16a9  7c          
    AND L                               ;16aa  a5          
    INC A                               ;16ab  3c          
    JR  Z,BRDRCT                        ;16ac  28 02       
    LD  A,1                             ;16ae  3e 01       
BRDRCT: LD  (BLNOBF),HL                 ;16b0  22 16 22    
    LD  (SPBUF),SP                      ;16b3  ed 73 25 22 
    LD  (CONTFG),A                      ;16b7  32 08 22    
    LD  HL,(NXTLPT)                     ;16ba  2a 12 16    
    LD  (BNXTLP),HL                     ;16bd  22 1c 22    
    CALL    CR2                         ;16c0  cd 23 08    
    LD  DE,BREAKM                       ;16c3  11 05 17    
    LD  B,5                             ;16c6  06 05       
    CALL    PRTSDC                      ;16c8  cd e1 07    
LNOPRT: DB  021H                        ;16cb  21          ;LD HL,?
LNOBUF: DEFS    2                       ;16cc              
    LD  A,H                             ;16ce  7c          
    AND L                               ;16cf  a5          
    INC A                               ;16d0  3c          
    JP  Z,OK                            ;16d1  ca 62 14    
    LD  (EDLINE),HL                     ;16d4  22 2a 37    
    LD  DE,INMES                        ;16d7  11 0a 17    
    LD  B,4                             ;16da  06 04       
    CALL    PRTSDC                      ;16dc  cd e1 07    
    CALL    FIVEPR                      ;16df  cd e5 16    
    JP  OK                              ;16e2  c3 62 14    
                  ;
FIVEPR: PUSH    DE                      ;16e5  d5          
    LD  DE,KEYBUF                       ;16e6  11 4f 7a    
    CALL    ASCHL                       ;16e9  cd a8 62    
    LD  B,4                             ;16ec  06 04       
SKIPFZ: LD  A,(DE)                      ;16ee  1a          
    CP  030h                            ;16ef  fe 30       
    JR  NZ,PRTNUM                       ;16f1  20 09       
    INC DE                              ;16f3  13          
    DJNZ    SKIPFZ                      ;16f4  10 f8       
LSTODP: LD  A,(DE)                      ;16f6  1a          
    CALL    ACCPRT                      ;16f7  cd 64 08    
    POP DE                              ;16fa  d1          
    RET                                 ;16fb  c9          
                  
PRTNUM: LD  A,(DE)                      ;16fc  1a          
    CALL    ACCPRT                      ;16fd  cd 64 08    
    INC DE                              ;1700  13          
    DJNZ    PRTNUM                      ;1701  10 f9       
    JR  LSTODP                          ;1703  18 f1       
                  ;
BREAKM: DEFM    'BREAK'                 ;1705  42 52 45 41 
                                        ;1709  4b            3429   3442
                  
INMES:  DEFM    ' IN '                  ;170a  20 49 4e 20 
                  ;
CVDSAD: PUSH    HL                      ;170e  e5          
    CALL    INDRCT                      ;170f  cd a3 2a    
    LD  A,(HL)                          ;1712  7e          
    INC HL                              ;1713  23          
    LD  E,(HL)                          ;1714  5e          
    INC HL                              ;1715  23          
    LD  D,(HL)                          ;1716  56          
    POP HL                              ;1717  e1          
    LD  (HL),A                          ;1718  77          
    INC HL                              ;1719  23          
    LD  (HL),E                          ;171a  73          
    INC HL                              ;171b  23          
    LD  (HL),D                          ;171c  72          
    DEC HL                              ;171d  2b          
    DEC HL                              ;171e  2b          
    RET                                 ;171f  c9          
                  ;
STMNTS: CP  0FFh                        ;1720  fe ff       
    JR  Z,FUNCTN1                       ;1722  28 1b       
    CP  0D0h                            ;1724  fe d0       
    JP  NC,SERROR                       ;1726  d2 3a 17    
    PUSH    HL                          ;1729  e5          
    LD  HL,SJPTBL                       ;172a  21 68 2f    
    CALL    GETJPA                      ;172d  cd 9f 28    
    EX  (SP),HL                         ;1730  e3          
    RET                                 ;1731  c9          
                  ;
TYPEMS: LD  A,13                        ;1732  3e 0d       
    JR  ERJUMP                          ;1734  18 06       
                  ;
IFCALL: LD  A,5                         ;1736  3e 05       
    JR  ERJUMP                          ;1738  18 02       
                  ;
SERROR: LD  A,2                         ;173a  3e 02       
ERJUMP: JP  ERROR                       ;173c  c3 96 21    
                  ;
FUNCTN1: LD A,(HL)                      ;173f  7e          
    CP  0B4h                            ;1740  fe b4       
    JP  Z,MIDDAI                        ;1742  ca 7e 17    
                  ;
                  ;	TIME$="00:00:00"
                  ;
MEMDAI: CP  0B8h                        ;1745  fe b8       
MEMDSE: JP  NZ,SERROR                   ;1747  c2 3a 17    
    LD  C,L                             ;174a  4d          
    LD  B,H                             ;174b  44          
    INC BC                              ;174c  03          
    CALL    CH28H                       ;174d  cd 58 2d    
    CALL    IHLEXP                      ;1750  cd cc 22    
    PUSH    HL                          ;1753  e5          
    CALL    CH2CH                       ;1754  cd 61 2d    
    CALL    IHLEXP                      ;1757  cd cc 22    
    CALL    CH29H                       ;175a  cd 66 2d    
    CALL    HCHECK                      ;175d  cd d8 22    
    PUSH    AF                          ;1760  f5          
    CALL    BCFTCH                      ;1761  cd c4 25    
    CP  0F5h                            ;1764  fe f5       
    JR  NZ,MEMDSE                       ;1766  20 df       
    CALL    STREXX                      ;1768  cd 9d 45    
    DEC BC                              ;176b  0b          
    POP HL                              ;176c  e1          
    CP  H                               ;176d  bc          
    JR  C,SKMDAI                        ;176e  38 01       
    LD  A,H                             ;1770  7c          
SKMDAI: POP HL                          ;1771  e1          
    PUSH    BC                          ;1772  c5          
    OR  A                               ;1773  b7          
    JR  Z,NOMDAI                        ;1774  28 06       
    LD  C,A                             ;1776  4f          
    LD  B,0                             ;1777  06 00       
    EX  DE,HL                           ;1779  eb          
    LDIR                                ;177a  ed b0       
NOMDAI: POP HL                          ;177c  e1          
    RET                                 ;177d  c9          
                  ;
MIDDAI: INC HL                          ;177e  23          
    LD  C,L                             ;177f  4d          
    LD  B,H                             ;1780  44          
    CALL    CH28H                       ;1781  cd 58 2d    
    LD  DE,(INTFAC)                     ;1784  ed 5b 4b 7a 
    CALL    GETVAB                      ;1788  cd d7 1e    
    CP  003h                            ;178b  fe 03       
    JP  NZ,TYPEMS                       ;178d  c2 32 17    
    PUSH    HL                          ;1790  e5          
    CALL    BCFTCH                      ;1791  cd c4 25    
    CALL    CH2CH                       ;1794  cd 61 2d    
    CALL    IHLEXP                      ;1797  cd cc 22    
    PUSH    AF                          ;179a  f5          
    CALL    HCHECK                      ;179b  cd d8 22    
    LD  D,A                             ;179e  57          
    LD  E,0FFh                          ;179f  1e ff       
    POP AF                              ;17a1  f1          
    CP  029h                            ;17a2  fe 29       
    JR  Z,MIDRAL                        ;17a4  28 0f       
    CALL    CH2CH                       ;17a6  cd 61 2d    
    PUSH    DE                          ;17a9  d5          
    CALL    IHLEXP                      ;17aa  cd cc 22    
    CALL    CH29H                       ;17ad  cd 66 2d    
    CALL    HCHECK                      ;17b0  cd d8 22    
    POP DE                              ;17b3  d1          
    LD  E,A                             ;17b4  5f          
MIDRAL: PUSH    DE                      ;17b5  d5          
    CALL    BCFTCH                      ;17b6  cd c4 25    
    CP  0F5h                            ;17b9  fe f5       
    JP  NZ,SERROR                       ;17bb  c2 3a 17    
    CALL    STREXX                      ;17be  cd 9d 45    
    EXX                                 ;17c1  d9          ; HL BC
    POP DE                              ;17c2  d1          ; D TO E
    POP HL                              ;17c3  e1          ; VAR DARD
    LD  A,(HL)                          ;17c4  7e          
    OR  A                               ;17c5  b7          
    LD  B,A                             ;17c6  47          
    LD  C,A                             ;17c7  4f          
    PUSH    HL                          ;17c8  e5          ; VAR ADRS
    JR  Z,NOEFT1                        ;17c9  28 56       
    PUSH    DE                          ;17cb  d5          ; D TO E
    INC HL                              ;17cc  23          
    CALL    INDRCT                      ;17cd  cd a3 2a    
    LD  DE,KEYBUF                       ;17d0  11 4f 7a    
    PUSH    DE                          ;17d3  d5          ; KEYBUF
MDTLLD: LD  A,(HL)                      ;17d4  7e          
    LD  (DE),A                          ;17d5  12          
    INC DE                              ;17d6  13          
    INC HL                              ;17d7  23          
    DJNZ    MDTLLD                      ;17d8  10 fa       
    POP HL                              ;17da  e1          ; KEYBUF
    POP DE                              ;17db  d1          ; D,E
    LD  A,D                             ;17dc  7a          
    DEC A                               ;17dd  3d          
    CP  C                               ;17de  b9          
    JR  NC,NOEFT1                       ;17df  30 40       
    ADD A,L                             ;17e1  85          
    LD  L,A                             ;17e2  6f          
    LD  A,000h                          ;17e3  3e 00       
    ADC A,H                             ;17e5  8c          
    LD  H,A                             ;17e6  67          ; HL <- REPLACE ADRS
    LD  A,C                             ;17e7  79          
    SUB D                               ;17e8  92          
    INC A                               ;17e9  3c          ; REPLACE LEN
    CP  E                               ;17ea  bb          
    JR  C,RPSTSW                        ;17eb  38 01       
    LD  A,E                             ;17ed  7b          
RPSTSW: LD  B,A                         ;17ee  47          
    PUSH    HL                          ;17ef  e5          
    PUSH    BC                          ;17f0  c5          
    EXX                                 ;17f1  d9          
    POP AF                              ;17f2  f1          ; B <- RP LEN
    POP DE                              ;17f3  d1          ; REPLACE ADRS
    PUSH    BC                          ;17f4  c5          ; TEXTPOINTER
    PUSH    AF                          ;17f5  f5          
    POP BC                              ;17f6  c1          ; B <- RP LEN
    LD  A,(HL)                          ;17f7  7e          
    CP  B                               ;17f8  b8          
    JR  NC,SKIOMR                       ;17f9  30 01       
    LD  B,A                             ;17fb  47          
SKIOMR: LD  A,B                         ;17fc  78          
    OR  A                               ;17fd  b7          
    JR  Z,NOEFT2                        ;17fe  28 1c       
    INC HL                              ;1800  23          
    CALL    INDRCT                      ;1801  cd a3 2a    
LSTRPL: LD  A,(HL)                      ;1804  7e          
    LD  (DE),A                          ;1805  12          
    INC HL                              ;1806  23          
    INC DE                              ;1807  13          
    DJNZ    LSTRPL                      ;1808  10 fa       
    LD  B,C                             ;180a  41          
    LD  DE,00008h                       ;180b  11 08 00    
    LD  HL,(INTFAC)                     ;180e  2a 4b 7a    
    ADD HL,DE                           ;1811  19          
    LD  DE,KEYBUF                       ;1812  11 4f 7a    
    CALL    ENTSTR                      ;1815  cd 1a 2b    
    POP BC                              ;1818  c1          
    JP  STRMDM                          ;1819  c3 52 15    
                  ;
NOEFT2: POP BC                          ;181c  c1          
RETNOE: POP HL                          ;181d  e1          
    JP  RETIRQ                          ;181e  c3 39 1b    
                  ;
NOEFT1: EXX                             ;1821  d9          
    JR  RETNOE                          ;1822  18 f9       
                  ;
DFLTCL: PUSH    BC                      ;1824  c5          
    LD  A,004h                          ;1825  3e 04       
    LD  B,26                            ;1827  06 1a       
    LD  DE,DFTABL                       ;1829  11 88 30    
    CALL    FILL                        ;182c  cd 11 62    
    XOR A                               ;182f  af          
    LD  DE,USRTBL                       ;1830  11 a2 30    
    LD  B,20                            ;1833  06 14       
    CALL    FILL                        ;1835  cd 11 62    
    POP BC                              ;1838  c1          
    RET                                 ;1839  c9          
                  ;
REM:    POP HL                          ;183a  e1          
    JP  NXLINE                          ;183b  c3 11 16    
                  ;
FILEER: LD  A,31                        ;183e  3e 1f       
    JP  ERROR                           ;1840  c3 96 21    
                  ;
PRTSTR: PUSH    BC                      ;1843  c5          
    CALL    CONDMZ                      ;1844  cd f6 6b    
    CALL    CVDSAD                      ;1847  cd 0e 17    
    LD  B,A                             ;184a  47          
    CALL    PRTSDC                      ;184b  cd e1 07    
    JP  SKIPP                           ;184e  c3 d6 18    
                  ;
RGPRMT: PUSH    AF                      ;1851  f5          
    JP  RGPRM'                          ;1852  c3 ca 18    
                  ;
PRINT:  LD  A,1                         ;1855  3e 01       
    LD  (DISFLG),A                      ;1857  32 eb 11    
    LD  C,L                             ;185a  4d          
    LD  B,H                             ;185b  44          
    CALL    BCFTCH                      ;185c  cd c4 25    
    CP  023h                            ;185f  fe 23       
    JR  NZ,PRINT'                       ;1861  20 2e       
    CALL    IHLEXP                      ;1863  cd cc 22    
    DEC BC                              ;1866  0b          
    OR  A                               ;1867  b7          
    JR  Z,PRDVSW                        ;1868  28 0a       
    CP  03Ah                            ;186a  fe 3a       
    JR  Z,PRDVSW                        ;186c  28 06       
    CP  02Ch                            ;186e  fe 2c       
    JP  NZ,SERROR                       ;1870  c2 3a 17    
    INC BC                              ;1873  03          
PRDVSW: LD  A,H                         ;1874  7c          
    OR  L                               ;1875  b5          
    JR  Z,PRSCRV                        ;1876  28 1b       
    INC HL                              ;1878  23          
    LD  A,H                             ;1879  7c          
    OR  L                               ;187a  b5          
    JR  NZ,PRTERM                       ;187b  20 0d       
    LD  A,(FILEFG)                      ;187d  3a 83 33    
    CP  2                               ;1880  fe 02       
    JR  NZ,FILEER                       ;1882  20 ba       
    INC A                               ;1884  3c          
    LD  (DISFLG),A                      ;1885  32 eb 11    
    JR  PRSCRV                          ;1888  18 09       
PRTERM: LD  A,2                         ;188a  3e 02       ; PRINTER
    LD  (DISFLG),A                      ;188c  32 eb 11    
    JR  PRSCRV                          ;188f  18 02       
                  ;
                  ;
PRINT': LD  C,L                         ;1891  4d          
    LD  B,H                             ;1892  44          
PRSCRV: CALL    SETSSP                  ;1893  cd f9 21    
    LD  (IY+0),0                        ;1896  fd 36 00 00 
    CALL    BCFTCH                      ;189a  cd c4 25    
    CP  0E2h                            ;189d  fe e2       
    JP  Z,USING                         ;189f  ca 10 34    
    OR  A                               ;18a2  b7          
    JR  Z,CRLFR'                        ;18a3  28 55       
    CP  03Ah                            ;18a5  fe 3a       
    JR  Z,CRLFR'                        ;18a7  28 51       
    CP  02Ch                            ;18a9  fe 2c       
    JP  Z,RGPRMT                        ;18ab  ca 51 18    
    CP  03Bh                            ;18ae  fe 3b       
    JP  Z,RGPRMT                        ;18b0  ca 51 18    
    CP  0E7h                            ;18b3  fe e7       
    JR  Z,TABOPR                        ;18b5  28 5b       
    CP  0E8h                            ;18b7  fe e8       
    JP  Z,SPCOPR                        ;18b9  ca 40 19    
    DEC BC                              ;18bc  0b          
    CALL    EXPRSN                      ;18bd  cd f2 22    
    PUSH    AF                          ;18c0  f5          
    LD  A,(IY+0)                        ;18c1  fd 7e 00    
    CP  003h                            ;18c4  fe 03       
    JP  Z,PRTSTR                        ;18c6  ca 43 18    
    OR  A                               ;18c9  b7          
RGPRM': PUSH    BC                      ;18ca  c5          
    JR  Z,SKIPP                         ;18cb  28 09       
    CALL    CVNMFL                      ;18cd  cd 58 5d    
    CALL    PRTSDC                      ;18d0  cd e1 07    
    CALL    SPPRT                       ;18d3  cd 62 08    
SKIPP:  POP HL                          ;18d6  e1          
    POP AF                              ;18d7  f1          
PRTYUI: OR  A                           ;18d8  b7          
    JR  Z,CRLFRT                        ;18d9  28 21       
    CP  03Ah                            ;18db  fe 3a       
    JR  Z,CRLFRT                        ;18dd  28 1d       
    CP  03Bh                            ;18df  fe 3b       
    JR  Z,SEMIS                         ;18e1  28 07       
    CP  02Ch                            ;18e3  fe 2c       
    JR  NZ,DECBCL                       ;18e5  20 1b       
    CALL    TABPRT                      ;18e7  cd 02 08    
SEMIS:  CALL    HLFTCH                  ;18ea  cd 87 29    
    OR  A                               ;18ed  b7          
    JR  Z,DISCLR                        ;18ee  28 04       
    CP  03Ah                            ;18f0  fe 3a       
    JR  NZ,PRINT'                       ;18f2  20 9d       
DISCLR: LD  A,1                         ;18f4  3e 01       
    LD  (DISFLG),A                      ;18f6  32 eb 11    
    RET                                 ;18f9  c9          
                  ;
CRLFR': LD  H,B                         ;18fa  60          
    LD  L,C                             ;18fb  69          
CRLFRT: CALL    CR1                     ;18fc  cd 43 08    
    DEC HL                              ;18ff  2b          
    JR  DISCLR                          ;1900  18 f2       
DECBCL: DEC HL                          ;1902  2b          
    CP  022h                            ;1903  fe 22       
    JR  Z,PRINT'                        ;1905  28 8a       
    CP  041h                            ;1907  fe 41       
    JR  NC,PRINT'                       ;1909  30 86       
    CP  021h                            ;190b  fe 21       
    JR  C,PRINT'                        ;190d  38 82       
    JP  SERROR                          ;190f  c3 3a 17    
                  ;
TABOPR: CALL    CH28H                   ;1912  cd 58 2d    
    CALL    IHLEXP                      ;1915  cd cc 22    
    CALL    CH29H                       ;1918  cd 66 2d    
    CALL    HCHECK                      ;191b  cd d8 22    
    LD  A,(DISFLG)                      ;191e  3a eb 11    
    CP  2                               ;1921  fe 02       
    JR  C,CRTTAS                        ;1923  38 05       
    LD  A,(PRINTN)                      ;1925  3a ec 11    
    JR  TSUBLS                          ;1928  18 03       
CRTTAS: LD  A,(CURX)                    ;192a  3a ed 11    
TSUBLS: SUB L                           ;192d  95          
    JR  NC,NOTABO                       ;192e  30 09       
    NEG                                 ;1930  ed 44       
TABPPP: LD  D,A                         ;1932  57          
TABPPT: CALL    SPPRT                   ;1933  cd 62 08    
    DEC D                               ;1936  15          
    JR  NZ,TABPPT                       ;1937  20 fa       
NOTABO: CALL    BCFTCH                  ;1939  cd c4 25    
    LD  L,C                             ;193c  69          
    LD  H,B                             ;193d  60          
    JR  PRTYUI                          ;193e  18 98       
                  ;
SPCOPR: CALL    CH28H                   ;1940  cd 58 2d    
    CALL    IHLEXP                      ;1943  cd cc 22    
    CALL    CH29H                       ;1946  cd 66 2d    
    CALL    HCHECK                      ;1949  cd d8 22    
    OR  A                               ;194c  b7          
    JR  Z,NOTABO                        ;194d  28 ea       
    JR  TABPPP                          ;194f  18 e1       
                  ;
CLR:    PUSH    HL                      ;1951  e5          
    PUSH    DE                          ;1952  d5          
    LD  HL,(VSTART)                     ;1953  2a 3b 7a    
    XOR A                               ;1956  af          
    LD  (HL),A                          ;1957  77          
    LD  (STKLMT),HL                     ;1958  22 3f 7a    
    LD  HL,(STRBTM)                     ;195b  2a 45 7a    
    LD  (STRPTR),HL                     ;195e  22 3d 7a    
    LD  DE,2000                         ;1961  11 d0 07    
    SBC HL,DE                           ;1964  ed 52       
    LD  (STRTOP),HL                     ;1966  22 41 7a    
    CALL    DFLTCL                      ;1969  cd 24 18    
    POP DE                              ;196c  d1          
    POP HL                              ;196d  e1          
    RET                                 ;196e  c9          
                  ;
FOR:    POP BC                          ;196f  c1          
    LD  (FLJPVC),BC                     ;1970  ed 43 f9 19 
    LD  C,L                             ;1974  4d          
    LD  B,H                             ;1975  44          
    LD  DE,(INTFAC)                     ;1976  ed 5b 4b 7a 
    CALL    GETVAB                      ;197a  cd d7 1e    
    LD  (FVTYPE),A                      ;197d  32 f1 19    
    EX  DE,HL                           ;1980  eb          
    LD  HL,0                            ;1981  21 00 00    
    ADD HL,SP                           ;1984  39          
FTSKIP: LD  A,(HL)                      ;1985  7e          
    OR  A                               ;1986  b7          
    JR  NZ,FORPUS                       ;1987  20 24       
    PUSH    DE                          ;1989  d5          
    LD  DE,6                            ;198a  11 06 00    
    ADD HL,DE                           ;198d  19          
    POP DE                              ;198e  d1          
    PUSH    HL                          ;198f  e5          
    CALL    INDRCT                      ;1990  cd a3 2a    
    OR  A                               ;1993  b7          
    SBC HL,DE                           ;1994  ed 52       
    POP HL                              ;1996  e1          
    JR  NZ,NXTSFT                       ;1997  20 0c       
    PUSH    DE                          ;1999  d5          
    LD  DE,18                           ;199a  11 12 00    
    ADD HL,DE                           ;199d  19          
    POP DE                              ;199e  d1          
    LD  (SPBUF),HL                      ;199f  22 25 22    
    LD  SP,HL                           ;19a2  f9          
    JR  FORPUS                          ;19a3  18 08       
                  ;
NXTSFT: PUSH    DE                      ;19a5  d5          
    LD  DE,16                           ;19a6  11 10 00    
    ADD HL,DE                           ;19a9  19          
    POP DE                              ;19aa  d1          
    JR  FTSKIP                          ;19ab  18 d8       
                  ;
FORPUS: EX  DE,HL                       ;19ad  eb          
    PUSH    HL                          ;19ae  e5          
    LD  A,(FVTYPE)                      ;19af  3a f1 19    
    CALL    DAINV'                      ;19b2  cd 1b 15    
    LD  A,(HL)                          ;19b5  7e          
    CP  0DFh                            ;19b6  fe df       
    JP  NZ,SERROR                       ;19b8  c2 3a 17    
    INC HL                              ;19bb  23          
    LD  C,L                             ;19bc  4d          
    LD  B,H                             ;19bd  44          
    CALL    FLEXPR                      ;19be  cd 99 22    
    POP DE                              ;19c1  d1          
    PUSH    HL                          ;19c2  e5          
    EXX                                 ;19c3  d9          
    POP DE                              ;19c4  d1          
    LD  HL,0FFF8h                       ;19c5  21 f8 ff    
    ADD HL,SP                           ;19c8  39          
    LD  SP,HL                           ;19c9  f9          
    EX  DE,HL                           ;19ca  eb          
    CALL    LDIR8                       ;19cb  cd a6 73    
    EXX                                 ;19ce  d9          
    CP  0E0h                            ;19cf  fe e0       
    LD  HL,FLONE                        ;19d1  21 98 62    
    JR  NZ,STEPON                       ;19d4  20 05       
    PUSH    DE                          ;19d6  d5          
    CALL    FLEXPR                      ;19d7  cd 99 22    
    POP DE                              ;19da  d1          
STEPON: PUSH    HL                      ;19db  e5          
    EXX                                 ;19dc  d9          
    POP DE                              ;19dd  d1          
    LD  HL,0FFF8h                       ;19de  21 f8 ff    
    ADD HL,SP                           ;19e1  39          
    LD  SP,HL                           ;19e2  f9          
    EX  DE,HL                           ;19e3  eb          
    CALL    LDIR8                       ;19e4  cd a6 73    
    EXX                                 ;19e7  d9          
    PUSH    DE                          ;19e8  d5          
    DEC BC                              ;19e9  0b          
    PUSH    BC                          ;19ea  c5          
    LD  HL,(NXTLPT)                     ;19eb  2a 12 16    
    PUSH    HL                          ;19ee  e5          
    DEFB    021H                        ;19ef  21          ;LD HL,?
    DEFB    000H                        ;19f0  00          ;low
FVTYPE: DEFS    1                       ;19f1              ;high
                  
    PUSH    HL                          ;19f2  e5          
    LD  L,C                             ;19f3  69          
    LD  H,B                             ;19f4  60          
    CALL    MEMCHK                      ;19f5  cd b0 1e    
    DEFB    0C3H                        ;19f8  c3          ; JP ?
FLJPVC: DEFS    2                       ;19f9              
                  ;
NXFVAR: CALL    BCFTCH                  ;19fb  cd c4 25    
    OR  A                               ;19fe  b7          
    JR  Z,NXWFOR                        ;19ff  28 04       
    CP  03Ah                            ;1a01  fe 3a       
    JR  NZ,AGINCV                       ;1a03  20 16       
NXWFOR: LD  A,1                         ;1a05  3e 01       
    JP  ERROR                           ;1a07  c3 96 21    
                  ;
NEXT:   CALL    HLFTCH                  ;1a0a  cd 87 29    
    OR  A                               ;1a0d  b7          
    JP  Z,DFLTNX                        ;1a0e  ca 62 1a    
    CP  03Ah                            ;1a11  fe 3a       
    JP  Z,DFLTNX                        ;1a13  ca 62 1a    
NEXTAG: LD  C,L                         ;1a16  4d          
    LD  B,H                             ;1a17  44          
    CALL    BCFTCH                      ;1a18  cd c4 25    
AGINCV: LD  DE,(INTFAC)                 ;1a1b  ed 5b 4b 7a 
    CALL    GETVAR                      ;1a1f  cd da 1e    
    EX  DE,HL                           ;1a22  eb          
    LD  HL,2                            ;1a23  21 02 00    
    ADD HL,SP                           ;1a26  39          
SKSTKS: LD  A,(HL)                      ;1a27  7e          
    OR  A                               ;1a28  b7          
    JR  NZ,NXFVAR                       ;1a29  20 d0       
    PUSH    DE                          ;1a2b  d5          
    LD  DE,6                            ;1a2c  11 06 00    
    ADD HL,DE                           ;1a2f  19          
    POP DE                              ;1a30  d1          
    PUSH    HL                          ;1a31  e5          
    CALL    INDRCT                      ;1a32  cd a3 2a    
    OR  A                               ;1a35  b7          
    SBC HL,DE                           ;1a36  ed 52       
    POP HL                              ;1a38  e1          
    JR  NZ,NXFPOR                       ;1a39  20 1f       
    LD  DE,6                            ;1a3b  11 06 00    
    OR  A                               ;1a3e  b7          
    SBC HL,DE                           ;1a3f  ed 52       
    POP DE                              ;1a41  d1          
    LD  SP,HL                           ;1a42  f9          
    LD  (NXTNXT),DE                     ;1a43  ed 53 4d 1a 
    LD  L,C                             ;1a47  69          
    LD  H,B                             ;1a48  60          
    CALL    DFLTNX                      ;1a49  cd 62 1a    
    DEFB    011H                        ;1a4c  11          ; LD DE,??
NXTNXT: DEFS    2                       ;1a4d              
    PUSH    DE                          ;1a4f  d5          
    RET NC                              ;1a50  d0          
    CALL    HLFTCH                      ;1a51  cd 87 29    
    CP  02Ch                            ;1a54  fe 2c       
    RET NZ                              ;1a56  c0          
    INC HL                              ;1a57  23          
    JR  NEXTAG                          ;1a58  18 bc       
                  ;
NXFPOR: PUSH    DE                      ;1a5a  d5          
    LD  DE,012H                         ;1a5b  11 12 00    
    ADD HL,DE                           ;1a5e  19          
    POP DE                              ;1a5f  d1          
    JR  SKSTKS                          ;1a60  18 c5       
                  ;
DFLTNX: PUSH    HL                      ;1a62  e5          
    LD  HL,00004h                       ;1a63  21 04 00    
    ADD HL,SP                           ;1a66  39          
    XOR A                               ;1a67  af          
    CP  (HL)                            ;1a68  be          
    JR  NZ,NXWFOR                       ;1a69  20 9a       
    INC HL                              ;1a6b  23          
    LD  A,0F0h                          ;1a6c  3e f0       
    AND (HL)                            ;1a6e  a6          
    JR  NZ,NXWFOR                       ;1a6f  20 94       
    LD  A,(HL)                          ;1a71  7e          
    INC HL                              ;1a72  23          
    LD  E,(HL)                          ;1a73  5e          
    INC HL                              ;1a74  23          
    LD  D,(HL)                          ;1a75  56          
    PUSH    DE                          ;1a76  d5          
    INC HL                              ;1a77  23          
    LD  E,(HL)                          ;1a78  5e          
    INC HL                              ;1a79  23          
    LD  D,(HL)                          ;1a7a  56          
    PUSH    DE                          ;1a7b  d5          
    INC HL                              ;1a7c  23          
    LD  E,(HL)                          ;1a7d  5e          
    INC HL                              ;1a7e  23          
    LD  D,(HL)                          ;1a7f  56          
    INC HL                              ;1a80  23          
    EX  DE,HL                           ;1a81  eb          
    CP  002h                            ;1a82  fe 02       
    JP  Z,INTFOR                        ;1a84  ca c1 1a    
    LD  (IY+0),A                        ;1a87  fd 77 00    
    CALL    ADD                         ;1a8a  cd a6 6c    
    INC DE                              ;1a8d  13          
    LD  A,(DE)                          ;1a8e  1a          
    DEC DE                              ;1a8f  1b          
    EX  AF,AF'                          ;1a90  08          
    PUSH    HL                          ;1a91  e5          
    LD  HL,00008h                       ;1a92  21 08 00    
    ADD HL,DE                           ;1a95  19          
    EX  DE,HL                           ;1a96  eb          
    POP HL                              ;1a97  e1          
    EX  AF,AF'                          ;1a98  08          
    RLCA                                ;1a99  07          
    JR  NC,FPCOMP                       ;1a9a  30 07       
    CALL    CMP                         ;1a9c  cd d6 61    
    JR  C,NEXTRT                        ;1a9f  38 12       
    JR  OMODED                          ;1aa1  18 07       
FPCOMP: CALL    CMP                     ;1aa3  cd d6 61    
    JR  Z,OMODED                        ;1aa6  28 02       
    JR  NC,NEXTRT                       ;1aa8  30 09       
OMODED: POP DE                          ;1aaa  d1          
    POP HL                              ;1aab  e1          
    LD  (NXTLPT),HL                     ;1aac  22 12 16    
    EX  DE,HL                           ;1aaf  eb          
    POP BC                              ;1ab0  c1          
    OR  A                               ;1ab1  b7          
    RET                                 ;1ab2  c9          
                  ;
NEXTRT: LD  HL,00008h                   ;1ab3  21 08 00    
    ADD HL,DE                           ;1ab6  19          
    POP BC                              ;1ab7  c1          
    POP BC                              ;1ab8  c1          
    POP DE                              ;1ab9  d1          
    POP IX                              ;1aba  dd e1       
    LD  SP,HL                           ;1abc  f9          
    EX  DE,HL                           ;1abd  eb          
    SCF                                 ;1abe  37          
    JP  (IX)                            ;1abf  dd e9       
                  ;
INTFOR: PUSH    DE                      ;1ac1  d5          ; STEP
    PUSH    HL                          ;1ac2  e5          ; VARADRS
    EX  DE,HL                           ;1ac3  eb          
    CALL    HLFLTO                      ;1ac4  cd 97 2d    ; STEP
    LD  A,H                             ;1ac7  7c          
    EX  AF,AF'                          ;1ac8  08          
    EX  DE,HL                           ;1ac9  eb          
    POP HL                              ;1aca  e1          
    PUSH    HL                          ;1acb  e5          
    CALL    INDRCT                      ;1acc  cd a3 2a    
    ADD HL,DE                           ;1acf  19          
    EX  DE,HL                           ;1ad0  eb          
    POP HL                              ;1ad1  e1          
    LD  (HL),E                          ;1ad2  73          
    INC HL                              ;1ad3  23          
    LD  (HL),D                          ;1ad4  72          
    POP HL                              ;1ad5  e1          
    LD  BC,00008h                       ;1ad6  01 08 00    
    ADD HL,BC                           ;1ad9  09          
    PUSH    HL                          ;1ada  e5          
    CALL    HLFLTO                      ;1adb  cd 97 2d    
    EX  AF,AF'                          ;1ade  08          
    RLCA                                ;1adf  07          
    JR  NC,MNIFOR                       ;1ae0  30 0a       
    CALL    INTCMP                      ;1ae2  cd f4 1a    
    POP DE                              ;1ae5  d1          
    JR  Z,OMODED                        ;1ae6  28 c2       
    JR  C,OMODED                        ;1ae8  38 c0       
    JR  NEXTRT                          ;1aea  18 c7       
                  ;
MNIFOR: CALL    INTCMP                  ;1aec  cd f4 1a    
    POP DE                              ;1aef  d1          
    JR  NC,OMODED                       ;1af0  30 b8       
    JR  NEXTRT                          ;1af2  18 bf       
                  ;
INTCMP: LD  A,H                         ;1af4  7c          
    RLCA                                ;1af5  07          
    JR  C,ICHMNS                        ;1af6  38 0c       
    LD  A,D                             ;1af8  7a          
    RLCA                                ;1af9  07          
    CCF                                 ;1afa  3f          
    JR  NC,NCICMT                       ;1afb  30 13       
INTCPM: OR  A                           ;1afd  b7          
    SBC HL,DE                           ;1afe  ed 52       
    RET C                               ;1b00  d8          
    LD  A,H                             ;1b01  7c          
    OR  L                               ;1b02  b5          
    RET                                 ;1b03  c9          
                  ;
ICHMNS: LD  A,D                         ;1b04  7a          
    RLCA                                ;1b05  07          
    CCF                                 ;1b06  3f          
    JR  C,CPRTMY                        ;1b07  38 02       
    JR  INTCPM                          ;1b09  18 f2       
                  ;
CPRTMY: LD  A,1                         ;1b0b  3e 01       
    OR  A                               ;1b0d  b7          
    SCF                                 ;1b0e  37          
    RET                                 ;1b0f  c9          
                  ;
NCICMT: LD  A,1                         ;1b10  3e 01       
    OR  A                               ;1b12  b7          
    RET                                 ;1b13  c9          
                  ;
ERTEST: LD  C,L                         ;1b14  4d          
    LD  B,H                             ;1b15  44          
    CALL    IBYTE                       ;1b16  cd df 22    
ERRTST: JP  ERROR                       ;1b19  c3 96 21    
                  ;
LET:    CALL    HLFTCH                  ;1b1c  cd 87 29    
    INC HL                              ;1b1f  23          
    JP  LETDA'                          ;1b20  c3 ff 14    
                  ;
POKE:   LD  C,L                         ;1b23  4d          
    LD  B,H                             ;1b24  44          
    CALL    IHLEXP                      ;1b25  cd cc 22    
POKELP: CP  02Ch                        ;1b28  fe 2c       
    JR  NZ,RETIRQ                       ;1b2a  20 0d       
    PUSH    HL                          ;1b2c  e5          
    CALL    IBYTE                       ;1b2d  cd df 22    
    POP HL                              ;1b30  e1          
    LD  (HL),A                          ;1b31  77          
    INC HL                              ;1b32  23          
    DEC BC                              ;1b33  0b          
    CALL    BCFTCH                      ;1b34  cd c4 25    
    JR  POKELP                          ;1b37  18 ef       
                  ;
RETIRQ: LD  L,C                         ;1b39  69          
    LD  H,B                             ;1b3a  60          
    DEC HL                              ;1b3b  2b          
    LD  A,1                             ;1b3c  3e 01       
    LD  (DISFLG),A                      ;1b3e  32 eb 11    
    RET                                 ;1b41  c9          
                  ;
CLS:    LD  A,(GMODEF)                  ;1b42  3a 06 1c    
    CP  2                               ;1b45  fe 02       
    LD  A,12                            ;1b47  3e 0c       
    JP  C,ACCPRT                        ;1b49  da 64 08    
CLSSB:                                  ;                  
    LD  BC,01800h                       ;1b4c  01 00 18    
    LD  D,000h                          ;1b4f  16 00       
CLS1LP: DEC BC                          ;1b51  0b          
    OUT (C),D                           ;1b52  ed 51       
    LD  A,B                             ;1b54  78          
    OR  C                               ;1b55  b1          
    JR  NZ,CLS1LP                       ;1b56  20 f9       
    RET                                 ;1b58  c9          
                  ;
                  ;
SCREEN: LD  C,L                         ;1b59  4d          
    LD  B,H                             ;1b5a  44          
    CALL    IHLEXP                      ;1b5b  cd cc 22    
    CALL    CH2CH                       ;1b5e  cd 61 2d    
    CALL    HCHECK                      ;1b61  cd d8 22    
    CP  5                               ;1b64  fe 05       
    JP  NC,IFCALL                       ;1b66  d2 36 17    
    PUSH    AF                          ;1b69  f5          
    CALL    IHLEXP                      ;1b6a  cd cc 22    
    CALL    CH2CH                       ;1b6d  cd 61 2d    
    CALL    HCHECK                      ;1b70  cd d8 22    
    CP  5                               ;1b73  fe 05       
    JP  NC,IFCALL                       ;1b75  d2 36 17    
    PUSH    AF                          ;1b78  f5          
    CALL    IBYTE                       ;1b79  cd df 22    
    CP  6                               ;1b7c  fe 06       
    JP  NC,IFCALL                       ;1b7e  d2 36 17    
    POP DE                              ;1b81  d1          
    LD  E,D                             ;1b82  5a          
    LD  L,A                             ;1b83  6f          
    POP AF                              ;1b84  f1          
    LD  D,A                             ;1b85  57          
    PUSH    BC                          ;1b86  c5          
    PUSH    DE                          ;1b87  d5          
    CALL    GRAPH                       ;1b88  cd 95 1b    
    POP BC                              ;1b8b  c1          
    CALL    SCRNBC                      ;1b8c  cd d6 05    
    POP BC                              ;1b8f  c1          
    JP  RETIRQ                          ;1b90  c3 39 1b    
                  ;
GRAPHI: LD  L,0                         ;1b93  2e 00       
GRAPH:  LD  A,(GMODEF)                  ;1b95  3a 06 1c    
    CP  L                               ;1b98  bd          
    JR  Z,GRAPOK                        ;1b99  28 1d       
    CP  2                               ;1b9b  fe 02       
    JR  NC,GM2345                       ;1b9d  30 0c       
    LD  A,L                             ;1b9f  7d          
    CP  2                               ;1ba0  fe 02       
    JR  C,GRAPOK                        ;1ba2  38 14       
    PUSH    AF                          ;1ba4  f5          
    CALL    CLSSB                       ;1ba5  cd 4c 1b    
    POP AF                              ;1ba8  f1          
    JR  GRAPOK                          ;1ba9  18 0d       
GM2345: LD  A,L                         ;1bab  7d          
    CP  2                               ;1bac  fe 02       
    JR  NC,GRAPOK                       ;1bae  30 08       
    PUSH    AF                          ;1bb0  f5          
    CALL    CLSSB                       ;1bb1  cd 4c 1b    
    CALL    GSAVES                      ;1bb4  cd ea 1b    
    POP AF                              ;1bb7  f1          
GRAPOK: LD  (GMODEF),A                  ;1bb8  32 06 1c    
    LD  L,A                             ;1bbb  6f          
    LD  E,A                             ;1bbc  5f          
    LD  H,0                             ;1bbd  26 00       
    LD  D,H                             ;1bbf  54          
    ADD HL,HL                           ;1bc0  29          
    ADD HL,HL                           ;1bc1  29          
    ADD HL,DE                           ;1bc2  19          
    LD  DE,SCRTAB                       ;1bc3  11 07 1c    
    ADD HL,DE                           ;1bc6  19          
    LD  A,(HL)                          ;1bc7  7e          
    LD  (SCRNYE+1),A                    ;1bc8  32 25 48    
    INC HL                              ;1bcb  23          
    LD  A,(HL)                          ;1bcc  7e          
    LD  (SCRNXE+1),A                    ;1bcd  32 2d 48    
    LD  A,0FFh                          ;1bd0  3e ff       
    LD  (SCRNYE+2),A                    ;1bd2  32 26 48    
    LD  (SCRNXE+2),A                    ;1bd5  32 2e 48    
    INC HL                              ;1bd8  23          
    LD  E,(HL)                          ;1bd9  5e          
    INC HL                              ;1bda  23          
    LD  D,(HL)                          ;1bdb  56          
    LD  (CALADR+1),DE                   ;1bdc  ed 53 34 48 
    INC HL                              ;1be0  23          
    LD  A,(IO2000)                      ;1be1  3a ea 11    
    AND 030h                            ;1be4  e6 30       
    OR  (HL)                            ;1be6  b6          
    JP  IO20SB                          ;1be7  c3 62 00    
                  ;
                  ;
GSAVES: PUSH    HL                      ;1bea  e5          
    LD  HL,$CGBUF                       ;1beb  21 4a 55    
    LD  BC,01000h                       ;1bee  01 00 10    
    LD  D,080h                          ;1bf1  16 80       
GSAVEL: LD  E,12                        ;1bf3  1e 0c       
GSAVEP: LD  A,(HL)                      ;1bf5  7e          
    OUT (C),A                           ;1bf6  ed 79       
    INC HL                              ;1bf8  23          
    INC BC                              ;1bf9  03          
    DEC E                               ;1bfa  1d          
    JR  NZ,GSAVEP                       ;1bfb  20 f8       
    INC BC                              ;1bfd  03          
    INC BC                              ;1bfe  03          
    INC BC                              ;1bff  03          
    INC BC                              ;1c00  03          
    DEC D                               ;1c01  15          
    JR  NZ,GSAVEL                       ;1c02  20 ef       
    POP HL                              ;1c04  e1          
    RET                                 ;1c05  c9          
                  ;
                  ;
GMODEF: DEFB    0                       ;1c06  00          
                  ;
SCRTAB: DEFB    0E0H                    ;1c07  e0          ;-32	G0
    DEFB    0C0H                        ;1c08  c0          ;-64
    DEFW    CALAD0                      ;1c09  36 48       
    DEFB    000H                        ;1c0b  00          
                  ;
    DEFB    0D0H                        ;1c0c  d0          ;G1	;-48
    DEFB    0C0H                        ;1c0d  c0          ;-64
    DEFW    CALAD1                      ;1c0e  75 48       
    DEFB    000H                        ;1c10  00          
                  ;
    DEFB    040H                        ;1c11  40          ;G2	;-192
    DEFB    080H                        ;1c12  80          ;-128
    DEFW    CALAD2                      ;1c13  ca 48       
    DEFB    00AH                        ;1c15  0a          
                  ;
    DEFB    040H                        ;1c16  40          ;G3
    DEFB    080H                        ;1c17  80          
    DEFW    CALAD3                      ;1c18  ca 48       
    DEFB    08AH                        ;1c1a  8a          
                  ;
    DEFB    040H                        ;1c1b  40          ;G4	;-192
    DEFB    000H                        ;1c1c  00          ;-256
    DEFW    CALAD4                      ;1c1d  f3 48       
    DEFB    00EH                        ;1c1f  0e          
                  ;
    DEFB    040H                        ;1c20  40          ;G5
    DEFB    000H                        ;1c21  00          
    DEFW    CALAD5                      ;1c22  f3 48       
    DEFB    08EH                        ;1c24  8e          
                  ;
LOCATE: LD  C,L                         ;1c25  4d          
    LD  B,H                             ;1c26  44          
    CALL    IHLEXP                      ;1c27  cd cc 22    
    CALL    CH2CH                       ;1c2a  cd 61 2d    
    CALL    HCHECK                      ;1c2d  cd d8 22    
    CP  32                              ;1c30  fe 20       ; CURX LIMI
LCTIFC: JP  NC,IFCALL                   ;1c32  d2 36 17    
    LD  (CURX),A                        ;1c35  32 ed 11    
    CALL    IBYTE                       ;1c38  cd df 22    
    CP  16                              ;1c3b  fe 10       ; CURY LIMIT
    JR  NC,LCTIFC                       ;1c3d  30 f3       
    LD  (CURY),A                        ;1c3f  32 ee 11    
    JP  RETIRQ                          ;1c42  c3 39 1b    
                  ;
READ:   LD  C,L                         ;1c45  4d          
    LD  B,H                             ;1c46  44          
    LD  HL,DATASK                       ;1c47  21 5f 1c    
    LD  (READVC),HL                     ;1c4a  22 5a 1e    
    LD  HL,LNG+1                        ;1c4d  21 28 45    
    LD  (DATAFV),HL                     ;1c50  22 fc 1d    
    LD  HL,00000h                       ;1c53  21 00 00    
    LD  (DATAV1),HL                     ;1c56  22 e2 1d    
    LD  HL,00428h                       ;1c59  21 28 04    
    LD  (DATAV2),HL                     ;1c5c  22 81 1e    
DATASK: DEFB    021H                    ;1c5f  21          ; LD HL,?
DATAPO: DEFS    2                       ;1c60              
DATAS': LD  A,(HL)                      ;1c62  7e          
    CP  03Ah                            ;1c63  fe 3a       
    JR  Z,MIDDAR                        ;1c65  28 11       
    OR  A                               ;1c67  b7          
    JR  NZ,DATAFD                       ;1c68  20 20       
    INC HL                              ;1c6a  23          
    LD  E,(HL)                          ;1c6b  5e          
    INC HL                              ;1c6c  23          
    LD  D,(HL)                          ;1c6d  56          
    LD  A,E                             ;1c6e  7b          
    OR  D                               ;1c6f  b2          
    LD  A,4                             ;1c70  3e 04       
    JP  Z,ERROR                         ;1c72  ca 96 21    
    INC HL                              ;1c75  23          
    INC HL                              ;1c76  23          
    INC HL                              ;1c77  23          
MIDDAR: CALL    HLFTCH                  ;1c78  cd 87 29    
    OR  A                               ;1c7b  b7          
    JR  Z,DATAS'                        ;1c7c  28 e4       
    CP  08Fh                            ;1c7e  fe 8f       ; DATA IM
    JR  Z,DATAFD                        ;1c80  28 08       
    CALL    DATA                        ;1c82  cd c8 1c    
    JR  C,DATAS'                        ;1c85  38 db       
    INC HL                              ;1c87  23          
    JR  MIDDAR                          ;1c88  18 ee       
                  ;
DATAFD: INC HL                          ;1c8a  23          
    LD  (DATAPO),HL                     ;1c8b  22 60 1c    
    EX  DE,HL                           ;1c8e  eb          
    JP  INPLOP                          ;1c8f  c3 df 1d    
                  ;
RESLBL: PUSH    HL                      ;1c92  e5          
    CALL    LBLSER                      ;1c93  cd be 42    
    LD  HL,(CURLPT)                     ;1c96  2a 53 43    
    DEC HL                              ;1c99  2b          
    LD  (DATAPO),HL                     ;1c9a  22 60 1c    
    POP HL                              ;1c9d  e1          
    CALL    IFDQSK                      ;1c9e  cd 64 44    
    OR  A                               ;1ca1  b7          
    RET Z                               ;1ca2  c8          
    INC HL                              ;1ca3  23          
    RET                                 ;1ca4  c9          
                  ;
RESTOR: CALL    HLFTCH                  ;1ca5  cd 87 29    
    CP  022h                            ;1ca8  fe 22       
    JR  Z,RESLBL                        ;1caa  28 e6       
    CP  00Bh                            ;1cac  fe 0b       
    PUSH    HL                          ;1cae  e5          
    LD  HL,TEXTST                       ;1caf  21 4e 7c    
    JR  NZ,RESTTT                       ;1cb2  20 0e       
    POP HL                              ;1cb4  e1          
    INC HL                              ;1cb5  23          
    LD  E,(HL)                          ;1cb6  5e          
    INC HL                              ;1cb7  23          
    LD  D,(HL)                          ;1cb8  56          
    INC HL                              ;1cb9  23          
    PUSH    HL                          ;1cba  e5          
    EX  DE,HL                           ;1cbb  eb          
    CALL    LNOSER                      ;1cbc  cd 8e 3f    
    JP  C,UDFLNO                        ;1cbf  da dc 43    
RESTTT: DEC HL                          ;1cc2  2b          
    LD  (DATAPO),HL                     ;1cc3  22 60 1c    
    POP HL                              ;1cc6  e1          
    RET                                 ;1cc7  c9          
                  ;
DATA:   DEC HL                          ;1cc8  2b          
DATALZ: CALL    IFSKSB                  ;1cc9  cd 40 44    
    OR  A                               ;1ccc  b7          
    SCF                                 ;1ccd  37          
    RET Z                               ;1cce  c8          
    CP  03Ah                            ;1ccf  fe 3a       
    RET Z                               ;1cd1  c8          
    JR  DATALZ                          ;1cd2  18 f5       
                  ;
LINCIN: CALL    IHLEXP                  ;1cd4  cd cc 22    
    CP  02Ch                            ;1cd7  fe 2c       
    JP  NZ,SERROR                       ;1cd9  c2 3a 17    
    LD  HL,CINPUT                       ;1cdc  21 f8 39    
    LD  (LINVEC),HL                     ;1cdf  22 30 1d    
    CALL    BCFTCH                      ;1ce2  cd c4 25    
    JR  LINPNP                          ;1ce5  18 35       
                  ;
LINE:   LD  (IBREKH),HL                 ;1ce7  22 4c 1d    
    LD  C,L                             ;1cea  4d          
    LD  B,H                             ;1ceb  44          
    CALL    BCFTCH                      ;1cec  cd c4 25    
    CP  08Dh                            ;1cef  fe 8d       
    JP  NZ,LINE@                        ;1cf1  c2 79 49    
    CALL    BCFTCH                      ;1cf4  cd c4 25    
    CP  023h                            ;1cf7  fe 23       
    JR  Z,LINCIN                        ;1cf9  28 d9       
    LD  HL,LININP                       ;1cfb  21 93 15    
    LD  (LINVEC),HL                     ;1cfe  22 30 1d    
    CP  022h                            ;1d01  fe 22       
    JR  NZ,LINPNP                       ;1d03  20 17       
LINPOL: LD  A,(BC)                      ;1d05  0a          
    INC BC                              ;1d06  03          
    OR  A                               ;1d07  b7          
    JP  Z,SERROR                        ;1d08  ca 3a 17    
    CP  022h                            ;1d0b  fe 22       
    JR  Z,PMTOUE                        ;1d0d  28 05       
    CALL    ACCPRT                      ;1d0f  cd 64 08    
    JR  LINPOL                          ;1d12  18 f1       
PMTOUE: CALL    BCFTCH                  ;1d14  cd c4 25    
    CP  03Bh                            ;1d17  fe 3b       
    CALL    Z,BCFTCH                    ;1d19  cc c4 25    
LINPNP: LD  DE,(INTFAC)                 ;1d1c  ed 5b 4b 7a 
    CALL    GETVAR                      ;1d20  cd da 1e    
    CP  003h                            ;1d23  fe 03       
    JP  NZ,TYPEMS                       ;1d25  c2 32 17    
    CALL    BCFTCH                      ;1d28  cd c4 25    
    PUSH    HL                          ;1d2b  e5          
    LD  DE,KEYBUF                       ;1d2c  11 4f 7a    
    DEFB    0CDH                        ;1d2f  cd          ; CALL ?
LINVEC: DEFW    LININP                  ;1d30  93 15       
    JR  C,IBREAK                        ;1d32  38 15       
    PUSH    BC                          ;1d34  c5          
    PUSH    DE                          ;1d35  d5          
    LD  B,0                             ;1d36  06 00       
LINESR: LD  A,(DE)                      ;1d38  1a          
    OR  A                               ;1d39  b7          
    JR  Z,ESLINE                        ;1d3a  28 04       
    INC DE                              ;1d3c  13          
    INC B                               ;1d3d  04          
    JR  LINESR                          ;1d3e  18 f8       
ESLINE: EX  DE,HL                       ;1d40  eb          
    POP DE                              ;1d41  d1          
    CALL    ENTSTR                      ;1d42  cd 1a 2b    
    POP BC                              ;1d45  c1          
    JP  STRMDM                          ;1d46  c3 52 15    
                  ;
IBREAK: POP HL                          ;1d49  e1          
    POP HL                              ;1d4a  e1          
    DEFB    021H                        ;1d4b  21          ; LD HL,?
IBREKH: DEFS    2                       ;1d4c              
    JP  BREAK                           ;1d4e  c3 a2 16    
                  ;
CINP'#: LD  HL,CIRPUT                   ;1d51  21 6c 1d    
    LD  (PMASVC),HL                     ;1d54  22 c3 1d    
    INC BC                              ;1d57  03          
    CALL    IHLEXP                      ;1d58  cd cc 22    
    CP  02Ch                            ;1d5b  fe 2c       
    JP  NZ,SERROR                       ;1d5d  c2 3a 17    
    LD  A,(FILEFG)                      ;1d60  3a 83 33    
    DEC A                               ;1d63  3d          
    JP  NZ,FILEER                       ;1d64  c2 3e 18    
    LD  A,0C3h                          ;1d67  3e c3       
    LD  (NRLDED),A                      ;1d69  32 30 3a    
CIRPUT: LD  DE,KEYBUF                   ;1d6c  11 4f 7a    
    CALL    CINPUT                      ;1d6f  cd f8 39    
    JR  INPLOP                          ;1d72  18 6b       
                  ;
INPUT:  PUSH    HL                      ;1d74  e5          
    LD  (IBREKH),HL                     ;1d75  22 4c 1d    
    LD  HL,PMTASK                       ;1d78  21 c2 1d    
    LD  (READVC),HL                     ;1d7b  22 5a 1e    
    LD  HL,00000h                       ;1d7e  21 00 00    
    LD  (DATAFV),HL                     ;1d81  22 fc 1d    
    LD  (DATAV2),HL                     ;1d84  22 81 1e    
    LD  HL,00418h                       ;1d87  21 18 04    
    LD  (DATAV1),HL                     ;1d8a  22 e2 1d    
    POP HL                              ;1d8d  e1          
    CALL    HLFTCH                      ;1d8e  cd 87 29    
    LD  C,L                             ;1d91  4d          
    LD  B,H                             ;1d92  44          
    PUSH    HL                          ;1d93  e5          
    LD  HL,LINEKB                       ;1d94  21 c5 1d    
    LD  (PMASVC),HL                     ;1d97  22 c3 1d    
    POP HL                              ;1d9a  e1          
    CP  023h                            ;1d9b  fe 23       
    JP  Z,CINP'#                        ;1d9d  ca 51 1d    
    CP  022h                            ;1da0  fe 22       
    JR  NZ,PMTASK                       ;1da2  20 1e       
PMTOUL: INC HL                          ;1da4  23          
    LD  A,(HL)                          ;1da5  7e          
    CP  022h                            ;1da6  fe 22       
    JR  Z,NPASK?                        ;1da8  28 09       
    OR  A                               ;1daa  b7          
    JP  Z,SERROR                        ;1dab  ca 3a 17    
    CALL    ACCPRT                      ;1dae  cd 64 08    
    JR  PMTOUL                          ;1db1  18 f1       
NPASK?: CALL    INCHLF                  ;1db3  cd 86 29    
    INC HL                              ;1db6  23          
    LD  C,L                             ;1db7  4d          
    LD  B,H                             ;1db8  44          
    CP  02Ch                            ;1db9  fe 2c       
    JR  Z,NOPPMT                        ;1dbb  28 10       
    CP  03Bh                            ;1dbd  fe 3b       
    JP  NZ,SERROR                       ;1dbf  c2 3a 17    
                  ;
PMTASK: DEFB    0C3H                    ;1dc2  c3          ; JP ?
PMASVC: DEFS    2                       ;1dc3              
LINEKB: LD  A,03Fh                      ;1dc5  3e 3f       
    CALL    ACCPRT                      ;1dc7  cd 64 08    
    CALL    SPPRT                       ;1dca  cd 62 08    
                  ;
NOPPMT: LD  HL,(CURX)                   ;1dcd  2a ed 11    ; ??DISPN
    PUSH    HL                          ;1dd0  e5          
    LD  DE,KEYBUF                       ;1dd1  11 4f 7a    
    CALL    LININP                      ;1dd4  cd 93 15    
    JP  C,IBREAK                        ;1dd7  da 49 1d    
    POP HL                              ;1dda  e1          
    LD  H,0                             ;1ddb  26 00       
    ADD HL,DE                           ;1ddd  19          
    EX  DE,HL                           ;1dde  eb          
                  ;
INPLOP: CALL    BCFTCH                  ;1ddf  cd c4 25    
DATAV1: JR  DASKIO                      ;1de2  18 04       
    LD  (DATAPO),DE                     ;1de4  ed 53 60 1c 
DASKIO: OR  A                           ;1de8  b7          
    JP  Z,RETIRQ                        ;1de9  ca 39 1b    
    CP  03Ah                            ;1dec  fe 3a       
    JP  Z,RETIRQ                        ;1dee  ca 39 1b    
    EX  AF,AF'                          ;1df1  08          
    CALL    DEFTCH                      ;1df2  cd 51 5d    
    DEC DE                              ;1df5  1b          
    OR  A                               ;1df6  b7          
    DEC BC                              ;1df7  0b          
    JR  Z,PMTERM                        ;1df8  28 5f       
    CP  03Ah                            ;1dfa  fe 3a       
DATAFV:                                 ;                  
    JR  Z,PMTERM                        ;1dfc  28 5b       
    INC BC                              ;1dfe  03          
    EX  AF,AF'                          ;1dff  08          
    PUSH    DE                          ;1e00  d5          
    LD  DE,(INTFAC)                     ;1e01  ed 5b 4b 7a 
    CALL    GETVAR                      ;1e05  cd da 1e    
    POP DE                              ;1e08  d1          
    CP  003h                            ;1e09  fe 03       
    JP  Z,STRINP                        ;1e0b  ca 69 1e    
    PUSH    HL                          ;1e0e  e5          
    PUSH    AF                          ;1e0f  f5          
    CALL    DEFTCH                      ;1e10  cd 51 5d    
    DEC DE                              ;1e13  1b          
    CP  02Eh                            ;1e14  fe 2e       
    JR  Z,INNMOK                        ;1e16  28 16       
    CP  02Dh                            ;1e18  fe 2d       
    JR  Z,INNMOK                        ;1e1a  28 12       
    CP  026h                            ;1e1c  fe 26       
    JR  Z,INNMOK                        ;1e1e  28 0e       
    CP  02Bh                            ;1e20  fe 2b       
    JR  Z,INNMOK                        ;1e22  28 0a       
    CP  030h                            ;1e24  fe 30       
    JP  C,TYPEMS                        ;1e26  da 32 17    
    CP  03Ah                            ;1e29  fe 3a       
    JP  NC,TYPEMS                       ;1e2b  d2 32 17    
INNMOK: LD  HL,ZFAC                     ;1e2e  21 f2 62    
    PUSH    BC                          ;1e31  c5          
    CALL    OVFLAG                      ;1e32  cd b8 5b    
    POP BC                              ;1e35  c1          
    POP AF                              ;1e36  f1          
    CP  002h                            ;1e37  fe 02       
    JR  Z,INITDI                        ;1e39  28 21       
    POP HL                              ;1e3b  e1          
    PUSH    BC                          ;1e3c  c5          
    LD  C,A                             ;1e3d  4f          
    LD  B,0                             ;1e3e  06 00       
    PUSH    DE                          ;1e40  d5          
    EX  DE,HL                           ;1e41  eb          
    LD  HL,ZFAC                         ;1e42  21 f2 62    
    LDIR                                ;1e45  ed b0       
    POP DE                              ;1e47  d1          
    POP BC                              ;1e48  c1          
NXTIN?: CALL    BCFTCH                  ;1e49  cd c4 25    
    CP  02Ch                            ;1e4c  fe 2c       
    DEC BC                              ;1e4e  0b          
    JR  NZ,INPLOP                       ;1e4f  20 8e       
    INC BC                              ;1e51  03          
    CALL    DEFTCH                      ;1e52  cd 51 5d    
    CP  02Ch                            ;1e55  fe 2c       ; BCOUTA?
    JR  Z,INPLOP                        ;1e57  28 86       
                  ;
PMTERM: DEFB    0C3H                    ;1e59  c3          ; JP ?
READVC: DEFS    2                       ;1e5a              
                  ;
INITDI: CALL    HLFLTO                  ;1e5c  cd 97 2d    
    POP IX                              ;1e5f  dd e1       
    LD  (IX+0),L                        ;1e61  dd 75 00    
    LD  (IX+1),H                        ;1e64  dd 74 01    
    JR  NXTIN?                          ;1e67  18 e0       
                  ;
STRINP: PUSH    BC                      ;1e69  c5          ; TEXT POINTR
    PUSH    HL                          ;1e6a  e5          ; VAR ADRS
    LD  (INPSDC),DE                     ;1e6b  ed 53 a9 1e 
    LD  B,0                             ;1e6f  06 00       
    CALL    DEFTCH                      ;1e71  cd 51 5d    
    CP  022h                            ;1e74  fe 22       
    JR  Z,DATA22                        ;1e76  28 20       
    DEC DE                              ;1e78  1b          
SRINPL: LD  A,(DE)                      ;1e79  1a          
    INC DE                              ;1e7a  13          
    INC B                               ;1e7b  04          
    OR  A                               ;1e7c  b7          
    JR  Z,ESCINS                        ;1e7d  28 08       
    CP  03Ah                            ;1e7f  fe 3a       
DATAV2: JR  Z,ESCINS                    ;1e81  28 04       
    CP  02Ch                            ;1e83  fe 2c       
    JR  NZ,SRINPL                       ;1e85  20 f2       
ESCINS: DEC DE                          ;1e87  1b          
ESCIN': DEC B                           ;1e88  05          
    LD  HL,INSDC                        ;1e89  21 a8 1e    
    LD  (HL),B                          ;1e8c  70          
    LD  C,E                             ;1e8d  4b          
    LD  B,D                             ;1e8e  42          
    POP DE                              ;1e8f  d1          
    PUSH    BC                          ;1e90  c5          
    CALL    INPENT                      ;1e91  cd 71 15    
    POP DE                              ;1e94  d1          
    POP BC                              ;1e95  c1          
    JR  NXTIN?                          ;1e96  18 b1       
                  ;
DATA22: LD  (INPSDC),DE                 ;1e98  ed 53 a9 1e 
DATADN: LD  A,(DE)                      ;1e9c  1a          
    INC B                               ;1e9d  04          
    OR  A                               ;1e9e  b7          
    JR  Z,ESCIN'                        ;1e9f  28 e7       
    INC DE                              ;1ea1  13          
    CP  022h                            ;1ea2  fe 22       
    JR  NZ,DATADN                       ;1ea4  20 f6       
    JR  ESCIN'                          ;1ea6  18 e0       
INSDC:  DEFS    1                       ;1ea8              
INPSDC: DEFS    2                       ;1ea9              
                  ;
HMEMCK: PUSH    HL                      ;1eab  e5          
    PUSH    DE                          ;1eac  d5          
    EX  DE,HL                           ;1ead  eb          
    JR  MCHKMD                          ;1eae  18 06       
                  ;
MEMCHK: PUSH    HL                      ;1eb0  e5          
    PUSH    DE                          ;1eb1  d5          
    LD  DE,(STKLMT)                     ;1eb2  ed 5b 3f 7a 
MCHKMD: PUSH    AF                      ;1eb6  f5          
    LD  HL,0                            ;1eb7  21 00 00    
    ADD HL,SP                           ;1eba  39          
    DEC H                               ;1ebb  25          
    OR  A                               ;1ebc  b7          
    SBC HL,DE                           ;1ebd  ed 52       
    JR  NC,MCHCKR                       ;1ebf  30 0e       
    CALL    MEMPUR                      ;1ec1  cd e8 2d    
    LD  HL,0                            ;1ec4  21 00 00    
    ADD HL,SP                           ;1ec7  39          
    DEC H                               ;1ec8  25          
    OR  A                               ;1ec9  b7          
    SBC HL,DE                           ;1eca  ed 52       
    JP  C,OMERR                         ;1ecc  da 88 21    
MCHCKR: POP AF                          ;1ecf  f1          
    POP DE                              ;1ed0  d1          
    POP HL                              ;1ed1  e1          
    RET                                 ;1ed2  c9          
                  
GETVAC: LD  DE,(INTFAC)                 ;1ed3  ed 5b 4b 7a 
GETVAB: CALL    BCFTCH                  ;1ed7  cd c4 25    
GETVAR: PUSH    DE                      ;1eda  d5          
    CALL    VSRTST                      ;1edb  cd fe 20    
    CP  028h                            ;1ede  fe 28       
    JP  Z,ARRAY                         ;1ee0  ca 41 1f    
    DEC BC                              ;1ee3  0b          
    PUSH    BC                          ;1ee4  c5          
    LD  A,E                             ;1ee5  7b          
    EX  DE,HL                           ;1ee6  eb          
    LD  B,A                             ;1ee7  47          
    LD  HL,(VSTART)                     ;1ee8  2a 3b 7a    
VARCLP: LD  A,(HL)                      ;1eeb  7e          
    OR  A                               ;1eec  b7          
    JR  Z,CRNVAR                        ;1eed  28 34       
    CP  B                               ;1eef  b8          
    JR  NZ,SKIPUS                       ;1ef0  20 12       
    INC HL                              ;1ef2  23          
    LD  A,E                             ;1ef3  7b          
    CP  (HL)                            ;1ef4  be          
    LD  A,B                             ;1ef5  78          
    JP  NZ,SKIPVT                       ;1ef6  c2 18 1f    
    INC HL                              ;1ef9  23          
    LD  A,D                             ;1efa  7a          
    CP  (HL)                            ;1efb  be          
    LD  A,B                             ;1efc  78          
    JP  NZ,SKIPVU                       ;1efd  c2 19 1f    
    INC HL                              ;1f00  23          
GVARRT: POP BC                          ;1f01  c1          
    POP DE                              ;1f02  d1          
    RET                                 ;1f03  c9          
                  ;
SKIPUS: INC A                           ;1f04  3c          
    JP  P,SKIPVT                        ;1f05  f2 18 1f    
    DEC A                               ;1f08  3d          
    AND 0C0h                            ;1f09  e6 c0       
    CP  0C0h                            ;1f0b  fe c0       
    LD  A,5                             ;1f0d  3e 05       
    JR  Z,SKIPVV                        ;1f0f  28 09       
    INC HL                              ;1f11  23          
    CALL    INDRCT                      ;1f12  cd a3 2a    
    JP  VARCLP                          ;1f15  c3 eb 1e    
                  ;
SKIPVT: INC A                           ;1f18  3c          
SKIPVU: INC A                           ;1f19  3c          
SKIPVV: ADD A,L                         ;1f1a  85          
    LD  L,A                             ;1f1b  6f          
    LD  A,000h                          ;1f1c  3e 00       
    ADC A,H                             ;1f1e  8c          
    LD  H,A                             ;1f1f  67          
    JP  VARCLP                          ;1f20  c3 eb 1e    
                  ;
CRNVAR: LD  (HL),B                      ;1f23  70          
    INC HL                              ;1f24  23          
    LD  (HL),E                          ;1f25  73          
    INC HL                              ;1f26  23          
    LD  (HL),D                          ;1f27  72          
    INC HL                              ;1f28  23          
    LD  C,B                             ;1f29  48          
    PUSH    HL                          ;1f2a  e5          
    EX  DE,HL                           ;1f2b  eb          
    INC B                               ;1f2c  04          
    XOR A                               ;1f2d  af          
LZFIL1: LD  (DE),A                      ;1f2e  12          
    INC DE                              ;1f2f  13          
    DJNZ    LZFIL1                      ;1f30  10 fc       
    DEC DE                              ;1f32  1b          
    EX  DE,HL                           ;1f33  eb          
    CALL    HMEMCK                      ;1f34  cd ab 1e    
    EX  DE,HL                           ;1f37  eb          
    LD  (STKLMT),DE                     ;1f38  ed 53 3f 7a 
    POP HL                              ;1f3c  e1          
    LD  A,C                             ;1f3d  79          
    JP  GVARRT                          ;1f3e  c3 01 1f    
                  ;
ARRAY:  LD  D,0                         ;1f41  16 00       
    EXX                                 ;1f43  d9          
    POP HL                              ;1f44  e1          
    PUSH    HL                          ;1f45  e5          
    PUSH    HL                          ;1f46  e5          
    EXX                                 ;1f47  d9          
    EX  (SP),HL                         ;1f48  e3          
    PUSH    HL                          ;1f49  e5          
TSALOP: POP HL                          ;1f4a  e1          
    PUSH    HL                          ;1f4b  e5          
    PUSH    DE                          ;1f4c  d5          
    DEC IY                              ;1f4d  fd 2b       
    CALL    HLEXP                       ;1f4f  cd c7 22    
    INC IY                              ;1f52  fd 23       
    CP  029h                            ;1f54  fe 29       
    JR  Z,TSFARY                        ;1f56  28 12       
    CP  02Ch                            ;1f58  fe 2c       
    JP  NZ,SERROR                       ;1f5a  c2 3a 17    
    POP DE                              ;1f5d  d1          
    INC D                               ;1f5e  14          
    EXX                                 ;1f5f  d9          
    POP HL                              ;1f60  e1          
    POP DE                              ;1f61  d1          
    EXX                                 ;1f62  d9          
    PUSH    HL                          ;1f63  e5          
    EXX                                 ;1f64  d9          
    PUSH    DE                          ;1f65  d5          
    PUSH    HL                          ;1f66  e5          
    EXX                                 ;1f67  d9          
    JR  TSALOP                          ;1f68  18 e0       
                  ;
TSFARY: POP DE                          ;1f6a  d1          
    EXX                                 ;1f6b  d9          
    POP HL                              ;1f6c  e1          
    POP DE                              ;1f6d  d1          
    EXX                                 ;1f6e  d9          
    INC D                               ;1f6f  14          
    PUSH    HL                          ;1f70  e5          
    PUSH    BC                          ;1f71  c5          
    EXX                                 ;1f72  d9          
    PUSH    DE                          ;1f73  d5          
    EXX                                 ;1f74  d9          
    POP BC                              ;1f75  c1          
    LD  HL,(VSTART)                     ;1f76  2a 3b 7a    
ASLOP:  LD  A,(HL)                      ;1f79  7e          
    OR  A                               ;1f7a  b7          
    JP  Z,SORERR                        ;1f7b  ca f5 20    
    JP  M,ARYATA                        ;1f7e  fa 8c 1f    
    INC A                               ;1f81  3c          
    INC A                               ;1f82  3c          
    INC A                               ;1f83  3c          
ARSKFN: ADD A,L                         ;1f84  85          
    LD  L,A                             ;1f85  6f          
    LD  A,000h                          ;1f86  3e 00       
    ADC A,H                             ;1f88  8c          
    LD  H,A                             ;1f89  67          
    JR  ASLOP                           ;1f8a  18 ed       
                  ;
ARYATA: AND 0C0h                        ;1f8c  e6 c0       
    CP  0C0h                            ;1f8e  fe c0       
    LD  A,005h                          ;1f90  3e 05       
    JR  Z,ARSKFN                        ;1f92  28 f0       
    LD  A,(HL)                          ;1f94  7e          
    AND 07Fh                            ;1f95  e6 7f       
    CP  E                               ;1f97  bb          
    JR  Z,ARMSN1                        ;1f98  28 0d       
    INC HL                              ;1f9a  23          
MIDNAM: CALL    INDRCT                  ;1f9b  cd a3 2a    
    JP  ASLOP                           ;1f9e  c3 79 1f    
                  ;
NXTVR:  DEC HL                          ;1fa1  2b          
NXTVR1:     DEC HL                      ;1fa2  2b          
    DEC HL                              ;1fa3  2b          
    JP  MIDNAM                          ;1fa4  c3 9b 1f    
                  ;
ARMSN1: EXX                             ;1fa7  d9          
    LD  C,A                             ;1fa8  4f          
    LD  B,000h                          ;1fa9  06 00       
    LD  HL,00000h                       ;1fab  21 00 00    
    EXX                                 ;1fae  d9          
    INC HL                              ;1faf  23          
    INC HL                              ;1fb0  23          
    INC HL                              ;1fb1  23          
    LD  A,C                             ;1fb2  79          
    CP  (HL)                            ;1fb3  be          
    JP  NZ,NXTVR1                       ;1fb4  c2 a2 1f    
    INC HL                              ;1fb7  23          
    LD  A,B                             ;1fb8  78          
    CP  (HL)                            ;1fb9  be          
    JP  NZ,NXTVR                        ;1fba  c2 a1 1f    
    INC HL                              ;1fbd  23          
    LD  A,D                             ;1fbe  7a          
    CP  (HL)                            ;1fbf  be          
    JP  NZ,SORERR                       ;1fc0  c2 f5 20    
    POP BC                              ;1fc3  c1          
    LD  (ARBCBF),BC                     ;1fc4  ed 43 f1 1f 
    LD  B,(HL)                          ;1fc8  46          
    INC HL                              ;1fc9  23          
ADRCL:  LD  E,(HL)                      ;1fca  5e          
    INC HL                              ;1fcb  23          
    LD  D,(HL)                          ;1fcc  56          
    INC HL                              ;1fcd  23          
    EX  (SP),HL                         ;1fce  e3          
    PUSH    DE                          ;1fcf  d5          
    EXX                                 ;1fd0  d9          
    POP DE                              ;1fd1  d1          
    CALL    IMUL                        ;1fd2  cd 4b 21    
    EXX                                 ;1fd5  d9          
    PUSH    HL                          ;1fd6  e5          
    SBC HL,DE                           ;1fd7  ed 52       
    JP  NC,SORERR                       ;1fd9  d2 f5 20    
    EXX                                 ;1fdc  d9          
    POP DE                              ;1fdd  d1          
    ADD HL,DE                           ;1fde  19          
    EXX                                 ;1fdf  d9          
    POP HL                              ;1fe0  e1          
    DJNZ    ADRCL                       ;1fe1  10 e7       
    PUSH    HL                          ;1fe3  e5          
    EXX                                 ;1fe4  d9          
    LD  E,C                             ;1fe5  59          
    LD  D,B                             ;1fe6  50          
    LD  A,C                             ;1fe7  79          
    CALL    IMUL                        ;1fe8  cd 4b 21    
    PUSH    HL                          ;1feb  e5          
    EXX                                 ;1fec  d9          
    POP DE                              ;1fed  d1          
    POP HL                              ;1fee  e1          
    ADD HL,DE                           ;1fef  19          
    DEFB    001H                        ;1ff0  01          ; LD BC,?
ARBCBF: DEFS    2                       ;1ff1              
    POP DE                              ;1ff3  d1          
    RET                                 ;1ff4  c9          
                  ;
CHALNM: CP  030h                        ;1ff5  fe 30       
    RET C                               ;1ff7  d8          
    CP  05Bh                            ;1ff8  fe 5b       
    CCF                                 ;1ffa  3f          
    RET C                               ;1ffb  d8          
    CP  041h                            ;1ffc  fe 41       
    RET NC                              ;1ffe  d0          
    CP  03Ah                            ;1fff  fe 3a       
    CCF                                 ;2001  3f          
    RET                                 ;2002  c9          
                  ;
DIM:    CALL    HLFTCH                  ;2003  cd 87 29    
    OR  A                               ;2006  b7          
    RET Z                               ;2007  c8          
    CP  03Ah                            ;2008  fe 3a       
    RET Z                               ;200a  c8          
    LD  C,L                             ;200b  4d          
    LD  B,H                             ;200c  44          
    CALL    BCFTCH                      ;200d  cd c4 25    
    CALL    VSRTST                      ;2010  cd fe 20    
    CP  028h                            ;2013  fe 28       
    JP  NZ,SERROR                       ;2015  c2 3a 17    
    PUSH    BC                          ;2018  c5          
    PUSH    DE                          ;2019  d5          
    PUSH    HL                          ;201a  e5          
    LD  C,L                             ;201b  4d          
    LD  B,H                             ;201c  44          
    LD  HL,(VSTART)                     ;201d  2a 3b 7a    
DASLOP: LD  A,(HL)                      ;2020  7e          
    OR  A                               ;2021  b7          
    JR  Z,DIMFDD                        ;2022  28 39       
    JP  M,DRYATA                        ;2024  fa 32 20    
    INC A                               ;2027  3c          
    INC A                               ;2028  3c          
    INC A                               ;2029  3c          
DRSKFN: ADD A,L                         ;202a  85          
    LD  L,A                             ;202b  6f          
    LD  A,000h                          ;202c  3e 00       
    ADC A,H                             ;202e  8c          
    LD  H,A                             ;202f  67          
    JR  DASLOP                          ;2030  18 ee       
                  ;
DRYATA: AND 0C0h                        ;2032  e6 c0       
    CP  0C0h                            ;2034  fe c0       
    LD  A,5                             ;2036  3e 05       
    JR  Z,DRSKFN                        ;2038  28 f0       
    LD  A,(HL)                          ;203a  7e          
    AND 07Fh                            ;203b  e6 7f       
    CP  E                               ;203d  bb          
    JP  Z,MOPDIM                        ;203e  ca 4c 20    
    INC HL                              ;2041  23          
DIDNAM: CALL    INDRCT                  ;2042  cd a3 2a    
    JR  DASLOP                          ;2045  18 d9       
                  ;
DXTVR1: DEC HL                          ;2047  2b          
DXTVR:  DEC HL                          ;2048  2b          
    DEC HL                              ;2049  2b          
    JR  DIDNAM                          ;204a  18 f6       
                  ;
MOPDIM: INC HL                          ;204c  23          
    INC HL                              ;204d  23          
    INC HL                              ;204e  23          
    LD  A,C                             ;204f  79          
    CP  (HL)                            ;2050  be          
    JP  NZ,DXTVR                        ;2051  c2 48 20    
    INC HL                              ;2054  23          
    LD  A,B                             ;2055  78          
    CP  (HL)                            ;2056  be          
    JP  NZ,DXTVR1                       ;2057  c2 47 20    
    JP  DUPDEF                          ;205a  c3 8b 3b    
                  ;
DIMFDD: POP HL                          ;205d  e1          
    POP DE                              ;205e  d1          
    POP BC                              ;205f  c1          
    LD  D,0                             ;2060  16 00       
    PUSH    HL                          ;2062  e5          
ARGLOP: PUSH    DE                      ;2063  d5          
    CALL    IHLEXP                      ;2064  cd cc 22    
    CP  029h                            ;2067  fe 29       
    JR  Z,DEFARY                        ;2069  28 09       
    CALL    CH2CH                       ;206b  cd 61 2d    
    POP DE                              ;206e  d1          
    INC D                               ;206f  14          
    INC HL                              ;2070  23          
    PUSH    HL                          ;2071  e5          
    JR  ARGLOP                          ;2072  18 ef       
                  ;
DEFARY: POP DE                          ;2074  d1          
    INC D                               ;2075  14          
    INC HL                              ;2076  23          
    PUSH    HL                          ;2077  e5          
    LD  HL,(STKLMT)                     ;2078  2a 3f 7a    
    LD  A,E                             ;207b  7b          
    OR  080h                            ;207c  f6 80       
    LD  (HL),A                          ;207e  77          
    EX  AF,AF'                          ;207f  08          
    INC HL                              ;2080  23          
    INC HL                              ;2081  23          
    INC HL                              ;2082  23          
    INC HL                              ;2083  23          
    INC HL                              ;2084  23          
    LD  (HL),D                          ;2085  72          
    INC HL                              ;2086  23          
    LD  A,D                             ;2087  7a          
    EXX                                 ;2088  d9          
    LD  HL,00001h                       ;2089  21 01 00    
AREPUT: POP DE                          ;208c  d1          
    PUSH    DE                          ;208d  d5          
    CALL    IMUL                        ;208e  cd 4b 21    
    EXX                                 ;2091  d9          
    POP DE                              ;2092  d1          
    LD  (HL),E                          ;2093  73          
    INC HL                              ;2094  23          
    LD  (HL),D                          ;2095  72          
    INC HL                              ;2096  23          
    DEC A                               ;2097  3d          
    EXX                                 ;2098  d9          
    JR  NZ,AREPUT                       ;2099  20 f1       
    EX  AF,AF'                          ;209b  08          
    AND 07Fh                            ;209c  e6 7f       
    LD  E,A                             ;209e  5f          
    LD  D,0                             ;209f  16 00       
    CALL    IMUL                        ;20a1  cd 4b 21    
    PUSH    HL                          ;20a4  e5          
    EXX                                 ;20a5  d9          
    POP DE                              ;20a6  d1          
    PUSH    HL                          ;20a7  e5          
    ADD HL,DE                           ;20a8  19          
    JP  C,OMERR                         ;20a9  da 88 21    
    PUSH    DE                          ;20ac  d5          
    CALL    HMEMCK                      ;20ad  cd ab 1e    
    EX  DE,HL                           ;20b0  eb          
    LD  HL,(STKLMT)                     ;20b1  2a 3f 7a    
    INC HL                              ;20b4  23          
    LD  (HL),E                          ;20b5  73          
    INC HL                              ;20b6  23          
    LD  (HL),D                          ;20b7  72          
    INC HL                              ;20b8  23          
    LD  (STKLMT),DE                     ;20b9  ed 53 3f 7a 
    POP DE                              ;20bd  d1          
    INC DE                              ;20be  13          
    EX  (SP),HL                         ;20bf  e3          
ARYCLL: LD  (HL),0                      ;20c0  36 00       
    INC HL                              ;20c2  23          
    DEC DE                              ;20c3  1b          
    LD  A,D                             ;20c4  7a          
    OR  E                               ;20c5  b3          
    JR  NZ,ARYCLL                       ;20c6  20 f8       
    POP HL                              ;20c8  e1          
    POP DE                              ;20c9  d1          
    LD  (HL),E                          ;20ca  73          
    INC HL                              ;20cb  23          
    LD  (HL),D                          ;20cc  72          
    LD  L,C                             ;20cd  69          
    LD  H,B                             ;20ce  60          
    CALL    HLFTCH                      ;20cf  cd 87 29    
    INC HL                              ;20d2  23          
    CP  02Ch                            ;20d3  fe 2c       
    JP  Z,DIM                           ;20d5  ca 03 20    
    DEC HL                              ;20d8  2b          
    RET                                 ;20d9  c9          
                  ;
OFF:    CALL    HLFTCH                  ;20da  cd 87 29    
    CP  09Ch                            ;20dd  fe 9c       
    JR  Z,BREAKL                        ;20df  28 0a       
    XOR A                               ;20e1  af          ;NUL CODE
    LD  (BREAKI),A                      ;20e2  32 be 06    
    LD  A,011h                          ;20e5  3e 11       ;LD DE,BREAK
OFFOFF: LD  (BREAKJ),A                  ;20e7  32 f7 14    
    RET                                 ;20ea  c9          
                  ;
BREAKL: LD  A,3                         ;20eb  3e 03       ;BREAK CODE
    LD  (BREAKI),A                      ;20ed  32 be 06    
    LD  A,0CAh                          ;20f0  3e ca       ;JP Z,BREAK
    INC HL                              ;20f2  23          
    JR  OFFOFF                          ;20f3  18 f2       
                  ;
SORERR: LD  A,9                         ;20f5  3e 09       
NIERRO: JP  ERROR                       ;20f7  c3 96 21    
                  ;
NINS:   LD  A,29                        ;20fa  3e 1d       
    JR  NIERRO                          ;20fc  18 f9       
                  ;
VSRTST: LD  HL,00000h                   ;20fe  21 00 00    
    CP  041h                            ;2101  fe 41       
    JP  C,SERROR                        ;2103  da 3a 17    
    CP  05Bh                            ;2106  fe 5b       
    JP  NC,SERROR                       ;2108  d2 3a 17    
    LD  L,A                             ;210b  6f          
    CALL    BCFTCH                      ;210c  cd c4 25    
    CALL    CHALNM                      ;210f  cd f5 1f    
    JR  C,CHKTYP                        ;2112  38 09       
    LD  H,A                             ;2114  67          
SKIPDM: CALL    BCFTCH                  ;2115  cd c4 25    
    CALL    CHALNM                      ;2118  cd f5 1f    
    JR  NC,SKIPDM                       ;211b  30 f8       
CHKTYP: CP  028h                        ;211d  fe 28       
    JR  NC,DFLTER                       ;211f  30 20       
    OR  A                               ;2121  b7          
    JP  Z,DFLTER                        ;2122  ca 41 21    
    CP  025h                            ;2125  fe 25       ;%
    LD  E,2                             ;2127  1e 02       
    JP  Z,BCFTCH                        ;2129  ca c4 25    
    CP  024h                            ;212c  fe 24       ;$
    LD  E,3                             ;212e  1e 03       
    JP  Z,BCFTCH                        ;2130  ca c4 25    
    CP  021h                            ;2133  fe 21       ;!
    LD  E,4                             ;2135  1e 04       
    JP  Z,BCFTCH                        ;2137  ca c4 25    
    CP  023h                            ;213a  fe 23       ;#
    LD  E,8                             ;213c  1e 08       
    JP  Z,BCFTCH                        ;213e  ca c4 25    
DFLTER: PUSH    HL                      ;2141  e5          
    LD  H,0                             ;2142  26 00       
    LD  DE,DFTABL-041H                  ;2144  11 47 30    
    ADD HL,DE                           ;2147  19          
    LD  E,(HL)                          ;2148  5e          
    POP HL                              ;2149  e1          
    RET                                 ;214a  c9          
                  ;
IMUL:   PUSH    AF                      ;214b  f5          
    PUSH    BC                          ;214c  c5          
    LD  A,L                             ;214d  7d          
    LD  C,H                             ;214e  4c          
    LD  HL,00000h                       ;214f  21 00 00    
    LD  B,008h                          ;2152  06 08       
IMADL1: RRCA                            ;2154  0f          
    JR  NC,IMNADD                       ;2155  30 03       
    ADD HL,DE                           ;2157  19          
    JR  C,SORERR                        ;2158  38 9b       
IMNADD: RL  E                           ;215a  cb 13       
    RL  D                               ;215c  cb 12       
    DJNZ    IMADL1                      ;215e  10 f4       
    LD  A,C                             ;2160  79          
    OR  A                               ;2161  b7          
    JR  Z,IMRET                         ;2162  28 0e       
    LD  B,008h                          ;2164  06 08       
IMADL2: RRCA                            ;2166  0f          
    JR  NC,IMNAD1                       ;2167  30 03       
    ADD HL,DE                           ;2169  19          
    JR  C,SORERR                        ;216a  38 89       
IMNAD1: RL  E                           ;216c  cb 13       
    RL  D                               ;216e  cb 12       
    DJNZ    IMADL2                      ;2170  10 f4       
IMRET:  POP BC                          ;2172  c1          
    POP AF                              ;2173  f1          
    RET                                 ;2174  c9          
                  ;
ERROPR: LD  A,2                         ;2175  3e 02       
    LD  (ERRORF),A                      ;2177  32 50 22    
    DEFB    021H                        ;217a  21          
CURTXT: DEFS    2                       ;217b              
    DEC HL                              ;217d  2b          
    LD  (RESTXT),HL                     ;217e  22 8a 22    
    POP AF                              ;2181  f1          
    DEFB    021H                        ;2182  21          
ERRORV: DEFS    2                       ;2183              
    JP  RUNMID                          ;2185  c3 0e 16    
                  ;
OMERRE:                                 ;                  
OMERR:  CALL    CLR                     ;2188  cd 51 19    
    EI                                  ;218b  fb          
    LD  SP,(STRTOP)                     ;218c  ed 7b 41 7a 
    LD  (SPBUF),SP                      ;2190  ed 73 25 22 
    LD  A,7                             ;2194  3e 07       
ERROR:  LD  SP,(SPBUF)                  ;2196  ed 7b 25 22 
    PUSH    AF                          ;219a  f5          
    LD  HL,(LNOBUF)                     ;219b  2a cc 16    
    LD  A,H                             ;219e  7c          
    AND L                               ;219f  a5          
    INC A                               ;21a0  3c          
    JR  Z,ERRSML                        ;21a1  28 14       
    POP AF                              ;21a3  f1          
    LD  (ERRLNO),HL                     ;21a4  22 65 22    
    LD  (ERRCOD),A                      ;21a7  32 95 22    
    LD  HL,(NXTLPT)                     ;21aa  2a 12 16    
    LD  (ERNLPT),HL                     ;21ad  22 5f 22    
    PUSH    AF                          ;21b0  f5          
    LD  A,(ERRORF)                      ;21b1  3a 50 22    
    DEC A                               ;21b4  3d          
    JR  Z,ERROPR                        ;21b5  28 be       
ERRSML: CALL    CR2                     ;21b7  cd 23 08    
    LD  A,1                             ;21ba  3e 01       
    LD  (DISFLG),A                      ;21bc  32 eb 11    
    POP AF                              ;21bf  f1          
    OR  A                               ;21c0  b7          
    JR  Z,UNPERR                        ;21c1  28 14       
    CP  32                              ;21c3  fe 20       
    JR  NC,UNPERR                       ;21c5  30 10       
    LD  DE,ERRTXT                       ;21c7  11 b2 69    
    LD  B,A                             ;21ca  47          
ERRTCO: LD  A,(DE)                      ;21cb  1a          
    INC DE                              ;21cc  13          
    OR  A                               ;21cd  b7          
    JR  NZ,ERRTCO                       ;21ce  20 fb       
    DEC B                               ;21d0  05          
    JR  NZ,ERRTCO                       ;21d1  20 f8       
    LD  A,(DE)                          ;21d3  1a          
    INC A                               ;21d4  3c          
    JR  NZ,ERRLOP                       ;21d5  20 03       
UNPERR: LD  DE,UNPMES                   ;21d7  11 e5 21    
ERRLOP: LD  A,(DE)                      ;21da  1a          
    OR  A                               ;21db  b7          
    JP  Z,LNOPRT                        ;21dc  ca cb 16    
    CALL    ACCPRT                      ;21df  cd 64 08    
    INC DE                              ;21e2  13          
    JR  ERRLOP                          ;21e3  18 f5       
                  
UNPMES: DEFM    'UNPRINTABLE ERROR'     ;21e5  55 4e 50 52 
                                        ;21e9  49 4e 54 41   5137   5151
                                        ;21ed  42 4c 45 20   5137   5152
                                        ;21f1  45 52 52 4f   5137   5153
                                        ;21f5  52            5137   5154
    DEFB    000H                        ;21f6  00          
                  ;
OKMES:  DEFM    'OK'                    ;21f7  4f 4b       
                  ;
SETSSP: LD  HL,00000h                   ;21f9  21 00 00    
    LD  (FUNCNS),HL                     ;21fc  22 2f 26    
    LD  HL,(INTFAC)                     ;21ff  2a 4b 7a    
    LD  IY,(INTSSP)                     ;2202  fd 2a 43 7a 
    RET                                 ;2206  c9          
                  ;
CONT:   DEFB    03EH                    ;2207  3e          
CONTFG: DEFS    1                       ;2208              
    OR  A                               ;2209  b7          
    JR  NZ,OKCONT                       ;220a  20 05       
    LD  A,17                            ;220c  3e 11       
    JP  ERROR                           ;220e  c3 96 21    
                  ;
OKCONT: XOR A                           ;2211  af          
    LD  (CONTFG),A                      ;2212  32 08 22    
    DEFB    021H                        ;2215  21          
BLNOBF: DEFS    2                       ;2216              
    LD  (LNOBUF),HL                     ;2218  22 cc 16    
    DEFB    021H                        ;221b  21          
BNXTLP: DEFS    2                       ;221c              
    LD  (NXTLPT),HL                     ;221e  22 12 16    
    DEFB    021H                        ;2221  21          
BTEXTP: DEFS    2                       ;2222              
    DEFB    031H                        ;2224  31          
SPBUF:  DEFS    2                       ;2225              
    JP  SPCCUT                          ;2227  c3 df 14    
                  ;
AUTOFF: LD  A,(AUTOVC)                  ;222a  3a 37 22    
    OR  A                               ;222d  b7          
    RET NZ                              ;222e  c0          
    LD  A,0C9h                          ;222f  3e c9       
    LD  (AUTOVC),A                      ;2231  32 37 22    
    JP  HOTENT                          ;2234  c3 46 14    
                  ;
AUTOVC: DEFB    0C9H                    ;2237  c9          
    DEFB    021H                        ;2238  21          
AUTOLN: DEFS    2                       ;2239              
    CALL    FIVEPR                      ;223b  cd e5 16    
    CALL    SPPRT                       ;223e  cd 62 08    
    LD  HL,(AUTOLN)                     ;2241  2a 39 22    
    DEFB    011H                        ;2244  11          ;LD DE,?
AUTOST: DEFS    2                       ;2245              
    ADD HL,DE                           ;2247  19          
    LD  (AUTOLN),HL                     ;2248  22 39 22    
    JP  C,AUTOFF                        ;224b  da 2a 22    
    RET                                 ;224e  c9          
                  ;
RESUME: DEFB    03EH                    ;224f  3e          
ERRORF: DEFS    1                       ;2250              
    CP  2                               ;2251  fe 02       
    LD  A,20                            ;2253  3e 14       
    JP  NZ,ERROR                        ;2255  c2 96 21    
    LD  A,1                             ;2258  3e 01       
    LD  (ERRORF),A                      ;225a  32 50 22    
    PUSH    HL                          ;225d  e5          
    DEFB    021H                        ;225e  21          ; LD HL,?
ERNLPT: DEFS    2                       ;225f              
    LD  (NXTLPT),HL                     ;2261  22 12 16    
    DEFB    021H                        ;2264  21          ; LD HL,?
ERRLNO: DEFS    2                       ;2265              
    LD  (LNOBUF),HL                     ;2267  22 cc 16    
    POP HL                              ;226a  e1          
    CALL    HLFTCH                      ;226b  cd 87 29    
    CP  03Ah                            ;226e  fe 3a       
    JR  Z,THISLN                        ;2270  28 17       
    OR  A                               ;2272  b7          
    JR  Z,THISLN                        ;2273  28 14       
    CP  0B5h                            ;2275  fe b5       
    JR  Z,RESERR                        ;2277  28 14       
    CP  08Bh                            ;2279  fe 8b       
    JP  NZ,GOTO                         ;227b  c2 b1 43    
    LD  HL,(RESTXT)                     ;227e  2a 8a 22    
    CALL    DATA                        ;2281  cd c8 1c    
    RET NC                              ;2284  d0          
    POP HL                              ;2285  e1          
    JP  NXLINE                          ;2286  c3 11 16    
                  ;
THISLN:                                 ;                  
    DEFB    021H                        ;2289  21          
RESTXT: DEFS    2                       ;228a              
    RET                                 ;228c  c9          
                  ;
RESERR: XOR A                           ;228d  af          
    LD  (ERRORF),A                      ;228e  32 50 22    
    CALL    THISLN                      ;2291  cd 89 22    
    DEFB    03EH                        ;2294  3e          
ERRCOD: DEFS    1                       ;2295              
    JP  ERROR                           ;2296  c3 96 21    
                  ;
                  ;	CHAIN	,EXPR
FLEXPR: CALL    SETSSP                  ;2299  cd f9 21    
FLEXP': LD  (IY+0),0                    ;229c  fd 36 00 00 
    CALL    EXPRSN                      ;22a0  cd f2 22    
    PUSH    AF                          ;22a3  f5          
    LD  A,(IY+0)                        ;22a4  fd 7e 00    
    CP  003h                            ;22a7  fe 03       
    JP  Z,TYPEMS                        ;22a9  ca 32 17    
MOTEST: OR  A                           ;22ac  b7          
    JP  Z,MOPRND                        ;22ad  ca bf 25    
    POP AF                              ;22b0  f1          
    RET                                 ;22b1  c9          
                  ;
STEXPR: CALL    SETSSP                  ;22b2  cd f9 21    
STEXP': LD  (IY+0),0                    ;22b5  fd 36 00 00 
    CALL    EXPRSN                      ;22b9  cd f2 22    
    PUSH    AF                          ;22bc  f5          
    LD  A,(IY+0)                        ;22bd  fd 7e 00    
    CP  003h                            ;22c0  fe 03       
    JP  NZ,TYPEMS                       ;22c2  c2 32 17    
    JR  MOTEST                          ;22c5  18 e5       
                  ;
HLEXP:  CALL    FLEXP'                  ;22c7  cd 9c 22    
    JR  MDLHLE                          ;22ca  18 03       
                  ;
IHLEXP: CALL    FLEXPR                  ;22cc  cd 99 22    
MDLHLE: PUSH    AF                      ;22cf  f5          
    CALL    HLFLTO                      ;22d0  cd 97 2d    
    POP AF                              ;22d3  f1          
    RET                                 ;22d4  c9          
                  ;
BYTE:   CALL    HLEXP                   ;22d5  cd c7 22    
HCHECK: LD  A,H                         ;22d8  7c          
    OR  A                               ;22d9  b7          
    LD  A,L                             ;22da  7d          
    RET Z                               ;22db  c8          
    JP  IFCALL                          ;22dc  c3 36 17    
                  ;
IBYTE:  CALL    IHLEXP                  ;22df  cd cc 22    
    JR  HCHECK                          ;22e2  18 f4       
                  ;
TYPECS: LD  A,(IY+0)                    ;22e4  fd 7e 00    
    CP  003h                            ;22e7  fe 03       
    RET NZ                              ;22e9  c0          
    JP  TYPEMS                          ;22ea  c3 32 17    
                  ;
TOOCMP: LD  A,16                        ;22ed  3e 10       
    JP  ERROR                           ;22ef  c3 96 21    
                  ;
EXPRSN: EX  DE,HL                       ;22f2  eb          
    DEFB    021H                        ;22f3  21          
MEMFAC: DEFS    2                       ;22f4              
    OR  A                               ;22f6  b7          
    SBC HL,DE                           ;22f7  ed 52       
    EX  DE,HL                           ;22f9  eb          
    JR  C,TOOCMP                        ;22fa  38 f1       
    CALL    EXPPH3                      ;22fc  cd 26 23    
XORAGN: CP  0EBh                        ;22ff  fe eb       
    RET NZ                              ;2301  c0          
    CALL    TYPECS                      ;2302  cd e4 22    
    PUSH    HL                          ;2305  e5          
    LD  (IY+0),0                        ;2306  fd 36 00 00 
    CALL    EXPPH3                      ;230a  cd 26 23    
    PUSH    AF                          ;230d  f5          
    CALL    HLFLTO                      ;230e  cd 97 2d    
    POP AF                              ;2311  f1          
    EX  DE,HL                           ;2312  eb          
    POP HL                              ;2313  e1          
    PUSH    AF                          ;2314  f5          
    PUSH    HL                          ;2315  e5          
    CALL    HLFLTO                      ;2316  cd 97 2d    
    LD  A,H                             ;2319  7c          
    XOR D                               ;231a  aa          
    LD  D,A                             ;231b  57          
    LD  A,L                             ;231c  7d          
    XOR E                               ;231d  ab          
    LD  E,A                             ;231e  5f          
    POP HL                              ;231f  e1          
    CALL    FLTHEX                      ;2320  cd 02 29    
    POP AF                              ;2323  f1          
    JR  XORAGN                          ;2324  18 d9       
                  ;
EXPPH3: CALL    EXPPH4                  ;2326  cd 50 23    
ORAGN:  CP  0ECh                        ;2329  fe ec       
    RET NZ                              ;232b  c0          
    CALL    TYPECS                      ;232c  cd e4 22    
    PUSH    HL                          ;232f  e5          
    LD  (IY+0),0                        ;2330  fd 36 00 00 
    CALL    EXPPH4                      ;2334  cd 50 23    
    PUSH    AF                          ;2337  f5          
    CALL    HLFLTO                      ;2338  cd 97 2d    
    POP AF                              ;233b  f1          
    EX  DE,HL                           ;233c  eb          
    POP HL                              ;233d  e1          
    PUSH    AF                          ;233e  f5          
    PUSH    HL                          ;233f  e5          
    CALL    HLFLTO                      ;2340  cd 97 2d    
    LD  A,H                             ;2343  7c          
    OR  D                               ;2344  b2          
    LD  D,A                             ;2345  57          
    LD  A,L                             ;2346  7d          
    OR  E                               ;2347  b3          
    LD  E,A                             ;2348  5f          
    POP HL                              ;2349  e1          
    CALL    FLTHEX                      ;234a  cd 02 29    
    POP AF                              ;234d  f1          
    JR  ORAGN                           ;234e  18 d9       
                  ;
EXPPH4: CALL    EXPPH5                  ;2350  cd 7b 23    
ANDAGN: CP  0EDh                        ;2353  fe ed       
    RET NZ                              ;2355  c0          
    CALL    TYPECS                      ;2356  cd e4 22    
    PUSH    HL                          ;2359  e5          
    LD  (IY+0),0                        ;235a  fd 36 00 00 
    CALL    EXPPH5                      ;235e  cd 7b 23    
    PUSH    AF                          ;2361  f5          
    CALL    HLFLTO                      ;2362  cd 97 2d    
    POP AF                              ;2365  f1          
    EX  DE,HL                           ;2366  eb          
    POP HL                              ;2367  e1          
    PUSH    AF                          ;2368  f5          
    PUSH    HL                          ;2369  e5          
    CALL    HLFLTO                      ;236a  cd 97 2d    
    LD  A,H                             ;236d  7c          
    AND D                               ;236e  a2          
    LD  D,A                             ;236f  57          
    LD  A,L                             ;2370  7d          
    AND E                               ;2371  a3          
    LD  E,A                             ;2372  5f          
    POP HL                              ;2373  e1          
    CALL    FLTHEX                      ;2374  cd 02 29    
    POP AF                              ;2377  f1          
    JP  ANDAGN                          ;2378  c3 53 23    
                  ;
EXPPH5: CALL    BCFTCH                  ;237b  cd c4 25    
    DEC BC                              ;237e  0b          
    CP  0EEh                            ;237f  fe ee       
    JP  NZ,EXPPH6                       ;2381  c2 9d 23    
    INC BC                              ;2384  03          
    CALL    EXPPH6                      ;2385  cd 9d 23    
    PUSH    AF                          ;2388  f5          
    CALL    TYPECS                      ;2389  cd e4 22    
    PUSH    HL                          ;238c  e5          
    CALL    HLFLTO                      ;238d  cd 97 2d    
    LD  A,L                             ;2390  7d          
    CPL                                 ;2391  2f          
    LD  L,A                             ;2392  6f          
    LD  A,H                             ;2393  7c          
    CPL                                 ;2394  2f          
    LD  H,A                             ;2395  67          
    EX  DE,HL                           ;2396  eb          
    POP HL                              ;2397  e1          
    CALL    FLTHEX                      ;2398  cd 02 29    
    POP AF                              ;239b  f1          
    RET                                 ;239c  c9          
                  ;
EXPPH6: CALL    EXPR1                   ;239d  cd 0e 24    
LOGLP:  CP  0EFh                        ;23a0  fe ef       
    RET C                               ;23a2  d8          
    PUSH    AF                          ;23a3  f5          
    PUSH    HL                          ;23a4  e5          
    CALL    EXPR1                       ;23a5  cd 0e 24    
    EX  DE,HL                           ;23a8  eb          
    POP HL                              ;23a9  e1          
    EX  AF,AF'                          ;23aa  08          
    POP AF                              ;23ab  f1          
    EX  AF,AF'                          ;23ac  08          
    PUSH    AF                          ;23ad  f5          
    EX  AF,AF'                          ;23ae  08          
    CP  0F6h                            ;23af  fe f6       
    JR  C,EQUALG                        ;23b1  38 2d       
    JR  Z,GTTHAN                        ;23b3  28 22       
    CALL    CMP                         ;23b5  cd d6 61    
LDGTCM: JR  Z,FALSE                     ;23b8  28 12       
    JR  NC,FALSE                        ;23ba  30 10       
TRUE:   PUSH    DE                      ;23bc  d5          
    PUSH    HL                          ;23bd  e5          
    PUSH    BC                          ;23be  c5          
    EX  DE,HL                           ;23bf  eb          
    CALL    LDIR1                       ;23c0  cd a3 73    
    POP BC                              ;23c3  c1          
    POP HL                              ;23c4  e1          
    CALL    TOGLE                       ;23c5  cd eb 6b    
    POP DE                              ;23c8  d1          
LGBACK: POP AF                          ;23c9  f1          
    JR  LOGLP                           ;23ca  18 d4       
                  ;
FALSE:  PUSH    BC                      ;23cc  c5          
    LD  B,8                             ;23cd  06 08       
    EX  DE,HL                           ;23cf  eb          
    CALL    ZFILL                       ;23d0  cd 10 62    
    POP BC                              ;23d3  c1          
    EX  DE,HL                           ;23d4  eb          
    JR  LGBACK                          ;23d5  18 f2       
                  ;
GTTHAN: CALL    CMP                     ;23d7  cd d6 61    
    CCF                                 ;23da  3f          
    JR  LDGTCM                          ;23db  18 db       
                  ;
PORTRU: POP AF                          ;23dd  f1          
    JR  TRUE                            ;23de  18 dc       
                  ;
EQUALG: CP  0F5h                        ;23e0  fe f5       
    JR  C,ALGLOG                        ;23e2  38 07       
    CALL    CMP                         ;23e4  cd d6 61    
    JR  Z,TRUE                          ;23e7  28 d3       
    JR  FALSE                           ;23e9  18 e1       
                  ;
ALGLOG: CP  0F1h                        ;23eb  fe f1       
    JP  C,NOTEQU                        ;23ed  da 07 24    
    PUSH    AF                          ;23f0  f5          
    CALL    CMP                         ;23f1  cd d6 61    
    JR  Z,PORTRU                        ;23f4  28 e7       
    EX  AF,AF'                          ;23f6  08          
    POP AF                              ;23f7  f1          
    CP  0F2h                            ;23f8  fe f2       
    JR  Z,GTEQLG                        ;23fa  28 07       
    CP  0F4h                            ;23fc  fe f4       
    JR  Z,GTEQLG                        ;23fe  28 03       
    EX  AF,AF'                          ;2400  08          
    JR  LDGTCM                          ;2401  18 b5       
GTEQLG: EX  AF,AF'                      ;2403  08          
    CCF                                 ;2404  3f          
    JR  LDGTCM                          ;2405  18 b1       
                  ;
NOTEQU: CALL    CMP                     ;2407  cd d6 61    
    JR  Z,FALSE                         ;240a  28 c0       
    JR  TRUE                            ;240c  18 ae       
                  ;
EXPR1:  CALL    TERM                    ;240e  cd 33 24    
EXPR':  CP  0F8h                        ;2411  fe f8       
    RET C                               ;2413  d8          
    PUSH    HL                          ;2414  e5          
    JR  Z,EXADD                         ;2415  28 0f       
    CALL    TERM                        ;2417  cd 33 24    
    EX  DE,HL                           ;241a  eb          
    POP HL                              ;241b  e1          
    PUSH    BC                          ;241c  c5          
EXPRBK: PUSH    AF                      ;241d  f5          
    CALL    SUB                         ;241e  cd d1 6b    
EXPRBK1:                                ;                  
    POP AF                              ;2421  f1          
    POP BC                              ;2422  c1          
    JP  EXPR'                           ;2423  c3 11 24    
                  ;
EXADD:  CALL    TERM                    ;2426  cd 33 24    
    EX  DE,HL                           ;2429  eb          
    POP HL                              ;242a  e1          
    PUSH    BC                          ;242b  c5          
    PUSH    AF                          ;242c  f5          
    CALL    ADD                         ;242d  cd a6 6c    
    JP  EXPRBK1                         ;2430  c3 21 24    
                  ;
TERM:   CALL    MFACT                   ;2433  cd 5b 24    
TERM':  CP  0FAh                        ;2436  fe fa       ; /
    RET C                               ;2438  d8          
    PUSH    HL                          ;2439  e5          
    JR  NZ,TMDIV                        ;243a  20 0f       
    CALL    MFACT                       ;243c  cd 5b 24    
    EX  DE,HL                           ;243f  eb          
    POP HL                              ;2440  e1          
    PUSH    BC                          ;2441  c5          
    PUSH    AF                          ;2442  f5          
    CALL    MOD                         ;2443  cd 4f 61    
TERMBK: POP AF                          ;2446  f1          
    POP BC                              ;2447  c1          
    JP  TERM'                           ;2448  c3 36 24    
                  ;
TMDIV:  CALL    MFACT                   ;244b  cd 5b 24    
    EX  DE,HL                           ;244e  eb          
    POP HL                              ;244f  e1          
    PUSH    BC                          ;2450  c5          
    PUSH    AF                          ;2451  f5          
    CALL    DIV                         ;2452  cd bd 70    
    CALL    INT                         ;2455  cd 10 60    
    JP  TERMBK                          ;2458  c3 46 24    
                  ;
MFACT:  CALL    FACT                    ;245b  cd 8f 24    
MFACT': CP  0FCh                        ;245e  fe fc       ; MOD
    RET C                               ;2460  d8          
    PUSH    HL                          ;2461  e5          
    JR  Z,TMMOD                         ;2462  28 0f       
    CALL    FACT                        ;2464  cd 8f 24    
    EX  DE,HL                           ;2467  eb          
    POP HL                              ;2468  e1          
    PUSH    BC                          ;2469  c5          
    PUSH    AF                          ;246a  f5          
    CALL    MUL                         ;246b  cd e0 6f    
MFACBK: POP AF                          ;246e  f1          
    POP BC                              ;246f  c1          
    JP  MFACT'                          ;2470  c3 5e 24    
                  ;
TMMOD:  CALL    FACT                    ;2473  cd 8f 24    
    EX  DE,HL                           ;2476  eb          
    POP HL                              ;2477  e1          
    PUSH    BC                          ;2478  c5          
    PUSH    AF                          ;2479  f5          
    CALL    DIV                         ;247a  cd bd 70    
    JP  MFACBK                          ;247d  c3 6e 24    
                  ;
POWZRR: POP HL                          ;2480  e1          
    PUSH    HL                          ;2481  e5          
    EX  DE,HL                           ;2482  eb          
    PUSH    BC                          ;2483  c5          
    CALL    LDIR1                       ;2484  cd a3 73    
    POP BC                              ;2487  c1          
    POP HL                              ;2488  e1          
POWAGN: DEC BC                          ;2489  0b          
    CALL    BCFTCH                      ;248a  cd c4 25    
    JR  MIDFAP                          ;248d  18 03       
                  ;
FACT:   CALL    FACT''                  ;248f  cd 5f 25    
MIDFAP: CP  0FEh                        ;2492  fe fe       
    RET NZ                              ;2494  c0          
    PUSH    HL                          ;2495  e5          
    CALL    FACT''                      ;2496  cd 5f 25    
    LD  A,(HL)                          ;2499  7e          
    OR  A                               ;249a  b7          
    JR  Z,POWZRR                        ;249b  28 e3       
    INC HL                              ;249d  23          
    BIT 7,(HL)                          ;249e  cb 7e       
    RES 7,(HL)                          ;24a0  cb be       
    DEC HL                              ;24a2  2b          
    JR  NZ,MPOWER                       ;24a3  20 07       
    EX  DE,HL                           ;24a5  eb          
    POP HL                              ;24a6  e1          
    CALL    POWER                       ;24a7  cd c6 24    
    JR  POWAGN                          ;24aa  18 dd       
                  ;
MPOWER: EX  DE,HL                       ;24ac  eb          
    POP HL                              ;24ad  e1          
    PUSH    HL                          ;24ae  e5          
    PUSH    DE                          ;24af  d5          
    CALL    POWER                       ;24b0  cd c6 24    
    POP DE                              ;24b3  d1          
    PUSH    DE                          ;24b4  d5          
    PUSH    BC                          ;24b5  c5          
    CALL    LDIR1                       ;24b6  cd a3 73    
    POP BC                              ;24b9  c1          
    POP DE                              ;24ba  d1          
    POP HL                              ;24bb  e1          
    CALL    PSWAP                       ;24bc  cd 42 25    
    PUSH    BC                          ;24bf  c5          
    CALL    DIV                         ;24c0  cd bd 70    
    POP BC                              ;24c3  c1          
    JR  POWAGN                          ;24c4  18 c3       
                  ;
POWER:  PUSH    BC                      ;24c6  c5          
    PUSH    HL                          ;24c7  e5          
    PUSH    DE                          ;24c8  d5          
    LD  HL,8                            ;24c9  21 08 00    
    ADD HL,DE                           ;24cc  19          
    EX  DE,HL                           ;24cd  eb          
    PUSH    DE                          ;24ce  d5          
    CALL    LDIR8                       ;24cf  cd a6 73    
    POP HL                              ;24d2  e1          
    CALL    INT                         ;24d3  cd 10 60    
    EX  DE,HL                           ;24d6  eb          
    POP HL                              ;24d7  e1          
    CALL    CMP                         ;24d8  cd d6 61    
    JR  Z,IPOWER                        ;24db  28 12       
RPOWER: POP DE                          ;24dd  d1          
    PUSH    DE                          ;24de  d5          
    CALL    PSWAP                       ;24df  cd 42 25    
    CALL    B_LOG                       ;24e2  cd bd 78    
    EX  DE,HL                           ;24e5  eb          
    POP HL                              ;24e6  e1          
    CALL    MUL                         ;24e7  cd e0 6f    
    CALL    B_EXP                       ;24ea  cd ca 77    
    POP BC                              ;24ed  c1          
    RET                                 ;24ee  c9          
                  
IPOWER: LD  A,(HL)                      ;24ef  7e          
    CP  086h                            ;24f0  fe 86       
    JR  NC,RPOWER                       ;24f2  30 e9       
    EX  (SP),HL                         ;24f4  e3          
    LD  A,(HL)                          ;24f5  7e          
    EX  (SP),HL                         ;24f6  e3          
    CP  088h                            ;24f7  fe 88       
    JR  NC,RPOWER                       ;24f9  30 e2       
    CALL    HLFLTO                      ;24fb  cd 97 2d    ; 0 END
    LD  A,L                             ;24fe  7d          
    POP HL                              ;24ff  e1          
    PUSH    AF                          ;2500  f5          ; BIT-P
    PUSH    HL                          ;2501  e5          ; FAC
    LD  DE,KEYBUF                       ;2502  11 4f 7a    
    PUSH    DE                          ;2505  d5          
    CALL    LDIR8                       ;2506  cd a6 73    
    POP HL                              ;2509  e1          ;ZFAC
    LD  B,4                             ;250a  06 04       ;RCOUNT
PWCLLP: PUSH    BC                      ;250c  c5          
    EX  DE,HL                           ;250d  eb          
    LD  HL,00008h                       ;250e  21 08 00    
    ADD HL,DE                           ;2511  19          
    EX  DE,HL                           ;2512  eb          
    CALL    LDIR8                       ;2513  cd a6 73    
    LD  E,L                             ;2516  5d          
    LD  D,H                             ;2517  54          
    CALL    MUL                         ;2518  cd e0 6f    
    POP BC                              ;251b  c1          
    DJNZ    PWCLLP                      ;251c  10 ee       
    POP HL                              ;251e  e1          
    PUSH    HL                          ;251f  e5          
    EX  DE,HL                           ;2520  eb          
    CALL    LDIR1                       ;2521  cd a3 73    
    POP HL                              ;2524  e1          
    POP AF                              ;2525  f1          
    LD  DE,KEYBUF                       ;2526  11 4f 7a    
    LD  B,5                             ;2529  06 05       
PWCLL1: RRCA                            ;252b  0f          
    JR  NC,NEXTPL                       ;252c  30 09       
    PUSH    AF                          ;252e  f5          
    PUSH    BC                          ;252f  c5          
    PUSH    DE                          ;2530  d5          
    CALL    MUL                         ;2531  cd e0 6f    
    POP DE                              ;2534  d1          
    POP BC                              ;2535  c1          
    POP AF                              ;2536  f1          
NEXTPL: PUSH    HL                      ;2537  e5          
    LD  HL,8                            ;2538  21 08 00    
    ADD HL,DE                           ;253b  19          
    EX  DE,HL                           ;253c  eb          
    POP HL                              ;253d  e1          
    DJNZ    PWCLL1                      ;253e  10 eb       
    POP BC                              ;2540  c1          
    RET                                 ;2541  c9          
                  ;
PSWAP:  PUSH    BC                      ;2542  c5          
    PUSH    HL                          ;2543  e5          
    PUSH    DE                          ;2544  d5          
    EX  DE,HL                           ;2545  eb          
    LD  DE,ZFAC                         ;2546  11 f2 62    
    CALL    LDIR8                       ;2549  cd a6 73    
    POP DE                              ;254c  d1          
    POP HL                              ;254d  e1          
    PUSH    DE                          ;254e  d5          
    PUSH    HL                          ;254f  e5          
    CALL    LDIR8                       ;2550  cd a6 73    
    POP DE                              ;2553  d1          
    PUSH    DE                          ;2554  d5          
    LD  HL,ZFAC                         ;2555  21 f2 62    
    CALL    LDIR8                       ;2558  cd a6 73    
    POP HL                              ;255b  e1          
    POP DE                              ;255c  d1          
    POP BC                              ;255d  c1          
    RET                                 ;255e  c9          
:                                       ;                  
FACT'': CALL    BCFTCH                  ;255f  cd c4 25    
    CP  020h                            ;2562  fe 20       
    JP  C,CONST                         ;2564  da cc 25    
    CP  0F8h                            ;2567  fe f8       
    JR  Z,FACT''                        ;2569  28 f4       
    CP  0F9h                            ;256b  fe f9       
    JP  Z,INUSE                         ;256d  ca 85 25    
    CP  041h                            ;2570  fe 41       
    JP  NC,VARFUN                       ;2572  d2 24 26    
    CP  028h                            ;2575  fe 28       
    JR  Z,KAKKO                         ;2577  28 1d       
    CP  029h                            ;2579  fe 29       
    JP  Z,SERROR                        ;257b  ca 3a 17    
    CP  022h                            ;257e  fe 22       
    JP  Z,STRFAC                        ;2580  ca b5 28    
    JR  MOCHCK                          ;2583  18 32       
                  ;
INUSE:  CALL    FACT''                  ;2585  cd 5f 25    
    PUSH    AF                          ;2588  f5          
    LD  A,(IY+0)                        ;2589  fd 7e 00    
    CP  003h                            ;258c  fe 03       
    JP  Z,TYPEMS                        ;258e  ca 32 17    
    CALL    TOGLE                       ;2591  cd eb 6b    
    POP AF                              ;2594  f1          
    RET                                 ;2595  c9          
                  ;
KAKKO:  DEC IY                          ;2596  fd 2b       
    LD  (IY+0),0                        ;2598  fd 36 00 00 
    CALL    EXPRSN                      ;259c  cd f2 22    
    CALL    CH29H                       ;259f  cd 66 2d    
    LD  A,(IY+0)                        ;25a2  fd 7e 00    
    INC IY                              ;25a5  fd 23       
    CP  003h                            ;25a7  fe 03       
    JR  Z,CONDSB                        ;25a9  28 06       
    CALL    CONDFL                      ;25ab  cd eb 28    
    JP  BCFTCH                          ;25ae  c3 c4 25    
                  ;
CONDSB: CALL    CONDSR                  ;25b1  cd d9 28    
    JP  BCFTCH                          ;25b4  c3 c4 25    
                  ;
MOCHCK: LD  D,A                         ;25b7  57          
    XOR A                               ;25b8  af          
    CP  (IY+0)                          ;25b9  fd be 00    
    LD  A,D                             ;25bc  7a          
    DEC BC                              ;25bd  0b          
    RET Z                               ;25be  c8          
MOPRND: LD  A,22                        ;25bf  3e 16       
    JP  ERROR                           ;25c1  c3 96 21    
                  ;
BCFTCH: LD  A,(BC)                      ;25c4  0a          
    INC BC                              ;25c5  03          
    CP  020h                            ;25c6  fe 20       
    RET NZ                              ;25c8  c0          
    JP  BCFTCH                          ;25c9  c3 c4 25    
                  ;
CONST:  CP  00Bh                        ;25cc  fe 0b       
    JR  NC,HXORFL                       ;25ce  30 16       
    OR  A                               ;25d0  b7          
    JR  Z,MOPRND                        ;25d1  28 ec       
    DEC A                               ;25d3  3d          
    LD  DE,00008h                       ;25d4  11 08 00    
    ADD HL,DE                           ;25d7  19          
    LD  E,A                             ;25d8  5f          
    LD  D,0                             ;25d9  16 00       
FLTHXB: LD  A,004h                      ;25db  3e 04       
    CALL    CONDFL                      ;25dd  cd eb 28    
    CALL    FLTHEX                      ;25e0  cd 02 29    
BCKFTR: JP  BCFTCH                      ;25e3  c3 c4 25    
                  ;
HXORFL: CP  014h                        ;25e6  fe 14       
    JR  NC,FLTPNT                       ;25e8  30 19       
    CP  00Bh                            ;25ea  fe 0b       
    LD  DE,00008h                       ;25ec  11 08 00    
    ADD HL,DE                           ;25ef  19          
    JR  Z,LNOCON                        ;25f0  28 08       
LDELNO: LD  A,(BC)                      ;25f2  0a          
    LD  E,A                             ;25f3  5f          
    INC BC                              ;25f4  03          
    LD  A,(BC)                          ;25f5  0a          
    LD  D,A                             ;25f6  57          
    INC BC                              ;25f7  03          
    JR  FLTHXB                          ;25f8  18 e1       
                  ;
LNOCON: CALL    LDELNO                  ;25fa  cd f2 25    
    PUSH    AF                          ;25fd  f5          
    CALL    ADJERL                      ;25fe  cd 78 37    
    POP AF                              ;2601  f1          
    RET                                 ;2602  c9          
                  ;
FLTPNT: CP  019h                        ;2603  fe 19       
    JP  NC,SERROR                       ;2605  d2 3a 17    
    LD  DE,00008h                       ;2608  11 08 00    
    ADD HL,DE                           ;260b  19          
    AND 00Fh                            ;260c  e6 0f       
    CALL    CONDFL                      ;260e  cd eb 28    
    CP  004h                            ;2611  fe 04       
    CALL    Z,CLRFAC                    ;2613  cc a9 28    
    PUSH    HL                          ;2616  e5          
    EX  DE,HL                           ;2617  eb          
    LD  L,C                             ;2618  69          
    LD  H,B                             ;2619  60          
    LD  B,000h                          ;261a  06 00       
    LD  C,A                             ;261c  4f          
    LDIR                                ;261d  ed b0       
    LD  C,L                             ;261f  4d          
    LD  B,H                             ;2620  44          
    POP HL                              ;2621  e1          
    JR  BCKFTR                          ;2622  18 bf       
                  ;
VARFUN: CP  0FFh                        ;2624  fe ff       
    JP  Z,FCTION                        ;2626  ca 61 27    
    CP  05Ch                            ;2629  fe 5c       
    JP  NC,SERROR                       ;262b  d2 3a 17    
    DEFB    011H                        ;262e  11          ;LD DE,
FUNCNS: DEFS    2                       ;262f              
    EX  AF,AF'                          ;2631  08          
    LD  A,E                             ;2632  7b          
    OR  D                               ;2633  b2          
    JR  NZ,FUNGVR                       ;2634  20 3d       
    EX  AF,AF'                          ;2636  08          
VARFNE: LD  DE,00008h                   ;2637  11 08 00    
    ADD HL,DE                           ;263a  19          
    EX  DE,HL                           ;263b  eb          
    CALL    GETVAR                      ;263c  cd da 1e    
    EX  DE,HL                           ;263f  eb          
    CALL    CLRFAC                      ;2640  cd a9 28    
    PUSH    HL                          ;2643  e5          
    PUSH    BC                          ;2644  c5          
    CP  003h                            ;2645  fe 03       
    JR  Z,STRVAR                        ;2647  28 13       
    CP  002h                            ;2649  fe 02       
    JR  Z,INTVAR                        ;264b  28 17       
    CALL    CONDFL                      ;264d  cd eb 28    
    LD  B,A                             ;2650  47          
VARTR#: LD  A,(DE)                      ;2651  1a          
    LD  (HL),A                          ;2652  77          
    INC HL                              ;2653  23          
    INC DE                              ;2654  13          
    DJNZ    VARTR#                      ;2655  10 fa       
RTVARI: POP BC                          ;2657  c1          
    POP HL                              ;2658  e1          
    JP  BCFTCH                          ;2659  c3 c4 25    
                  ;
STRVAR: CALL    CONDSR                  ;265c  cd d9 28    
    LD  (HL),E                          ;265f  73          
    INC HL                              ;2660  23          
    LD  (HL),D                          ;2661  72          
    JR  RTVARI                          ;2662  18 f3       
                  ;
INTVAR: LD  A,004h                      ;2664  3e 04       
    CALL    CONDFL                      ;2666  cd eb 28    
    EX  DE,HL                           ;2669  eb          
    CALL    INDRCT                      ;266a  cd a3 2a    
    EX  DE,HL                           ;266d  eb          
    CALL    FLTHEX                      ;266e  cd 02 29    
    JR  RTVARI                          ;2671  18 e4       
                  ;
FUNGVR: EX  AF,AF'                      ;2673  08          
    PUSH    HL                          ;2674  e5          
    PUSH    AF                          ;2675  f5          
    PUSH    BC                          ;2676  c5          
    CALL    VSRTST                      ;2677  cd fe 20    
    LD  (FNBCPT),BC                     ;267a  ed 43 c3 26 
    CP  028h                            ;267e  fe 28       
    JR  NZ,EFCT1                        ;2680  20 05       
NFCVAR: POP BC                          ;2682  c1          
    POP AF                              ;2683  f1          
    POP HL                              ;2684  e1          
    JR  VARFNE                          ;2685  18 b0       
                  ;
EFCT1:  LD  A,E                         ;2687  7b          
    LD  (CPIMDP),A                      ;2688  32 ad 26    
    LD  (CPIMDQ),A                      ;268b  32 ba 26    
    XOR A                               ;268e  af          
    EX  AF,AF'                          ;268f  08          
    EX  DE,HL                           ;2690  eb          
    LD  HL,(FUNCNS)                     ;2691  2a 2f 26    
    LD  C,(HL)                          ;2694  4e          
    INC HL                              ;2695  23          
    LD  B,(HL)                          ;2696  46          
VRFLOP: PUSH    DE                      ;2697  d5          
    EX  AF,AF'                          ;2698  08          
    INC A                               ;2699  3c          
    EX  AF,AF'                          ;269a  08          
    CALL    BCFTCH                      ;269b  cd c4 25    
    CALL    VSRTST                      ;269e  cd fe 20    
    CP  029h                            ;26a1  fe 29       
    JR  Z,LSTCMP                        ;26a3  28 12       
    CP  02Ch                            ;26a5  fe 2c       
    JP  NZ,SERROR                       ;26a7  c2 3a 17    
    LD  A,E                             ;26aa  7b          
    POP DE                              ;26ab  d1          
    DEFB    0FEH                        ;26ac  fe          ;CP
CPIMDP: DEFS    1                       ;26ad              
    JR  NZ,VRFLOP                       ;26ae  20 e7       
    OR  A                               ;26b0  b7          
    SBC HL,DE                           ;26b1  ed 52       
    JR  NZ,VRFLOP                       ;26b3  20 e2       
    JR  FVRFND                          ;26b5  18 0b       
                  ;
LSTCMP: LD  A,E                         ;26b7  7b          
    POP DE                              ;26b8  d1          
    DEFB    0FEH                        ;26b9  fe          ;CP
CPIMDQ: DEFS    1                       ;26ba              
    JR  NZ,NFCVAR                       ;26bb  20 c5       
    OR  A                               ;26bd  b7          
    SBC HL,DE                           ;26be  ed 52       
    JR  NZ,NFCVAR                       ;26c0  20 c0       
                  ;
FVRFND: DEFB    001H                    ;26c2  01          ;LD BC,?
FNBCPT: DEFS    2                       ;26c3              
    EX  AF,AF'                          ;26c5  08          
    LD  E,A                             ;26c6  5f          
    LD  A,(CPIMDQ)                      ;26c7  3a ba 26    
    CP  003h                            ;26ca  fe 03       
    JR  Z,FNLVRS                        ;26cc  28 05       
    CALL    CONDFL                      ;26ce  cd eb 28    
    JR  FVRFDD                          ;26d1  18 03       
FNLVRS: CALL    CONDSR                  ;26d3  cd d9 28    
FVRFDD: POP HL                          ;26d6  e1          
    POP HL                              ;26d7  e1          
    POP HL                              ;26d8  e1          
    DEC BC                              ;26d9  0b          
    PUSH    BC                          ;26da  c5          
    PUSH    HL                          ;26db  e5          
    LD  HL,(FUNCNS)                     ;26dc  2a 2f 26    
    INC HL                              ;26df  23          
    INC HL                              ;26e0  23          
    LD  C,(HL)                          ;26e1  4e          
    INC HL                              ;26e2  23          
    LD  B,(HL)                          ;26e3  46          
TSTARG: DEC E                           ;26e4  1d          
    JR  Z,FNCGS                         ;26e5  28 05       
    CALL    SNXT2C                      ;26e7  cd 08 27    
    JR  TSTARG                          ;26ea  18 f8       
                  ;
FNCGS:  LD  HL,(FUNCNS)                 ;26ec  2a 2f 26    
    POP DE                              ;26ef  d1          
    PUSH    HL                          ;26f0  e5          
    INC HL                              ;26f1  23          
    INC HL                              ;26f2  23          
    INC HL                              ;26f3  23          
    INC HL                              ;26f4  23          
    CALL    INDRCT                      ;26f5  cd a3 2a    
    LD  (FUNCNS),HL                     ;26f8  22 2f 26    
    EX  DE,HL                           ;26fb  eb          
    CALL    EXPRSN                      ;26fc  cd f2 22    
    POP DE                              ;26ff  d1          
    LD  (FUNCNS),DE                     ;2700  ed 53 2f 26 
    POP BC                              ;2704  c1          
    JP  BCFTCH                          ;2705  c3 c4 25    
                  ;
SNXT2C: CALL    SK2C2C                  ;2708  cd 10 27    
    CP  02Ch                            ;270b  fe 2c       
    JR  NZ,SNXT2C                       ;270d  20 f9       
    RET                                 ;270f  c9          
                  ;
SK2C2C: CALL    SKPSBL                  ;2710  cd 2d 27    
    CP  028h                            ;2713  fe 28       
    RET NZ                              ;2715  c0          
S2C2CL: CALL    SK2C2C                  ;2716  cd 10 27    
    CP  029h                            ;2719  fe 29       
    RET Z                               ;271b  c8          
    JR  S2C2CL                          ;271c  18 f8       
                  ;
SK2829: CALL    SKPSBL                  ;271e  cd 2d 27    
    CP  029h                            ;2721  fe 29       
    RET Z                               ;2723  c8          
    CP  028h                            ;2724  fe 28       
    JR  NZ,SK2829                       ;2726  20 f6       
SK2BLO: CALL    SK2829                  ;2728  cd 1e 27    
    JR  SK2829                          ;272b  18 f1       
                  ;
SKPSBL: CALL    BCFTCH                  ;272d  cd c4 25    
    OR  A                               ;2730  b7          
SKSBER: JP  Z,SERROR                    ;2731  ca 3a 17    
    CP  03Ah                            ;2734  fe 3a       
    JR  Z,SKSBER                        ;2736  28 f9       
    CP  022h                            ;2738  fe 22       
    JR  Z,DQSKCM                        ;273a  28 19       
    CP  020h                            ;273c  fe 20       
    RET NC                              ;273e  d0          
    CP  012h                            ;273f  fe 12       
    JR  C,DWNERG                        ;2741  38 0a       
    AND 00Fh                            ;2743  e6 0f       
HEXSKS: ADD A,C                         ;2745  81          
    LD  C,A                             ;2746  4f          
    LD  A,0                             ;2747  3e 00       
    ADC A,B                             ;2749  88          
    LD  B,A                             ;274a  47          
    JR  SKPSBL                          ;274b  18 e0       
                  ;
DWNERG: CP  00Bh                        ;274d  fe 0b       
    JR  C,SKPSBL                        ;274f  38 dc       
    LD  A,002h                          ;2751  3e 02       
    JR  HEXSKS                          ;2753  18 f0       
                  ;
DQSKCM: CALL    BCFTCH                  ;2755  cd c4 25    
    CP  022h                            ;2758  fe 22       
    JR  Z,SKPSBL                        ;275a  28 d1       
    OR  A                               ;275c  b7          
    JR  Z,SKSBER                        ;275d  28 d2       
    JR  DQSKCM                          ;275f  18 f4       
                  ;
FCTION: LD  A,(BC)                      ;2761  0a          
    INC BC                              ;2762  03          
    CP  0A0h                            ;2763  fe a0       
    JP  NC,FUNCT1                       ;2765  d2 8c 27    
    PUSH    HL                          ;2768  e5          
    LD  HL,FLFNRT                       ;2769  21 81 27    
FTRMER: EX  (SP),HL                     ;276c  e3          
    PUSH    HL                          ;276d  e5          
    CALL    GETFJP                      ;276e  cd 9c 28    
    EX  (SP),HL                         ;2771  e3          
    CALL    CH28H                       ;2772  cd 58 2d    
    DEC IY                              ;2775  fd 2b       
    LD  (IY+0),0                        ;2777  fd 36 00 00 
    CALL    FLEXP'                      ;277b  cd 9c 22    
    JP  CH29H                           ;277e  c3 66 2d    
                  ;
FLFNRT: LD  A,(IY+0)                    ;2781  fd 7e 00    
    INC IY                              ;2784  fd 23       
    CALL    CONDFL                      ;2786  cd eb 28    
FNCCON: JP  BCFTCH                      ;2789  c3 c4 25    
                  ;
FUNCT1: CP  0A9h                        ;278c  fe a9       
    JP  NC,FUNCT2                       ;278e  d2 9c 27    
    PUSH    HL                          ;2791  e5          
    LD  HL,SRFNRT                       ;2792  21 97 27    
    JR  FTRMER                          ;2795  18 d5       
                  ;
SRFNRT: INC IY                          ;2797  fd 23       
    JP  CONDSB                          ;2799  c3 b1 25    
                  ;
                  ;
FUNCT2: CP  0B2h                        ;279c  fe b2       
    JP  NC,OTHERF                       ;279e  d2 c5 27    
    PUSH    HL                          ;27a1  e5          
    LD  HL,SRSRRT                       ;27a2  21 ba 27    
    EX  (SP),HL                         ;27a5  e3          
    PUSH    HL                          ;27a6  e5          
    CALL    GETFJP                      ;27a7  cd 9c 28    
    EX  (SP),HL                         ;27aa  e3          
    CALL    CH28H                       ;27ab  cd 58 2d    
    DEC IY                              ;27ae  fd 2b       
    LD  (IY+0),0                        ;27b0  fd 36 00 00 
    CALL    STEXP'                      ;27b4  cd b5 22    
    JP  CH29H                           ;27b7  c3 66 2d    
                  ;
SRSRRT: LD  A,(IY+0)                    ;27ba  fd 7e 00    
    INC IY                              ;27bd  fd 23       
    CALL    CONDFL                      ;27bf  cd eb 28    
    JP  BCFTCH                          ;27c2  c3 c4 25    
                  ;
OTHERF: PUSH    HL                      ;27c5  e5          
    CALL    GETFJP                      ;27c6  cd 9c 28    
    EX  (SP),HL                         ;27c9  e3          
    RET                                 ;27ca  c9          
                  ;
LENSUB: PUSH    BC                      ;27cb  c5          
    PUSH    DE                          ;27cc  d5          
    PUSH    HL                          ;27cd  e5          
    CALL    CONDMZ                      ;27ce  cd f6 6b    
    CALL    INDRCT                      ;27d1  cd a3 2a    
    JR  MIDERL                          ;27d4  18 12       
                  ;
ASCSUB: PUSH    BC                      ;27d6  c5          
    PUSH    DE                          ;27d7  d5          
    PUSH    HL                          ;27d8  e5          
    CALL    CONDMZ                      ;27d9  cd f6 6b    
    CALL    INDRCT                      ;27dc  cd a3 2a    
    LD  A,(HL)                          ;27df  7e          
    OR  A                               ;27e0  b7          
    JP  Z,IFCALL                        ;27e1  ca 36 17    
    INC HL                              ;27e4  23          
    CALL    INDRCT                      ;27e5  cd a3 2a    
MIDERL: LD  E,(HL)                      ;27e8  5e          
    LD  D,0                             ;27e9  16 00       
    POP HL                              ;27eb  e1          
    LD  (IY+0),4                        ;27ec  fd 36 00 04 
    CALL    CLRFAC                      ;27f0  cd a9 28    
    CALL    FLTHEX                      ;27f3  cd 02 29    
    POP DE                              ;27f6  d1          
    POP BC                              ;27f7  c1          
    RET                                 ;27f8  c9          
                  ;
VALSUB: PUSH    BC                      ;27f9  c5          
    PUSH    DE                          ;27fa  d5          
    PUSH    HL                          ;27fb  e5          
    CALL    CONDMZ                      ;27fc  cd f6 6b    
    CALL    INDRCT                      ;27ff  cd a3 2a    
    LD  A,(HL)                          ;2802  7e          
    OR  A                               ;2803  b7          
    JR  Z,ZRVALR                        ;2804  28 1a       
    INC HL                              ;2806  23          
    CALL    INDRCT                      ;2807  cd a3 2a    
    LD  B,A                             ;280a  47          
    LD  DE,KEYBUF                       ;280b  11 4f 7a    
VALTRL: LD  A,(HL)                      ;280e  7e          
    LD  (DE),A                          ;280f  12          
    INC HL                              ;2810  23          
    INC DE                              ;2811  13          
    DJNZ    VALTRL                      ;2812  10 fa       
MIDVAL: XOR A                           ;2814  af          
    LD  (DE),A                          ;2815  12          
    LD  DE,KEYBUF                       ;2816  11 4f 7a    
    POP HL                              ;2819  e1          
    CALL    OVFLAG                      ;281a  cd b8 5b    
    POP DE                              ;281d  d1          
    POP BC                              ;281e  c1          
    RET                                 ;281f  c9          
                  ;
ZRVALR: LD  DE,KEYBUF                   ;2820  11 4f 7a    
    JR  MIDVAL                          ;2823  18 ef       
                  ;
NULSDC: DEFB    000H                    ;2825  00          
    DEFW    0                           ;2826  00 00       
                  ;
INKEY:  LD  DE,00008h                   ;2828  11 08 00    
    ADD HL,DE                           ;282b  19          
    CALL    BCFTCH                      ;282c  cd c4 25    
    CP  028h                            ;282f  fe 28       
    DEC BC                              ;2831  0b          
    JR  NZ,NORGET                       ;2832  20 20       
    INC BC                              ;2834  03          
    PUSH    HL                          ;2835  e5          
    DEC IY                              ;2836  fd 2b       
    LD  (IY+0),0                        ;2838  fd 36 00 00 
    CALL    FLEXP'                      ;283c  cd 9c 22    
    CALL    CH29H                       ;283f  cd 66 2d    
    INC IY                              ;2842  fd 23       
    CALL    HLFLTO                      ;2844  cd 97 2d    
    CALL    HCHECK                      ;2847  cd d8 22    
    POP HL                              ;284a  e1          
    LD  (FLASHF),A                      ;284b  32 7f 0c    
    CALL    ASCGET                      ;284e  cd 62 0c    
    JP  INKMID                          ;2851  c3 62 28    
                  ;
NORGET: XOR A                           ;2854  af          
    LD  (FLASHF),A                      ;2855  32 7f 0c    
    CALL    ASCGET                      ;2858  cd 62 0c    
    DEFB    0FEH                        ;285b  fe          ;CP
LSTGET: DEFB    000H                    ;285c  00          
    JR  Z,NLINKY                        ;285d  28 06       
    LD  (LSTGET),A                      ;285f  32 5c 28    
INKMID: OR  A                           ;2862  b7          
    JR  NZ,CHRMIS                       ;2863  20 0a       
NLINKY: LD  DE,NULSDC                   ;2865  11 25 28    
    LD  (HL),E                          ;2868  73          
    INC HL                              ;2869  23          
    LD  (HL),D                          ;286a  72          
    DEC HL                              ;286b  2b          
INKBCK: JP  CONDSB                      ;286c  c3 b1 25    
                  ;
                  ;
CHRMIS: CALL    CHRMID                  ;286f  cd 7c 28    
    JR  INKBCK                          ;2872  18 f8       
                  ;
CHRSUB: PUSH    HL                      ;2874  e5          
    CALL    HLFLTO                      ;2875  cd 97 2d    
    CALL    HCHECK                      ;2878  cd d8 22    
    POP HL                              ;287b  e1          
CHRMID: PUSH    HL                      ;287c  e5          
    PUSH    DE                          ;287d  d5          
    LD  E,L                             ;287e  5d          
    LD  D,H                             ;287f  54          
    INC DE                              ;2880  13          
    INC DE                              ;2881  13          
    LD  (HL),E                          ;2882  73          
    INC HL                              ;2883  23          
    LD  (HL),D                          ;2884  72          
    INC HL                              ;2885  23          
    PUSH    HL                          ;2886  e5          
    LD  (HL),1                          ;2887  36 01       
    INC HL                              ;2889  23          
    INC DE                              ;288a  13          
    INC DE                              ;288b  13          
    INC DE                              ;288c  13          
    INC DE                              ;288d  13          
    INC DE                              ;288e  13          
    LD  (HL),E                          ;288f  73          
    INC HL                              ;2890  23          
    LD  (HL),D                          ;2891  72          
    LD  (DE),A                          ;2892  12          
    POP HL                              ;2893  e1          
    LD  E,L                             ;2894  5d          
    LD  D,H                             ;2895  54          
    CALL    GETSTR                      ;2896  cd 9e 2d    
    POP DE                              ;2899  d1          
    POP HL                              ;289a  e1          
    RET                                 ;289b  c9          
                  ;
GETFJP: LD  HL,FJPTBL                   ;289c  21 06 30    
GETJPA: SUB 081h                        ;289f  d6 81       
    ADD A,A                             ;28a1  87          
    LD  E,A                             ;28a2  5f          
    LD  D,0                             ;28a3  16 00       
    ADD HL,DE                           ;28a5  19          
    JP  INDRCT                          ;28a6  c3 a3 2a    
                  ;
CLRFAC: PUSH    HL                      ;28a9  e5          
    PUSH    BC                          ;28aa  c5          
    LD  B,8                             ;28ab  06 08       
CLFCLP: LD  (HL),0                      ;28ad  36 00       
    INC HL                              ;28af  23          
    DJNZ    CLFCLP                      ;28b0  10 fb       
    POP BC                              ;28b2  c1          
    POP HL                              ;28b3  e1          
    RET                                 ;28b4  c9          
                  ;
STRFAC: LD  DE,00008h                   ;28b5  11 08 00    
    ADD HL,DE                           ;28b8  19          
    INC HL                              ;28b9  23          
    INC HL                              ;28ba  23          
    LD  (HL),0                          ;28bb  36 00       
    INC HL                              ;28bd  23          
    LD  (HL),C                          ;28be  71          
    INC HL                              ;28bf  23          
    LD  (HL),B                          ;28c0  70          
    DEC HL                              ;28c1  2b          
    DEC HL                              ;28c2  2b          
STRSL:  LD  A,(BC)                      ;28c3  0a          
    INC (HL)                            ;28c4  34          
    OR  A                               ;28c5  b7          
    JR  Z,LENOKS                        ;28c6  28 05       
    INC BC                              ;28c8  03          
    CP  022h                            ;28c9  fe 22       
    JR  NZ,STRSL                        ;28cb  20 f6       
LENOKS: DEC (HL)                        ;28cd  35          
    PUSH    DE                          ;28ce  d5          
    LD  E,L                             ;28cf  5d          
    LD  D,H                             ;28d0  54          
    DEC HL                              ;28d1  2b          
    LD  (HL),D                          ;28d2  72          
    DEC HL                              ;28d3  2b          
    LD  (HL),E                          ;28d4  73          
    POP DE                              ;28d5  d1          
    JP  CONDSB                          ;28d6  c3 b1 25    
                  ;
CONDSR: PUSH    AF                      ;28d9  f5          
    LD  A,(IY+0)                        ;28da  fd 7e 00    
    OR  A                               ;28dd  b7          
    JR  Z,OKSTTH                        ;28de  28 05       
    CP  003h                            ;28e0  fe 03       
    JP  NZ,TYPEMS                       ;28e2  c2 32 17    
OKSTTH: POP AF                          ;28e5  f1          
    LD  (IY+0),3                        ;28e6  fd 36 00 03 
    RET                                 ;28ea  c9          
                  ;
CONDFL: PUSH    AF                      ;28eb  f5          
    LD  A,(IY+0)                        ;28ec  fd 7e 00    
    OR  A                               ;28ef  b7          
    JR  Z,STFLMK                        ;28f0  28 0b       
    CP  003h                            ;28f2  fe 03       
    JP  Z,TYPEMS                        ;28f4  ca 32 17    
    POP AF                              ;28f7  f1          
    CP  004h                            ;28f8  fe 04       
    RET Z                               ;28fa  c8          
    JR  STDBL                           ;28fb  18 01       
STFLMK: POP AF                          ;28fd  f1          
STDBL:  LD  (IY+0),A                    ;28fe  fd 77 00    
    RET                                 ;2901  c9          
                  ;
FLTHEX: CALL    CLRFAC                  ;2902  cd a9 28    
    LD  A,E                             ;2905  7b          
    OR  D                               ;2906  b2          
    RET Z                               ;2907  c8          
    BIT 7,D                             ;2908  cb 7a       
    JR  Z,NORFLH                        ;290a  28 0d       
    LD  A,D                             ;290c  7a          
    CPL                                 ;290d  2f          
    LD  D,A                             ;290e  57          
    LD  A,E                             ;290f  7b          
    CPL                                 ;2910  2f          
    LD  E,A                             ;2911  5f          
    INC DE                              ;2912  13          
    CALL    NORFLH                      ;2913  cd 19 29    
    JP  TOGLE                           ;2916  c3 eb 6b    
                  ;
NORFLH: LD  A,091h                      ;2919  3e 91       
SFL:    DEC A                           ;291b  3d          
    BIT 7,D                             ;291c  cb 7a       
    JR  NZ,FLHXRT                       ;291e  20 06       
    RL  E                               ;2920  cb 13       
    RL  D                               ;2922  cb 12       
    JR  SFL                             ;2924  18 f5       
FLHXRT: LD  (HL),A                      ;2926  77          
    INC HL                              ;2927  23          
    RES 7,D                             ;2928  cb ba       
    LD  (HL),D                          ;292a  72          
    INC HL                              ;292b  23          
    LD  (HL),E                          ;292c  73          
    DEC HL                              ;292d  2b          
    DEC HL                              ;292e  2b          
    RET                                 ;292f  c9          
                  ;
DEFINT: LD  C,002h                      ;2930  0e 02       
    JR  CONTDF                          ;2932  18 0a       
DEFSTR: LD  C,003h                      ;2934  0e 03       
    JR  CONTDF                          ;2936  18 06       
DEFSNG: LD  C,004h                      ;2938  0e 04       
    JR  CONTDF                          ;293a  18 02       
DEFDBL: LD  C,008h                      ;293c  0e 08       
CONTDF: CALL    HLFTCH                  ;293e  cd 87 29    
    CP  05Bh                            ;2941  fe 5b       
    RET NC                              ;2943  d0          
    SUB 041h                            ;2944  d6 41       
    RET C                               ;2946  d8          
    LD  E,A                             ;2947  5f          
    LD  D,0                             ;2948  16 00       
    LD  B,A                             ;294a  47          
    PUSH    HL                          ;294b  e5          
    LD  HL,DFTABL                       ;294c  21 88 30    
    ADD HL,DE                           ;294f  19          
    LD  (HL),C                          ;2950  71          
    EX  DE,HL                           ;2951  eb          
    POP HL                              ;2952  e1          
CDEFTP: CALL    INCHLF                  ;2953  cd 86 29    
                  ;
    INC HL                              ;2956  23          
    CP  02Ch                            ;2957  fe 2c       
    JR  Z,CONTDF                        ;2959  28 e3       
    DEC HL                              ;295b  2b          
    CP  0F9h                            ;295c  fe f9       
    RET NZ                              ;295e  c0          
    CALL    INCHLF                      ;295f  cd 86 29    
                  ;
    CP  05Bh                            ;2962  fe 5b       
    RET NC                              ;2964  d0          
    SUB 041h                            ;2965  d6 41       
    RET C                               ;2967  d8          
STRMDM2: SUB    B                       ;2968  90          
    RET C                               ;2969  d8          
    RET Z                               ;296a  c8          
    EX  DE,HL                           ;296b  eb          
DFFIL1: INC HL                          ;296c  23          
    LD  (HL),C                          ;296d  71          
    DEC A                               ;296e  3d          
    JR  NZ,DFFIL1                       ;296f  20 fb       
    EX  DE,HL                           ;2971  eb          
    JR  CDEFTP                          ;2972  18 df       
                  ;
CALLUP: LD  C,L                         ;2974  4d          
    LD  B,H                             ;2975  44          
    CALL    IHLEXP                      ;2976  cd cc 22    
    PUSH    BC                          ;2979  c5          
    PUSH    IY                          ;297a  fd e5       
    LD  BC,CALUPR                       ;297c  01 81 29    
    PUSH    BC                          ;297f  c5          
    JP  (HL)                            ;2980  e9          
CALUPR: POP IY                          ;2981  fd e1       
    POP HL                              ;2983  e1          
    DEC HL                              ;2984  2b          
    RET                                 ;2985  c9          
                  ;
INCHLF: INC HL                          ;2986  23          
HLFTCH:                                 ;                  
    LD  A,(HL)                          ;2987  7e          
    CP  020h                            ;2988  fe 20       
    RET NZ                              ;298a  c0          
    JR  INCHLF                          ;298b  18 f9       
                  ;
INTG:   INC HL                          ;298d  23          
    BIT 7,(HL)                          ;298e  cb 7e       
    DEC HL                              ;2990  2b          
    JP  Z,INT                           ;2991  ca 10 60    
    PUSH    DE                          ;2994  d5          
    PUSH    HL                          ;2995  e5          
    LD  DE,00008h                       ;2996  11 08 00    
    ADD HL,DE                           ;2999  19          
    EX  DE,HL                           ;299a  eb          
    POP HL                              ;299b  e1          
    PUSH    HL                          ;299c  e5          
    PUSH    DE                          ;299d  d5          
    PUSH    BC                          ;299e  c5          
    CALL    LDIR8                       ;299f  cd a6 73    
    POP BC                              ;29a2  c1          
    POP HL                              ;29a3  e1          
    CALL    INT                         ;29a4  cd 10 60    
    EX  DE,HL                           ;29a7  eb          
    POP HL                              ;29a8  e1          
    CALL    CMP                         ;29a9  cd d6 61    
    JR  Z,MNINTR                        ;29ac  28 08       
    CALL    INT                         ;29ae  cd 10 60    
    PUSH    BC                          ;29b1  c5          
    CALL    ONESUB                      ;29b2  cd ce 6b    
    POP BC                              ;29b5  c1          
MNINTR: POP DE                          ;29b6  d1          
    RET                                 ;29b7  c9          
                  ;
STRING: CALL    CH28H                   ;29b8  cd 58 2d    
    DEC IY                              ;29bb  fd 2b       
    PUSH    HL                          ;29bd  e5          
    CALL    FLEXP'                      ;29be  cd 9c 22    
    CALL    CH2CH                       ;29c1  cd 61 2d    
    CALL    HLFLTO                      ;29c4  cd 97 2d    
    CALL    HCHECK                      ;29c7  cd d8 22    
    POP HL                              ;29ca  e1          
    PUSH    AF                          ;29cb  f5          
    CALL    FLEXP'                      ;29cc  cd 9c 22    
    INC IY                              ;29cf  fd 23       
    PUSH    HL                          ;29d1  e5          
    CALL    HLFLTO                      ;29d2  cd 97 2d    
    CALL    HCHECK                      ;29d5  cd d8 22    
    LD  (FILLCH),A                      ;29d8  32 ff 29    
    POP HL                              ;29db  e1          
    POP AF                              ;29dc  f1          
    CALL    SPCSU'                      ;29dd  cd e3 29    
    JP  CONDSB                          ;29e0  c3 b1 25    
                  ;
                  ;
SPCSU': PUSH    BC                      ;29e3  c5          
    PUSH    DE                          ;29e4  d5          
    PUSH    HL                          ;29e5  e5          
    JR  SPCSME                          ;29e6  18 0e       
                  ;
SPCSUB: LD  A,020h                      ;29e8  3e 20       
    LD  (FILLCH),A                      ;29ea  32 ff 29    
    PUSH    BC                          ;29ed  c5          
    PUSH    DE                          ;29ee  d5          
    PUSH    HL                          ;29ef  e5          
    CALL    HLFLTO                      ;29f0  cd 97 2d    
    CALL    HCHECK                      ;29f3  cd d8 22    
SPCSME: OR  A                           ;29f6  b7          
    JR  Z,NULRET                        ;29f7  28 0a       
    LD  B,A                             ;29f9  47          
    LD  C,B                             ;29fa  48          
    LD  HL,KEYBUF                       ;29fb  21 4f 7a    
SPCFLL: DEFB    036H                    ;29fe  36          ;LD (HL),?
FILLCH: DEFB    020H                    ;29ff  20          
    INC HL                              ;2a00  23          
    DJNZ    SPCFLL                      ;2a01  10 fb       
NULRET: POP HL                          ;2a03  e1          
    LD  DE,KEYBUF                       ;2a04  11 4f 7a    
    LD  B,C                             ;2a07  41          
    CALL    ENTSTR                      ;2a08  cd 1a 2b    
    POP DE                              ;2a0b  d1          
    POP BC                              ;2a0c  c1          
    RET                                 ;2a0d  c9          
                  ;
FRACSB: PUSH    BC                      ;2a0e  c5          
    CALL    FRAC                        ;2a0f  cd 95 60    
    POP BC                              ;2a12  c1          
    RET                                 ;2a13  c9          
                  ;
PEEK:   PUSH    DE                      ;2a14  d5          
    PUSH    HL                          ;2a15  e5          
    CALL    HLFLTO                      ;2a16  cd 97 2d    
    LD  E,(HL)                          ;2a19  5e          
    LD  D,0                             ;2a1a  16 00       
    POP HL                              ;2a1c  e1          
    CALL    FLTHEX                      ;2a1d  cd 02 29    
    POP DE                              ;2a20  d1          
    LD  (IY+0),4                        ;2a21  fd 36 00 04 
    RET                                 ;2a25  c9          
                  ;
HEXD:   PUSH    BC                      ;2a26  c5          
    PUSH    DE                          ;2a27  d5          
    PUSH    HL                          ;2a28  e5          
    PUSH    HL                          ;2a29  e5          
    LD  DE,KEYBUF                       ;2a2a  11 4f 7a    
    CALL    HLFLTO                      ;2a2d  cd 97 2d    
    CALL    HEXHL                       ;2a30  cd 12 67    
    LD  B,4                             ;2a33  06 04       
MIDOCT: LD  A,(DE)                      ;2a35  1a          
    CP  030h                            ;2a36  fe 30       
    JR  NZ,MIDHEX                       ;2a38  20 20       
    INC DE                              ;2a3a  13          
    DEC B                               ;2a3b  05          
    JR  NZ,MIDOCT                       ;2a3c  20 f7       
    INC B                               ;2a3e  04          
    DEC DE                              ;2a3f  1b          
    JR  MIDHEX                          ;2a40  18 18       
                  ;
OCTD:   PUSH    BC                      ;2a42  c5          
    PUSH    DE                          ;2a43  d5          
    PUSH    HL                          ;2a44  e5          
    PUSH    HL                          ;2a45  e5          
    LD  DE,KEYBUF                       ;2a46  11 4f 7a    
    CALL    HLFLTO                      ;2a49  cd 97 2d    
    CALL    OCTHL                       ;2a4c  cd db 66    
    LD  B,6                             ;2a4f  06 06       
    JR  MIDOCT                          ;2a51  18 e2       
                  ;
STRSUB: PUSH    BC                      ;2a53  c5          
    PUSH    DE                          ;2a54  d5          
    PUSH    HL                          ;2a55  e5          
    PUSH    HL                          ;2a56  e5          
    CALL    CVNMFL                      ;2a57  cd 58 5d    
MIDHEX: EX  DE,HL                       ;2a5a  eb          
    EX  (SP),HL                         ;2a5b  e3          
    LD  E,L                             ;2a5c  5d          
    LD  D,H                             ;2a5d  54          
    INC DE                              ;2a5e  13          
    INC DE                              ;2a5f  13          
    LD  (HL),E                          ;2a60  73          
    INC HL                              ;2a61  23          
    LD  (HL),D                          ;2a62  72          
    INC HL                              ;2a63  23          
    LD  (HL),B                          ;2a64  70          
    INC HL                              ;2a65  23          
    POP DE                              ;2a66  d1          
    LD  (HL),E                          ;2a67  73          
    INC HL                              ;2a68  23          
    LD  (HL),D                          ;2a69  72          
    DEC HL                              ;2a6a  2b          
    DEC HL                              ;2a6b  2b          
    LD  E,L                             ;2a6c  5d          
    LD  D,H                             ;2a6d  54          
    CALL    GETSTR                      ;2a6e  cd 9e 2d    
    POP HL                              ;2a71  e1          
    POP DE                              ;2a72  d1          
    POP BC                              ;2a73  c1          
    RET                                 ;2a74  c9          
                  ;
MK1:    PUSH    BC                      ;2a75  c5          
    PUSH    DE                          ;2a76  d5          
    PUSH    HL                          ;2a77  e5          
    PUSH    HL                          ;2a78  e5          
    CALL    HLFLTO                      ;2a79  cd 97 2d    
    LD  (INPSDC),HL                     ;2a7c  22 a9 1e    
    LD  B,2                             ;2a7f  06 02       
    LD  DE,INPSDC                       ;2a81  11 a9 1e    
    POP HL                              ;2a84  e1          
    PUSH    HL                          ;2a85  e5          
    JR  MIDHEX                          ;2a86  18 d2       
                  ;
MKS:    PUSH    BC                      ;2a88  c5          
    LD  BC,4                            ;2a89  01 04 00    
    JR  MKHILS                          ;2a8c  18 04       
                  ;
MKD:    PUSH    BC                      ;2a8e  c5          
    LD  BC,8                            ;2a8f  01 08 00    
MKHILS: PUSH    DE                      ;2a92  d5          
    PUSH    HL                          ;2a93  e5          
    PUSH    HL                          ;2a94  e5          
    LD  DE,ZFAC                         ;2a95  11 f2 62    
    PUSH    DE                          ;2a98  d5          
    PUSH    BC                          ;2a99  c5          
    LDIR                                ;2a9a  ed b0       
    POP BC                              ;2a9c  c1          
    POP DE                              ;2a9d  d1          
    POP HL                              ;2a9e  e1          
    PUSH    HL                          ;2a9f  e5          
    LD  B,C                             ;2aa0  41          
    JR  MIDHEX                          ;2aa1  18 b7       
INDRCT: PUSH    DE                      ;2aa3  d5          
    LD  E,(HL)                          ;2aa4  5e          
    INC HL                              ;2aa5  23          
    LD  D,(HL)                          ;2aa6  56          
    EX  DE,HL                           ;2aa7  eb          
    POP DE                              ;2aa8  d1          
    RET                                 ;2aa9  c9          
                  ;
CVI:    PUSH    BC                      ;2aaa  c5          
    PUSH    HL                          ;2aab  e5          
    CALL    CONDMZ                      ;2aac  cd f6 6b    
    CALL    INDRCT                      ;2aaf  cd a3 2a    
    LD  A,(HL)                          ;2ab2  7e          
    CP  002h                            ;2ab3  fe 02       
    JP  NZ,IFCALL                       ;2ab5  c2 36 17    
    INC HL                              ;2ab8  23          
    CALL    INDRCT                      ;2ab9  cd a3 2a    
    CALL    INDRCT                      ;2abc  cd a3 2a    
    EX  DE,HL                           ;2abf  eb          
    POP HL                              ;2ac0  e1          
    CALL    FLTHEX                      ;2ac1  cd 02 29    
    POP BC                              ;2ac4  c1          
    LD  (IY+0),4                        ;2ac5  fd 36 00 04 
    RET                                 ;2ac9  c9          
                  ;
CVD:    PUSH    BC                      ;2aca  c5          
    LD  C,8                             ;2acb  0e 08       
    JR  CVMIDE                          ;2acd  18 03       
                  ;
CVS:    PUSH    BC                      ;2acf  c5          
    LD  C,4                             ;2ad0  0e 04       
CVMIDE: PUSH    HL                      ;2ad2  e5          
    CALL    CONDMZ                      ;2ad3  cd f6 6b    
    CALL    INDRCT                      ;2ad6  cd a3 2a    
    LD  A,(HL)                          ;2ad9  7e          
    CP  C                               ;2ada  b9          
    JP  NZ,IFCALL                       ;2adb  c2 36 17    
    INC HL                              ;2ade  23          
    CALL    INDRCT                      ;2adf  cd a3 2a    
    EX  DE,HL                           ;2ae2  eb          
    POP HL                              ;2ae3  e1          
    PUSH    HL                          ;2ae4  e5          
    CALL    CLRFAC                      ;2ae5  cd a9 28    
    LD  B,C                             ;2ae8  41          
CVTRLP: LD  A,(DE)                      ;2ae9  1a          
    LD  (HL),A                          ;2aea  77          
    INC HL                              ;2aeb  23          
    INC DE                              ;2aec  13          
    DJNZ    CVTRLP                      ;2aed  10 fa       
    POP HL                              ;2aef  e1          
    LD  (IY+0),C                        ;2af0  fd 71 00    
    POP BC                              ;2af3  c1          
    RET                                 ;2af4  c9          
                  ;
PARI:   PUSH    BC                      ;2af5  c5          
    PUSH    DE                          ;2af6  d5          
    PUSH    HL                          ;2af7  e5          
    CALL    CONDMZ                      ;2af8  cd f6 6b    
    CALL    INDRCT                      ;2afb  cd a3 2a    
    LD  A,(HL)                          ;2afe  7e          
    JP  Z,IFCALL                        ;2aff  ca 36 17    
    INC HL                              ;2b02  23          
    CALL    INDRCT                      ;2b03  cd a3 2a    
    LD  A,(HL)                          ;2b06  7e          
    AND A                               ;2b07  a7          
    LD  DE,00001h                       ;2b08  11 01 00    
    JP  PO,SKIMPL                       ;2b0b  e2 0f 2b    
    DEC DE                              ;2b0e  1b          
SKIMPL: POP HL                          ;2b0f  e1          
    CALL    FLTHEX                      ;2b10  cd 02 29    
    POP DE                              ;2b13  d1          
    POP BC                              ;2b14  c1          
    LD  (IY+0),4                        ;2b15  fd 36 00 04 
    RET                                 ;2b19  c9          
                  ;
ENTSTR: PUSH    BC                      ;2b1a  c5          
    PUSH    DE                          ;2b1b  d5          
    PUSH    HL                          ;2b1c  e5          
    PUSH    HL                          ;2b1d  e5          
    JP  MIDHEX                          ;2b1e  c3 5a 2a    
                  ;
CDBL:   LD  A,8                         ;2b21  3e 08       
    JP  CONDFL                          ;2b23  c3 eb 28    ;CONDFL
                  ;
CSNG:   LD  A,(HL)                      ;2b26  7e          
    OR  A                               ;2b27  b7          
    JR  Z,INRETY                        ;2b28  28 51       
    LD  A,(IY+0)                        ;2b2a  fd 7e 00    
    CP  004h                            ;2b2d  fe 04       
    JR  Z,INRETY                        ;2b2f  28 4a       
    INC HL                              ;2b31  23          
    LD  A,(HL)                          ;2b32  7e          
    RES 7,(HL)                          ;2b33  cb be       
    DEC HL                              ;2b35  2b          
    PUSH    AF                          ;2b36  f5          
    LD  A,(HL)                          ;2b37  7e          
    PUSH    AF                          ;2b38  f5          
    LD  (HL),099h                       ;2b39  36 99       
    PUSH    BC                          ;2b3b  c5          
    CALL    ONEADD                      ;2b3c  cd ac 73    
    POP BC                              ;2b3f  c1          
    LD  A,(HL)                          ;2b40  7e          
    CP  09Ah                            ;2b41  fe 9a       
    JR  NZ,EPREST                       ;2b43  20 06       
    POP AF                              ;2b45  f1          
    INC A                               ;2b46  3c          
    JP  Z,OVERFL                        ;2b47  ca b8 30    
    PUSH    AF                          ;2b4a  f5          
EPREST: POP AF                          ;2b4b  f1          
    LD  (HL),A                          ;2b4c  77          
    POP AF                              ;2b4d  f1          
    INC HL                              ;2b4e  23          
    AND 080h                            ;2b4f  e6 80       
    OR  (HL)                            ;2b51  b6          
    LD  (HL),A                          ;2b52  77          
    DEC HL                              ;2b53  2b          
    LD  (IY+0),4                        ;2b54  fd 36 00 04 
    JR  INRETY                          ;2b58  18 21       
                  ;
CINT:   LD  A,(HL)                      ;2b5a  7e          
    OR  A                               ;2b5b  b7          
    JR  Z,INRETY                        ;2b5c  28 1d       
    PUSH    HL                          ;2b5e  e5          
    INC HL                              ;2b5f  23          
    LD  A,(HL)                          ;2b60  7e          
    PUSH    AF                          ;2b61  f5          
    RES 7,(HL)                          ;2b62  cb be       
    DEC HL                              ;2b64  2b          
    PUSH    BC                          ;2b65  c5          
    INC (HL)                            ;2b66  34          
    CALL    ONEADD                      ;2b67  cd ac 73    
    DEC (HL)                            ;2b6a  35          
    POP BC                              ;2b6b  c1          
    INC HL                              ;2b6c  23          
    POP AF                              ;2b6d  f1          
    AND 080h                            ;2b6e  e6 80       
    ADD A,(HL)                          ;2b70  86          
    LD  (HL),A                          ;2b71  77          
    DEC HL                              ;2b72  2b          
    CALL    HLFLTO                      ;2b73  cd 97 2d    
    EX  DE,HL                           ;2b76  eb          
    POP HL                              ;2b77  e1          
    CALL    FLTHEX                      ;2b78  cd 02 29    
INRETY: LD  A,004h                      ;2b7b  3e 04       
    JP  CONDFL                          ;2b7d  c3 eb 28    
                  ;
LEFT1:  CALL    CH28H                   ;2b80  cd 58 2d    
    LD  DE,00008h                       ;2b83  11 08 00    
    ADD HL,DE                           ;2b86  19          
    PUSH    HL                          ;2b87  e5          
    CALL    STEXP'                      ;2b88  cd b5 22    
    CALL    CH2CH                       ;2b8b  cd 61 2d    
    PUSH    HL                          ;2b8e  e5          
    DEC IY                              ;2b8f  fd 2b       
    LD  (IY+0),0                        ;2b91  fd 36 00 00 
    CALL    HLEXP                       ;2b95  cd c7 22    
    INC IY                              ;2b98  fd 23       
    CALL    CH29H                       ;2b9a  cd 66 2d    
    CALL    HCHECK                      ;2b9d  cd d8 22    
    POP HL                              ;2ba0  e1          
    PUSH    HL                          ;2ba1  e5          
    CALL    INDRCT                      ;2ba2  cd a3 2a    
    CP  (HL)                            ;2ba5  be          
    JR  C,LFTOLM                        ;2ba6  38 01       
    LD  A,(HL)                          ;2ba8  7e          
LFTOLM: INC HL                          ;2ba9  23          
    CALL    INDRCT                      ;2baa  cd a3 2a    
    EX  DE,HL                           ;2bad  eb          
LMIDET: POP IX                          ;2bae  dd e1       
    POP HL                              ;2bb0  e1          
    PUSH    BC                          ;2bb1  c5          
    LD  B,A                             ;2bb2  47          
    OR  A                               ;2bb3  b7          
    JR  Z,NOLENE                        ;2bb4  28 0f       
    PUSH    HL                          ;2bb6  e5          
    PUSH    BC                          ;2bb7  c5          
    EX  DE,HL                           ;2bb8  eb          
    LD  DE,KEYBUF                       ;2bb9  11 4f 7a    
    PUSH    DE                          ;2bbc  d5          
    LD  C,B                             ;2bbd  48          
    LD  B,0                             ;2bbe  06 00       
    LDIR                                ;2bc0  ed b0       
    POP DE                              ;2bc2  d1          
    POP BC                              ;2bc3  c1          
    POP HL                              ;2bc4  e1          
NOLENE: CALL    ENTSTR                  ;2bc5  cd 1a 2b    
    PUSH    HL                          ;2bc8  e5          
    PUSH    IX                          ;2bc9  dd e5       
    POP HL                              ;2bcb  e1          
    CALL    CONDMZ                      ;2bcc  cd f6 6b    
    POP HL                              ;2bcf  e1          
    POP BC                              ;2bd0  c1          
    JP  CONDSB                          ;2bd1  c3 b1 25    
                  ;
RIGHT1: CALL    CH28H                   ;2bd4  cd 58 2d    
    LD  DE,00008h                       ;2bd7  11 08 00    
    ADD HL,DE                           ;2bda  19          
    PUSH    HL                          ;2bdb  e5          
    CALL    STEXP'                      ;2bdc  cd b5 22    
    CALL    CH2CH                       ;2bdf  cd 61 2d    
    PUSH    HL                          ;2be2  e5          
    DEC IY                              ;2be3  fd 2b       
    LD  (IY+0),0                        ;2be5  fd 36 00 00 
    CALL    HLEXP                       ;2be9  cd c7 22    
    INC IY                              ;2bec  fd 23       
    CALL    CH29H                       ;2bee  cd 66 2d    
    CALL    HCHECK                      ;2bf1  cd d8 22    
    POP HL                              ;2bf4  e1          
    PUSH    HL                          ;2bf5  e5          
    CALL    INDRCT                      ;2bf6  cd a3 2a    
    CP  (HL)                            ;2bf9  be          
    JR  C,NOLSRD                        ;2bfa  38 01       
    LD  A,(HL)                          ;2bfc  7e          
NOLSRD: PUSH    AF                      ;2bfd  f5          
    SUB (HL)                            ;2bfe  96          
    NEG                                 ;2bff  ed 44       
    INC HL                              ;2c01  23          
    CALL    INDRCT                      ;2c02  cd a3 2a    
    ADD A,L                             ;2c05  85          
    LD  L,A                             ;2c06  6f          
    LD  A,000h                          ;2c07  3e 00       
    ADC A,H                             ;2c09  8c          
    LD  H,A                             ;2c0a  67          
    EX  DE,HL                           ;2c0b  eb          
    POP AF                              ;2c0c  f1          
    JR  LMIDET                          ;2c0d  18 9f       
                  ;
MID:    CALL    CH28H                   ;2c0f  cd 58 2d    
    LD  DE,00008h                       ;2c12  11 08 00    
    ADD HL,DE                           ;2c15  19          
    PUSH    HL                          ;2c16  e5          
    CALL    STEXP'                      ;2c17  cd b5 22    
    CALL    CH2CH                       ;2c1a  cd 61 2d    
    PUSH    HL                          ;2c1d  e5          
    DEC IY                              ;2c1e  fd 2b       
    LD  (IY+0),0                        ;2c20  fd 36 00 00 
    CALL    HLEXP                       ;2c24  cd c7 22    
    INC IY                              ;2c27  fd 23       
    EX  AF,AF'                          ;2c29  08          
    CALL    HCHECK                      ;2c2a  cd d8 22    
    OR  A                               ;2c2d  b7          
    JP  Z,IFCALL                        ;2c2e  ca 36 17    
    LD  D,A                             ;2c31  57          
    EX  AF,AF'                          ;2c32  08          
    CP  029h                            ;2c33  fe 29       
    LD  E,0FFh                          ;2c35  1e ff       
    JR  Z,MIDALL                        ;2c37  28 19       
    CALL    CH2CH                       ;2c39  cd 61 2d    
    POP HL                              ;2c3c  e1          
    PUSH    HL                          ;2c3d  e5          
    PUSH    DE                          ;2c3e  d5          
    DEC IY                              ;2c3f  fd 2b       
    LD  (IY+0),0                        ;2c41  fd 36 00 00 
    CALL    HLEXP                       ;2c45  cd c7 22    
    INC IY                              ;2c48  fd 23       
    CALL    CH29H                       ;2c4a  cd 66 2d    
    CALL    HCHECK                      ;2c4d  cd d8 22    
    POP DE                              ;2c50  d1          
    LD  E,A                             ;2c51  5f          
MIDALL: POP HL                          ;2c52  e1          
    PUSH    HL                          ;2c53  e5          
    CALL    INDRCT                      ;2c54  cd a3 2a    
    LD  A,D                             ;2c57  7a          
    DEC A                               ;2c58  3d          
    CP  (HL)                            ;2c59  be          
    JR  NC,MIDNUL                       ;2c5a  30 18       
    EX  AF,AF'                          ;2c5c  08          
    LD  A,(HL)                          ;2c5d  7e          
    SUB D                               ;2c5e  92          
    INC A                               ;2c5f  3c          
    EX  AF,AF'                          ;2c60  08          
    INC HL                              ;2c61  23          
    CALL    INDRCT                      ;2c62  cd a3 2a    
    ADD A,L                             ;2c65  85          
    LD  L,A                             ;2c66  6f          
    LD  A,000h                          ;2c67  3e 00       
    ADC A,H                             ;2c69  8c          
    LD  H,A                             ;2c6a  67          
    EX  AF,AF'                          ;2c6b  08          
    CP  E                               ;2c6c  bb          
    JR  C,KMIJL                         ;2c6d  38 01       
    LD  A,E                             ;2c6f  7b          
KMIJL:  EX  DE,HL                       ;2c70  eb          
MNULIS: JP  LMIDET                      ;2c71  c3 ae 2b    
                  ;
MIDNUL: LD  DE,00000h                   ;2c74  11 00 00    
    XOR A                               ;2c77  af          
    JR  MNULIS                          ;2c78  18 f7       
                  ;
INSTR:  PUSH    HL                      ;2c7a  e5          
    CALL    CH28H                       ;2c7b  cd 58 2d    
    LD  D,001h                          ;2c7e  16 01       
    DEC IY                              ;2c80  fd 2b       
    LD  (IY+0),0                        ;2c82  fd 36 00 00 
    PUSH    DE                          ;2c86  d5          
    CALL    EXPRSN                      ;2c87  cd f2 22    
    POP DE                              ;2c8a  d1          
    CALL    CH2CH                       ;2c8b  cd 61 2d    
    LD  A,(IY+0)                        ;2c8e  fd 7e 00    
    CP  003h                            ;2c91  fe 03       
    JR  Z,SINSEX                        ;2c93  28 11       
    CALL    HLFLTO                      ;2c95  cd 97 2d    
    CALL    HCHECK                      ;2c98  cd d8 22    
    LD  D,A                             ;2c9b  57          
    POP HL                              ;2c9c  e1          
    PUSH    HL                          ;2c9d  e5          
    PUSH    DE                          ;2c9e  d5          
    CALL    STEXP'                      ;2c9f  cd b5 22    
    POP DE                              ;2ca2  d1          
    CALL    CH2CH                       ;2ca3  cd 61 2d    
SINSEX: PUSH    DE                      ;2ca6  d5          
    PUSH    HL                          ;2ca7  e5          
    CALL    STEXP'                      ;2ca8  cd b5 22    
    CALL    CH29H                       ;2cab  cd 66 2d    
    LD  (BCPOTR),BC                     ;2cae  ed 43 11 2d 
    INC IY                              ;2cb2  fd 23       
    CALL    CONDMZ                      ;2cb4  cd f6 6b    
    CALL    INDRCT                      ;2cb7  cd a3 2a    
    LD  A,(HL)                          ;2cba  7e          
    OR  A                               ;2cbb  b7          
    JR  Z,INSZR1                        ;2cbc  28 5b       
    INC HL                              ;2cbe  23          
    CALL    INDRCT                      ;2cbf  cd a3 2a    
    EX  DE,HL                           ;2cc2  eb          
    LD  C,A                             ;2cc3  4f          
    POP HL                              ;2cc4  e1          
    CALL    CONDMZ                      ;2cc5  cd f6 6b    
    CALL    INDRCT                      ;2cc8  cd a3 2a    
    LD  A,(HL)                          ;2ccb  7e          
    OR  A                               ;2ccc  b7          
    JR  Z,INSZR2                        ;2ccd  28 4b       
    CP  C                               ;2ccf  b9          
    JR  C,INSZR2                        ;2cd0  38 48       
    LD  B,A                             ;2cd2  47          
    INC HL                              ;2cd3  23          
    CALL    INDRCT                      ;2cd4  cd a3 2a    
    POP AF                              ;2cd7  f1          
    DEC A                               ;2cd8  3d          
INCPL1: CP  B                           ;2cd9  b8          
    JR  NC,INSZR3                       ;2cda  30 3f       
    PUSH    AF                          ;2cdc  f5          
    SUB B                               ;2cdd  90          
    NEG                                 ;2cde  ed 44       
    CP  C                               ;2ce0  b9          
    JR  C,INSZR2                        ;2ce1  38 37       
    POP AF                              ;2ce3  f1          
    PUSH    BC                          ;2ce4  c5          
    PUSH    DE                          ;2ce5  d5          
    PUSH    HL                          ;2ce6  e5          
    PUSH    AF                          ;2ce7  f5          
    ADD A,L                             ;2ce8  85          
    LD  L,A                             ;2ce9  6f          
    LD  A,0                             ;2cea  3e 00       
    ADC A,H                             ;2cec  8c          
    LD  H,A                             ;2ced  67          
    LD  B,C                             ;2cee  41          
INSCPL: LD  A,(DE)                      ;2cef  1a          
    CP  (HL)                            ;2cf0  be          
    JR  NZ,INMTCH                       ;2cf1  20 06       
    INC HL                              ;2cf3  23          
    INC DE                              ;2cf4  13          
    DJNZ    INSCPL                      ;2cf5  10 f8       
    JR  INSRET                          ;2cf7  18 07       
INMTCH: POP AF                          ;2cf9  f1          
    POP HL                              ;2cfa  e1          
    POP DE                              ;2cfb  d1          
    POP BC                              ;2cfc  c1          
    INC A                               ;2cfd  3c          
    JR  INCPL1                          ;2cfe  18 d9       
                  ;
INSRET: POP AF                          ;2d00  f1          
    POP HL                              ;2d01  e1          
    POP DE                              ;2d02  d1          
    POP BC                              ;2d03  c1          
    INC A                               ;2d04  3c          
INSZR:  LD  DE,00008h                   ;2d05  11 08 00    
    POP HL                              ;2d08  e1          
    ADD HL,DE                           ;2d09  19          
    LD  E,A                             ;2d0a  5f          
    CALL    FLTHEX                      ;2d0b  cd 02 29    
    LD  A,004h                          ;2d0e  3e 04       
    DEFB    001H                        ;2d10  01          ;LD BC,?
BCPOTR: DEFS    2                       ;2d11              
    CALL    CONDFL                      ;2d13  cd eb 28    
    JP  BCFTCH                          ;2d16  c3 c4 25    
                  ;
INSZR1: POP HL                          ;2d19  e1          
INSZR2: POP AF                          ;2d1a  f1          
INSZR3: XOR A                           ;2d1b  af          
    JR  INSZR                           ;2d1c  18 e7       
                  ;
FRE:    CALL    CH28H                   ;2d1e  cd 58 2d    
    CALL    FLEXP'                      ;2d21  cd 9c 22    
    CALL    CH29H                       ;2d24  cd 66 2d    
                  ;
    PUSH    HL                          ;2d27  e5          
    LD  DE,(STKLMT)                     ;2d28  ed 5b 3f 7a 
    LD  HL,00000h                       ;2d2c  21 00 00    
    ADD HL,SP                           ;2d2f  39          
    OR  A                               ;2d30  b7          
    SBC HL,DE                           ;2d31  ed 52       
    EX  DE,HL                           ;2d33  eb          
    POP HL                              ;2d34  e1          
FREMID: CALL    FLTHEX                  ;2d35  cd 02 29    
    LD  A,004h                          ;2d38  3e 04       
    CALL    CONDFL                      ;2d3a  cd eb 28    
    JP  BCFTCH                          ;2d3d  c3 c4 25    
                  ;
VARPTR: CALL    CH28H                   ;2d40  cd 58 2d    
    PUSH    HL                          ;2d43  e5          
    EX  DE,HL                           ;2d44  eb          
    CALL    GETVAB                      ;2d45  cd d7 1e    
    CALL    BCFTCH                      ;2d48  cd c4 25    
    CALL    CH29H                       ;2d4b  cd 66 2d    
    EX  DE,HL                           ;2d4e  eb          
    POP HL                              ;2d4f  e1          
    PUSH    DE                          ;2d50  d5          
    LD  DE,00008h                       ;2d51  11 08 00    
    ADD HL,DE                           ;2d54  19          
    POP DE                              ;2d55  d1          
    JR  FREMID                          ;2d56  18 dd       
                  ;
CH28H:  CALL    BCFTCH                  ;2d58  cd c4 25    
    CP  028h                            ;2d5b  fe 28       
    RET Z                               ;2d5d  c8          
SERVED: JP  SERROR                      ;2d5e  c3 3a 17    
                  ;
CH2CH:  CP  02Ch                        ;2d61  fe 2c       
    RET Z                               ;2d63  c8          
    JR  SERVED                          ;2d64  18 f8       
                  ;
CH29H:  CP  029h                        ;2d66  fe 29       
    RET Z                               ;2d68  c8          
    JR  SERVED                          ;2d69  18 f3       
                  ;
MEM$:   CALL    CH28H                   ;2d6b  cd 58 2d    
    DEC IY                              ;2d6e  fd 2b       
    PUSH    HL                          ;2d70  e5          
    CALL    FLEXP'                      ;2d71  cd 9c 22    
    CALL    CH2CH                       ;2d74  cd 61 2d    
    CALL    HLFLTO                      ;2d77  cd 97 2d    
    EX  DE,HL                           ;2d7a  eb          
    POP HL                              ;2d7b  e1          
    PUSH    DE                          ;2d7c  d5          
    CALL    FLEXP'                      ;2d7d  cd 9c 22    
    CALL    CH29H                       ;2d80  cd 66 2d    
    INC IY                              ;2d83  fd 23       
    PUSH    HL                          ;2d85  e5          
    CALL    HLFLTO                      ;2d86  cd 97 2d    
    CALL    HCHECK                      ;2d89  cd d8 22    
    POP HL                              ;2d8c  e1          
    POP DE                              ;2d8d  d1          
    PUSH    BC                          ;2d8e  c5          
    LD  B,A                             ;2d8f  47          
    CALL    ENTSTR                      ;2d90  cd 1a 2b    
    POP BC                              ;2d93  c1          
    JP  CONDSB                          ;2d94  c3 b1 25    
                  ;
                  ;
HLFLTO: CALL    HLFLT                   ;2d97  cd 67 61    
    RET NC                              ;2d9a  d0          
    JP  OVERFL                          ;2d9b  c3 b8 30    
                  ;
GETSTR: PUSH    BC                      ;2d9e  c5          
    PUSH    HL                          ;2d9f  e5          
    PUSH    DE                          ;2da0  d5          
    XOR A                               ;2da1  af          
    LD  B,(HL)                          ;2da2  46          
    OR  B                               ;2da3  b0          
    JR  Z,NULSTR                        ;2da4  28 3d       
    INC HL                              ;2da6  23          
    LD  E,(HL)                          ;2da7  5e          
    INC HL                              ;2da8  23          
    LD  D,(HL)                          ;2da9  56          
    LD  HL,(STRPTR)                     ;2daa  2a 3d 7a    
    XOR A                               ;2dad  af          
    LD  C,B                             ;2dae  48          
    LD  B,A                             ;2daf  47          
    SBC HL,BC                           ;2db0  ed 42       
    DEC HL                              ;2db2  2b          
    DEC HL                              ;2db3  2b          
    PUSH    HL                          ;2db4  e5          
    PUSH    DE                          ;2db5  d5          
    LD  DE,(STRTOP)                     ;2db6  ed 5b 41 7a 
    OR  A                               ;2dba  b7          
    SBC HL,DE                           ;2dbb  ed 52       
    POP DE                              ;2dbd  d1          
    POP HL                              ;2dbe  e1          
    JR  C,PURGE                         ;2dbf  38 76       
    LD  (STRPTR),HL                     ;2dc1  22 3d 7a    
    EX  DE,HL                           ;2dc4  eb          
    EX  (SP),HL                         ;2dc5  e3          
    EX  DE,HL                           ;2dc6  eb          
    LD  (HL),E                          ;2dc7  73          
    INC HL                              ;2dc8  23          
    LD  (HL),D                          ;2dc9  72          
    INC HL                              ;2dca  23          
    EX  DE,HL                           ;2dcb  eb          
    EX  (SP),HL                         ;2dcc  e3          
    EX  DE,HL                           ;2dcd  eb          
    LD  B,C                             ;2dce  41          
    PUSH    HL                          ;2dcf  e5          
STRTRL: LD  A,(DE)                      ;2dd0  1a          
    LD  (HL),A                          ;2dd1  77          
    INC HL                              ;2dd2  23          
    INC DE                              ;2dd3  13          
    DJNZ    STRTRL                      ;2dd4  10 fa       
    POP DE                              ;2dd6  d1          
NULBCK: POP BC                          ;2dd7  c1          
    POP HL                              ;2dd8  e1          
    INC HL                              ;2dd9  23          
    LD  (HL),E                          ;2dda  73          
    INC HL                              ;2ddb  23          
    LD  (HL),D                          ;2ddc  72          
    DEC HL                              ;2ddd  2b          
    DEC HL                              ;2dde  2b          
    LD  D,B                             ;2ddf  50          
    LD  E,C                             ;2de0  59          
    POP BC                              ;2de1  c1          
    RET                                 ;2de2  c9          
                  ;
NULSTR: LD  DE,00000h                   ;2de3  11 00 00    
    JR  NULBCK                          ;2de6  18 ef       
                  ;
MEMPUR: LD  (BLTHLB),HL                 ;2de8  22 c1 2e    
    LD  (BLTDEB),DE                     ;2deb  ed 53 c4 2e 
    LD  (BLTBCB),BC                     ;2def  ed 43 c7 2e 
    POP HL                              ;2df3  e1          
    LD  (BLTRTA),HL                     ;2df4  22 ca 2e    
    CALL    STRPRG                      ;2df7  cd cc 2e    
    LD  HL,(STRPTR)                     ;2dfa  2a 3d 7a    
    LD  DE,0FC00h                       ;2dfd  11 00 fc    ;-400H
    ADD HL,DE                           ;2e00  19          
    LD  DE,(STRTOP)                     ;2e01  ed 5b 41 7a 
    LD  (STRTOP),HL                     ;2e05  22 41 7a    
    EX  DE,HL                           ;2e08  eb          
    LD  (MEPDEB),HL                     ;2e09  22 1d 2e    
    EX  DE,HL                           ;2e0c  eb          
    LD  HL,0                            ;2e0d  21 00 00    
    ADD HL,SP                           ;2e10  39          
    EX  DE,HL                           ;2e11  eb          
    OR  A                               ;2e12  b7          
    SBC HL,DE                           ;2e13  ed 52       
    LD  C,L                             ;2e15  4d          
    LD  B,H                             ;2e16  44          
    INC BC                              ;2e17  03          
    LD  HL,(STRTOP)                     ;2e18  2a 41 7a    
    EX  DE,HL                           ;2e1b  eb          
    DEFB    021H                        ;2e1c  21          ; LD HL,
MEPDEB: DEFS    2                       ;2e1d              
    DI                                  ;2e1f  f3          
    INC DE                              ;2e20  13          
    INC HL                              ;2e21  23          
    INC BC                              ;2e22  03          
    LDDR                                ;2e23  ed b8       
    EX  DE,HL                           ;2e25  eb          
    INC HL                              ;2e26  23          
    LD  SP,HL                           ;2e27  f9          
    EI                                  ;2e28  fb          
    LD  DE,(STRTOP)                     ;2e29  ed 5b 41 7a 
    LD  HL,(MEPDEB)                     ;2e2d  2a 1d 2e    
    OR  A                               ;2e30  b7          
    SBC HL,DE                           ;2e31  ed 52       
    EX  DE,HL                           ;2e33  eb          
    JP  MIDMPR                          ;2e34  c3 a0 2e    
                  ;
PURGE:  CALL    STRPRG                  ;2e37  cd cc 2e    
    LD  HL,(STRPTR)                     ;2e3a  2a 3d 7a    
    SBC HL,BC                           ;2e3d  ed 42       
    DEC HL                              ;2e3f  2b          
    DEC HL                              ;2e40  2b          
PURAGN: LD  DE,(STRTOP)                 ;2e41  ed 5b 41 7a 
    OR  A                               ;2e45  b7          
    SBC HL,DE                           ;2e46  ed 52       
    JR  C,SPBLTF                        ;2e48  38 06       
    POP DE                              ;2e4a  d1          
    POP HL                              ;2e4b  e1          
    POP BC                              ;2e4c  c1          
    JP  GETSTR                          ;2e4d  c3 9e 2d    
                  ;
SPBLTF: CALL    STKBLT                  ;2e50  cd 55 2e    
    JR  PURAGN                          ;2e53  18 ec       
                  ;
STKBLT: PUSH    HL                      ;2e55  e5          
    PUSH    DE                          ;2e56  d5          
    LD  HL,00000h                       ;2e57  21 00 00    
    ADD HL,SP                           ;2e5a  39          
    EX  DE,HL                           ;2e5b  eb          
    LD  HL,(STKLMT)                     ;2e5c  2a 3f 7a    
    INC H                               ;2e5f  24          
    INC H                               ;2e60  24          
    INC H                               ;2e61  24          
    OR  A                               ;2e62  b7          
    SBC HL,DE                           ;2e63  ed 52       
    JP  NC,OMERR                        ;2e65  d2 88 21    
    POP DE                              ;2e68  d1          
    POP HL                              ;2e69  e1          
    LD  (BLTHLB),HL                     ;2e6a  22 c1 2e    
    LD  (BLTDEB),DE                     ;2e6d  ed 53 c4 2e 
    LD  (BLTBCB),BC                     ;2e71  ed 43 c7 2e 
    POP HL                              ;2e75  e1          
    LD  (BLTRTA),HL                     ;2e76  22 ca 2e    
    LD  HL,0                            ;2e79  21 00 00    
    ADD HL,SP                           ;2e7c  39          
    EX  DE,HL                           ;2e7d  eb          
    LD  HL,(STRTOP)                     ;2e7e  2a 41 7a    
    OR  A                               ;2e81  b7          
    SBC HL,DE                           ;2e82  ed 52       
    LD  C,L                             ;2e84  4d          
    LD  B,H                             ;2e85  44          
    INC BC                              ;2e86  03          
    INC BC                              ;2e87  03          
    LD  HL,0FE00h                       ;2e88  21 00 fe    ;-200H
    ADD HL,DE                           ;2e8b  19          
    EX  DE,HL                           ;2e8c  eb          
    DI                                  ;2e8d  f3          
    LDIR                                ;2e8e  ed b0       
    LD  HL,0FE00h                       ;2e90  21 00 fe    ;-200H
    ADD HL,SP                           ;2e93  39          
    LD  SP,HL                           ;2e94  f9          
    EI                                  ;2e95  fb          
    LD  DE,0FE00h                       ;2e96  11 00 fe    ;-200H
    LD  HL,(STRTOP)                     ;2e99  2a 41 7a    
    ADD HL,DE                           ;2e9c  19          
    LD  (STRTOP),HL                     ;2e9d  22 41 7a    
MIDMPR: LD  HL,(SPBUF)                  ;2ea0  2a 25 22    
    ADD HL,DE                           ;2ea3  19          
    LD  (SPBUF),HL                      ;2ea4  22 25 22    
    LD  BC,FUNCNS                       ;2ea7  01 2f 26    
BLTAJL: LD  A,(BC)                      ;2eaa  0a          
    LD  L,A                             ;2eab  6f          
    INC BC                              ;2eac  03          
    LD  A,(BC)                          ;2ead  0a          
    LD  H,A                             ;2eae  67          
    OR  L                               ;2eaf  b5          
    JR  Z,BLTRET                        ;2eb0  28 0e       
    ADD HL,DE                           ;2eb2  19          
    LD  A,H                             ;2eb3  7c          
    LD  (BC),A                          ;2eb4  02          
    DEC BC                              ;2eb5  0b          
    LD  A,L                             ;2eb6  7d          
    LD  (BC),A                          ;2eb7  02          
    LD  C,L                             ;2eb8  4d          
    LD  B,H                             ;2eb9  44          
    INC BC                              ;2eba  03          
    INC BC                              ;2ebb  03          
    INC BC                              ;2ebc  03          
    INC BC                              ;2ebd  03          
    JR  BLTAJL                          ;2ebe  18 ea       
                  ;
BLTRET: DEFB    021H                    ;2ec0  21          ; LD HL,?
BLTHLB: DEFS    2                       ;2ec1              
    DEFB    011H                        ;2ec3  11          ; LD DE,?
BLTDEB: DEFS    2                       ;2ec4              
    DEFB    001H                        ;2ec6  01          ; LD BC,?
BLTBCB: DEFS    2                       ;2ec7              
    DEFB    0C3H                        ;2ec9  c3          ; JP ?
BLTRTA: DEFS    2                       ;2eca              
                  ;
STRPRG: PUSH    BC                      ;2ecc  c5          
    PUSH    DE                          ;2ecd  d5          
    PUSH    HL                          ;2ece  e5          
    LD  HL,(STRPTR)                     ;2ecf  2a 3d 7a    
FSTRTP: CALL    SREDCK                  ;2ed2  cd 59 2f    
    LD  C,(HL)                          ;2ed5  4e          
    INC HL                              ;2ed6  23          
    LD  B,(HL)                          ;2ed7  46          
    INC HL                              ;2ed8  23          
    XOR A                               ;2ed9  af          
    CP  B                               ;2eda  b8          
    JP  NZ,FDSRTP                       ;2edb  c2 e5 2e    
    ADD HL,BC                           ;2ede  09          
    LD  (STRPTR),HL                     ;2edf  22 3d 7a    
    JP  FSTRTP                          ;2ee2  c3 d2 2e    
                  ;
FDSRTP: LD  HL,(STRPTR)                 ;2ee5  2a 3d 7a    
SPRGLP: CALL    SREDCK                  ;2ee8  cd 59 2f    
    LD  C,(HL)                          ;2eeb  4e          
    INC HL                              ;2eec  23          
    LD  B,(HL)                          ;2eed  46          
    INC HL                              ;2eee  23          
    XOR A                               ;2eef  af          
    CP  B                               ;2ef0  b8          
    JR  Z,SHORTN                        ;2ef1  28 0c       
    LD  A,(BC)                          ;2ef3  0a          
    LD  E,A                             ;2ef4  5f          
    LD  D,0                             ;2ef5  16 00       
    ADD HL,DE                           ;2ef7  19          
    JP  SPRGLP                          ;2ef8  c3 e8 2e    
ESCSPR: POP HL                          ;2efb  e1          
    POP DE                              ;2efc  d1          
    POP BC                              ;2efd  c1          
    RET                                 ;2efe  c9          
                  ;
SHORTN: PUSH    HL                      ;2eff  e5          
SHRTNL: ADD HL,BC                       ;2f00  09          
    EX  DE,HL                           ;2f01  eb          
    LD  HL,(STRBTM)                     ;2f02  2a 45 7a    
    XOR A                               ;2f05  af          
    SBC HL,DE                           ;2f06  ed 52       
    EX  DE,HL                           ;2f08  eb          
    JR  Z,STRNST                        ;2f09  28 09       
    LD  C,(HL)                          ;2f0b  4e          
    INC HL                              ;2f0c  23          
    LD  B,(HL)                          ;2f0d  46          
    INC HL                              ;2f0e  23          
    CP  B                               ;2f0f  b8          
    JR  Z,SHRTNL                        ;2f10  28 ee       
    DEC HL                              ;2f12  2b          
    DEC HL                              ;2f13  2b          
STRNST: POP DE                          ;2f14  d1          
    DEC DE                              ;2f15  1b          
    DEC DE                              ;2f16  1b          
    DEC DE                              ;2f17  1b          
    PUSH    HL                          ;2f18  e5          
    DEC HL                              ;2f19  2b          
    EX  DE,HL                           ;2f1a  eb          
    PUSH    HL                          ;2f1b  e5          
    LD  BC,(STRPTR)                     ;2f1c  ed 4b 3d 7a 
    OR  A                               ;2f20  b7          
    SBC HL,BC                           ;2f21  ed 42       
    LD  C,L                             ;2f23  4d          
    LD  B,H                             ;2f24  44          
    INC BC                              ;2f25  03          
    POP HL                              ;2f26  e1          
    PUSH    HL                          ;2f27  e5          
    PUSH    DE                          ;2f28  d5          
    EX  DE,HL                           ;2f29  eb          
    OR  A                               ;2f2a  b7          
    SBC HL,DE                           ;2f2b  ed 52       
    EX  DE,HL                           ;2f2d  eb          
    LD  HL,(STRPTR)                     ;2f2e  2a 3d 7a    
    ADD HL,DE                           ;2f31  19          
    LD  (STRPTR),HL                     ;2f32  22 3d 7a    
    POP DE                              ;2f35  d1          
    POP HL                              ;2f36  e1          
    LDDR                                ;2f37  ed b8       
    LD  HL,(STRPTR)                     ;2f39  2a 3d 7a    
    POP DE                              ;2f3c  d1          
ADRSFL: LD  C,(HL)                      ;2f3d  4e          
    INC HL                              ;2f3e  23          
    LD  B,(HL)                          ;2f3f  46          
    INC HL                              ;2f40  23          
    LD  A,(BC)                          ;2f41  0a          
    EX  AF,AF'                          ;2f42  08          
    INC BC                              ;2f43  03          
    LD  A,L                             ;2f44  7d          
    LD  (BC),A                          ;2f45  02          
    INC BC                              ;2f46  03          
    LD  A,H                             ;2f47  7c          
    LD  (BC),A                          ;2f48  02          
    EX  AF,AF'                          ;2f49  08          
    ADD A,L                             ;2f4a  85          
    LD  L,A                             ;2f4b  6f          
    LD  A,000h                          ;2f4c  3e 00       
    ADC A,H                             ;2f4e  8c          
    LD  H,A                             ;2f4f  67          
    PUSH    HL                          ;2f50  e5          
    SBC HL,DE                           ;2f51  ed 52       
    POP HL                              ;2f53  e1          
    JR  NZ,ADRSFL                       ;2f54  20 e7       
    JP  SPRGLP                          ;2f56  c3 e8 2e    
                  ;
SREDCK: EX  DE,HL                       ;2f59  eb          
    LD  HL,(STRBTM)                     ;2f5a  2a 45 7a    
    OR  A                               ;2f5d  b7          
    SBC HL,DE                           ;2f5e  ed 52       
    EX  DE,HL                           ;2f60  eb          
    JR  C,OVERST                        ;2f61  38 01       
    RET NZ                              ;2f63  c0          
OVERST: POP HL                          ;2f64  e1          
    JP  ESCSPR                          ;2f65  c3 fb 2e    
                  ;
SJPTBL: DEFW    GOTO                    ;2f68  b1 43       ; GOTO
    DEFW    GOSUB                       ;2f6a  63 42       ; GOSUB
    DEFW    RUN                         ;2f6c  c3 15       ; RUN
    DEFW    RETURN                      ;2f6e  78 41       ; RETURN
    DEFW    RESTOR                      ;2f70  a5 1c       ; RESTORE
    DEFW    LIST                        ;2f72  7e 40       ; LIST
    DEFW    LIST#                       ;2f74  72 40       ; LIST#
    DEFW    AUTO                        ;2f76  0f 37       ; AUTO
    DEFW    DEL                         ;2f78  8e 37       ; DELETE
    DEFW    FOR                         ;2f7a  6f 19       ; FOR
    DEFW    NEXT                        ;2f7c  0a 1a       ; NEXT
    DEFW    PRINT                       ;2f7e  55 18       ; PRINT
    DEFW    INPUT                       ;2f80  74 1d       ; INPUT
    DEFW    IF                          ;2f82  01 44       ; IF
    DEFW    DATA                        ;2f84  c8 1c       ; DATA
    DEFW    READ                        ;2f86  45 1c       ; READ ; 90H
    DEFW    DIM                         ;2f88  03 20       ; DIM
    DEFW    REM                         ;2f8a  3a 18       ; REM
    DEFW    EDIT                        ;2f8c  22 40       ; EDIT
    DEFW    BREAK$                      ;2f8e  a0 16       ; STOP
    DEFW    CONT                        ;2f90  07 22       ; CONT
    DEFW    CLS                         ;2f92  42 1b       ; CLS
    DEFW    CLEAR                       ;2f94  ab 33       ; CLEAR
    DEFW    ON                          ;2f96  72 43       ; ON
    DEFW    LET                         ;2f98  1c 1b       ; LET
    DEFW    START                       ;2f9a  3d 14       ; START
    DEFW    POKE                        ;2f9c  23 1b       ; POKE
    DEFW    OFF                         ;2f9e  da 20       ; OFF
    DEFW    WHILE                       ;2fa0  b2 41       ; WHILE
    DEFW    WEND                        ;2fa2  df 41       ; WEND
    DEFW    REPEAT                      ;2fa4  44 42       ; REPEAT
    DEFW    UNTIL                       ;2fa6  3e 41       ; UNTIL ; A0H
    DEFW    TRACE                       ;2fa8  9b 32       ; TRACE
    DEFW    OK                          ;2faa  62 14       ; END
    DEFW    PLAY                        ;2fac  8c 47       ; PLAY
    DEFW    BEEPOP                      ;2fae  48 47       ; BEEP
    DEFW    DEFINT                      ;2fb0  30 29       ; DEFINT
    DEFW    DEFSNG                      ;2fb2  38 29       ; DEFSNG
    DEFW    DEFDBL                      ;2fb4  3c 29       ; DEFDBL
    DEFW    DEFSTR                      ;2fb6  34 29       ; DEFSTR
    DEFW    DEFFN                       ;2fb8  4d 3b       ; DEF
    DEFW    DUMP                        ;2fba  2f 3d       ; DUMP
    DEFW    LOAD                        ;2fbc  2c 39       ; LOAD
    DEFW    SAVE$                       ;2fbe  bb 3a       ; SAVE
    DEFW    MERGE                       ;2fc0  19 39       ; MERGE
    DEFW    NINS                        ;2fc2  fa 20       ; CONSOLE/WIDTH
    DEFW    OUT                         ;2fc4  67 33       ; OUT
    DEFW    SEARCH                      ;2fc6  2b 32       ; SEARCH ; B0H
    DEFW    SOUND                       ;2fc8  22 47       ;SOUND
    DEFW    NINS                        ;2fca  fa 20       ; WRITE
    DEFW    SWAP                        ;2fcc  ef 32       ; SWAP
    DEFW    NINS                        ;2fce  fa 20       ; ERASE
    DEFW    ERTEST                      ;2fd0  14 1b       ; ERROR
    DEFW    RESUME                      ;2fd2  4f 22       ; RESUME
    DEFW    RENUM                       ;2fd4  aa 37       ; RENUM
    DEFW    REM                         ;2fd6  3a 18       ; ELSE
    DEFW    CALLUP                      ;2fd8  74 29       ; CALL
    DEFW    LOCATE                      ;2fda  25 1c       ; LOCATE
    DEFW    NINS                        ;2fdc  fa 20       ; MAT
    DEFW    MONOP                       ;2fde  50 04       ; MON
    DEFW    HCOPY                       ;2fe0  d3 50       ; HCOPY
    DEFW    KEY                         ;2fe2  75 3e       ; KEY
    DEFW    VPUSH                       ;2fe4  6d 44       ; PUSH
    DEFW    VPOP                        ;2fe6  b4 44       ; POP ; C0H
    DEFW    NINS                        ;2fe8  fa 20       ;BASE
    DEFW    DATA                        ;2fea  c8 1c       ; LABEL
    DEFW    NINS                        ;2fec  fa 20       ; RANDOMIZE
    DEFW    SCREEN                      ;2fee  59 1b       ;SCREEN
    DEFW    LINE                        ;2ff0  e7 1c       ; LINE
    DEFW    COLOR                       ;2ff2  e9 47       ; COLOR
    DEFW    PSET                        ;2ff4  03 48       ; PSET
    DEFW    PRESET                      ;2ff6  fa 47       ; PRESET
    DEFW    GSAVES                      ;2ff8  ea 1b       ;CGINIT
    DEFW    PATTEN                      ;2ffa  28 50       ;PATTERN
    DEFW    CIRCLE                      ;2ffc  de 4b       ;CIRCLE
    DEFW    PAINT                       ;2ffe  c1 4e       ; PAINT
    DEFW    ROPEN                       ;3000  f4 38       ; ROPEN
    DEFW    WOPEN                       ;3002  51 3a       ; WOPEN
    DEFW    CLOSE                       ;3004  82 33       ; CLOSE
                  ;DEFW	NINS	; FILES
                  ;DEFW	NINS	; RENAME
                  ;DEFW	NINS	; KILL
                  ;DEFW	NINS	; LSET
                  ;DEFW	NINS	; RSET
                  ;DEFW	NINS	; FORMAT
                  ;DEFW	NINS	; INIT
                  ;DEFW	NINS	; CHAIN
                  ;DEFW	NINS	; PEN
                  ;DEFW	NINS	; COM
                  ;DEFW	NINS	; PAUSE ; DEH
                  ;
FJPTBL: DEFW    INTG                    ;3006  8d 29       ; INT 81H
    DEFW    RESNHL                      ;3008  c0 6b       ; ABS
    DEFW    B_SIN                       ;300a  57 75       ; SIN
    DEFW    B_COS                       ;300c  45 75       ; COS
    DEFW    B_TAN                       ;300e  46 76       ; TAN
    DEFW    B_LOG                       ;3010  bd 78       ; LOG 078bdh
    DEFW    B_EXP                       ;3012  ca 77       ; EXP
    DEFW    B_SQR                       ;3014  b9 73       ; SQR
    DEFW    B_RND                       ;3016  99 77       ; RND
    DEFW    PEEK                        ;3018  14 2a       ; PEEK
    DEFW    B_ATN                       ;301a  77 74       ; ATN
    DEFW    B_SGN                       ;301c  52 77       ; SGN
    DEFW    FRACSB                      ;301e  0e 2a       ; FRAC
    DEFW    INT                         ;3020  10 60       ; FIX
    DEFW    B_PAI                       ;3022  6f 77       ; PAI   776fh
    DEFW    B_RAD                       ;3024  6a 77       ; RAD 90H 776ah
    DEFW    B_INP                       ;3026  88 77       ; INP   7788h
    DEFW    CDBL                        ;3028  21 2b       ; CDBL
    DEFW    CSNG                        ;302a  26 2b       ; CSNG
    DEFW    CINT                        ;302c  5a 2b       ; CINT
    DEFW    NINS                        ;302e  fa 20       ; DSKF
    DEFW    NINS                        ;3030  fa 20       ; EOF
    DEFW    NINS                        ;3032  fa 20       ; FPOS
    DEFW    NINS                        ;3034  fa 20       ; LOC
    DEFW    NINS                        ;3036  fa 20       ; LOF
    DEFW    POS                         ;3038  4f 37       ; POS
    DEFW    LPOS                        ;303a  4a 37       ; LPOS
    DEFW    B_FACG                      ;303c  2b 74       ; FAC
    DEFW    B_SUM                       ;303e  09 74       ; SUM
    DEFW    NINS                        ;3040  fa 20       ; REV
    DEFW    NINS                        ;3042  fa 20       ; DUMMY
    DEFW    CHRSUB                      ;3044  74 28       ; CHR$ A0H
    DEFW    STRSUB                      ;3046  53 2a       ; STR$
    DEFW    HEXD                        ;3048  26 2a       ; HEX$
    DEFW    OCTD                        ;304a  42 2a       ; OCT$
    DEFW    MK1                         ;304c  75 2a       ; MK1$
    DEFW    MKS                         ;304e  88 2a       ; MKS$
    DEFW    MKD                         ;3050  8e 2a       ; MKD$
    DEFW    SPCSUB                      ;3052  e8 29       ; SPACE$
    DEFW    SPCSUB                      ;3054  e8 29       ; SPC
    DEFW    ASCSUB                      ;3056  d6 27       ; ASC A9H
    DEFW    LENSUB                      ;3058  cb 27       ; LEN
    DEFW    VALSUB                      ;305a  f9 27       ; VAL
    DEFW    CVS                         ;305c  cf 2a       ; CVS
    DEFW    CVD                         ;305e  ca 2a       ; CVD
    DEFW    CVI                         ;3060  aa 2a       ; CVI
    DEFW    NINS                        ;3062  fa 20       ; STAT
    DEFW    PARI                        ;3064  f5 2a       ; PARITY
    DEFW    NINS                        ;3066  fa 20       ; 
    DEFW    LEFT1                       ;3068  80 2b       ; LEFT$ (CVI)
    DEFW    RIGHT1                      ;306a  d4 2b       ; RIGHT$
    DEFW    MID                         ;306c  0f 2c       ; MID$
    DEFW    INKEY                       ;306e  28 28       ; INKEY$
    DEFW    INSTR                       ;3070  7a 2c       ; INSTR
    DEFW    FRE                         ;3072  1e 2d       ; FRE
    DEFW    MEM$                        ;3074  6b 2d       ; MEM$
    DEFW    SCRN$                       ;3076  c4 3c       ; SCRN
    DEFW    VARPTR                      ;3078  40 2d       ; VARPTR
    DEFW    STRING                      ;307a  b8 29       ; STRING$
    DEFW    NINS                        ;307c  fa 20       ; TIME$
    DEFW    FNOPR                       ;307e  f4 3b       ;
    DEFW    USROPR                      ;3080  78 3c       ; USR
    DEFW    ERR                         ;3082  58 37       ; ERR
    DEFW    ERL                         ;3084  72 37       ; ERL
    DEFW    CSRLIN                      ;3086  e8 3e       ; CSRLIN
                  ;
                  ;
DFTABL: DEFS    26                      ;3088              
                  ;
USRTBL: DEFS    20                      ;30a2              
                  ;
ADHLHL: ADD HL,HL                       ;30b6  29          
    RET NC                              ;30b7  d0          
OVERFL: LD  A,6                         ;30b8  3e 06       
    JP  ERROR                           ;30ba  c3 96 21    
                  ;
CVBCAS: PUSH    HL                      ;30bd  e5          
    CALL    HEXCUL                      ;30be  cd d0 30    
    LD  C,L                             ;30c1  4d          
    LD  B,H                             ;30c2  44          
    DEC DE                              ;30c3  1b          
    DEC DE                              ;30c4  1b          
    POP HL                              ;30c5  e1          
CVBABS: LD  A,(DE)                      ;30c6  1a          
    CP  020h                            ;30c7  fe 20       
    JR  NZ,INCRTM                       ;30c9  20 03       
    DEC DE                              ;30cb  1b          
    JR  CVBABS                          ;30cc  18 f8       
                  ;
INCRTM: INC DE                          ;30ce  13          
    RET                                 ;30cf  c9          
                  ;
HEXCUL: LD  HL,00000h                   ;30d0  21 00 00    
LNOCLP: CALL    DEFTCH                  ;30d3  cd 51 5d    
    SUB 030h                            ;30d6  d6 30       
    RET C                               ;30d8  d8          
    CP  00Ah                            ;30d9  fe 0a       
    RET NC                              ;30db  d0          
    CALL    ADHLHL                      ;30dc  cd b6 30    
    LD  C,L                             ;30df  4d          
    LD  B,H                             ;30e0  44          
    CALL    ADHLHL                      ;30e1  cd b6 30    
    CALL    ADHLHL                      ;30e4  cd b6 30    
    ADD HL,BC                           ;30e7  09          
    JR  C,OVERFL                        ;30e8  38 ce       
    LD  C,A                             ;30ea  4f          
    LD  B,0                             ;30eb  06 00       
    ADD HL,BC                           ;30ed  09          
    JR  C,OVERFL                        ;30ee  38 c8       
    JR  LNOCLP                          ;30f0  18 e1       
                  ;
EDITOR: CALL    CLR                     ;30f2  cd 51 19    
    XOR A                               ;30f5  af          
    LD  (CONTFG),A                      ;30f6  32 08 22    
    LD  (ERRORF),A                      ;30f9  32 50 22    
    CALL    RETLNO                      ;30fc  cd 0a 3f    
    CALL    HEXCUL                      ;30ff  cd d0 30    
    LD  (EDLINE),HL                     ;3102  22 2a 37    
    ADD A,030h                          ;3105  c6 30       
    DEC DE                              ;3107  1b          
    JR  Z,DELMIK                        ;3108  28 0f       
    DEC DE                              ;310a  1b          
RSFGLP: LD  A,(DE)                      ;310b  1a          
    CP  020h                            ;310c  fe 20       
    DEC DE                              ;310e  1b          
    JR  Z,RSFGLP                        ;310f  28 fa       
    INC DE                              ;3111  13          
    INC DE                              ;3112  13          
    LD  A,(DE)                          ;3113  1a          
    CP  020h                            ;3114  fe 20       
    JR  NZ,DELMIK                       ;3116  20 01       
    INC DE                              ;3118  13          
DELMIK: PUSH    HL                      ;3119  e5          
    PUSH    AF                          ;311a  f5          
    LD  HL,IMDBUF                       ;311b  21 4e 7b    
    CALL    CVIMTX                      ;311e  cd 25 63    
    LD  (IMLSTP),HL                     ;3121  22 2f 31    
    POP AF                              ;3124  f1          
    POP HL                              ;3125  e1          
    LD  E,L                             ;3126  5d          
    LD  D,H                             ;3127  54          
    CALL    DELETE1                     ;3128  cd a5 31    
    OR  A                               ;312b  b7          
    RET Z                               ;312c  c8          
    PUSH    HL                          ;312d  e5          
    DEFB    021H                        ;312e  21          ; LD HL,?
IMLSTP: DEFS    2                       ;312f              
    LD  DE,IMDBUF                       ;3131  11 4e 7b    
    OR  A                               ;3134  b7          
    SBC HL,DE                           ;3135  ed 52       
    INC HL                              ;3137  23          
    INC HL                              ;3138  23          
    INC HL                              ;3139  23          
    INC HL                              ;313a  23          
    INC HL                              ;313b  23          
    EX  (SP),HL                         ;313c  e3          
    LD  C,L                             ;313d  4d          
    LD  B,H                             ;313e  44          
    LD  HL,TEXTST                       ;313f  21 4e 7c    
    JR  IMDENS                          ;3142  18 04       
                  ;
ENOSLP: LD  E,(HL)                      ;3144  5e          
    INC HL                              ;3145  23          
    LD  D,(HL)                          ;3146  56          
    EX  DE,HL                           ;3147  eb          
IMDENS: LD  E,(HL)                      ;3148  5e          
    INC HL                              ;3149  23          
    LD  D,(HL)                          ;314a  56          
    DEC HL                              ;314b  2b          
    LD  A,D                             ;314c  7a          
    OR  E                               ;314d  b3          
    JR  Z,EAPEND                        ;314e  28 0e       
    INC HL                              ;3150  23          
    INC HL                              ;3151  23          
    LD  E,(HL)                          ;3152  5e          
    INC HL                              ;3153  23          
    LD  D,(HL)                          ;3154  56          
    EX  DE,HL                           ;3155  eb          
    SBC HL,BC                           ;3156  ed 42       
    DEC DE                              ;3158  1b          
    DEC DE                              ;3159  1b          
    DEC DE                              ;315a  1b          
    EX  DE,HL                           ;315b  eb          
    JR  C,ENOSLP                        ;315c  38 e6       
EAPEND: POP DE                          ;315e  d1          
    PUSH    BC                          ;315f  c5          ; L NO
    PUSH    HL                          ;3160  e5          ; INS POINTER
    PUSH    DE                          ;3161  d5          ; LENGTH
    EX  DE,HL                           ;3162  eb          
    LD  HL,(VSTART)                     ;3163  2a 3b 7a    
    PUSH    HL                          ;3166  e5          
    SBC HL,DE                           ;3167  ed 52       
    LD  C,L                             ;3169  4d          
    LD  B,H                             ;316a  44          
    POP HL                              ;316b  e1          
    POP DE                              ;316c  d1          
    PUSH    DE                          ;316d  d5          
    EX  DE,HL                           ;316e  eb          
    ADD HL,DE                           ;316f  19          
    CALL    HMEMCK                      ;3170  cd ab 1e    
    LD  (VSTART),HL                     ;3173  22 3b 7a    
    EX  DE,HL                           ;3176  eb          
    INC BC                              ;3177  03          
    LDDR                                ;3178  ed b8       
    POP BC                              ;317a  c1          ; LENGTH
    POP DE                              ;317b  d1          ; INS POINTER
    POP HL                              ;317c  e1          ; L NO
    PUSH    DE                          ;317d  d5          
    EX  DE,HL                           ;317e  eb          
    INC HL                              ;317f  23          
    INC HL                              ;3180  23          
    LD  (HL),E                          ;3181  73          
    INC HL                              ;3182  23          
    LD  (HL),D                          ;3183  72          
    INC HL                              ;3184  23          
    EX  DE,HL                           ;3185  eb          
    LD  HL,IMDBUF                       ;3186  21 4e 7b    
    PUSH    BC                          ;3189  c5          
    DEC BC                              ;318a  0b          
    DEC BC                              ;318b  0b          
    DEC BC                              ;318c  0b          
    DEC BC                              ;318d  0b          
    LDIR                                ;318e  ed b0       
    POP BC                              ;3190  c1          
    POP HL                              ;3191  e1          
    LD  (HL),E                          ;3192  73          
    INC HL                              ;3193  23          
    LD  (HL),D                          ;3194  72          
    EX  DE,HL                           ;3195  eb          
RELPTR: LD  E,(HL)                      ;3196  5e          
    INC HL                              ;3197  23          
    LD  D,(HL)                          ;3198  56          
    LD  A,D                             ;3199  7a          
    OR  E                               ;319a  b3          
    RET Z                               ;319b  c8          
    EX  DE,HL                           ;319c  eb          
    ADD HL,BC                           ;319d  09          
    EX  DE,HL                           ;319e  eb          
    LD  (HL),D                          ;319f  72          
    DEC HL                              ;31a0  2b          
    LD  (HL),E                          ;31a1  73          
    EX  DE,HL                           ;31a2  eb          
    JR  RELPTR                          ;31a3  18 f1       
                  ;
DELETE1: PUSH   AF                      ;31a5  f5          ; 315ah
    PUSH    BC                          ;31a6  c5          
    PUSH    HL                          ;31a7  e5          
    PUSH    DE                          ;31a8  d5          
    LD  C,L                             ;31a9  4d          
    LD  B,H                             ;31aa  44          
    LD  HL,TEXTST                       ;31ab  21 4e 7c    
FSTLOP: LD  E,(HL)                      ;31ae  5e          
    INC HL                              ;31af  23          
    LD  D,(HL)                          ;31b0  56          
    INC HL                              ;31b1  23          
    LD  A,E                             ;31b2  7b          
    OR  D                               ;31b3  b2          
    JR  NZ,FDDLST                       ;31b4  20 08       
RTDLTE: POP DE                          ;31b6  d1          
    POP HL                              ;31b7  e1          
    POP BC                              ;31b8  c1          
    POP AF                              ;31b9  f1          
    RET                                 ;31ba  c9          
                  ;
POPDLR: POP DE                          ;31bb  d1          
    JR  RTDLTE                          ;31bc  18 f8       
                  ;
FDDLST: PUSH    DE                      ;31be  d5          
    LD  E,(HL)                          ;31bf  5e          
    INC HL                              ;31c0  23          
    LD  D,(HL)                          ;31c1  56          
    EX  DE,HL                           ;31c2  eb          
    LD  (LNOTBF),HL                     ;31c3  22 d3 31    
    SBC HL,BC                           ;31c6  ed 42       
    POP HL                              ;31c8  e1          
    JR  C,FSTLOP                        ;31c9  38 e3       
    DEC DE                              ;31cb  1b          
    DEC DE                              ;31cc  1b          
    DEC DE                              ;31cd  1b          
    POP BC                              ;31ce  c1          ; DELETE END LINE NO.
    PUSH    BC                          ;31cf  c5          
    PUSH    DE                          ;31d0  d5          ; DELETE START ADRS
    PUSH    HL                          ;31d1  e5          ; NEXT LINE ADRS
    DEFB    021H                        ;31d2  21          ; LD HL,?
LNOTBF: DEFS    2                       ;31d3              
    SBC HL,BC                           ;31d5  ed 42       
    POP HL                              ;31d7  e1          
    JR  Z,DLSTRT                        ;31d8  28 1a       ; DEL-LINE END FOUND
    JR  NC,POPDLR                       ;31da  30 df       ; NOTHING OCCUR
SNDDLP: LD  E,(HL)                      ;31dc  5e          ; END S-LOOP
    INC HL                              ;31dd  23          
    LD  D,(HL)                          ;31de  56          
    INC HL                              ;31df  23          
    LD  A,D                             ;31e0  7a          
    OR  E                               ;31e1  b3          
    JR  Z,DLEFD'                        ;31e2  28 0e       
    PUSH    DE                          ;31e4  d5          
    LD  E,(HL)                          ;31e5  5e          
    INC HL                              ;31e6  23          
    LD  D,(HL)                          ;31e7  56          
    EX  DE,HL                           ;31e8  eb          
    SBC HL,BC                           ;31e9  ed 42       
    POP HL                              ;31eb  e1          
    JR  C,SNDDLP                        ;31ec  38 ee       
    JR  Z,DLSTRT                        ;31ee  28 04       
    EX  DE,HL                           ;31f0  eb          
    DEC HL                              ;31f1  2b          
DLEFD': DEC HL                          ;31f2  2b          
    DEC HL                              ;31f3  2b          
DLSTRT: POP DE                          ;31f4  d1          
    PUSH    DE                          ;31f5  d5          
    PUSH    HL                          ;31f6  e5          
    OR  A                               ;31f7  b7          
    SBC HL,DE                           ;31f8  ed 52       
    LD  C,L                             ;31fa  4d          
    LD  B,H                             ;31fb  44          
    POP HL                              ;31fc  e1          
    POP DE                              ;31fd  d1          
    PUSH    BC                          ;31fe  c5          
    PUSH    DE                          ;31ff  d5          
    PUSH    DE                          ;3200  d5          
    PUSH    HL                          ;3201  e5          
    EX  DE,HL                           ;3202  eb          
    LD  HL,(VSTART)                     ;3203  2a 3b 7a    
    OR  A                               ;3206  b7          
    SBC HL,DE                           ;3207  ed 52       
    LD  C,L                             ;3209  4d          
    LD  B,H                             ;320a  44          
    POP HL                              ;320b  e1          
    POP DE                              ;320c  d1          
    LDIR                                ;320d  ed b0       
    EX  DE,HL                           ;320f  eb          
    LD  (VSTART),HL                     ;3210  22 3b 7a    
    CALL    CLR                         ;3213  cd 51 19    
    POP HL                              ;3216  e1          
    POP BC                              ;3217  c1          
DRNLOP: LD  E,(HL)                      ;3218  5e          
    INC HL                              ;3219  23          
    LD  D,(HL)                          ;321a  56          
    LD  A,D                             ;321b  7a          
    OR  E                               ;321c  b3          
    JP  Z,RTDLTE                        ;321d  ca b6 31    
    EX  DE,HL                           ;3220  eb          
    OR  A                               ;3221  b7          
    SBC HL,BC                           ;3222  ed 42       
    EX  DE,HL                           ;3224  eb          
    LD  (HL),D                          ;3225  72          
    DEC HL                              ;3226  2b          
    LD  (HL),E                          ;3227  73          
    EX  DE,HL                           ;3228  eb          
    JR  DRNLOP                          ;3229  18 ed       
                  ;
                  ;
                  ;	CHAIN	,LIST
                  ;
                  ;   LIST
                  ;
SEARCH: XOR A                           ;322b  af          
    LD  (DISFLG),A                      ;322c  32 eb 11    
    CALL    HLFTCH                      ;322f  cd 87 29    
    CP  023h                            ;3232  fe 23       
    JR  NZ,SEARC'                       ;3234  20 06       
    LD  A,2                             ;3236  3e 02       
    LD  (DISFLG),A                      ;3238  32 eb 11    
    INC HL                              ;323b  23          
SEARC': CALL    STREXZ                  ;323c  cd 9b 45    
    OR  A                               ;323f  b7          
    JP  Z,IFCALL                        ;3240  ca 36 17    
    PUSH    BC                          ;3243  c5          
    LD  (SERLEN),A                      ;3244  32 90 32    
    LD  (MATLEN),A                      ;3247  32 62 32    
    LD  (SERDEB),DE                     ;324a  ed 53 95 32 
    LD  (MARDEB),DE                     ;324e  ed 53 5c 32 
    CALL    SLIST                       ;3252  cd 50 40    
    POP HL                              ;3255  e1          
    DEC HL                              ;3256  2b          
    RET                                 ;3257  c9          
                  ;
SERVEC: PUSH    DE                      ;3258  d5          
    PUSH    HL                          ;3259  e5          
    LD  B,A                             ;325a  47          
    DEFB    021H                        ;325b  21          ; LD HL,?
MARDEB: DEFS    2                       ;325c              
    CP  (HL)                            ;325e  be          
    JR  NZ,SERNMT                       ;325f  20 11       
    DEFB    03EH                        ;3261  3e          ; LD A,?
MATLEN: DEFS    1                       ;3262              
    DEC A                               ;3263  3d          
    LD  (MATLEN),A                      ;3264  32 62 32    
    JR  Z,MATLIS                        ;3267  28 0e       
    INC HL                              ;3269  23          
    LD  (MARDEB),HL                     ;326a  22 5c 32    
SERRTT: POP HL                          ;326d  e1          
    POP DE                              ;326e  d1          
    JP  CTIRTR                          ;326f  c3 00 41    
                  ;
SERNMT: CALL    SERINT                  ;3272  cd 8f 32    
    JR  SERRTT                          ;3275  18 f6       
                  ;
MATLIS: DEFB    011H                    ;3277  11          ; LD DE,?
SERDIS: DEFS    2                       ;3278              
SERLPP: LD  A,(DE)                      ;327a  1a          
    OR  A                               ;327b  b7          
    JR  Z,ESSRSP                        ;327c  28 06       
    CALL    ACCPRT                      ;327e  cd 64 08    
    INC DE                              ;3281  13          
    JR  SERLPP                          ;3282  18 f6       
                  ;
ESSRSP: CALL    CR2                     ;3284  cd 23 08    
    JR  SERRTT                          ;3287  18 e4       
                  ;
SER0DH: CALL    SERINT                  ;3289  cd 8f 32    
    JP  LISCRC                          ;328c  c3 11 41    
                  ;
SERINT: DEFB    03EH                    ;328f  3e          ; LD A,?
SERLEN: DEFS    1                       ;3290              
    LD  (MATLEN),A                      ;3291  32 62 32    
    DEFB    021H                        ;3294  21          ; LD HL,?
SERDEB: DEFS    2                       ;3295              
    LD  (MARDEB),HL                     ;3297  22 5c 32    
    RET                                 ;329a  c9          
                  ;
TRACE:  CALL    HLFTCH                  ;329b  cd 87 29    
    OR  A                               ;329e  b7          
    JR  Z,TROFF                         ;329f  28 49       
    CP  03Ah                            ;32a1  fe 3a       
    JR  Z,TROFF                         ;32a3  28 45       
    CALL    STREXZ                      ;32a5  cd 9b 45    
    LD  A,(HL)                          ;32a8  7e          
    OR  A                               ;32a9  b7          
    JR  Z,TRCOFF                        ;32aa  28 38       
    PUSH    BC                          ;32ac  c5          
    INC HL                              ;32ad  23          
    LD  B,A                             ;32ae  47          
    CALL    INDRCT                      ;32af  cd a3 2a    
    CALL    TROFF                       ;32b2  cd ea 32    
    EX  DE,HL                           ;32b5  eb          
    LD  HL,TRACEF                       ;32b6  21 29 16    
TRLTPR: LD  A,(DE)                      ;32b9  1a          
    CP  048h                            ;32ba  fe 48       ; HOME?
    JR  NZ,TRACL0                       ;32bc  20 02       
    SET 0,(HL)                          ;32be  cb c6       
TRACL0: CP  050h                        ;32c0  fe 50       
    JR  NZ,TRACL1                       ;32c2  20 02       ; PRINTER?
    SET 1,(HL)                          ;32c4  cb ce       
TRACL1: CP  04Eh                        ;32c6  fe 4e       ; NUMBER?
    JR  NZ,TRACL2                       ;32c8  20 02       
    SET 2,(HL)                          ;32ca  cb d6       
TRACL2: CP  04Ch                        ;32cc  fe 4c       ; LIST?
    JR  NZ,TRACL3                       ;32ce  20 02       
    SET 3,(HL)                          ;32d0  cb de       
TRACL3: CP  053h                        ;32d2  fe 53       ; STEP?
    JR  NZ,TRACL4                       ;32d4  20 02       
    SET 4,(HL)                          ;32d6  cb e6       
TRACL4: CP  044h                        ;32d8  fe 44       ; DUMP?
    JR  NZ,TRACLP                       ;32da  20 02       
    SET 5,(HL)                          ;32dc  cb ee       
TRACLP: INC DE                          ;32de  13          
    DJNZ    TRLTPR                      ;32df  10 d8       
    POP BC                              ;32e1  c1          
    JR  RTTRAC                          ;32e2  18 03       
                  ;
TRCOFF: CALL    TROFF                   ;32e4  cd ea 32    
RTTRAC: JP  RETIRQ                      ;32e7  c3 39 1b    
                  ;
TROFF:  XOR A                           ;32ea  af          
    LD  (TRACEF),A                      ;32eb  32 29 16    
    RET                                 ;32ee  c9          
                  ;
SWAP:   LD  C,L                         ;32ef  4d          
    LD  B,H                             ;32f0  44          
    CALL    GETVAC                      ;32f1  cd d3 1e    
    PUSH    HL                          ;32f4  e5          
    PUSH    AF                          ;32f5  f5          
    CALL    BCFTCH                      ;32f6  cd c4 25    
    CALL    CH2CH                       ;32f9  cd 61 2d    
    CALL    GETVAC                      ;32fc  cd d3 1e    
    POP DE                              ;32ff  d1          
    CP  D                               ;3300  ba          
    JP  NZ,TYPEMS                       ;3301  c2 32 17    
    POP DE                              ;3304  d1          
    PUSH    AF                          ;3305  f5          
    PUSH    BC                          ;3306  c5          
    LD  B,A                             ;3307  47          
    LD  C,B                             ;3308  48          
    PUSH    HL                          ;3309  e5          
    PUSH    DE                          ;330a  d5          
    LD  (SWAPHL),DE                     ;330b  ed 53 49 33 
    LD  HL,ZFAC                         ;330f  21 f2 62    
SWTRL1: LD  A,(DE)                      ;3312  1a          
    LD  (HL),A                          ;3313  77          
    INC HL                              ;3314  23          
    INC DE                              ;3315  13          
    DJNZ    SWTRL1                      ;3316  10 fa       
    POP DE                              ;3318  d1          
    POP HL                              ;3319  e1          
    PUSH    HL                          ;331a  e5          
    PUSH    BC                          ;331b  c5          
    LDIR                                ;331c  ed b0       
    POP BC                              ;331e  c1          
    POP DE                              ;331f  d1          
    PUSH    DE                          ;3320  d5          
    LD  HL,ZFAC                         ;3321  21 f2 62    
    LDIR                                ;3324  ed b0       
    POP DE                              ;3326  d1          
    POP HL                              ;3327  e1          
    POP AF                              ;3328  f1          
    CP  003h                            ;3329  fe 03       
    RET NZ                              ;332b  c0          
    PUSH    HL                          ;332c  e5          ; TEXT POINT
    EX  DE,HL                           ;332d  eb          
    LD  A,(HL)                          ;332e  7e          
    OR  A                               ;332f  b7          
    JR  Z,NXTSAS                        ;3330  28 16       
    LD  E,L                             ;3332  5d          
    LD  D,H                             ;3333  54          
    INC HL                              ;3334  23          
    CALL    INDRCT                      ;3335  cd a3 2a    
    PUSH    DE                          ;3338  d5          
    EX  DE,HL                           ;3339  eb          
    LD  HL,(STRPTR)                     ;333a  2a 3d 7a    
    OR  A                               ;333d  b7          
    SBC HL,DE                           ;333e  ed 52       
    EX  DE,HL                           ;3340  eb          
    POP DE                              ;3341  d1          
    JR  NC,NXTSAS                       ;3342  30 04       
    DEC HL                              ;3344  2b          
    LD  (HL),H                          ;3345  74          
    DEC HL                              ;3346  2b          
    LD  (HL),L                          ;3347  75          
NXTSAS: DEFB    021H                    ;3348  21          
SWAPHL: DEFS    2                       ;3349              
    LD  A,(HL)                          ;334b  7e          
    OR  A                               ;334c  b7          
    JR  Z,NXTSAW                        ;334d  28 16       
    LD  E,L                             ;334f  5d          
    LD  D,H                             ;3350  54          
    INC HL                              ;3351  23          
    CALL    INDRCT                      ;3352  cd a3 2a    
    PUSH    DE                          ;3355  d5          
    EX  DE,HL                           ;3356  eb          
    LD  HL,(STRPTR)                     ;3357  2a 3d 7a    
    OR  A                               ;335a  b7          
    SBC HL,DE                           ;335b  ed 52       
    EX  DE,HL                           ;335d  eb          
    POP DE                              ;335e  d1          
    JR  NC,NXTSAW                       ;335f  30 04       
    DEC HL                              ;3361  2b          
    LD  (HL),H                          ;3362  74          
    DEC HL                              ;3363  2b          
    LD  (HL),L                          ;3364  75          
NXTSAW: POP HL                          ;3365  e1          
    RET                                 ;3366  c9          
                  ;
OUT:    LD  C,L                         ;3367  4d          
    LD  B,H                             ;3368  44          
    CALL    IHLEXP                      ;3369  cd cc 22    
    CALL    CH2CH                       ;336c  cd 61 2d    
    LD  (OPORT),HL                      ;336f  22 7a 33    
    CALL    IHLEXP                      ;3372  cd cc 22    
    CALL    HCHECK                      ;3375  cd d8 22    
    PUSH    BC                          ;3378  c5          
    DEFB    001H                        ;3379  01          ;LD BC,OPOR
OPORT:  DEFW    00000H                  ;337a  00 00       
    OUT (C),A                           ;337c  ed 79       
    POP BC                              ;337e  c1          
    JP  RETIRQ                          ;337f  c3 39 1b    
                  ;
CLOSE:  DEFB    03EH                    ;3382  3e          ; LD A,?
FILEFG: DEFS    1                       ;3383              
    CP  2                               ;3384  fe 02       
    LD  A,0                             ;3386  3e 00       
    LD  (FILEFG),A                      ;3388  32 83 33    
    JR  NZ,CLSINP                       ;338b  20 10       
    LD  A,00Dh                          ;338d  3e 0d       
    CALL    CTOUT                       ;338f  cd 58 45    
    XOR A                               ;3392  af          
    CALL    CTOUT                       ;3393  cd 58 45    
    XOR A                               ;3396  af          
    CALL    CTOUT                       ;3397  cd 58 45    
    CALL    CTCLOS                      ;339a  cd 86 45    
CLSINP: PUSH    HL                      ;339d  e5          
    LD  HL,LININP                       ;339e  21 93 15    
    LD  (LODVEC),HL                     ;33a1  22 9d 14    
    POP HL                              ;33a4  e1          
    LD  A,001h                          ;33a5  3e 01       
    LD  (DISFLG),A                      ;33a7  32 eb 11    
    RET                                 ;33aa  c9          
                  ;
CLEAR:  CALL    HLFTCH                  ;33ab  cd 87 29    
    OR  A                               ;33ae  b7          
    JP  Z,CLR                           ;33af  ca 51 19    
    CP  03Ah                            ;33b2  fe 3a       
    JP  Z,CLR                           ;33b4  ca 51 19    
    LD  C,L                             ;33b7  4d          
    LD  B,H                             ;33b8  44          
    CALL    IHLEXP                      ;33b9  cd cc 22    
    PUSH    HL                          ;33bc  e5          
    LD  DE,(MEMMAX)                     ;33bd  ed 5b 49 7a 
    SCF                                 ;33c1  37          
    SBC HL,DE                           ;33c2  ed 52       
    JP  NC,OMERR                        ;33c4  d2 88 21    
    LD  DE,(VSTART)                     ;33c7  ed 5b 3b 7a 
    LD  HL,00800h                       ;33cb  21 00 08    
    ADD HL,DE                           ;33ce  19          
                  
    POP DE                              ;33cf  d1          
    PUSH    DE                          ;33d0  d5          
    OR  A                               ;33d1  b7          
    SBC HL,DE                           ;33d2  ed 52       
    JP  NC,OMERR                        ;33d4  d2 88 21    
    POP HL                              ;33d7  e1          
    CALL    MEMSET                      ;33d8  cd e9 33    
    LD  SP,(STRTOP)                     ;33db  ed 7b 41 7a 
    LD  DE,0FFFFh                       ;33df  11 ff ff    
    PUSH    DE                          ;33e2  d5          
    LD  L,C                             ;33e3  69          
    LD  H,B                             ;33e4  60          
    DEC HL                              ;33e5  2b          
    JP  ONELIN                          ;33e6  c3 db 14    
                  ;
MEMSET: LD  (MEMEND),HL                 ;33e9  22 47 7a    
    LD  DE,00010h                       ;33ec  11 10 00    
    OR  A                               ;33ef  b7          
    SBC HL,DE                           ;33f0  ed 52       
    LD  (MEMFAC),HL                     ;33f2  22 f4 22    
    LD  DE,000F1h                       ;33f5  11 f1 00    
    SBC HL,DE                           ;33f8  ed 52       
    LD  (INTSSP),HL                     ;33fa  22 43 7a    
    LD  DE,00007h                       ;33fd  11 07 00    
    SBC HL,DE                           ;3400  ed 52       
    LD  (INTFAC),HL                     ;3402  22 4b 7a    
    LD  DE,JT9                          ;3405  11 18 00    
    SBC HL,DE                           ;3408  ed 52       
    LD  (STRBTM),HL                     ;340a  22 45 7a    
    JP  CLR                             ;340d  c3 51 19    
                  ;
USING:  CALL    STREXX                  ;3410  cd 9d 45    
    DEC BC                              ;3413  0b          
    CALL    BCFTCH                      ;3414  cd c4 25    
    CP  02Ch                            ;3417  fe 2c       
    JR  Z,OKLIOP                        ;3419  28 05       
    CP  03Bh                            ;341b  fe 3b       
    JP  NZ,SERROR                       ;341d  c2 3a 17    
OKLIOP: LD  A,(HL)                      ;3420  7e          
    CP  019h                            ;3421  fe 19       
USGIFC: JP  NC,IFCALL                   ;3423  d2 36 17    
    OR  A                               ;3426  b7          
    JR  Z,USGIFC                        ;3427  28 fa       
    INC HL                              ;3429  23          
    CALL    INDRCT                      ;342a  cd a3 2a    
    LD  DE,USINGB                       ;342d  11 b1 46    
    PUSH    BC                          ;3430  c5          
    LD  C,A                             ;3431  4f          
    LD  B,000h                          ;3432  06 00       
    LDIR                                ;3434  ed b0       
    POP BC                              ;3436  c1          
    XOR A                               ;3437  af          
    LD  (DE),A                          ;3438  12          
    INC DE                              ;3439  13          
    LD  (DE),A                          ;343a  12          
IUSGLP: LD  DE,USINGB                   ;343b  11 b1 46    
    XOR A                               ;343e  af          
    LD  (PRTEDF),A                      ;343f  32 75 34    
USNGLP: LD  A,(DE)                      ;3442  1a          
    INC DE                              ;3443  13          
    OR  A                               ;3444  b7          
    JP  Z,USINED                        ;3445  ca 74 34    
    CP  0C4h                            ;3448  fe c4       
    JR  Z,PESCCH                        ;344a  28 38       
    CP  021h                            ;344c  fe 21       
    JP  Z,PSFRST                        ;344e  ca 88 34    
    CP  026h                            ;3451  fe 26       
    JP  Z,PSMIDL                        ;3453  ca e9 34    
    CP  023h                            ;3456  fe 23       
    JP  Z,PFLENG                        ;3458  ca 81 35    
    CP  02Ah                            ;345b  fe 2a       
    JP  Z,ASTRSK                        ;345d  ca 34 35    
    CP  07Ch                            ;3460  fe 7c       
    JP  Z,VENUSG                        ;3462  ca 59 35    
    CP  02Eh                            ;3465  fe 2e       
    JP  Z,PRLEN?                        ;3467  ca 79 35    
    CP  02Bh                            ;346a  fe 2b       
    JP  Z,PLUSUS                        ;346c  ca 6b 35    
PUTCHS: CALL    ACCPRT                  ;346f  cd 64 08    
    JR  USNGLP                          ;3472  18 ce       
                  ;
USINED: DEFB    03EH                    ;3474  3e          ; LD A,?
PRTEDF: DEFS    1                       ;3475              
    OR  A                               ;3476  b7          
    JP  Z,IFCALL                        ;3477  ca 36 17    
    LD  DE,USINGB                       ;347a  11 b1 46    
    XOR A                               ;347d  af          
    LD  (PRTEDF),A                      ;347e  32 75 34    
ESPUVC: DEFB    0C3H                    ;3481  c3          ; JP ?
URTVEC: DEFW    RETIRQ                  ;3482  39 1b       
                  ;
PESCCH: LD  A,(DE)                      ;3484  1a          
    INC DE                              ;3485  13          
    JR  PUTCHS                          ;3486  18 e7       
                  ;
PSFRST: PUSH    DE                      ;3488  d5          
    CALL    STREXX                      ;3489  cd 9d 45    
    CALL    CHCKRV                      ;348c  cd a2 34    
    POP DE                              ;348f  d1          
    LD  A,1                             ;3490  3e 01       
    LD  (PRTEDF),A                      ;3492  32 75 34    
    LD  A,(HL)                          ;3495  7e          
    OR  A                               ;3496  b7          
    LD  A,020h                          ;3497  3e 20       
    JR  Z,PUTCHS                        ;3499  28 d4       
    INC HL                              ;349b  23          
    CALL    INDRCT                      ;349c  cd a3 2a    
    LD  A,(HL)                          ;349f  7e          
    JR  PUTCHS                          ;34a0  18 cd       
                  ;
CHCKRV: DEC BC                          ;34a2  0b          
    LD  A,(BC)                          ;34a3  0a          
    INC BC                              ;34a4  03          
    CP  03Bh                            ;34a5  fe 3b       
    JR  Z,USGCON                        ;34a7  28 0a       
    CP  02Ch                            ;34a9  fe 2c       
    JR  Z,USGCMN                        ;34ab  28 1a       
    PUSH    HL                          ;34ad  e5          
    LD  HL,CRRTIR                       ;34ae  21 e3 34    
    JR  PTPURV                          ;34b1  18 0f       
                  ;
USGCON: CALL    BCFTCH                  ;34b3  cd c4 25    
    OR  A                               ;34b6  b7          
    JR  Z,PUSEMR                        ;34b7  28 24       
    CP  03Ah                            ;34b9  fe 3a       
    JR  Z,PUSEMR                        ;34bb  28 20       
MGFDXZ: DEC BC                          ;34bd  0b          
    PUSH    HL                          ;34be  e5          
    LD  HL,USNGLP                       ;34bf  21 42 34    
PTPURV: LD  (URTVEC),HL                 ;34c2  22 82 34    
    POP HL                              ;34c5  e1          
    RET                                 ;34c6  c9          
                  ;
USGCMN: CALL    BCFTCH                  ;34c7  cd c4 25    
    OR  A                               ;34ca  b7          
    JR  Z,PUCHRA                        ;34cb  28 04       
    CP  03Ah                            ;34cd  fe 3a       
    JR  NZ,MGFDXZ                       ;34cf  20 ec       
PUCHRA: PUSH    HL                      ;34d1  e5          
    LD  HL,PULSC#                       ;34d2  21 d7 34    
    JR  PTPURV                          ;34d5  18 eb       
                  ;
PULSC#: CALL    TABPRT                  ;34d7  cd 02 08    
    JP  RETIRQ                          ;34da  c3 39 1b    
                  ;
PUSEMR: PUSH    HL                      ;34dd  e5          
    LD  HL,RETIRQ                       ;34de  21 39 1b    
    JR  PTPURV                          ;34e1  18 df       
                  ;
CRRTIR: CALL    CR1                     ;34e3  cd 43 08    
    JP  RETIRQ                          ;34e6  c3 39 1b    
                  ;
PSMIDL: LD  H,1                         ;34e9  26 01       
COUUSP: LD  A,(DE)                      ;34eb  1a          
    INC H                               ;34ec  24          
    INC DE                              ;34ed  13          
    CP  026h                            ;34ee  fe 26       
    JR  Z,ESCCSP                        ;34f0  28 07       
    CP  020h                            ;34f2  fe 20       
    JR  Z,COUUSP                        ;34f4  28 f5       
    JP  IFCALL                          ;34f6  c3 36 17    
                  ;
ESCCSP: PUSH    DE                      ;34f9  d5          
    PUSH    HL                          ;34fa  e5          
    CALL    STREXX                      ;34fb  cd 9d 45    
    CALL    CHCKRV                      ;34fe  cd a2 34    
    POP AF                              ;3501  f1          
    CP  (HL)                            ;3502  be          
    PUSH    BC                          ;3503  c5          
    JR  NC,PRSPNE                       ;3504  30 16       
ZRPRUS: LD  B,A                         ;3506  47          
    INC HL                              ;3507  23          
    CALL    INDRCT                      ;3508  cd a3 2a    
USGMDL: LD  A,(HL)                      ;350b  7e          
    INC HL                              ;350c  23          
    CALL    ACCPRT                      ;350d  cd 64 08    
    DJNZ    USGMDL                      ;3510  10 f9       
RETIOE: POP BC                          ;3512  c1          
    POP DE                              ;3513  d1          
    LD  A,1                             ;3514  3e 01       
    LD  (PRTEDF),A                      ;3516  32 75 34    
    JP  USNGLP                          ;3519  c3 42 34    
                  ;
PRSPNE: JR  Z,ZRPRUS                    ;351c  28 e8       
    SUB (HL)                            ;351e  96          
    PUSH    AF                          ;351f  f5          
    LD  B,(HL)                          ;3520  46          
    INC HL                              ;3521  23          
    CALL    INDRCT                      ;3522  cd a3 2a    
USGMD': LD  A,(HL)                      ;3525  7e          
    INC HL                              ;3526  23          
    CALL    ACCPRT                      ;3527  cd 64 08    
    DJNZ    USGMD'                      ;352a  10 f9       
    POP BC                              ;352c  c1          
SPACPT: CALL    SPPRT                   ;352d  cd 62 08    
    DJNZ    SPACPT                      ;3530  10 fb       
    JR  RETIOE                          ;3532  18 de       
                  ;
ASTRSK: LD  A,(DE)                      ;3534  1a          
    CP  02Ah                            ;3535  fe 2a       
    LD  A,02Ah                          ;3537  3e 2a       
    JP  NZ,PUTCHS                       ;3539  c2 6f 34    
    LD  A,1                             ;353c  3e 01       
    LD  (PUASTF),A                      ;353e  32 c5 36    
    INC DE                              ;3541  13          
    LD  A,(DE)                          ;3542  1a          
    INC DE                              ;3543  13          
    LD  H,2                             ;3544  26 02       
    CP  07Ch                            ;3546  fe 7c       
    LD  A,0                             ;3548  3e 00       
    JR  NZ,PULSLS                       ;354a  20 3d       
    INC DE                              ;354c  13          
    INC H                               ;354d  24          
KIUYTJ: LD  A,1                         ;354e  3e 01       
    LD  (PUYENF),A                      ;3550  32 ae 36    
    XOR A                               ;3553  af          
    LD  (FPLUSF),A                      ;3554  32 80 36    
    JR  MIDFUS                          ;3557  18 33       
                  ;
VENUSG: LD  A,(DE)                      ;3559  1a          
    CP  07Ch                            ;355a  fe 7c       
    LD  A,07Ch                          ;355c  3e 7c       
    JP  NZ,PUTCHS                       ;355e  c2 6f 34    
    XOR A                               ;3561  af          
    LD  (PUASTF),A                      ;3562  32 c5 36    
    INC DE                              ;3565  13          
    INC DE                              ;3566  13          
    LD  H,2                             ;3567  26 02       
    JR  KIUYTJ                          ;3569  18 e3       
                  ;
PLUSUS: LD  A,1                         ;356b  3e 01       
    LD  (FPLUSF),A                      ;356d  32 80 36    
    XOR A                               ;3570  af          
    LD  (PUASTF),A                      ;3571  32 c5 36    
    INC DE                              ;3574  13          
    LD  H,1                             ;3575  26 01       
    JR  PULSLS                          ;3577  18 10       
                  ;
PRLEN?: LD  A,(DE)                      ;3579  1a          
    CP  023h                            ;357a  fe 23       
    LD  A,02Eh                          ;357c  3e 2e       
    JP  NZ,PUTCHS                       ;357e  c2 6f 34    
PFLENG: XOR A                           ;3581  af          
    LD  H,A                             ;3582  67          
    LD  (FPLUSF),A                      ;3583  32 80 36    
    LD  (PUASTF),A                      ;3586  32 c5 36    ; PUT *   FLG
PULSLS: LD  (PUYENF),A                  ;3589  32 ae 36    ;PUT * FLG
MIDFUS: LD  (PUAFMF),A                  ;358c  32 75 36    ;AFTER-FLG
    LD  (PUCOMF),A                      ;358f  32 31 36    ; PUT ,   FLG
    LD  (INTLEN),A                      ;3592  32 5d 36    ; INT LENGTH
    LD  (FRCLEN),A                      ;3595  32 21 36    ; FRAC LENGTH
    LD  (RPLUSF),A                      ;3598  32 7b 36    ; ###+
    LD  (PUEXPF),A                      ;359b  32 24 36    ; ^^^^
    DEC DE                              ;359e  1b          
PUGTFC: INC H                           ;359f  24          
    LD  A,(DE)                          ;35a0  1a          
    INC DE                              ;35a1  13          
    CP  023h                            ;35a2  fe 23       
    JR  Z,PUGTFC                        ;35a4  28 f9       
    CP  02Ch                            ;35a6  fe 2c       
    JR  NZ,PUCOMP                       ;35a8  20 07       
    LD  A,1                             ;35aa  3e 01       
    LD  (PUCOMF),A                      ;35ac  32 31 36    
    JR  PUGTFC                          ;35af  18 ee       
PUCOMP: CP  02Eh                        ;35b1  fe 2e       
    JR  Z,PUPOIT                        ;35b3  28 1e       
    CP  02Dh                            ;35b5  fe 2d       
    JR  NZ,PUAFMO                       ;35b7  20 08       
    LD  A,1                             ;35b9  3e 01       
    LD  (PUAFMF),A                      ;35bb  32 75 36    
    INC DE                              ;35be  13          
    JR  PUAFQO                          ;35bf  18 0a       
PUAFMO: CP  02Bh                        ;35c1  fe 2b       
    JR  NZ,PUAFQO                       ;35c3  20 06       
    LD  A,1                             ;35c5  3e 01       
    LD  (RPLUSF),A                      ;35c7  32 7b 36    
    INC DE                              ;35ca  13          
PUAFQO: DEC DE                          ;35cb  1b          
    DEC H                               ;35cc  25          
    LD  A,H                             ;35cd  7c          
    LD  (INTLEN),A                      ;35ce  32 5d 36    
    JR  BEGUSG                          ;35d1  18 1e       
                  ;
PUPOIT: DEC H                           ;35d3  25          
    LD  A,H                             ;35d4  7c          
    LD  (INTLEN),A                      ;35d5  32 5d 36    
    LD  H,1                             ;35d8  26 01       
PUPOFC: INC H                           ;35da  24          
    LD  A,(DE)                          ;35db  1a          
    INC DE                              ;35dc  13          
    CP  023h                            ;35dd  fe 23       
    JR  Z,PUPOFC                        ;35df  28 f9       
    CP  02Dh                            ;35e1  fe 2d       
    JR  NZ,PUCOPP                       ;35e3  20 06       
    LD  A,1                             ;35e5  3e 01       
    LD  (PUAFMF),A                      ;35e7  32 75 36    
    INC DE                              ;35ea  13          
PUCOPP: DEC DE                          ;35eb  1b          
    DEC H                               ;35ec  25          
    LD  A,H                             ;35ed  7c          
    LD  (FRCLEN),A                      ;35ee  32 21 36    
                  ;
BEGUSG: LD  (USGDEB),DE                 ;35f1  ed 53 05 37 
    PUSH    BC                          ;35f5  c5          
    LD  B,4                             ;35f6  06 04       
CHEXPU: LD  A,(DE)                      ;35f8  1a          
    INC DE                              ;35f9  13          
    CP  05Eh                            ;35fa  fe 5e       
    JR  NZ,NEXPPU                       ;35fc  20 0b       
    DJNZ    CHEXPU                      ;35fe  10 f8       
    LD  (USGDEB),DE                     ;3600  ed 53 05 37 
    LD  A,1                             ;3604  3e 01       
    LD  (PUEXPF),A                      ;3606  32 24 36    
NEXPPU: POP BC                          ;3609  c1          
    CALL    FLEXPR                      ;360a  cd 99 22    
    CALL    CHCKRV                      ;360d  cd a2 34    
    LD  (USGBCB),BC                     ;3610  ed 43 02 37 
    INC HL                              ;3614  23          
    LD  A,(HL)                          ;3615  7e          
    RES 7,(HL)                          ;3616  cb be       
    DEC HL                              ;3618  2b          
    LD  (USGSGN),A                      ;3619  32 a3 36    
    LD  A,(INTLEN)                      ;361c  3a 5d 36    
    LD  B,A                             ;361f  47          
    DEFB    03EH                        ;3620  3e          ; LD A,?
FRCLEN: DEFS    1                       ;3621              
    LD  C,A                             ;3622  4f          
    DEFB    03EH                        ;3623  3e          ; LD A,?
PUEXPF: DEFS    1                       ;3624              
    CALL    USGNCV                      ;3625  cd d6 5e    
    PUSH    HL                          ;3628  e5          
    LD  DE,KEYBUF                       ;3629  11 4f 7a    
    LD  A,020h                          ;362c  3e 20       
    LD  (DE),A                          ;362e  12          
    INC DE                              ;362f  13          
    DEFB    03EH                        ;3630  3e          ; LD A,?
PUCOMF: DEFS    1                       ;3631              
    OR  A                               ;3632  b7          
    JR  Z,LADJS1                        ;3633  28 3f       
    PUSH    DE                          ;3635  d5          
    LD  A,(INTLEN)                      ;3636  3a 5d 36    
    LD  L,A                             ;3639  6f          
    LD  H,000h                          ;363a  26 00       
    ADD HL,DE                           ;363c  19          
    DEC HL                              ;363d  2b          
    LD  DE,ZFAC                         ;363e  11 f2 62    
    LD  C,0                             ;3641  0e 00       
COMN3D: LD  B,3                         ;3643  06 03       
COMSK3: LD  A,(HL)                      ;3645  7e          
    CP  020h                            ;3646  fe 20       
    JR  Z,ESCPUC                        ;3648  28 12       
    INC C                               ;364a  0c          
    LD  (DE),A                          ;364b  12          
    INC DE                              ;364c  13          
    DEC HL                              ;364d  2b          
    DJNZ    COMSK3                      ;364e  10 f5       
    LD  A,(HL)                          ;3650  7e          
    CP  020h                            ;3651  fe 20       
    JR  Z,ESCPUC                        ;3653  28 07       
PURTJM: LD  A,02Ch                      ;3655  3e 2c       
    LD  (DE),A                          ;3657  12          
    INC DE                              ;3658  13          
    INC C                               ;3659  0c          
    JR  COMN3D                          ;365a  18 e7       
                  ;
ESCPUC: DEFB    03EH                    ;365c  3e          ; LD A,?
INTLEN: DEFS    1                       ;365d              
    CP  C                               ;365e  b9          
    JP  C,FOVER                         ;365f  da a6 5f    
    LD  B,C                             ;3662  41          
    LD  L,A                             ;3663  6f          
    LD  H,0                             ;3664  26 00       
    POP DE                              ;3666  d1          
    PUSH    DE                          ;3667  d5          
    ADD HL,DE                           ;3668  19          
    DEC HL                              ;3669  2b          
    LD  DE,ZFAC                         ;366a  11 f2 62    
COMTPU: LD  A,(DE)                      ;366d  1a          
    LD  (HL),A                          ;366e  77          
    DEC HL                              ;366f  2b          
    INC DE                              ;3670  13          
    DJNZ    COMTPU                      ;3671  10 fa       
    POP DE                              ;3673  d1          
LADJS1: DEFB    03EH                    ;3674  3e          ; LD A,?
PUAFMF: DEFS    1                       ;3675              
    OR  A                               ;3676  b7          
NPUSGN: JP  NZ,LADJS2                   ;3677  c2 ad 36    ; ###-
    DEFB    03EH                        ;367a  3e          ; LD A,?
RPLUSF: DEFS    1                       ;367b              
    OR  A                               ;367c  b7          ; ###+
    JR  NZ,NPUSGN                       ;367d  20 f8       
    DEFB    03EH                        ;367f  3e          ; LD A,?
FPLUSF: DEFS    1                       ;3680              
    OR  A                               ;3681  b7          ; +###
    JR  NZ,PTPLS1                       ;3682  20 1e       
    LD  A,(USGSGN)                      ;3684  3a a3 36    
    RLCA                                ;3687  07          
    JP  NC,LADJS2                       ;3688  d2 ad 36    
    LD  A,(DE)                          ;368b  1a          
    CP  020h                            ;368c  fe 20       
    JP  NZ,FOVER                        ;368e  c2 a6 5f    
    LD  B,02Dh                          ;3691  06 2d       
FPUTER: PUSH    DE                      ;3693  d5          
PUPTML: LD  A,(DE)                      ;3694  1a          
    INC DE                              ;3695  13          
    CP  020h                            ;3696  fe 20       
    JR  Z,PUPTML                        ;3698  28 fa       
    DEC DE                              ;369a  1b          
    DEC DE                              ;369b  1b          
    LD  A,B                             ;369c  78          
    LD  (DE),A                          ;369d  12          
    POP DE                              ;369e  d1          
THISLN1: JP LADJS2                      ;369f  c3 ad 36    
                  ;
PTPLS1: DEFB    03EH                    ;36a2  3e          ; LD A,?
USGSGN: DEFS    1                       ;36a3              
    RLCA                                ;36a4  07          
    LD  B,02Bh                          ;36a5  06 2b       
    JR  NC,FPUTER                       ;36a7  30 ea       
    LD  B,02Dh                          ;36a9  06 2d       
    JR  FPUTER                          ;36ab  18 e6       
                  ;
LADJS2: DEFB    03EH                    ;36ad  3e          ; LD A,?
PUYENF: DEFS    1                       ;36ae              
    OR  A                               ;36af  b7          
    JR  Z,LADJS3                        ;36b0  28 12       
    LD  A,(DE)                          ;36b2  1a          
    CP  020h                            ;36b3  fe 20       
    JR  NZ,LADJS3                       ;36b5  20 0d       
    PUSH    DE                          ;36b7  d5          
LSDQW1: LD  A,(DE)                      ;36b8  1a          
    INC DE                              ;36b9  13          
    CP  020h                            ;36ba  fe 20       
    JR  Z,LSDQW1                        ;36bc  28 fa       
    DEC DE                              ;36be  1b          
    DEC DE                              ;36bf  1b          
    LD  A,07Ch                          ;36c0  3e 7c       
    LD  (DE),A                          ;36c2  12          
    POP DE                              ;36c3  d1          
LADJS3: DEFB    03EH                    ;36c4  3e          ; LD A,?
PUASTF: DEFS    1                       ;36c5              
    OR  A                               ;36c6  b7          
    JR  Z,LADJS4                        ;36c7  28 0d       
    PUSH    DE                          ;36c9  d5          
ASTFIL: LD  A,(DE)                      ;36ca  1a          
    CP  020h                            ;36cb  fe 20       
    JR  NZ,LADJ4'                       ;36cd  20 06       
    LD  A,02Ah                          ;36cf  3e 2a       
    LD  (DE),A                          ;36d1  12          
    INC DE                              ;36d2  13          
    JR  ASTFIL                          ;36d3  18 f5       
LADJ4': POP DE                          ;36d5  d1          
LADJS4: POP HL                          ;36d6  e1          
    OR  A                               ;36d7  b7          
    SBC HL,DE                           ;36d8  ed 52       
    LD  B,L                             ;36da  45          
    CALL    PRTSDC                      ;36db  cd e1 07    
    LD  A,(RPLUSF)                      ;36de  3a 7b 36    
    OR  A                               ;36e1  b7          
    JR  Z,TST2DH                        ;36e2  28 0f       
    LD  A,(USGSGN)                      ;36e4  3a a3 36    
    RLCA                                ;36e7  07          
    LD  A,02Bh                          ;36e8  3e 2b       
LSDVZR: JR  NC,PULSTX                   ;36ea  30 02       
    LD  A,02Dh                          ;36ec  3e 2d       
PULSTX: CALL    ACCPRT                  ;36ee  cd 64 08    
    JR  RETPU$                          ;36f1  18 0e       
                  ;
TST2DH: LD  A,(PUAFMF)                  ;36f3  3a 75 36    
    OR  A                               ;36f6  b7          
    JR  Z,RETPU$                        ;36f7  28 08       
    LD  A,(USGSGN)                      ;36f9  3a a3 36    
    RLCA                                ;36fc  07          
    LD  A,020h                          ;36fd  3e 20       
    JR  LSDVZR                          ;36ff  18 e9       
                  ;
RETPU$: DEFB    001H                    ;3701  01          ; LD BC,?
USGBCB: DEFS    2                       ;3702              
    DEFB    011H                        ;3704  11          ; LD DE,?
USGDEB: DEFS    2                       ;3705              
    LD  A,1                             ;3707  3e 01       
    LD  (PRTEDF),A                      ;3709  32 75 34    
    JP  USNGLP                          ;370c  c3 42 34    
                  ;
AUTO:   LD  C,L                         ;370f  4d          
    LD  B,H                             ;3710  44          
    LD  HL,10                           ;3711  21 0a 00    ; 그냥 AUTO면 10부터 시작한다.
    LD  (AUTOST),HL                     ;3714  22 45 22    
    LD  (AUTOLN),HL                     ;3717  22 39 22    
    CALL    BCFTCH                      ;371a  cd c4 25    
    DEC BC                              ;371d  0b          
    OR  A                               ;371e  b7          
    JR  Z,AUTOES                        ;371f  28 22       
    CP  03Ah                            ;3721  fe 3a       
    JR  Z,AUTOES                        ;3723  28 1e       
    CP  02Eh                            ;3725  fe 2e       
    JR  NZ,AUTONE                       ;3727  20 09       
    DEFB    021H                        ;3729  21          ; LD HL,?
EDLINE: DEFS    2                       ;372a              
    INC BC                              ;372c  03          
    CALL    BCFTCH                      ;372d  cd c4 25    
    JR  AUTNER                          ;3730  18 03       
AUTONE: CALL    IHLEXP                  ;3732  cd cc 22    
AUTNER: CP  02Ch                        ;3735  fe 2c       
    LD  (AUTOLN),HL                     ;3737  22 39 22    
    JP  NZ,AUTOES                       ;373a  c2 43 37    
    CALL    IHLEXP                      ;373d  cd cc 22    
    LD  (AUTOST),HL                     ;3740  22 45 22    
AUTOES: XOR A                           ;3743  af          
    LD  (AUTOVC),A                      ;3744  32 37 22    
    JP  AUTOBK                          ;3747  c3 8b 14    
                  ;
LPOS:   LD  A,(PRINTN)                  ;374a  3a ec 11    
    JR  POSMID                          ;374d  18 03       
                  ;
POS:    LD  A,(CURX)                    ;374f  3a ed 11    
POSMID: LD  E,A                         ;3752  5f          
    LD  D,0                             ;3753  16 00       
    JP  FLTHEX                          ;3755  c3 02 29    
                  ;
ERR:    LD  A,(ERRCOD)                  ;3758  3a 95 22    
    LD  E,A                             ;375b  5f          
    LD  D,0                             ;375c  16 00       
MIDERS: PUSH    DE                      ;375e  d5          
    LD  DE,8                            ;375f  11 08 00    
    ADD HL,DE                           ;3762  19          
    POP DE                              ;3763  d1          
    CALL    FLTHEX                      ;3764  cd 02 29    
    CALL    ADJERL                      ;3767  cd 78 37    
    LD  A,4                             ;376a  3e 04       
    CALL    CONDFL                      ;376c  cd eb 28    
    JP  BCFTCH                          ;376f  c3 c4 25    
                  ;
ERL:    LD  DE,(ERRLNO)                 ;3772  ed 5b 65 22 
    JR  MIDERS                          ;3776  18 e6       
                  ;
ADJERL: INC HL                          ;3778  23          
    LD  A,(HL)                          ;3779  7e          
    DEC HL                              ;377a  2b          
    ADD A,A                             ;377b  87          
    RET NC                              ;377c  d0          
    PUSH    BC                          ;377d  c5          
    LD  DE,FLMXD0                       ;377e  11 86 37    
    CALL    ADD                         ;3781  cd a6 6c    
    POP BC                              ;3784  c1          
    RET                                 ;3785  c9          
FLMXD0:                                 ;                  
    DEFB    091H                        ;3786  91          
    DEFB    000H                        ;3787  00          
    DEFB    000H                        ;3788  00          
    DEFB    000H                        ;3789  00          
    DEFB    000H                        ;378a  00          
    DEFB    000H                        ;378b  00          
    DEFB    000H                        ;378c  00          
    DEFB    000H                        ;378d  00          
                  ;
DEL:    CALL    HLFTCH                  ;378e  cd 87 29    
    OR  A                               ;3791  b7          
    RET Z                               ;3792  c8          
    CP  03Ah                            ;3793  fe 3a       
    RET Z                               ;3795  c8          
    PUSH    HL                          ;3796  e5          
    CALL    RETLNO                      ;3797  cd 0a 3f    
    CALL    CLR                         ;379a  cd 51 19    
    POP HL                              ;379d  e1          
    CALL    GTSTED                      ;379e  cd c7 3f    
    EX  DE,HL                           ;37a1  eb          
    LD  E,C                             ;37a2  59          
    LD  D,B                             ;37a3  50          
    CALL    DELETE1                     ;37a4  cd a5 31    
    JP  HOTENT                          ;37a7  c3 46 14    
                  ;
RENUM:  LD  C,L                         ;37aa  4d          
    LD  B,H                             ;37ab  44          
    LD  HL,10                           ;37ac  21 0a 00    ; 그냥 RENUM이면 10부터 10씩 증가
    LD  (NEWNO),HL                      ;37af  22 34 38    
    LD  (ADDNO),HL                      ;37b2  22 42 38    
    LD  L,0                             ;37b5  2e 00       
    LD  (STLNO),HL                      ;37b7  22 23 38    
    CALL    BCFTCH                      ;37ba  cd c4 25    
    DEC BC                              ;37bd  0b          
    OR  A                               ;37be  b7          
    JR  Z,RNSTRT                        ;37bf  28 39       
    CP  03Ah                            ;37c1  fe 3a       
    JR  Z,RNSTRT                        ;37c3  28 35       
    CP  02Ch                            ;37c5  fe 2c       
    JR  Z,SKIRE1                        ;37c7  28 0b       
    CALL    IHLEXP                      ;37c9  cd cc 22    
    LD  (NEWNO),HL                      ;37cc  22 34 38    
    CP  02Ch                            ;37cf  fe 2c       
    JR  NZ,RNSTRT                       ;37d1  20 27       
    DEC BC                              ;37d3  0b          
SKIRE1: INC BC                          ;37d4  03          
    CALL    BCFTCH                      ;37d5  cd c4 25    
    DEC BC                              ;37d8  0b          
    CP  02Ch                            ;37d9  fe 2c       
    JR  Z,SKMRNU                        ;37db  28 0b       
    CALL    IHLEXP                      ;37dd  cd cc 22    
    LD  (STLNO),HL                      ;37e0  22 23 38    
    CP  02Ch                            ;37e3  fe 2c       
    JR  NZ,RNSTRT                       ;37e5  20 13       
    DEC BC                              ;37e7  0b          
SKMRNU: INC BC                          ;37e8  03          
    CALL    BCFTCH                      ;37e9  cd c4 25    
    DEC BC                              ;37ec  0b          
    OR  A                               ;37ed  b7          
    JR  Z,RNSTRT                        ;37ee  28 0a       
    CP  03Ah                            ;37f0  fe 3a       
    JR  Z,RNSTRT                        ;37f2  28 06       
    CALL    IHLEXP                      ;37f4  cd cc 22    
    LD  (ADDNO),HL                      ;37f7  22 42 38    
RNSTRT: PUSH    BC                      ;37fa  c5          
    LD  HL,(ADDNO)                      ;37fb  2a 42 38    
    LD  A,H                             ;37fe  7c          
    OR  L                               ;37ff  b5          
    JP  Z,IFCALL                        ;3800  ca 36 17    
    LD  HL,(STLNO)                      ;3803  2a 23 38    
    EX  DE,HL                           ;3806  eb          
    LD  HL,(NEWNO)                      ;3807  2a 34 38    
    OR  A                               ;380a  b7          
    SBC HL,DE                           ;380b  ed 52       
    JP  C,IFCALL                        ;380d  da 36 17    
    CALL    LNOADR                      ;3810  cd fd 3e    
    LD  HL,TEXTST                       ;3813  21 4e 7c    
BEGRNS: LD  E,(HL)                      ;3816  5e          
    INC HL                              ;3817  23          
    LD  D,(HL)                          ;3818  56          
    LD  A,D                             ;3819  7a          
    OR  E                               ;381a  b3          
    JR  Z,RNUMED'                       ;381b  28 2f       
    INC HL                              ;381d  23          
    LD  C,(HL)                          ;381e  4e          
    INC HL                              ;381f  23          
    LD  B,(HL)                          ;3820  46          
    PUSH    HL                          ;3821  e5          
    DEFB    021H                        ;3822  21          ; LD HL,?
STLNO:  DEFS    2                       ;3823              
    OR  A                               ;3825  b7          
    SBC HL,BC                           ;3826  ed 42       
    POP HL                              ;3828  e1          
    JR  Z,BEGREN                        ;3829  28 05       
    JR  C,BEGREN                        ;382b  38 03       
    EX  DE,HL                           ;382d  eb          
    JR  BEGRNS                          ;382e  18 e6       
                  ;
BEGREN: DEC HL                          ;3830  2b          
    DEC HL                              ;3831  2b          
    DEC HL                              ;3832  2b          
    DEFB    001H                        ;3833  01          ; LD BC,?
NEWNO:  DEFS    2                       ;3834              
REKUML: LD  E,(HL)                      ;3836  5e          
    INC HL                              ;3837  23          
    LD  D,(HL)                          ;3838  56          
    LD  A,D                             ;3839  7a          
    OR  E                               ;383a  b3          
    JR  Z,RNUMED'                       ;383b  28 0f       
    INC HL                              ;383d  23          
    LD  (HL),C                          ;383e  71          
    INC HL                              ;383f  23          
    LD  (HL),B                          ;3840  70          
    DEFB    021H                        ;3841  21          ; LD HL,?
ADDNO:  DEFS    2                       ;3842              
    ADD HL,BC                           ;3844  09          
    JR  C,RENOVR                        ;3845  38 0a       
    LD  C,L                             ;3847  4d          
    LD  B,H                             ;3848  44          
    EX  DE,HL                           ;3849  eb          
    JR  REKUML                          ;384a  18 ea       
                  ;
RNUMED':CALL    RETLNO                  ;384c  cd 0a 3f    
    POP HL                              ;384f  e1          
    RET                                 ;3850  c9          
                  ;
RENOVR: LD  HL,10                       ;3851  21 0a 00    
    LD  (ADDNO),HL                      ;3854  22 42 38    
    LD  (NEWNO),HL                      ;3857  22 34 38    
    LD  L,0                             ;385a  2e 00       
    LD  (STLNO),HL                      ;385c  22 23 38    
    CALL    RNSTRT                      ;385f  cd fa 37    
    JP  IFCALL                          ;3862  c3 36 17    
                  ;
CROPEN: LD  A,(FILEFG)                  ;3865  3a 83 33    
    OR  A                               ;3868  b7          
    JP  NZ,FILEER                       ;3869  c2 3e 18    
    LD  (LOADFN),A                      ;386c  32 c3 38    
    INC A                               ;386f  3c          
    LD  (FILEFG),A                      ;3870  32 83 33    
    CALL    BCFTCH                      ;3873  cd c4 25    
    DEC BC                              ;3876  0b          
    OR  A                               ;3877  b7          
    JR  Z,LOADST                        ;3878  28 24       
    CP  03Ah                            ;387a  fe 3a       
    JR  Z,LOADST                        ;387c  28 20       
    LD  A,001h                          ;387e  3e 01       
    LD  (LOADFN),A                      ;3880  32 c3 38    
    CALL    STREXX                      ;3883  cd 9d 45    
    DEC BC                              ;3886  0b          
    PUSH    BC                          ;3887  c5          
    OR  A                               ;3888  b7          
    JR  Z,LODIFC                        ;3889  28 02       
    CP  17                              ;388b  fe 11       
LODIFC: JP  NC,IFCALL                   ;388d  d2 36 17    
    LD  B,A                             ;3890  47          
    EX  DE,HL                           ;3891  eb          
    LD  DE,KEYBUF                       ;3892  11 4f 7a    
LDFNTR: LD  A,(HL)                      ;3895  7e          
    LD  (DE),A                          ;3896  12          
    INC DE                              ;3897  13          
    INC HL                              ;3898  23          
    DJNZ    LDFNTR                      ;3899  10 fa       
    XOR A                               ;389b  af          
    LD  (DE),A                          ;389c  12          
    POP BC                              ;389d  c1          
LOADST: CALL    FLOAD                   ;389e  cd 14 01    ;0027
    JP  C,BREAK                         ;38a1  da a2 16    
    CALL    CR2                         ;38a4  cd 23 08    
    LD  DE,LFOUM                        ;38a7  11 43 3a    
    PUSH    BC                          ;38aa  c5          
    LD  B,6                             ;38ab  06 06       
    CALL    PRTSDC                      ;38ad  cd e1 07    
    LD  DE,FILMOD                       ;38b0  11 96 13    ;10F0
LFDFNL: INC DE                          ;38b3  13          
    LD  A,(DE)                          ;38b4  1a          
    CP  000h                            ;38b5  fe 00       
    JR  Z,FLFPRE                        ;38b7  28 05       
    CALL    ACCPRT                      ;38b9  cd 64 08    
    JR  LFDFNL                          ;38bc  18 f5       
FLFPRE: POP BC                          ;38be  c1          
    CALL    CR2                         ;38bf  cd 23 08    
    DEFB    03EH                        ;38c2  3e          
LOADFN: DEFS    1                       ;38c3              
    OR  A                               ;38c4  b7          
    JR  Z,LFNOK                         ;38c5  28 16       
    LD  HL,KEYBUF                       ;38c7  21 4f 7a    
    LD  DE,FILNAM                       ;38ca  11 97 13    ;10F1
FNCMPL: LD  A,(DE)                      ;38cd  1a          
    CP  000h                            ;38ce  fe 00       
    JR  Z,LFNLCP                        ;38d0  28 07       
    CP  (HL)                            ;38d2  be          
    INC HL                              ;38d3  23          
    INC DE                              ;38d4  13          
    JR  Z,FNCMPL                        ;38d5  28 f6       
    JR  LOADST                          ;38d7  18 c5       
LFNLCP: LD  A,(HL)                      ;38d9  7e          
    OR  A                               ;38da  b7          
    JR  NZ,LOADST                       ;38db  20 c1       
LFNOK:  PUSH    BC                      ;38dd  c5          
    CALL    BUFCLR                      ;38de  cd 11 45    
    LD  DE,LDINGM                       ;38e1  11 49 3a    
    LD  B,8                             ;38e4  06 08       
    CALL    PRTSDC                      ;38e6  cd e1 07    
    LD  DE,FILNAM                       ;38e9  11 97 13    
    CALL    DEPRT                       ;38ec  cd f3 07    ;0015
    CALL    CR2                         ;38ef  cd 23 08    
    POP BC                              ;38f2  c1          
    RET                                 ;38f3  c9          
                  ;
ROPEN:  LD  C,L                         ;38f4  4d          
    LD  B,H                             ;38f5  44          
    CALL    CROPEN                      ;38f6  cd 65 38    
    LD  L,C                             ;38f9  69          
    LD  H,B                             ;38fa  60          
    RET                                 ;38fb  c9          
                  ;
VERIFY: INC HL                          ;38fc  23          
    LD  C,L                             ;38fd  4d          
    LD  B,H                             ;38fe  44          
    CALL    CROPEN                      ;38ff  cd 65 38    
    LD  A,(FILMOD)                      ;3902  3a 96 13    
    CP  016h                            ;3905  fe 16       
    JP  Z,FILEER                        ;3907  ca 3e 18    
    CALL    CVSAVE                      ;390a  cd de 39    
    CALL    MVRFY                       ;390d  cd b9 01    
    CALL    CVLOAD                      ;3910  cd b9 39    
    LD  A,27                            ;3913  3e 1b       
    JP  C,ERROR                         ;3915  da 96 21    
    RET                                 ;3918  c9          
                  ;
MERGE:  XOR A                           ;3919  af          
    LD  (FILEFG),A                      ;391a  32 83 33    
    LD  C,L                             ;391d  4d          
    LD  B,H                             ;391e  44          
    CALL    CROPEN                      ;391f  cd 65 38    
    LD  A,(FILMOD)                      ;3922  3a 96 13    
    CP  004h                            ;3925  fe 04       
    JP  C,FILEER                        ;3927  da 3e 18    
    JR  MRGEVC                          ;392a  18 1d       
                  ;
LOAD:   XOR A                           ;392c  af          
    LD  (FILEFG),A                      ;392d  32 83 33    
    LD  (CONTFG),A                      ;3930  32 08 22    
    CALL    HLFTCH                      ;3933  cd 87 29    
    CP  08Ch                            ;3936  fe 8c       
    JR  Z,VERIFY                        ;3938  28 c2       
    LD  C,L                             ;393a  4d          
    LD  B,H                             ;393b  44          
    CALL    CROPEN                      ;393c  cd 65 38    
    LD  A,(FILMOD)                      ;393f  3a 96 13    
    CP  004h                            ;3942  fe 04       
    JR  C,BLOAD                         ;3944  38 32       
    CALL    NEW                         ;3946  cd ac 39    
MRGEVC: CALL    CLR                     ;3949  cd 51 19    
    LD  SP,(STRTOP)                     ;394c  ed 7b 41 7a 
    LD  HL,0FFFFh                       ;3950  21 ff ff    
    PUSH    HL                          ;3953  e5          
    LD  (SPBUF),SP                      ;3954  ed 73 25 22 
    LD  HL,CINPUT                       ;3958  21 f8 39    
    LD  (LODVEC),HL                     ;395b  22 9d 14    
    LD  A,001h                          ;395e  3e 01       
    LD  (NRLDED),A                      ;3960  32 30 3a    
    CALL    BUFCLR                      ;3963  cd 11 45    
    JP  NMESOK                          ;3966  c3 88 14    
                  ;
TPRDER: XOR A                           ;3969  af          
    LD  (FILEFG),A                      ;396a  32 83 33    
    LD  A,(FILMOD)                      ;396d  3a 96 13    
    CP  002h                            ;3970  fe 02       
    CALL    Z,NEW                       ;3972  cc ac 39    
    JP  BREAK                           ;3975  c3 a2 16    
                  ;
BLOAD:  CP  002h                        ;3978  fe 02       ; basic이면 TEXTST에 로딩
    JR  NZ,MLLOAD                       ;397a  20 28       
    LD  HL,TEXTST                       ;397c  21 4e 7c    
    LD  (MTADRS),HL                     ;397f  22 aa 13    
    LD  DE,(MTBYTE)                     ;3982  ed 5b a8 13 
    ADD HL,DE                           ;3986  19          
    LD  HL,(MEMEND)                     ;3987  2a 47 7a    
    OR  A                               ;398a  b7          
    SBC HL,DE                           ;398b  ed 52       
    JP  C,OMERR                         ;398d  da 88 21    
    CALL    MLOAD                       ;3990  cd 34 01    
    JR  C,TPRDER                        ;3993  38 d4       
    CALL    CVLOAD                      ;3995  cd b9 39    
    LD  HL,PROTCT                       ;3998  21 ae 13    
    LD  A,(HL)                          ;399b  7e          
    CP  03Ah                            ;399c  fe 3a       
    JP  Z,RUN                           ;399e  ca c3 15    
RTBLOD: LD  L,C                         ;39a1  69          
    LD  H,B                             ;39a2  60          
    RET                                 ;39a3  c9          
                  ;
MLLOAD: CALL    MLOAD                   ;39a4  cd 34 01    
    JP  C,TPRDER                        ;39a7  da 69 39    
    JR  RTBLOD                          ;39aa  18 f5       
                  ;
NEW:    LD  HL,TEXTST                   ;39ac  21 4e 7c    
    XOR A                               ;39af  af          
    LD  (HL),A                          ;39b0  77          
    INC HL                              ;39b1  23          
    LD  (HL),A                          ;39b2  77          
    INC HL                              ;39b3  23          
    LD  (HL),A                          ;39b4  77          
    LD  (VSTART),HL                     ;39b5  22 3b 7a    
    RET                                 ;39b8  c9          
                  ;
CVLOAD: PUSH    AF                      ;39b9  f5          
    PUSH    HL                          ;39ba  e5          
    PUSH    DE                          ;39bb  d5          
    LD  HL,TEXTST                       ;39bc  21 4e 7c    
CVLDLP: LD  E,(HL)                      ;39bf  5e          
    INC HL                              ;39c0  23          
    LD  D,(HL)                          ;39c1  56          
    LD  A,E                             ;39c2  7b          
    OR  D                               ;39c3  b2          
    JR  Z,ESCCVL                        ;39c4  28 0b       
    PUSH    HL                          ;39c6  e5          
    ADD HL,DE                           ;39c7  19          
    DEC HL                              ;39c8  2b          
    EX  DE,HL                           ;39c9  eb          
    POP HL                              ;39ca  e1          
    LD  (HL),D                          ;39cb  72          
    DEC HL                              ;39cc  2b          
    LD  (HL),E                          ;39cd  73          
    EX  DE,HL                           ;39ce  eb          
    JR  CVLDLP                          ;39cf  18 ee       
ESCCVL: INC HL                          ;39d1  23          
    LD  (VSTART),HL                     ;39d2  22 3b 7a    
    LD  (HL),0                          ;39d5  36 00       
    LD  (STKLMT),HL                     ;39d7  22 3f 7a    
    POP DE                              ;39da  d1          
    POP HL                              ;39db  e1          
    POP AF                              ;39dc  f1          
    RET                                 ;39dd  c9          
                  ;
CVSAVE: PUSH    AF                      ;39de  f5          
    PUSH    HL                          ;39df  e5          
    PUSH    DE                          ;39e0  d5          
    LD  HL,TEXTST                       ;39e1  21 4e 7c    
CVSVLP: LD  E,(HL)                      ;39e4  5e          
    INC HL                              ;39e5  23          
    LD  D,(HL)                          ;39e6  56          
    LD  A,D                             ;39e7  7a          
    OR  E                               ;39e8  b3          
    JR  Z,ESCCVL                        ;39e9  28 e6       
    PUSH    DE                          ;39eb  d5          
    EX  DE,HL                           ;39ec  eb          
    OR  A                               ;39ed  b7          
    DEC DE                              ;39ee  1b          
    SBC HL,DE                           ;39ef  ed 52       
    EX  DE,HL                           ;39f1  eb          
    LD  (HL),E                          ;39f2  73          
    INC HL                              ;39f3  23          
    LD  (HL),D                          ;39f4  72          
    POP HL                              ;39f5  e1          
    JR  CVSVLP                          ;39f6  18 ec       
                  ;
CINPUT: PUSH    DE                      ;39f8  d5          
    CALL    CTINP                       ;39f9  cd 21 45    
    JR  C,ABORT                         ;39fc  38 1e       
    CP  00Dh                            ;39fe  fe 0d       
    JR  Z,NRLDED                        ;3a00  28 2e       
    JR  MIDCIP                          ;3a02  18 05       
CLDLP1: CALL    CTINP                   ;3a04  cd 21 45    
    JR  C,ABORT                         ;3a07  38 13       
MIDCIP: OR  A                           ;3a09  b7          
    JP  Z,FILEER                        ;3a0a  ca 3e 18    
    LD  (DE),A                          ;3a0d  12          
    INC DE                              ;3a0e  13          
    CP  00Dh                            ;3a0f  fe 0d       
    JR  NZ,CLDLP1                       ;3a11  20 f1       
    DEC DE                              ;3a13  1b          
    XOR A                               ;3a14  af          
    LD  (DE),A                          ;3a15  12          
    INC DE                              ;3a16  13          
    LD  (DE),A                          ;3a17  12          
    INC DE                              ;3a18  13          
    LD  (DE),A                          ;3a19  12          
    POP DE                              ;3a1a  d1          
    RET                                 ;3a1b  c9          
                  ;
ABORT:  LD  HL,LININP                   ;3a1c  21 93 15    
    LD  (LODVEC),HL                     ;3a1f  22 9d 14    
    LD  SP,(SPBUF)                      ;3a22  ed 7b 25 22 
CBREAK: XOR A                           ;3a26  af          
    LD  (FILEFG),A                      ;3a27  32 83 33    
    LD  (CONTFG),A                      ;3a2a  32 08 22    
    JP  BREAK                           ;3a2d  c3 a2 16    
                  ;
NRLDED: JP  FILEER                      ;3a30  c3 3e 18    
    LD  HL,LININP                       ;3a33  21 93 15    
    LD  (LODVEC),HL                     ;3a36  22 9d 14    
    LD  SP,(SPBUF)                      ;3a39  ed 7b 25 22 
    CALL    CLOSE                       ;3a3d  cd 82 33    
    JP  OK                              ;3a40  c3 62 14    
                  ;
LFOUM:  DEFM    'FOUND:'                ;3a43  46 4f 55 4e 
                                        ;3a47  44 3a         8939   8957
                  ;
LDINGM: DEFM    'LOADING:'              ;3a49  4c 4f 41 44 
                                        ;3a4d  49 4e 47 3a   8941   8960
                  ;
WOPEN:  CALL    CWOPEN                  ;3a51  cd 5d 3a    
    CALL    FSAVE                       ;3a54  cd 80 00    
    JP  C,CBREAK                        ;3a57  da 26 3a    
    LD  L,C                             ;3a5a  69          
    LD  H,B                             ;3a5b  60          
    RET                                 ;3a5c  c9          
                  ;
CWOPEN: LD  A,(FILEFG)                  ;3a5d  3a 83 33    
    OR  A                               ;3a60  b7          
    JP  NZ,FILEER                       ;3a61  c2 3e 18    
    LD  A,2                             ;3a64  3e 02       
    LD  (FILEFG),A                      ;3a66  32 83 33    
    LD  C,L                             ;3a69  4d          
    LD  B,H                             ;3a6a  44          
    CALL    BCFTCH                      ;3a6b  cd c4 25    
    DEC BC                              ;3a6e  0b          
    LD  HL,NULSDC                       ;3a6f  21 25 28    
    OR  A                               ;3a72  b7          
    JR  Z,NULSAV                        ;3a73  28 0a       
    CP  03Ah                            ;3a75  fe 3a       
    LD  A,0                             ;3a77  3e 00       
    JR  Z,NULSAV                        ;3a79  28 04       
    CALL    STREXX                      ;3a7b  cd 9d 45    
    DEC BC                              ;3a7e  0b          
NULSAV: CP  17                          ;3a7f  fe 11       
WOPIFC: JP  NC,IFCALL                   ;3a81  d2 36 17    
    PUSH    BC                          ;3a84  c5          
    LD  B,A                             ;3a85  47          
    EX  DE,HL                           ;3a86  eb          
    LD  DE,FILMOD                       ;3a87  11 96 13    
    LD  A,016h                          ;3a8a  3e 16       
    LD  (DE),A                          ;3a8c  12          
    INC DE                              ;3a8d  13          
    LD  A,B                             ;3a8e  78          
    OR  A                               ;3a8f  b7          
    JR  Z,NULFNM                        ;3a90  28 06       
SAVEFT: LD  A,(HL)                      ;3a92  7e          
    LD  (DE),A                          ;3a93  12          
    INC DE                              ;3a94  13          
    INC HL                              ;3a95  23          
    DJNZ    SAVEFT                      ;3a96  10 fa       
NULFNM: LD  A,000h                      ;3a98  3e 00       
    LD  (DE),A                          ;3a9a  12          
    POP BC                              ;3a9b  c1          
    LD  HL,TEXTST                       ;3a9c  21 4e 7c    
    LD  (MTADRS),HL                     ;3a9f  22 aa 13    
    EX  DE,HL                           ;3aa2  eb          
    LD  HL,(VSTART)                     ;3aa3  2a 3b 7a    
    OR  A                               ;3aa6  b7          
    SBC HL,DE                           ;3aa7  ed 52       
    LD  (MTBYTE),HL                     ;3aa9  22 a8 13    
    LD  HL,0                            ;3aac  21 00 00    
    LD  (MTEXEC),HL                     ;3aaf  22 ac 13    
    LD  A,0                             ;3ab2  3e 00       
    LD  (PROTCT),A                      ;3ab4  32 ae 13    
    CALL    BUFCLR                      ;3ab7  cd 11 45    
    RET                                 ;3aba  c9          
                  ;
SAVE$:  XOR A                           ;3abb  af          
    LD  (FILEFG),A                      ;3abc  32 83 33    
    LD  A,(HL)                          ;3abf  7e          
    CP  04Dh                            ;3ac0  fe 4d       
    JR  Z,SAVEM                         ;3ac2  28 4f       
    CALL    CWOPEN                      ;3ac4  cd 5d 3a    
    CALL    BCFTCH                      ;3ac7  cd c4 25    
    CP  02Ch                            ;3aca  fe 2c       
    JR  NZ,BSAVE                        ;3acc  20 28       
    CALL    BCFTCH                      ;3ace  cd c4 25    
    CP  041h                            ;3ad1  fe 41       
    JP  NZ,SERROR                       ;3ad3  c2 3a 17    
    CALL    FSAVE                       ;3ad6  cd 80 00    
    JP  C,CBREAK                        ;3ad9  da 26 3a    
    PUSH    BC                          ;3adc  c5          
    CALL    RETLNO                      ;3add  cd 0a 3f    
    CALL    CLIST                       ;3ae0  cd 5e 40    
    LD  HL,CRTCR2                       ;3ae3  21 0e 41    
    LD  (LSCRVC),HL                     ;3ae6  22 04 41    
    LD  HL,CRTVEC                       ;3ae9  21 fd 40    
    LD  (SAVEVC),HL                     ;3aec  22 f6 40    
    JP  C,BREAK                         ;3aef  da a2 16    
    POP HL                              ;3af2  e1          
    JP  CLOSE                           ;3af3  c3 82 33    
                  ;
BSAVE:  DEC BC                          ;3af6  0b          
    PUSH    BC                          ;3af7  c5          
    CALL    RETLNO                      ;3af8  cd 0a 3f    
    CALL    CVSAVE                      ;3afb  cd de 39    
    LD  A,002h                          ;3afe  3e 02       
    LD  (FILMOD),A                      ;3b00  32 96 13    
    CALL    FSAVE                       ;3b03  cd 80 00    
    JR  C,CBREA'                        ;3b06  38 03       
    CALL    MSAVE                       ;3b08  cd b6 00    
CBREA': CALL    CVLOAD                  ;3b0b  cd b9 39    
CBRSHM: POP HL                          ;3b0e  e1          
    JP  C,CBREAK                        ;3b0f  da 26 3a    
    RET                                 ;3b12  c9          
                  ;
SAVEM:  INC HL                          ;3b13  23          
    CALL    CWOPEN                      ;3b14  cd 5d 3a    
    CALL    BCFTCH                      ;3b17  cd c4 25    
    CALL    CH2CH                       ;3b1a  cd 61 2d    
    CALL    IHLEXP                      ;3b1d  cd cc 22    
    LD  (MTADRS),HL                     ;3b20  22 aa 13    
    PUSH    HL                          ;3b23  e5          
    CALL    CH2CH                       ;3b24  cd 61 2d    
    CALL    IHLEXP                      ;3b27  cd cc 22    
    POP DE                              ;3b2a  d1          
    OR  A                               ;3b2b  b7          
    SBC HL,DE                           ;3b2c  ed 52       
    INC HL                              ;3b2e  23          
    LD  (MTBYTE),HL                     ;3b2f  22 a8 13    
    CP  02Ch                            ;3b32  fe 2c       
    JR  NZ,SVMNEA                       ;3b34  20 06       
    CALL    IHLEXP                      ;3b36  cd cc 22    
    LD  (MTEXEC),HL                     ;3b39  22 ac 13    
SVMNEA: DEC BC                          ;3b3c  0b          
    PUSH    BC                          ;3b3d  c5          
    LD  A,1                             ;3b3e  3e 01       
    LD  (FILMOD),A                      ;3b40  32 96 13    
    CALL    FSAVE                       ;3b43  cd 80 00    
    JR  C,CBRSHM                        ;3b46  38 c6       
    CALL    MSAVE                       ;3b48  cd b6 00    
    JR  CBRSHM                          ;3b4b  18 c1       
                  ;
DEFFN:  CALL    HLFTCH                  ;3b4d  cd 87 29    
    INC A                               ;3b50  3c          
FNSERR: JP  NZ,SERROR                   ;3b51  c2 3a 17    
    INC HL                              ;3b54  23          
    LD  A,(HL)                          ;3b55  7e          
    CP  0A0h                            ;3b56  fe a0       
    JP  Z,DEFCHR                        ;3b58  ca cb 46    
    CP  0BEh                            ;3b5b  fe be       
    JP  Z,DEFUSR                        ;3b5d  ca 40 3c    
    CP  0BDh                            ;3b60  fe bd       
    JR  NZ,FNSERR                       ;3b62  20 ed       
    INC HL                              ;3b64  23          
    LD  C,L                             ;3b65  4d          
    LD  B,H                             ;3b66  44          
    CALL    ILDRCH                      ;3b67  cd 90 3b    
    CALL    BCFTCH                      ;3b6a  cd c4 25    
    CALL    GETFUN                      ;3b6d  cd a1 3b    
    JR  NC,DUPDEF                       ;3b70  30 19       
    LD  HL,(STKLMT)                     ;3b72  2a 3f 7a    
    OR  0C0h                            ;3b75  f6 c0       
    LD  (HL),A                          ;3b77  77          
    INC HL                              ;3b78  23          
    LD  (HL),E                          ;3b79  73          
    INC HL                              ;3b7a  23          
    LD  (HL),D                          ;3b7b  72          
    INC HL                              ;3b7c  23          
    LD  (HL),C                          ;3b7d  71          
    INC HL                              ;3b7e  23          
    LD  (HL),B                          ;3b7f  70          
    INC HL                              ;3b80  23          
    LD  (HL),000h                       ;3b81  36 00       
    LD  (STKLMT),HL                     ;3b83  22 3f 7a    
    LD  L,C                             ;3b86  69          
    LD  H,B                             ;3b87  60          
    JP  DATA                            ;3b88  c3 c8 1c    
                  ;
DUPDEF: LD  A,10                        ;3b8b  3e 0a       
ERJVDE: JP  ERROR                       ;3b8d  c3 96 21    
                  ;
ILDRCH: PUSH    HL                      ;3b90  e5          
    LD  HL,(LNOBUF)                     ;3b91  2a cc 16    
    INC HL                              ;3b94  23          
    LD  A,H                             ;3b95  7c          
    OR  L                               ;3b96  b5          
    POP HL                              ;3b97  e1          
    RET NZ                              ;3b98  c0          
    LD  A,12                            ;3b99  3e 0c       
    JR  ERJVDE                          ;3b9b  18 f0       
                  ;
UNDEFN: LD  A,012h                      ;3b9d  3e 12       
    JR  ERJVDE                          ;3b9f  18 ec       
                  ;
GETFUN: CALL    VSRTST                  ;3ba1  cd fe 20    
    CP  028h                            ;3ba4  fe 28       
    JP  NZ,SERROR                       ;3ba6  c2 3a 17    
    DEC BC                              ;3ba9  0b          
    PUSH    BC                          ;3baa  c5          
    LD  A,E                             ;3bab  7b          
    OR  0C0h                            ;3bac  f6 c0       
    EX  DE,HL                           ;3bae  eb          
    LD  B,A                             ;3baf  47          
    LD  HL,(VSTART)                     ;3bb0  2a 3b 7a    
GFNLP1: LD  A,(HL)                      ;3bb3  7e          
    OR  A                               ;3bb4  b7          
    JR  Z,FNNOTF                        ;3bb5  28 37       
    CP  B                               ;3bb7  b8          
    JR  NZ,SKIPN1                       ;3bb8  20 17       
    INC HL                              ;3bba  23          
    LD  A,E                             ;3bbb  7b          
    CP  (HL)                            ;3bbc  be          
    LD  A,004h                          ;3bbd  3e 04       
    JR  NZ,SKIPFN                       ;3bbf  20 25       
    INC HL                              ;3bc1  23          
    LD  A,D                             ;3bc2  7a          
    CP  (HL)                            ;3bc3  be          
    LD  A,3                             ;3bc4  3e 03       
    JR  NZ,SKIPFN                       ;3bc6  20 1e       
    INC HL                              ;3bc8  23          
    CALL    INDRCT                      ;3bc9  cd a3 2a    
    LD  A,B                             ;3bcc  78          
    AND 00Fh                            ;3bcd  e6 0f       
    POP BC                              ;3bcf  c1          
    RET                                 ;3bd0  c9          
                  ;
SKIPN1: INC A                           ;3bd1  3c          
    JP  P,SKIPN2                        ;3bd2  f2 e4 3b    
    DEC A                               ;3bd5  3d          
    AND 0C0h                            ;3bd6  e6 c0       
    CP  0C0h                            ;3bd8  fe c0       
    LD  A,5                             ;3bda  3e 05       
    JR  Z,SKIPFN                        ;3bdc  28 08       
    INC HL                              ;3bde  23          
    CALL    INDRCT                      ;3bdf  cd a3 2a    
    JR  GFNLP1                          ;3be2  18 cf       
                  ;
SKIPN2: INC A                           ;3be4  3c          
    INC A                               ;3be5  3c          
SKIPFN: ADD A,L                         ;3be6  85          
    LD  L,A                             ;3be7  6f          
    LD  A,000h                          ;3be8  3e 00       
    ADC A,H                             ;3bea  8c          
    LD  H,A                             ;3beb  67          
    JR  GFNLP1                          ;3bec  18 c5       
                  ;
FNNOTF: LD  A,B                         ;3bee  78          
    AND 00Fh                            ;3bef  e6 0f       
    POP BC                              ;3bf1  c1          
    SCF                                 ;3bf2  37          
    RET                                 ;3bf3  c9          
                  ;
FNOPR:  PUSH    HL                      ;3bf4  e5          
    CALL    BCFTCH                      ;3bf5  cd c4 25    
    CALL    GETFUN                      ;3bf8  cd a1 3b    
    JR  C,UNDEFN                        ;3bfb  38 a0       
    CP  003h                            ;3bfd  fe 03       
    JR  Z,STRFNC                        ;3bff  28 05       
    CALL    CONDFL                      ;3c01  cd eb 28    
    JR  ARGFUN                          ;3c04  18 03       
STRFNC: CALL    CONDSR                  ;3c06  cd d9 28    
ARGFUN: EX  DE,HL                       ;3c09  eb          
    LD  HL,(FUNCNS)                     ;3c0a  2a 2f 26    
    EX  (SP),HL                         ;3c0d  e3          
    CALL    CH28H                       ;3c0e  cd 58 2d    
    PUSH    BC                          ;3c11  c5          
    LD  C,E                             ;3c12  4b          
    LD  B,D                             ;3c13  42          
    CALL    CH28H                       ;3c14  cd 58 2d    
    PUSH    BC                          ;3c17  c5          
    EX  DE,HL                           ;3c18  eb          
    LD  HL,00000h                       ;3c19  21 00 00    
    ADD HL,SP                           ;3c1c  39          
    LD  (FUNCNS),HL                     ;3c1d  22 2f 26    
    EX  DE,HL                           ;3c20  eb          
    CALL    SK2829                      ;3c21  cd 1e 27    
    CALL    BCFTCH                      ;3c24  cd c4 25    
    CP  0F5h                            ;3c27  fe f5       
    JP  NZ,SERROR                       ;3c29  c2 3a 17    
    CALL    EXPRSN                      ;3c2c  cd f2 22    
    POP DE                              ;3c2f  d1          
    POP BC                              ;3c30  c1          
    CALL    SK2829                      ;3c31  cd 1e 27    
    POP DE                              ;3c34  d1          
    LD  (FUNCNS),DE                     ;3c35  ed 53 2f 26 
    JP  BCFTCH                          ;3c39  c3 c4 25    
                  ;
DFLTUF: LD  A,0                         ;3c3c  3e 00       
    JR  DFLTZR                          ;3c3e  18 11       
                  ;
DEFUSR: INC HL                          ;3c40  23          
    CALL    HLFTCH                      ;3c41  cd 87 29    
    CP  0F5h                            ;3c44  fe f5       
    JR  Z,DFLTUF                        ;3c46  28 f4       
    OR  A                               ;3c48  b7          
    JR  Z,USERSE                        ;3c49  28 26       
    CP  00Bh                            ;3c4b  fe 0b       
    JR  NC,USERSE                       ;3c4d  30 22       
    DEC A                               ;3c4f  3d          
    INC HL                              ;3c50  23          
DFLTZR: PUSH    AF                      ;3c51  f5          
    CALL    HLFTCH                      ;3c52  cd 87 29    
    CP  0F5h                            ;3c55  fe f5       
    JR  NZ,USERSE                       ;3c57  20 18       
    INC HL                              ;3c59  23          
    LD  C,L                             ;3c5a  4d          
    LD  B,H                             ;3c5b  44          
    CALL    IHLEXP                      ;3c5c  cd cc 22    
    LD  DE,USRTBL                       ;3c5f  11 a2 30    
    POP AF                              ;3c62  f1          
    ADD A,A                             ;3c63  87          
    ADD A,E                             ;3c64  83          
    LD  E,A                             ;3c65  5f          
    LD  A,0                             ;3c66  3e 00       
    ADC A,D                             ;3c68  8a          
    LD  D,A                             ;3c69  57          
    EX  DE,HL                           ;3c6a  eb          
    LD  (HL),E                          ;3c6b  73          
    INC HL                              ;3c6c  23          
    LD  (HL),D                          ;3c6d  72          
    JP  RETIRQ                          ;3c6e  c3 39 1b    
                  ;
USERSE: JP  SERROR                      ;3c71  c3 3a 17    
                  ;
USRDFZ: DEC BC                          ;3c74  0b          
    XOR A                               ;3c75  af          
    JR  USRDZE                          ;3c76  18 0f       
                  ;
USROPR: CALL    BCFTCH                  ;3c78  cd c4 25    
    CP  028h                            ;3c7b  fe 28       
    JR  Z,USRDFZ                        ;3c7d  28 f5       
    OR  A                               ;3c7f  b7          
    JR  Z,USERSE                        ;3c80  28 ef       
    CP  00Bh                            ;3c82  fe 0b       
    JR  NC,USERSE                       ;3c84  30 eb       
    DEC A                               ;3c86  3d          
USRDZE: PUSH    AF                      ;3c87  f5          
    CALL    BCFTCH                      ;3c88  cd c4 25    
    CP  028h                            ;3c8b  fe 28       
    JR  NZ,USERSE                       ;3c8d  20 e2       
    CALL    EXPRSN                      ;3c8f  cd f2 22    
    CP  029h                            ;3c92  fe 29       
    JR  NZ,USERSE                       ;3c94  20 db       
    POP AF                              ;3c96  f1          
    PUSH    BC                          ;3c97  c5          
    PUSH    HL                          ;3c98  e5          
    ADD A,A                             ;3c99  87          
    LD  DE,USRTBL                       ;3c9a  11 a2 30    
    ADD A,E                             ;3c9d  83          
    LD  E,A                             ;3c9e  5f          
    LD  A,0                             ;3c9f  3e 00       
    ADC A,D                             ;3ca1  8a          
    LD  D,A                             ;3ca2  57          
    EX  DE,HL                           ;3ca3  eb          
    CALL    INDRCT                      ;3ca4  cd a3 2a    
    EX  DE,HL                           ;3ca7  eb          
    LD  A,D                             ;3ca8  7a          
    OR  E                               ;3ca9  b3          
    JP  Z,UNDEFN                        ;3caa  ca 9d 3b    
    LD  A,(IY+0)                        ;3cad  fd 7e 00    
    CP  003h                            ;3cb0  fe 03       
    CALL    Z,INDRCT                    ;3cb2  cc a3 2a    
    PUSH    HL                          ;3cb5  e5          
    LD  HL,USRBCK                       ;3cb6  21 bc 3c    
    EX  (SP),HL                         ;3cb9  e3          
    PUSH    DE                          ;3cba  d5          
    RET                                 ;3cbb  c9          
                  ;
USRBCK: POP HL                          ;3cbc  e1          
    POP BC                              ;3cbd  c1          
    JP  BCFTCH                          ;3cbe  c3 c4 25    
                  ;
TIME$:  JP  NINS                        ;3cc1  c3 fa 20    
                  ;
SCRN$:  PUSH    HL                      ;3cc4  e5          
    CALL    CH28H                       ;3cc5  cd 58 2d    
    DEC IY                              ;3cc8  fd 2b       
    CALL    HLEXP                       ;3cca  cd c7 22    
    CP  02Ch                            ;3ccd  fe 2c       
SCRNER: JP  NZ,SERROR                   ;3ccf  c2 3a 17    
    CALL    HCHECK                      ;3cd2  cd d8 22    
    CP  32                              ;3cd5  fe 20       
SCRIFC: JP  NC,IFCALL                   ;3cd7  d2 36 17    
    LD  E,A                             ;3cda  5f          
    POP HL                              ;3cdb  e1          
    PUSH    HL                          ;3cdc  e5          
    PUSH    DE                          ;3cdd  d5          
    CALL    HLEXP                       ;3cde  cd c7 22    
    CP  02Ch                            ;3ce1  fe 2c       
    JR  NZ,SCRNER                       ;3ce3  20 ea       
    CALL    HCHECK                      ;3ce5  cd d8 22    
    CP  16                              ;3ce8  fe 10       
    JR  NC,SCRIFC                       ;3cea  30 eb       
    POP HL                              ;3cec  e1          
    LD  H,A                             ;3ced  67          
    PUSH    BC                          ;3cee  c5          
    CALL    ADRCA2                      ;3cef  cd 3b 09    
    LD  D,B                             ;3cf2  50          
    LD  E,C                             ;3cf3  59          
    POP BC                              ;3cf4  c1          
    POP HL                              ;3cf5  e1          
    PUSH    HL                          ;3cf6  e5          
    PUSH    DE                          ;3cf7  d5          
    CALL    HLEXP                       ;3cf8  cd c7 22    
    CP  029h                            ;3cfb  fe 29       
    JR  NZ,SCRNER                       ;3cfd  20 d0       
    CALL    HCHECK                      ;3cff  cd d8 22    
    POP HL                              ;3d02  e1          
    POP DE                              ;3d03  d1          
    PUSH    BC                          ;3d04  c5          
    PUSH    DE                          ;3d05  d5          
    PUSH    AF                          ;3d06  f5          
    LD  C,L                             ;3d07  4d          
    LD  B,H                             ;3d08  44          
    LD  H,A                             ;3d09  67          
    LD  DE,KEYBUF                       ;3d0a  11 4f 7a    
    PUSH    DE                          ;3d0d  d5          
SCRNTL: CALL    AINBC                   ;3d0e  cd 94 07    
    OR  A                               ;3d11  b7          
    JR  NZ,L2900                        ;3d12  20 02       
    LD  A,020h                          ;3d14  3e 20       
L2900:  LD  (DE),A                      ;3d16  12          
    INC BC                              ;3d17  03          
    INC DE                              ;3d18  13          
    DEC H                               ;3d19  25          
    JR  NZ,SCRNTL                       ;3d1a  20 f2       
    POP DE                              ;3d1c  d1          
    POP AF                              ;3d1d  f1          
    LD  B,A                             ;3d1e  47          
    POP HL                              ;3d1f  e1          
    PUSH    DE                          ;3d20  d5          
    LD  DE,00008h                       ;3d21  11 08 00    
    ADD HL,DE                           ;3d24  19          
    POP DE                              ;3d25  d1          
    CALL    ENTSTR                      ;3d26  cd 1a 2b    
    INC IY                              ;3d29  fd 23       
    POP BC                              ;3d2b  c1          
    JP  CONDSB                          ;3d2c  c3 b1 25    
                  ;
DUMP:   CALL    HLFTCH                  ;3d2f  cd 87 29    
    CP  023h                            ;3d32  fe 23       
    LD  A,0                             ;3d34  3e 00       
    JR  NZ,STDPDV                       ;3d36  20 03       
    INC HL                              ;3d38  23          
    LD  A,2                             ;3d39  3e 02       
STDPDV: LD  (DISFLG),A                  ;3d3b  32 eb 11    
    PUSH    HL                          ;3d3e  e5          
    LD  HL,(VSTART)                     ;3d3f  2a 3b 7a    
DMPLOP: LD  A,(HL)                      ;3d42  7e          
    OR  A                               ;3d43  b7          
    JP  Z,DUMPRT                        ;3d44  ca e4 3d    
    RLCA                                ;3d47  07          
    JR  NC,ONLYVR                       ;3d48  30 38       
    RLCA                                ;3d4a  07          
    JR  NC,ARYSKP                       ;3d4b  30 07       
    INC HL                              ;3d4d  23          
    INC HL                              ;3d4e  23          
    INC HL                              ;3d4f  23          
    INC HL                              ;3d50  23          
    INC HL                              ;3d51  23          
    JR  DMPLOP                          ;3d52  18 ee       
ARYSKP: LD  A,(HL)                      ;3d54  7e          
    INC HL                              ;3d55  23          
    PUSH    HL                          ;3d56  e5          
    INC HL                              ;3d57  23          
    AND 00Fh                            ;3d58  e6 0f       
    CALL    PRDMVR                      ;3d5a  cd eb 3d    
    LD  B,(HL)                          ;3d5d  46          
    INC HL                              ;3d5e  23          
    LD  A,028h                          ;3d5f  3e 28       
ARDSLP: CALL    ACCPRT                  ;3d61  cd 64 08    
    PUSH    HL                          ;3d64  e5          
    CALL    INDRCT                      ;3d65  cd a3 2a    
    PUSH    BC                          ;3d68  c5          
    CALL    FIVEPR                      ;3d69  cd e5 16    
    POP BC                              ;3d6c  c1          
    POP HL                              ;3d6d  e1          
    INC HL                              ;3d6e  23          
    INC HL                              ;3d6f  23          
    LD  A,02Ch                          ;3d70  3e 2c       
    DJNZ    ARDSLP                      ;3d72  10 ed       
    LD  A,029h                          ;3d74  3e 29       
    CALL    ACCPRT                      ;3d76  cd 64 08    
    CALL    CR1                         ;3d79  cd 43 08    
    POP HL                              ;3d7c  e1          
    CALL    INDRCT                      ;3d7d  cd a3 2a    
    JR  DMPLOP                          ;3d80  18 c0       
ONLYVR: PUSH    HL                      ;3d82  e5          
    LD  A,(HL)                          ;3d83  7e          
    PUSH    AF                          ;3d84  f5          
    CALL    PRDMVR                      ;3d85  cd eb 3d    
    LD  A,03Dh                          ;3d88  3e 3d       
    CALL    ACCPRT                      ;3d8a  cd 64 08    
    LD  A,(IY+0)                        ;3d8d  fd 7e 00    
    CP  003h                            ;3d90  fe 03       
    JR  NZ,STRDMP                       ;3d92  20 15       
    LD  B,(HL)                          ;3d94  46          
    INC HL                              ;3d95  23          
    CALL    INDRCT                      ;3d96  cd a3 2a    
    EX  DE,HL                           ;3d99  eb          
    LD  A,022h                          ;3d9a  3e 22       
    CALL    ACCPRT                      ;3d9c  cd 64 08    
    CALL    PRTSDC                      ;3d9f  cd e1 07    
    LD  A,022h                          ;3da2  3e 22       
    CALL    ACCPRT                      ;3da4  cd 64 08    
    JR  NXTDMP                          ;3da7  18 20       
                  ;
STRDMP: CP  002h                        ;3da9  fe 02       
    JR  NZ,RALDMP                       ;3dab  20 0e       
    CALL    INDRCT                      ;3dad  cd a3 2a    
    EX  DE,HL                           ;3db0  eb          
    LD  HL,KEYBUF                       ;3db1  21 4f 7a    
    LD  (IY+0),4                        ;3db4  fd 36 00 04 
    CALL    FLTHEX                      ;3db8  cd 02 29    
RALDMP: LD  DE,USINGB                   ;3dbb  11 b1 46    
    PUSH    DE                          ;3dbe  d5          
    CALL    LDIR8                       ;3dbf  cd a6 73    
    POP HL                              ;3dc2  e1          
    CALL    CVNMFL                      ;3dc3  cd 58 5d    
    CALL    PRTSDC                      ;3dc6  cd e1 07    
NXTDMP: CALL    CR1                     ;3dc9  cd 43 08    
    POP AF                              ;3dcc  f1          
    POP HL                              ;3dcd  e1          
    INC A                               ;3dce  3c          
    INC A                               ;3dcf  3c          
    INC A                               ;3dd0  3c          
    LD  E,A                             ;3dd1  5f          
    LD  D,0                             ;3dd2  16 00       
    ADD HL,DE                           ;3dd4  19          
    LD  A,080h                          ;3dd5  3e 80       
    IN  A,(1)                           ;3dd7  db 01       
    AND 004h                            ;3dd9  e6 04       
    CALL    Z,FLSHGT                    ;3ddb  cc 3c 0d    
    CALL    BRKEY                       ;3dde  cd 5b 0c    
    JP  NZ,DMPLOP                       ;3de1  c2 42 3d    
DUMPRT: POP HL                          ;3de4  e1          
    LD  A,1                             ;3de5  3e 01       
    LD  (DISFLG),A                      ;3de7  32 eb 11    
    RET                                 ;3dea  c9          
                  ;
PRDMVR: PUSH    AF                      ;3deb  f5          
    INC HL                              ;3dec  23          
    LD  A,(HL)                          ;3ded  7e          
    CALL    ACCPRT                      ;3dee  cd 64 08    
    INC HL                              ;3df1  23          
    LD  A,(HL)                          ;3df2  7e          
    OR  A                               ;3df3  b7          
    JR  NZ,NTNULD                       ;3df4  20 02       
    LD  A,020h                          ;3df6  3e 20       
NTNULD: CALL    ACCPRT                  ;3df8  cd 64 08    
    INC HL                              ;3dfb  23          
    POP AF                              ;3dfc  f1          
    LD  B,021h                          ;3dfd  06 21       
    CP  004h                            ;3dff  fe 04       
    JR  Z,PTVSBL                        ;3e01  28 0c       
    INC B                               ;3e03  04          
    INC B                               ;3e04  04          
    CP  008h                            ;3e05  fe 08       
    JR  Z,PTVSBL                        ;3e07  28 06       
    INC B                               ;3e09  04          
    CP  003h                            ;3e0a  fe 03       
    JR  Z,PTVSBL                        ;3e0c  28 01       
    INC B                               ;3e0e  04          
PTVSBL: LD  IY,(INTSSP)                 ;3e0f  fd 2a 43 7a 
    LD  (IY+0),A                        ;3e13  fd 77 00    
    LD  A,B                             ;3e16  78          
    CALL    ACCPRT                      ;3e17  cd 64 08    
    RET                                 ;3e1a  c9          
                  ;
CONSOL: JP  NINS                        ;3e1b  c3 fa 20    
                  ;
KLIST:  PUSH    HL                      ;3e1e  e5          
    CALL    CR2                         ;3e1f  cd 23 08    
    LD  C,0                             ;3e22  0e 00       
KLSTLP: LD  A,C                         ;3e24  79          
    CP  009h                            ;3e25  fe 09       
    JR  Z,KLTEN                         ;3e27  28 07       
    ADD A,031h                          ;3e29  c6 31       
    CALL    ACCPRT                      ;3e2b  cd 64 08    
    JR  KLTAB                           ;3e2e  18 09       
KLTEN:  LD  A,031h                      ;3e30  3e 31       
    CALL    ACCPRT                      ;3e32  cd 64 08    
    DEC A                               ;3e35  3d          
    CALL    ACCPRT                      ;3e36  cd 64 08    
KLTAB:  CALL    TABPRT                  ;3e39  cd 02 08    
    LD  A,C                             ;3e3c  79          
    CALL    KEYBCL                      ;3e3d  cd da 3e    
    LD  B,(HL)                          ;3e40  46          
    INC HL                              ;3e41  23          
    XOR A                               ;3e42  af          
    CP  B                               ;3e43  b8          
    JR  Z,KLESC                         ;3e44  28 07       
KLLP1:  LD  A,(HL)                      ;3e46  7e          
    CALL    CTRLPR                      ;3e47  cd 59 3e    
    INC HL                              ;3e4a  23          
    DJNZ    KLLP1                       ;3e4b  10 f9       
KLESC:  CALL    CR2                     ;3e4d  cd 23 08    
    INC C                               ;3e50  0c          
    LD  A,C                             ;3e51  79          
    CP  10                              ;3e52  fe 0a       
    JR  NZ,KLSTLP                       ;3e54  20 ce       
    POP HL                              ;3e56  e1          
    INC HL                              ;3e57  23          
    RET                                 ;3e58  c9          
                  ;
CTRLPR: CP  020h                        ;3e59  fe 20       
    JP  NC,ACCPRT                       ;3e5b  d2 64 08    
    PUSH    AF                          ;3e5e  f5          
    LD  A,05Bh                          ;3e5f  3e 5b       
    CALL    ACCPRT                      ;3e61  cd 64 08    
    POP AF                              ;3e64  f1          
    ADD A,040h                          ;3e65  c6 40       
    CALL    ACCPRT                      ;3e67  cd 64 08    
    LD  A,05Dh                          ;3e6a  3e 5d       
    JP  ACCPRT                          ;3e6c  c3 64 08    
                  ;
KEYON:  JP  NINS                        ;3e6f  c3 fa 20    
                  ;
KEYOFF: JP  NINS                        ;3e72  c3 fa 20    
                  ;
KEY:    CALL    HLFTCH                  ;3e75  cd 87 29    
    CP  086h                            ;3e78  fe 86       
    JP  Z,KLIST                         ;3e7a  ca 1e 3e    
    CP  098h                            ;3e7d  fe 98       
    JR  Z,KEYON                         ;3e7f  28 ee       
    CP  09Ch                            ;3e81  fe 9c       
    JR  Z,KEYOFF                        ;3e83  28 ed       
    LD  C,L                             ;3e85  4d          
    LD  B,H                             ;3e86  44          
    CALL    IHLEXP                      ;3e87  cd cc 22    
    CP  02Ch                            ;3e8a  fe 2c       
    JP  NZ,SERROR                       ;3e8c  c2 3a 17    
    CALL    HCHECK                      ;3e8f  cd d8 22    
    CP  11                              ;3e92  fe 0b       
KIFCVX: JP  NC,IFCALL                   ;3e94  d2 36 17    
    OR  A                               ;3e97  b7          
    JR  Z,KBUFST                        ;3e98  28 25       
    DEC A                               ;3e9a  3d          
    CALL    KEYBCL                      ;3e9b  cd da 3e    
    PUSH    HL                          ;3e9e  e5          
    CALL    STREXX                      ;3e9f  cd 9d 45    
    POP DE                              ;3ea2  d1          
    LD  A,(HL)                          ;3ea3  7e          
    CP  16                              ;3ea4  fe 10       
    JR  C,KLNLMT                        ;3ea6  38 02       
    LD  A,15                            ;3ea8  3e 0f       
KLNLMT: LD  (DE),A                      ;3eaa  12          
    INC DE                              ;3eab  13          
    INC HL                              ;3eac  23          
    PUSH    BC                          ;3ead  c5          
    LD  B,A                             ;3eae  47          
    CALL    INDRCT                      ;3eaf  cd a3 2a    
    XOR A                               ;3eb2  af          
    OR  B                               ;3eb3  b0          
    JR  Z,ESCKPT                        ;3eb4  28 06       
KYPTLP: LD  A,(HL)                      ;3eb6  7e          
    LD  (DE),A                          ;3eb7  12          
    INC DE                              ;3eb8  13          
INDRCT1: INC    HL                      ;3eb9  23          
    DJNZ    KYPTLP                      ;3eba  10 fa       
ESCKPT: POP HL                          ;3ebc  e1          
    DEC HL                              ;3ebd  2b          
    RET                                 ;3ebe  c9          
                  ;
KBUFST: CALL    STREXX                  ;3ebf  cd 9d 45    
    DEC DE                              ;3ec2  1b          
    INC A                               ;3ec3  3c          
    INC A                               ;3ec4  3c          
    LD  HL,POINT1                       ;3ec5  21 04 12    
    LD  (HL),0                          ;3ec8  36 00       
    CP  040h                            ;3eca  fe 40       ;KEY BUFF LIMIT
    JR  C,KBUFSL                        ;3ecc  38 02       
    LD  A,040h                          ;3ece  3e 40       
KBUFSL: PUSH    BC                      ;3ed0  c5          
    LD  B,A                             ;3ed1  47          
KBUFLP: INC HL                          ;3ed2  23          
    LD  (HL),A                          ;3ed3  77          
    LD  A,(DE)                          ;3ed4  1a          
    INC DE                              ;3ed5  13          
    DJNZ    KBUFLP                      ;3ed6  10 fa       
    JR  ESCKPT                          ;3ed8  18 e2       
                  ;
KEYBCL: ADD A,A                         ;3eda  87          
    ADD A,A                             ;3edb  87          
    ADD A,A                             ;3edc  87          
    ADD A,A                             ;3edd  87          
    LD  HL,FUNBUF                       ;3ede  21 66 12    
    ADD A,L                             ;3ee1  85          
    LD  L,A                             ;3ee2  6f          
    LD  A,0                             ;3ee3  3e 00       
    ADC A,H                             ;3ee5  8c          
    LD  H,A                             ;3ee6  67          
    RET                                 ;3ee7  c9          
                  ;
CSRLIN: LD  DE,00008h                   ;3ee8  11 08 00    
    ADD HL,DE                           ;3eeb  19          
    LD  A,(CURY)                        ;3eec  3a ee 11    
    LD  E,A                             ;3eef  5f          
    LD  D,0                             ;3ef0  16 00       
    CALL    FLTHEX                      ;3ef2  cd 02 29    
    LD  A,4                             ;3ef5  3e 04       
    CALL    CONDFL                      ;3ef7  cd eb 28    
    JP  BCFTCH                          ;3efa  c3 c4 25    
                  ;
LNOADR: PUSH    DE                      ;3efd  d5          
    PUSH    HL                          ;3efe  e5          
    LD  HL,ADRNVC                       ;3eff  21 4f 3f    
    LD  (RETLNV),HL                     ;3f02  22 33 3f    
    JR  MIDRLN                          ;3f05  18 0b       
                  ;
RETLNR: POP HL                          ;3f07  e1          
    POP DE                              ;3f08  d1          
    RET                                 ;3f09  c9          
                  ;
RETLNO: PUSH    DE                      ;3f0a  d5          
    PUSH    HL                          ;3f0b  e5          
    LD  HL,RELNVC                       ;3f0c  21 35 3f    
    LD  (RETLNV),HL                     ;3f0f  22 33 3f    
MIDRLN: LD  HL,TEXTST                   ;3f12  21 4e 7c    
    DEC HL                              ;3f15  2b          
RTLLOP: INC HL                          ;3f16  23          
    LD  A,(HL)                          ;3f17  7e          
    INC HL                              ;3f18  23          
    OR  (HL)                            ;3f19  b6          
    JR  Z,RETLNR                        ;3f1a  28 eb       
    INC HL                              ;3f1c  23          
    LD  E,(HL)                          ;3f1d  5e          
    INC HL                              ;3f1e  23          
    LD  D,(HL)                          ;3f1f  56          
    LD  (UDLBUF),DE                     ;3f20  ed 53 82 3f 
RETSTL: CALL    IFSKSB                  ;3f24  cd 40 44    
    OR  A                               ;3f27  b7          
    JR  Z,RTLLOP                        ;3f28  28 ec       
    CP  00Bh                            ;3f2a  fe 0b       
    JR  Z,CVRTLN                        ;3f2c  28 04       
    CP  00Ch                            ;3f2e  fe 0c       
    JR  NZ,RETSTL                       ;3f30  20 f2       
                  ;
CVRTLN: DEFB    0C3H                    ;3f32  c3          ; JP ?
RETLNV: DEFW    RELNVC                  ;3f33  35 3f       
RELNVC: CP  00Bh                        ;3f35  fe 0b       
    JR  Z,RETSTL                        ;3f37  28 eb       
                  ;
CVLNAD: DEC HL                          ;3f39  2b          
    LD  E,(HL)                          ;3f3a  5e          
    INC HL                              ;3f3b  23          
    LD  D,(HL)                          ;3f3c  56          
    PUSH    HL                          ;3f3d  e5          
    EX  DE,HL                           ;3f3e  eb          
    INC HL                              ;3f3f  23          
    INC HL                              ;3f40  23          
    LD  E,(HL)                          ;3f41  5e          
    INC HL                              ;3f42  23          
    LD  D,(HL)                          ;3f43  56          
    POP HL                              ;3f44  e1          
    LD  (HL),D                          ;3f45  72          
    DEC HL                              ;3f46  2b          
    LD  (HL),E                          ;3f47  73          
    DEC HL                              ;3f48  2b          
    LD  (HL),00Bh                       ;3f49  36 0b       
    INC HL                              ;3f4b  23          
    INC HL                              ;3f4c  23          
RTLSHM: JR  RETSTL                      ;3f4d  18 d5       
                  ;
ADRNVC: CP  00Ch                        ;3f4f  fe 0c       
    JR  Z,RETSTL                        ;3f51  28 d1       
    DEC HL                              ;3f53  2b          
    PUSH    HL                          ;3f54  e5          
    CALL    INDRCT                      ;3f55  cd a3 2a    
    LD  E,L                             ;3f58  5d          
    LD  D,H                             ;3f59  54          
    CALL    LNOSER                      ;3f5a  cd 8e 3f    
    JR  C,RENNTF                        ;3f5d  38 0b       
    EX  DE,HL                           ;3f5f  eb          
    POP HL                              ;3f60  e1          
    DEC HL                              ;3f61  2b          
    LD  (HL),00Ch                       ;3f62  36 0c       
    INC HL                              ;3f64  23          
    LD  (HL),E                          ;3f65  73          
    INC HL                              ;3f66  23          
    LD  (HL),D                          ;3f67  72          
RTRNAD: JR  RTLSHM                      ;3f68  18 e3       
                  ;
RENNTF: EX  DE,HL                       ;3f6a  eb          
    LD  DE,UDLMES                       ;3f6b  11 1f 6a    
    LD  B,21                            ;3f6e  06 15       
    CALL    PRTSDC                      ;3f70  cd e1 07    
    CALL    SPPRT                       ;3f73  cd 62 08    
    CALL    FIVEPR                      ;3f76  cd e5 16    
    LD  DE,INMES                        ;3f79  11 0a 17    
    LD  B,4                             ;3f7c  06 04       
    CALL    PRTSDC                      ;3f7e  cd e1 07    
    DEFB    021H                        ;3f81  21          ; LD HL,?
UDLBUF: DEFS    2                       ;3f82              
    CALL    FIVEPR                      ;3f84  cd e5 16    
    CALL    CR2                         ;3f87  cd 23 08    
    POP HL                              ;3f8a  e1          
    INC HL                              ;3f8b  23          
    JR  RTRNAD                          ;3f8c  18 da       
                  ;
LNOSER: PUSH    BC                      ;3f8e  c5          
    PUSH    DE                          ;3f8f  d5          
    EX  DE,HL                           ;3f90  eb          
    LD  HL,TEXTST                       ;3f91  21 4e 7c    
    LD  (TMPUYS),HL                     ;3f94  22 99 3f    
LNOSLP: PUSH    HL                      ;3f97  e5          
    DEFB    021H                        ;3f98  21          ; LD HL,?
TMPUYS: DEFS    2                       ;3f99              
                  ;
    POP HL                              ;3f9b  e1          
    LD  (TMPUYS),HL                     ;3f9c  22 99 3f    
    LD  C,(HL)                          ;3f9f  4e          
    INC HL                              ;3fa0  23          
    LD  B,(HL)                          ;3fa1  46          
    LD  A,B                             ;3fa2  78          
    OR  C                               ;3fa3  b1          
    JR  Z,LMIDET1                       ;3fa4  28 1e       
    PUSH    BC                          ;3fa6  c5          
    INC HL                              ;3fa7  23          
    LD  C,(HL)                          ;3fa8  4e          
    INC HL                              ;3fa9  23          
    LD  B,(HL)                          ;3faa  46          
    LD  A,C                             ;3fab  79          
    CP  E                               ;3fac  bb          
    JR  NZ,NOMTCH                       ;3fad  20 0c       
    LD  A,B                             ;3faf  78          
    CP  D                               ;3fb0  ba          
    DEC HL                              ;3fb1  2b          
    DEC HL                              ;3fb2  2b          
    DEC HL                              ;3fb3  2b          
    JR  NZ,NOMTCH                       ;3fb4  20 05       
    POP BC                              ;3fb6  c1          
    OR  A                               ;3fb7  b7          
NTFRET: POP DE                          ;3fb8  d1          
    POP BC                              ;3fb9  c1          
    RET                                 ;3fba  c9          
                  ;
NOMTCH: PUSH    DE                      ;3fbb  d5          
    EX  DE,HL                           ;3fbc  eb          
    OR  A                               ;3fbd  b7          
    SBC HL,BC                           ;3fbe  ed 42       
    POP DE                              ;3fc0  d1          
    POP HL                              ;3fc1  e1          
    JR  NC,LNOSLP                       ;3fc2  30 d3       
LMIDET1: SCF                            ;3fc4  37          
    JR  NTFRET                          ;3fc5  18 f1       
                  ;
GTSTED: LD  DE,00000h                   ;3fc7  11 00 00    
    LD  BC,0FFFFh                       ;3fca  01 ff ff    
    CALL    HLFTCH                      ;3fcd  cd 87 29    
    OR  A                               ;3fd0  b7          
    RET Z                               ;3fd1  c8          
    CP  03Ah                            ;3fd2  fe 3a       
    RET Z                               ;3fd4  c8          
    CP  02Dh                            ;3fd5  fe 2d       
    JR  Z,GTNXNM                        ;3fd7  28 2c       
    CP  02Ch                            ;3fd9  fe 2c       
    JR  Z,GTNXNM                        ;3fdb  28 28       
    CP  02Eh                            ;3fdd  fe 2e       
    JR  NZ,FSTNUB                       ;3fdf  20 06       
    LD  DE,(EDLINE)                     ;3fe1  ed 5b 2a 37 
    JR  NX2C2D                          ;3fe5  18 09       
FSTNUB: CP  00Bh                        ;3fe7  fe 0b       
GSESER: JP  NZ,SERROR                   ;3fe9  c2 3a 17    
    INC HL                              ;3fec  23          
    LD  E,(HL)                          ;3fed  5e          
    INC HL                              ;3fee  23          
    LD  D,(HL)                          ;3fef  56          
NX2C2D: INC HL                          ;3ff0  23          
    CALL    HLFTCH                      ;3ff1  cd 87 29    
    CP  02Dh                            ;3ff4  fe 2d       
    JR  Z,GTNXNM                        ;3ff6  28 0d       
    CP  02Ch                            ;3ff8  fe 2c       
    JR  Z,GTNXNM                        ;3ffa  28 09       
    LD  C,E                             ;3ffc  4b          
    LD  B,D                             ;3ffd  42          
    OR  A                               ;3ffe  b7          
    RET Z                               ;3fff  c8          
    CP  03AH                            ;4000  fe 3a       
    RET Z                               ;4002  c8          
    JR  GSESER                          ;4003  18 e4       
                  ;
GTNXNM: INC HL                          ;4005  23          
    CALL    HLFTCH                      ;4006  cd 87 29    
    OR  A                               ;4009  b7          
    RET Z                               ;400a  c8          
    CP  03Ah                            ;400b  fe 3a       
    RET Z                               ;400d  c8          
    CP  02Eh                            ;400e  fe 2e       
    JR  NZ,GTEDNO                       ;4010  20 06       
    LD  BC,(EDLINE)                     ;4012  ed 4b 2a 37 
    INC HL                              ;4016  23          
    RET                                 ;4017  c9          
                  ;
GTEDNO: CP  00Bh                        ;4018  fe 0b       
    JR  NZ,GSESER                       ;401a  20 cd       
    INC HL                              ;401c  23          
    LD  C,(HL)                          ;401d  4e          
    INC HL                              ;401e  23          
    LD  B,(HL)                          ;401f  46          
    INC HL                              ;4020  23          
    RET                                 ;4021  c9          
                  ;
EDIT:   CALL    GTSTED                  ;4022  cd c7 3f    
    PUSH    DE                          ;4025  d5          
    EX  DE,HL                           ;4026  eb          
    CALL    LNOSER                      ;4027  cd 8e 3f    
    JP  C,UDFLNO                        ;402a  da dc 43    
    XOR A                               ;402d  af          
    LD  (DISFLG),A                      ;402e  32 eb 11    
    EX  DE,HL                           ;4031  eb          
    POP HL                              ;4032  e1          
    CALL    FIVEPR                      ;4033  cd e5 16    
    CALL    SPPRT                       ;4036  cd 62 08    
    EX  DE,HL                           ;4039  eb          
    LD  DE,4                            ;403a  11 04 00    
    ADD HL,DE                           ;403d  19          
    CALL    ONELST                      ;403e  cd 28 41    
    LD  A,1                             ;4041  3e 01       
    LD  (DISFLG),A                      ;4043  32 eb 11    
EDBKLP: LD  A,29                        ;4046  3e 1d       ;CURLEFT CODE
    CALL    ACCPRT                      ;4048  cd 64 08    
    DJNZ    EDBKLP                      ;404b  10 f9       
    JP  AUTOBK                          ;404d  c3 8b 14    
                  ;
SLIST:  PUSH    BC                      ;4050  c5          
    PUSH    DE                          ;4051  d5          
    PUSH    HL                          ;4052  e5          
    LD  HL,SERVEC                       ;4053  21 58 32    
    LD  (SAVEVC),HL                     ;4056  22 f6 40    
    LD  HL,SER0DH                       ;4059  21 89 32    
    JR  SDXSET                          ;405c  18 0c       
                  ;
CLIST:  PUSH    BC                      ;405e  c5          
    PUSH    DE                          ;405f  d5          
    PUSH    HL                          ;4060  e5          
    LD  HL,COUTCH                       ;4061  21 f8 40    
    LD  (SAVEVC),HL                     ;4064  22 f6 40    
    LD  HL,COUT0D                       ;4067  21 06 41    
SDXSET: LD  DE,00000h                   ;406a  11 00 00    
    LD  BC,0FFFFh                       ;406d  01 ff ff    
    JR  CLISTM                          ;4070  18 1f       
                  ;
LIST#:  CALL    HLFTCH                  ;4072  cd 87 29    
    CP  02Ch                            ;4075  fe 2c       
    JR  NZ,LIST##                       ;4077  20 01       
    INC HL                              ;4079  23          
LIST##: LD  A,2                         ;407a  3e 02       
    JR  LIST#E                          ;407c  18 01       
                  ;
LIST:   XOR A                           ;407e  af          
LIST#E: LD  (DISFLG),A                  ;407f  32 eb 11    
    PUSH    BC                          ;4082  c5          
    PUSH    DE                          ;4083  d5          
    CALL    GTSTED                      ;4084  cd c7 3f    
    PUSH    HL                          ;4087  e5          
    LD  HL,CRTVEC                       ;4088  21 fd 40    
    LD  (SAVEVC),HL                     ;408b  22 f6 40    
    LD  HL,CRTCR2                       ;408e  21 0e 41    
CLISTM: LD  (LSCRVC),HL                 ;4091  22 04 41    
    LD  (LISTSN),DE                     ;4094  ed 53 ae 40 
    LD  (LISTEN),BC                     ;4098  ed 43 bc 40 
    LD  HL,TEXTST                       ;409c  21 4e 7c    
LISTLP: LD  E,(HL)                      ;409f  5e          
    INC HL                              ;40a0  23          
    LD  D,(HL)                          ;40a1  56          
    INC HL                              ;40a2  23          
    LD  A,D                             ;40a3  7a          
    OR  E                               ;40a4  b3          
    JR  Z,LISTE'                        ;40a5  28 1e       
    PUSH    DE                          ;40a7  d5          
    LD  E,(HL)                          ;40a8  5e          
    INC HL                              ;40a9  23          
    LD  D,(HL)                          ;40aa  56          
    INC HL                              ;40ab  23          
    PUSH    HL                          ;40ac  e5          
    DEFB    021H                        ;40ad  21          ; LD HL,?
LISTSN: DEFS    2                       ;40ae              
    OR  A                               ;40b0  b7          
    SBC HL,DE                           ;40b1  ed 52       
    JR  C,LISTRT                        ;40b3  38 06       
    JR  Z,LISTRT                        ;40b5  28 04       
    POP HL                              ;40b7  e1          
    POP HL                              ;40b8  e1          
LISTL': JR  LISTLP                      ;40b9  18 e4       
                  ;
LISTRT: DEFB    021H                    ;40bb  21          ; LD HL,?
LISTEN: DEFS    2                       ;40bc              
    OR  A                               ;40be  b7          
    SBC HL,DE                           ;40bf  ed 52       
    JR  NC,LOKJMN                       ;40c1  30 04       
    POP HL                              ;40c3  e1          
    POP HL                              ;40c4  e1          
LISTE': JR  LISTED                      ;40c5  18 58       
                  ;
LOKJMN: EX  DE,HL                       ;40c7  eb          
    LD  (EDLINE),HL                     ;40c8  22 2a 37    
    LD  DE,KEYBUF                       ;40cb  11 4f 7a    
    CALL    ASCHL                       ;40ce  cd a8 62    
    LD  HL,00005h                       ;40d1  21 05 00    
    ADD HL,DE                           ;40d4  19          
    LD  (HL),020h                       ;40d5  36 20       
    INC HL                              ;40d7  23          
    EX  DE,HL                           ;40d8  eb          
    POP HL                              ;40d9  e1          
    CALL    CVTXIM                      ;40da  cd 3a 65    
    LD  DE,KEYBUF                       ;40dd  11 4f 7a    
    PUSH    BC                          ;40e0  c5          
    LD  B,5                             ;40e1  06 05       
LZSKL:  LD  A,(DE)                      ;40e3  1a          
    CP  030h                            ;40e4  fe 30       
    INC DE                              ;40e6  13          
    JR  NZ,LTSKZR                       ;40e7  20 02       
    DJNZ    LZSKL                       ;40e9  10 f8       
LTSKZR: POP BC                          ;40eb  c1          
    DEC DE                              ;40ec  1b          
    LD  (SERDIS),DE                     ;40ed  ed 53 78 32 
LIST0L: LD  A,(DE)                      ;40f1  1a          
    OR  A                               ;40f2  b7          
    JR  Z,ESCLOT                        ;40f3  28 0e       
    DEFB    0C3H                        ;40f5  c3          ; JP ?
SAVEVC: DEFS    2                       ;40f6              
COUTCH: CALL    CTOUT                   ;40f8  cd 58 45    
    JR  CTIRTR                          ;40fb  18 03       
                  ;
CRTVEC: CALL    ACCPRT                  ;40fd  cd 64 08    
CTIRTR: INC DE                          ;4100  13          
    JR  LIST0L                          ;4101  18 ee       
ESCLOT: DEFB    0C3H                    ;4103  c3          ; JP ?
LSCRVC: DEFS    2                       ;4104              
COUT0D: LD  A,00Dh                      ;4106  3e 0d       
    CALL    CTOUT                       ;4108  cd 58 45    
    POP HL                              ;410b  e1          
    JR  LSTCR'                          ;410c  18 04       
CRTCR2: CALL    CR2                     ;410e  cd 23 08    
                  ;
LISCRC: POP HL                          ;4111  e1          
LSTCR': LD  A,080h                      ;4112  3e 80       ;SPACE STOP
    IN  A,(1)                           ;4114  db 01       
    AND 4                               ;4116  e6 04       
    JR  Z,LSTCR'                        ;4118  28 f8       
    CALL    BRKEY                       ;411a  cd 5b 0c    
    JR  NZ,LISTL'                       ;411d  20 9a       
                  
LISTED: POP HL                          ;411f  e1          
    POP DE                              ;4120  d1          
    POP BC                              ;4121  c1          
    LD  A,1                             ;4122  3e 01       
    LD  (DISFLG),A                      ;4124  32 eb 11    
    RET                                 ;4127  c9          
                  ;
ONELST: PUSH    HL                      ;4128  e5          
    LD  DE,KEYBUF                       ;4129  11 4f 7a    
    CALL    CVTXIM                      ;412c  cd 3a 65    
    LD  B,0                             ;412f  06 00       
ONLZLP: LD  A,(DE)                      ;4131  1a          
    OR  A                               ;4132  b7          
    JR  Z,ONLSRT                        ;4133  28 07       
    CALL    ACCPRT                      ;4135  cd 64 08    
    INC DE                              ;4138  13          
    INC B                               ;4139  04          
    JR  ONLZLP                          ;413a  18 f5       
ONLSRT: POP HL                          ;413c  e1          
    RET                                 ;413d  c9          
                  ;
UNTIL:  POP DE                          ;413e  d1          
    POP BC                              ;413f  c1          
    PUSH    BC                          ;4140  c5          
    INC B                               ;4141  04          
UNWTRP: LD  A,24                        ;4142  3e 18       
    JP  NZ,ERROR                        ;4144  c2 96 21    
    LD  A,C                             ;4147  79          
    ADD A,6                             ;4148  c6 06       
    JR  NZ,UNWTRP                       ;414a  20 f6       
    PUSH    DE                          ;414c  d5          
    LD  C,L                             ;414d  4d          
    LD  B,H                             ;414e  44          
    CALL    FLEXPR                      ;414f  cd 99 22    
    LD  A,(HL)                          ;4152  7e          
    OR  A                               ;4153  b7          
    LD  L,C                             ;4154  69          
    LD  H,B                             ;4155  60          
    DEC HL                              ;4156  2b          
    JR  NZ,ESCUTL                       ;4157  20 17       
    LD  HL,4                            ;4159  21 04 00    
UNTILM: ADD HL,SP                       ;415c  39          
    LD  E,(HL)                          ;415d  5e          
    INC HL                              ;415e  23          
    LD  D,(HL)                          ;415f  56          
    INC HL                              ;4160  23          
    LD  (LNOBUF),DE                     ;4161  ed 53 cc 16 
    LD  E,(HL)                          ;4165  5e          
    INC HL                              ;4166  23          
    LD  D,(HL)                          ;4167  56          
    LD  (NXTLPT),DE                     ;4168  ed 53 12 16 
    INC HL                              ;416c  23          
    JP  INDRCT                          ;416d  c3 a3 2a    
                  ;
ESCUTL: POP IX                          ;4170  dd e1       
    POP BC                              ;4172  c1          
    POP BC                              ;4173  c1          
    POP BC                              ;4174  c1          
    POP BC                              ;4175  c1          
    JP  (IX)                            ;4176  dd e9       
                  ;
RETURN: POP IX                          ;4178  dd e1       
RTAGPO: POP BC                          ;417a  c1          
    INC BC                              ;417b  03          
    LD  A,B                             ;417c  78          
    OR  C                               ;417d  b1          
    JR  Z,RTWGOS                        ;417e  28 1d       
    INC BC                              ;4180  03          
    LD  A,B                             ;4181  78          
    OR  C                               ;4182  b1          
    JR  NZ,FPOPRT                       ;4183  20 1e       
    CALL    HLFTCH                      ;4185  cd 87 29    
    EX  DE,HL                           ;4188  eb          
    POP HL                              ;4189  e1          
    LD  (LNOBUF),HL                     ;418a  22 cc 16    
    POP HL                              ;418d  e1          
    LD  (NXTLPT),HL                     ;418e  22 12 16    
    POP HL                              ;4191  e1          
    PUSH    IX                          ;4192  dd e5       
    CP  03Ah                            ;4194  fe 3a       
    RET Z                               ;4196  c8          
    OR  A                               ;4197  b7          
    RET Z                               ;4198  c8          
    EX  DE,HL                           ;4199  eb          
    JP  GOTO                            ;419a  c3 b1 43    
                  ;
RTWGOS: LD  A,3                         ;419d  3e 03       
    PUSH    BC                          ;419f  c5          
    JP  ERROR                           ;41a0  c3 96 21    
                  ;
FPOPRT: DEC BC                          ;41a3  0b          
    DEC BC                              ;41a4  0b          
    XOR A                               ;41a5  af          
    CP  C                               ;41a6  b9          
    JR  NZ,RTWGOS                       ;41a7  20 f4       
    EX  DE,HL                           ;41a9  eb          
    LD  HL,22                           ;41aa  21 16 00    
    ADD HL,SP                           ;41ad  39          
    LD  SP,HL                           ;41ae  f9          
    EX  DE,HL                           ;41af  eb          
    JR  RTAGPO                          ;41b0  18 c8       
                  ;
WHILE:  POP BC                          ;41b2  c1          
    PUSH    HL                          ;41b3  e5          
    EX  DE,HL                           ;41b4  eb          
    LD  HL,(NXTLPT)                     ;41b5  2a 12 16    
    LD  (WHNLPT),HL                     ;41b8  22 d1 41    
    PUSH    HL                          ;41bb  e5          
    LD  HL,(LNOBUF)                     ;41bc  2a cc 16    
    LD  (WHNLBF),HL                     ;41bf  22 d7 41    
    PUSH    HL                          ;41c2  e5          
    LD  HL,0FFF9h                       ;41c3  21 f9 ff    
    PUSH    HL                          ;41c6  e5          
    CALL    MEMCHK                      ;41c7  cd b0 1e    
    EX  DE,HL                           ;41ca  eb          
    DEC HL                              ;41cb  2b          
    CALL    SKIPWH                      ;41cc  cd 0b 42    
    EX  DE,HL                           ;41cf  eb          
    DEFB    021H                        ;41d0  21          ; LD HL,?
WHNLPT: DEFS    2                       ;41d1              
    LD  (NXTLPT),HL                     ;41d3  22 12 16    
    DEFB    021H                        ;41d6  21          ; LD HL,?
WHNLBF: DEFS    2                       ;41d7              
    LD  (LNOBUF),HL                     ;41d9  22 cc 16    
    EX  DE,HL                           ;41dc  eb          
    PUSH    BC                          ;41dd  c5          
    INC HL                              ;41de  23          
WEND:   POP DE                          ;41df  d1          
    POP BC                              ;41e0  c1          
    PUSH    BC                          ;41e1  c5          
    INC B                               ;41e2  04          
WENDER: LD  A,26                        ;41e3  3e 1a       
    JP  NZ,ERROR                        ;41e5  c2 96 21    
    LD  A,007h                          ;41e8  3e 07       
    ADD A,C                             ;41ea  81          
    JR  NZ,WENDER                       ;41eb  20 f6       
    PUSH    DE                          ;41ed  d5          
    PUSH    HL                          ;41ee  e5          
    LD  HL,10                           ;41ef  21 0a 00    
    ADD HL,SP                           ;41f2  39          
    CALL    INDRCT                      ;41f3  cd a3 2a    
    LD  C,L                             ;41f6  4d          
    LD  B,H                             ;41f7  44          
    CALL    FLEXPR                      ;41f8  cd 99 22    
    LD  A,(HL)                          ;41fb  7e          
    OR  A                               ;41fc  b7          
    POP HL                              ;41fd  e1          
    JP  Z,ESCUTL                        ;41fe  ca 70 41    
    PUSH    BC                          ;4201  c5          
    LD  HL,8                            ;4202  21 08 00    
    CALL    UNTILM                      ;4205  cd 5c 41    
    POP HL                              ;4208  e1          
    DEC HL                              ;4209  2b          
    RET                                 ;420a  c9          
                  ;
SKIPWH: CALL    IFSKSB                  ;420b  cd 40 44    
    OR  A                               ;420e  b7          
    JR  Z,SKWHEL                        ;420f  28 0c       
    CP  09Eh                            ;4211  fe 9e       
    RET Z                               ;4213  c8          
    CP  09Dh                            ;4214  fe 9d       
    JR  NZ,SKIPWH                       ;4216  20 f3       
    CALL    SKIPWH                      ;4218  cd 0b 42    
    JR  SKIPWH                          ;421b  18 ee       
                  ;
SKWHEL: INC HL                          ;421d  23          
    LD  E,(HL)                          ;421e  5e          
    INC HL                              ;421f  23          
    LD  D,(HL)                          ;4220  56          
    INC HL                              ;4221  23          
    LD  A,D                             ;4222  7a          
    OR  E                               ;4223  b3          
    LD  A,25                            ;4224  3e 19       
    JP  Z,ERROR                         ;4226  ca 96 21    
    LD  (WHNLPT),DE                     ;4229  ed 53 d1 41 
    LD  E,(HL)                          ;422d  5e          
    INC HL                              ;422e  23          
    LD  D,(HL)                          ;422f  56          
    LD  (WHNLBF),DE                     ;4230  ed 53 d7 41 
    JR  SKIPWH                          ;4234  18 d5       
                  ;
REPTON: LD  DE,200                      ;4236  11 c8 00    
    JR  REPTST                          ;4239  18 03       
                  ;
REPOFF: LD  DE,0FFFFh                   ;423b  11 ff ff    
REPTST: LD  (REPTSW),DE                 ;423e  ed 53 c9 0c 
    INC HL                              ;4242  23          
    RET                                 ;4243  c9          
                  ;
REPEAT: CALL    HLFTCH                  ;4244  cd 87 29    
    CP  098h                            ;4247  fe 98       
    JR  Z,REPTON                        ;4249  28 eb       
    CP  09Ch                            ;424b  fe 9c       
    JR  Z,REPOFF                        ;424d  28 ec       
    POP BC                              ;424f  c1          
    PUSH    HL                          ;4250  e5          
    EX  DE,HL                           ;4251  eb          
    LD  HL,(NXTLPT)                     ;4252  2a 12 16    
    PUSH    HL                          ;4255  e5          
    LD  HL,(LNOBUF)                     ;4256  2a cc 16    
    PUSH    HL                          ;4259  e5          
    LD  HL,0FFFAh                       ;425a  21 fa ff    ; REPEAT MARK
    PUSH    HL                          ;425d  e5          
    EX  DE,HL                           ;425e  eb          
    PUSH    BC                          ;425f  c5          
    JP  MEMCHK                          ;4260  c3 b0 1e    
                  ;
GOSUB:  POP BC                          ;4263  c1          
    CALL    HLFTCH                      ;4264  cd 87 29    
    CP  00Bh                            ;4267  fe 0b       
    JR  Z,GOSNDQ                        ;4269  28 15       
    CP  00Ch                            ;426b  fe 0c       
    JR  Z,GOSNDQ                        ;426d  28 11       
    PUSH    HL                          ;426f  e5          
    PUSH    BC                          ;4270  c5          
    CALL    STREXZ                      ;4271  cd 9b 45    
    DEC BC                              ;4274  0b          
    LD  L,C                             ;4275  69          
    LD  H,B                             ;4276  60          
    POP BC                              ;4277  c1          
    EX  (SP),HL                         ;4278  e3          
    INC HL                              ;4279  23          
    INC HL                              ;427a  23          
    INC HL                              ;427b  23          
    LD  A,022h                          ;427c  3e 22       
    JR  GOSMID                          ;427e  18 04       
GOSNDQ: INC HL                          ;4280  23          
    INC HL                              ;4281  23          
    INC HL                              ;4282  23          
    PUSH    HL                          ;4283  e5          
GOSMID: EX  DE,HL                       ;4284  eb          
    LD  HL,(NXTLPT)                     ;4285  2a 12 16    
    PUSH    HL                          ;4288  e5          
    LD  HL,(LNOBUF)                     ;4289  2a cc 16    
    PUSH    HL                          ;428c  e5          
    LD  HL,0FFFEh                       ;428d  21 fe ff    
    PUSH    HL                          ;4290  e5          
    EX  DE,HL                           ;4291  eb          
    PUSH    BC                          ;4292  c5          
    CALL    MEMCHK                      ;4293  cd b0 1e    
    DEC HL                              ;4296  2b          
    DEC HL                              ;4297  2b          
    JP  MIDLAG                          ;4298  c3 b5 43    
                  ;
OGSJMP: PUSH    HL                      ;429b  e5          
    CALL    DATA                        ;429c  cd c8 1c    
    POP DE                              ;429f  d1          
    POP BC                              ;42a0  c1          
    PUSH    HL                          ;42a1  e5          
    EX  DE,HL                           ;42a2  eb          
    CALL    HLFTCH                      ;42a3  cd 87 29    
    INC HL                              ;42a6  23          
    INC HL                              ;42a7  23          
    INC HL                              ;42a8  23          
    JR  GOSMID                          ;42a9  18 d9       
                  ;
LBLGOT: DEC HL                          ;42ab  2b          
    CALL    LBLSER                      ;42ac  cd be 42    
    PUSH    HL                          ;42af  e5          
    LD  HL,(LBLNXT)                     ;42b0  2a d3 42    
    LD  (NXTLPT),HL                     ;42b3  22 12 16    
    DEFB    021H                        ;42b6  21          ; LD HL,?
LBLLNO: DEFS    2                       ;42b7              
    LD  (LNOBUF),HL                     ;42b9  22 cc 16    
    POP HL                              ;42bc  e1          
    RET                                 ;42bd  c9          
                  ;
LBLSER: CALL    STREXZ                  ;42be  cd 9b 45    
    OR  A                               ;42c1  b7          
    JP  Z,UDFLNO                        ;42c2  ca dc 43    
    LD  (LBLLEN),A                      ;42c5  32 fd 42    
    LD  (LBLDEB),DE                     ;42c8  ed 53 0c 43 
    LD  HL,TEXTST                       ;42cc  21 4e 7c    
    LD  (LBLNXT),HL                     ;42cf  22 d3 42    
LBLSLP: DEFB    021H                    ;42d2  21          ; LD HL,?
LBLNXT: DEFS    2                       ;42d3              
    LD  (CURLPT),HL                     ;42d5  22 53 43    
    LD  E,(HL)                          ;42d8  5e          
    INC HL                              ;42d9  23          
    LD  D,(HL)                          ;42da  56          
    INC HL                              ;42db  23          
    LD  A,D                             ;42dc  7a          
    OR  E                               ;42dd  b3          
    JP  Z,UDFLNO                        ;42de  ca dc 43    
    LD  (LBLNXT),DE                     ;42e1  ed 53 d3 42 
    LD  E,(HL)                          ;42e5  5e          
    INC HL                              ;42e6  23          
    LD  D,(HL)                          ;42e7  56          
    LD  (LBLLNO),DE                     ;42e8  ed 53 b7 42 
NOTLBL: CALL    IFSKSB                  ;42ec  cd 40 44    ; SKIP SMBL
    OR  A                               ;42ef  b7          
    JR  Z,LBLSLP                        ;42f0  28 e0       
    CP  0C2h                            ;42f2  fe c2       
    JR  NZ,NOTLBL                       ;42f4  20 f6       
    INC HL                              ;42f6  23          
    CALL    STREXZ                      ;42f7  cd 9b 45    
    DEC BC                              ;42fa  0b          
    PUSH    BC                          ;42fb  c5          
    DEFB    0FEH                        ;42fc  fe          ; CP ?
LBLLEN: DEFS    1                       ;42fd              
    JR  NZ,LBLNMT                       ;42fe  20 19       
    LD  C,A                             ;4300  4f          
    LD  B,000h                          ;4301  06 00       
    EX  DE,HL                           ;4303  eb          
    LD  DE,KEYBUF                       ;4304  11 4f 7a    
    PUSH    DE                          ;4307  d5          
    LDIR                                ;4308  ed b0       
    LD  B,A                             ;430a  47          
    DEFB    011H                        ;430b  11          ; LD DE,?
LBLDEB: DEFS    2                       ;430c              
    POP HL                              ;430e  e1          
LBLMTL: LD  A,(DE)                      ;430f  1a          
    CP  (HL)                            ;4310  be          
    JR  NZ,LBLNMT                       ;4311  20 06       
    INC HL                              ;4313  23          
    INC DE                              ;4314  13          
    DJNZ    LBLMTL                      ;4315  10 f8       
    POP HL                              ;4317  e1          
    RET                                 ;4318  c9          
                  ;
LBLNMT: POP HL                          ;4319  e1          
    DEC HL                              ;431a  2b          
    JR  NOTLBL                          ;431b  18 cf       
                  ;
ONERRG: INC HL                          ;431d  23          
    CALL    HLFTCH                      ;431e  cd 87 29    
    CP  081h                            ;4321  fe 81       
    JP  NZ,SERROR                       ;4323  c2 3a 17    
    INC HL                              ;4326  23          
    CALL    HLFTCH                      ;4327  cd 87 29    
    CP  00Bh                            ;432a  fe 0b       
    JR  NZ,ONERDQ                       ;432c  20 1b       
    INC HL                              ;432e  23          
    PUSH    HL                          ;432f  e5          
    CALL    INDRCT                      ;4330  cd a3 2a    
    LD  A,L                             ;4333  7d          
    OR  H                               ;4334  b4          
    JR  Z,OEROFF                        ;4335  28 2f       
    CALL    LNOSER                      ;4337  cd 8e 3f    
    JP  C,UDFLNO                        ;433a  da dc 43    
    LD  (ERRORV),HL                     ;433d  22 83 21    
    LD  A,1                             ;4340  3e 01       
OEROF': LD  (ERRORF),A                  ;4342  32 50 22    
    POP HL                              ;4345  e1          
    INC HL                              ;4346  23          
    INC HL                              ;4347  23          
    RET                                 ;4348  c9          
                  ;
ONERDQ: CP  022h                        ;4349  fe 22       
    JP  NZ,UDFLNO                       ;434b  c2 dc 43    
    PUSH    HL                          ;434e  e5          
    CALL    LBLSER                      ;434f  cd be 42    
    DEFB    021H                        ;4352  21          ; LD HL,?
CURLPT: DEFS    2                       ;4353              
    LD  (ERRORV),HL                     ;4355  22 83 21    
    POP HL                              ;4358  e1          
    CALL    IFDQSK                      ;4359  cd 64 44    
    OR  A                               ;435c  b7          
    JR  Z,DQOENB                        ;435d  28 01       
    INC HL                              ;435f  23          
DQOENB: LD  A,1                         ;4360  3e 01       
    LD  (ERRORF),A                      ;4362  32 50 22    
    RET                                 ;4365  c9          
                  ;
OEROFF: LD  A,(ERRORF)                  ;4366  3a 50 22    
    CP  002h                            ;4369  fe 02       
    LD  A,0                             ;436b  3e 00       
    JR  NZ,OEROF'                       ;436d  20 d3       
    JP  RESERR                          ;436f  c3 8d 22    
                  ;
ON: LD  C,L                             ;4372  4d          
    LD  B,H                             ;4373  44          
    CALL    HLFTCH                      ;4374  cd 87 29    
    CP  0B5h                            ;4377  fe b5       
    JR  Z,ONERRG                        ;4379  28 a2       
    CALL    FLEXPR                      ;437b  cd 99 22    
    LD  DE,OGSJMP                       ;437e  11 9b 42    
    CP  082h                            ;4381  fe 82       
    JR  Z,OGOSUB                        ;4383  28 08       
    LD  DE,GOTO                         ;4385  11 b1 43    
    CP  081h                            ;4388  fe 81       
    JP  NZ,SERROR                       ;438a  c2 3a 17    
OGOSUB: PUSH    DE                      ;438d  d5          
    CALL    HLFLT                       ;438e  cd 67 61    
    JR  C,ODATA                         ;4391  38 18       
    LD  A,H                             ;4393  7c          
    OR  A                               ;4394  b7          
    JR  NZ,ODATA                        ;4395  20 14       
    LD  A,L                             ;4397  7d          
    OR  A                               ;4398  b7          
    JR  Z,ODATA                         ;4399  28 10       
    LD  L,C                             ;439b  69          
    LD  H,B                             ;439c  60          
    LD  B,A                             ;439d  47          
ONLNOS: DEC B                           ;439e  05          
    RET Z                               ;439f  c8          
    CALL    LNRGCK                      ;43a0  cd eb 43    
    CP  02Ch                            ;43a3  fe 2c       
    INC HL                              ;43a5  23          
    JR  Z,ONLNOS                        ;43a6  28 f6       
    DEC HL                              ;43a8  2b          
    POP DE                              ;43a9  d1          
    RET                                 ;43aa  c9          
                  ;
ODATA:  POP DE                          ;43ab  d1          
    LD  L,C                             ;43ac  69          
    LD  H,B                             ;43ad  60          
    JP  DATA                            ;43ae  c3 c8 1c    
                  ;
GOTO:   CALL    HLFTCH                  ;43b1  cd 87 29    
IFGOTO: INC HL                          ;43b4  23          
MIDLAG: CP  00Ch                        ;43b5  fe 0c       
    JR  NZ,SERGOT                       ;43b7  20 0a       
    CALL    INDRCT                      ;43b9  cd a3 2a    
LNSGOT: LD  (NXTLPT),HL                 ;43bc  22 12 16    ;"
                  ;XOR A
                  ;LD (CON
    POP BC                              ;43bf  c1          
    JP  NXLINE                          ;43c0  c3 11 16    
                  ;
SERGOT: CP  00Bh                        ;43c3  fe 0b       
    JP  NZ,LBLGOT                       ;43c5  c2 ab 42    
    LD  E,(HL)                          ;43c8  5e          
    INC HL                              ;43c9  23          
    LD  D,(HL)                          ;43ca  56          
    EX  DE,HL                           ;43cb  eb          
    CALL    LNOSER                      ;43cc  cd 8e 3f    
    JR  C,UDFLNO                        ;43cf  38 0b       
    EX  DE,HL                           ;43d1  eb          
    LD  (HL),D                          ;43d2  72          
    DEC HL                              ;43d3  2b          
    LD  (HL),E                          ;43d4  73          
    DEC HL                              ;43d5  2b          
    LD  (HL),00Ch                       ;43d6  36 0c       
    EX  DE,HL                           ;43d8  eb          
    JP  LNSGOT                          ;43d9  c3 bc 43    
                  ;
UDFLNO: LD  A,8                         ;43dc  3e 08       
    JP  ERROR                           ;43de  c3 96 21    
                  ;
ONGDQT: CALL    IFDQSK                  ;43e1  cd 64 44    
    OR  A                               ;43e4  b7          
    JR  Z,HLFVEC                        ;43e5  28 14       
    INC HL                              ;43e7  23          
    JP  HLFTCH                          ;43e8  c3 87 29    
                  ;
LNRGCK: CALL    HLFTCH                  ;43eb  cd 87 29    
    CP  022h                            ;43ee  fe 22       
    JR  Z,ONGDQT                        ;43f0  28 ef       
    INC HL                              ;43f2  23          
    INC HL                              ;43f3  23          
    INC HL                              ;43f4  23          
    CP  00Bh                            ;43f5  fe 0b       
    JR  Z,HLFVEC                        ;43f7  28 02       
    CP  00Ch                            ;43f9  fe 0c       
HLFVEC: JP  Z,HLFTCH                    ;43fb  ca 87 29    
    JP  SERROR                          ;43fe  c3 3a 17    
                  ;
IF: LD  C,L                             ;4401  4d          
    LD  B,H                             ;4402  44          
    CALL    FLEXPR                      ;4403  cd 99 22    
    EX  AF,AF'                          ;4406  08          
    LD  A,(HL)                          ;4407  7e          
    OR  A                               ;4408  b7          
    LD  L,C                             ;4409  69          
    LD  H,B                             ;440a  60          
    DEC HL                              ;440b  2b          
    JR  Z,IFALSE                        ;440c  28 15       
    EX  AF,AF'                          ;440e  08          
    CP  0E1h                            ;440f  fe e1       
    RET NZ                              ;4411  c0          
ELSEMD: INC HL                          ;4412  23          
    CALL    HLFTCH                      ;4413  cd 87 29    
    CP  00Bh                            ;4416  fe 0b       
    JR  Z,IFGOTO                        ;4418  28 9a       
    CP  00Ch                            ;441a  fe 0c       
    JR  Z,IFGOTO                        ;441c  28 96       
    CP  022h                            ;441e  fe 22       
    JR  Z,IFGOTO                        ;4420  28 92       
    RET                                 ;4422  c9          
                  ;
IFALSE: DEC HL                          ;4423  2b          
    CALL    IFSKIP                      ;4424  cd 2d 44    
    JR  NC,ELSEMD                       ;4427  30 e9       
    POP HL                              ;4429  e1          
    JP  NXLINE                          ;442a  c3 11 16    
                  ;
IFSKIP: CALL    IFSKSB                  ;442d  cd 40 44    
    OR  A                               ;4430  b7          
    SCF                                 ;4431  37          
    RET Z                               ;4432  c8          
    CP  0B8h                            ;4433  fe b8       
    RET Z                               ;4435  c8          
    CP  08Eh                            ;4436  fe 8e       
    JR  NZ,IFSKIP                       ;4438  20 f3       
IFSKMD: CALL    IFSKIP                  ;443a  cd 2d 44    
    RET C                               ;443d  d8          
    JR  IFSKIP                          ;443e  18 ed       
                  ;
IFSKSB: INC HL                          ;4440  23          
    LD  A,(HL)                          ;4441  7e          
    OR  A                               ;4442  b7          
    RET Z                               ;4443  c8          
    CP  0FFh                            ;4444  fe ff       
    JR  Z,FUNCRQ                        ;4446  28 0f       
    CP  022h                            ;4448  fe 22       
    JR  Z,IFDQSK                        ;444a  28 18       
    CP  020h                            ;444c  fe 20       
    RET NC                              ;444e  d0          
    CP  00Bh                            ;444f  fe 0b       
    RET C                               ;4451  d8          
    CP  014h                            ;4452  fe 14       
    JR  NC,ISKFLT                       ;4454  30 03       
    INC HL                              ;4456  23          
FUNCRQ: INC HL                          ;4457  23          
    RET                                 ;4458  c9          
                  ;
ISKFLT: AND 00Fh                        ;4459  e6 0f       
    ADD A,L                             ;445b  85          
    LD  L,A                             ;445c  6f          
    LD  A,0                             ;445d  3e 00       
    ADC A,H                             ;445f  8c          
    LD  H,A                             ;4460  67          
    LD  A,020h                          ;4461  3e 20       
    RET                                 ;4463  c9          
                  ;
IFDQSK: INC HL                          ;4464  23          
    LD  A,(HL)                          ;4465  7e          
    OR  A                               ;4466  b7          
    RET Z                               ;4467  c8          
    CP  022h                            ;4468  fe 22       
    RET Z                               ;446a  c8          
    JR  IFDQSK                          ;446b  18 f7       
                  ;
VPUSH:  LD  C,L                         ;446d  4d          
    LD  B,H                             ;446e  44          
    CALL    ILDRCH                      ;446f  cd 90 3b    
    POP HL                              ;4472  e1          
    LD  (PUSHJV),HL                     ;4473  22 b2 44    
PUSHAG: LD  HL,(INTFAC)                 ;4476  2a 4b 7a    
    LD  IY,(INTSSP)                     ;4479  fd 2a 43 7a 
    LD  (IY+0),0                        ;447d  fd 36 00 00 
    CALL    EXPRSN                      ;4481  cd f2 22    
    EX  AF,AF'                          ;4484  08          
    LD  A,(IY+0)                        ;4485  fd 7e 00    
    CP  003h                            ;4488  fe 03       
    JP  Z,TYPEMS                        ;448a  ca 32 17    
    EX  DE,HL                           ;448d  eb          
    LD  HL,0FFF8h                       ;448e  21 f8 ff    
    ADD HL,SP                           ;4491  39          
    LD  SP,HL                           ;4492  f9          
    PUSH    BC                          ;4493  c5          
    CALL    CLRFAC                      ;4494  cd a9 28    
    LD  B,A                             ;4497  47          
    LD  C,A                             ;4498  4f          
PUTSTRL:LD  A,(DE)                      ;4499  1a          
    LD  (HL),A                          ;449a  77          
    INC HL                              ;449b  23          
    INC DE                              ;449c  13          
    DJNZ    PUTSTRL                     ;449d  10 fa       
    LD  D,C                             ;449f  51          
    POP BC                              ;44a0  c1          
    LD  E,0FDh                          ;44a1  1e fd       
    PUSH    DE                          ;44a3  d5          
    EX  AF,AF'                          ;44a4  08          
    PUSH    AF                          ;44a5  f5          
    CALL    MEMCHK                      ;44a6  cd b0 1e    
    POP AF                              ;44a9  f1          
PUSHL1: CP  02Ch                        ;44aa  fe 2c       
    JR  Z,PUSHAG                        ;44ac  28 c8       
    LD  L,C                             ;44ae  69          
    LD  H,B                             ;44af  60          
RETVCP: DEC HL                          ;44b0  2b          
    DEFB    0C3H                        ;44b1  c3          ; JP ?
PUSHJV: DEFS    2                       ;44b2              
                  ;
VPOP:   LD  C,L                         ;44b4  4d          
    LD  B,H                             ;44b5  44          
    CALL    ILDRCH                      ;44b6  cd 90 3b    
    POP HL                              ;44b9  e1          
    LD  (PUSHJV),HL                     ;44ba  22 b2 44    
POPLOP: CALL    GETVAC                  ;44bd  cd d3 1e    
    POP DE                              ;44c0  d1          
    CP  002h                            ;44c1  fe 02       
    JR  Z,INTPOP                        ;44c3  28 32       
    CP  003h                            ;44c5  fe 03       
    JP  Z,TYPEMS                        ;44c7  ca 32 17    
    CP  D                               ;44ca  ba          
    JR  NZ,STKEMP                       ;44cb  20 25       
    LD  A,E                             ;44cd  7b          
    CP  0FDh                            ;44ce  fe fd       
    JR  NZ,STKEMP                       ;44d0  20 20       
    LD  A,D                             ;44d2  7a          
    EX  DE,HL                           ;44d3  eb          
    LD  HL,00000h                       ;44d4  21 00 00    
    ADD HL,SP                           ;44d7  39          
    PUSH    BC                          ;44d8  c5          
    LD  B,A                             ;44d9  47          
POPTRL: LD  A,(HL)                      ;44da  7e          
    LD  (DE),A                          ;44db  12          
    INC HL                              ;44dc  23          
    INC DE                              ;44dd  13          
    DJNZ    POPTRL                      ;44de  10 fa       
    POP BC                              ;44e0  c1          
INTPOR: LD  HL,8                        ;44e1  21 08 00    
    ADD HL,SP                           ;44e4  39          
    LD  SP,HL                           ;44e5  f9          
HEXCUL1: CALL   BCFTCH                  ;44e6  cd c4 25    
    CP  02Ch                            ;44e9  fe 2c       
    JR  Z,POPLOP                        ;44eb  28 d0       
    LD  L,C                             ;44ed  69          
    LD  H,B                             ;44ee  60          
    JP  RETVCP                          ;44ef  c3 b0 44    
                  ;
STKEMP: LD  A,30                        ;44f2  3e 1e       
    JP  ERROR                           ;44f4  c3 96 21    
                  ;
INTPOP: LD  A,D                         ;44f7  7a          
    CP  003h                            ;44f8  fe 03       
    JR  Z,STKEMP                        ;44fa  28 f6       
    LD  A,E                             ;44fc  7b          
    CP  0FDh                            ;44fd  fe fd       
    JR  NZ,STKEMP                       ;44ff  20 f1       
    LD  A,D                             ;4501  7a          
    EX  DE,HL                           ;4502  eb          
    LD  HL,00000h                       ;4503  21 00 00    
    ADD HL,SP                           ;4506  39          
    CALL    HLFLTO                      ;4507  cd 97 2d    
    EX  DE,HL                           ;450a  eb          
    LD  (HL),E                          ;450b  73          
    INC HL                              ;450c  23          
    LD  (HL),D                          ;450d  72          
    DEC HL                              ;450e  2b          
    JR  INTPOR                          ;450f  18 d0       
                  ;
BUFCLR: PUSH    HL                      ;4511  e5          
    LD  HL,0                            ;4512  21 00 00    
    LD  (LNG),HL                        ;4515  22 27 45    
    LD  HL,CTBUF                        ;4518  21 b1 45    
    LD  (ADRES),HL                      ;451b  22 24 45    
    XOR A                               ;451e  af          
    JR  CTRET'                          ;451f  18 31       
                  ;
CTINP:  PUSH    HL                      ;4521  e5          
    PUSH    BC                          ;4522  c5          
    DEFB    021H                        ;4523  21          ; LD HL,?
ADRES:  DEFW    CTBUF                   ;4524  b1 45       
    DEFB    001H                        ;4526  01          ; LD BC,?
LNG:    DEFS    2                       ;4527              
    LD  A,B                             ;4529  78          
    OR  C                               ;452a  b1          
    JR  NZ,CTINP1                       ;452b  20 1a       
    LD  HL,CTBUF                        ;452d  21 b1 45    
    LD  (ADRES),HL                      ;4530  22 24 45    
    LD  (MTADRS),HL                     ;4533  22 aa 13    
    LD  BC,00100H                       ;4536  01 00 01    
    LD  (LNG),BC                        ;4539  ed 43 27 45 
    LD  (MTBYTE),BC                     ;453d  ed 43 a8 13 
    CALL    MLOAD                       ;4541  cd 34 01    
    JP  C,CTERR                         ;4544  da 54 45    
CTINP1: LD  A,(HL)                      ;4547  7e          
    INC HL                              ;4548  23          
    DEC BC                              ;4549  0b          
    LD  (ADRES),HL                      ;454a  22 24 45    
    LD  (LNG),BC                        ;454d  ed 43 27 45 
CTRETN: POP BC                          ;4551  c1          
CTRET': POP HL                          ;4552  e1          
    RET                                 ;4553  c9          
                  ;
CTERR:  POP HL                          ;4554  e1          
    POP BC                              ;4555  c1          
    SCF                                 ;4556  37          
    RET                                 ;4557  c9          
                  ;
CTOUT:  PUSH    BC                      ;4558  c5          
    PUSH    HL                          ;4559  e5          
    LD  HL,(ADRES)                      ;455a  2a 24 45    
    LD  BC,(LNG)                        ;455d  ed 4b 27 45 
    LD  (HL),A                          ;4561  77          
    INC HL                              ;4562  23          
    INC BC                              ;4563  03          
    LD  (ADRES),HL                      ;4564  22 24 45    
    LD  A,B                             ;4567  78          
    CP  1                               ;4568  fe 01       
    JR  NZ,CTOUT1                       ;456a  20 10       
    LD  HL,CTBUF                        ;456c  21 b1 45    
    LD  (MTADRS),HL                     ;456f  22 aa 13    
    LD  (MTBYTE),BC                     ;4572  ed 43 a8 13 
    CALL    MSAVE                       ;4576  cd b6 00    
    LD  BC,0                            ;4579  01 00 00    
CTOUT1: LD  (LNG),BC                    ;457c  ed 43 27 45 
    LD  (ADRES),HL                      ;4580  22 24 45    
    OR  A                               ;4583  b7          
    JR  CTRETN                          ;4584  18 cb       
                  ;
CTCLOS: PUSH    BC                      ;4586  c5          
    PUSH    HL                          ;4587  e5          
    LD  HL,CTBUF                        ;4588  21 b1 45    
    LD  (MTADRS),HL                     ;458b  22 aa 13    
    LD  HL,00100H                       ;458e  21 00 01    
    LD  (MTBYTE),HL                     ;4591  22 a8 13    
    CALL    MSAVE                       ;4594  cd b6 00    
    JR  C,CTERR                         ;4597  38 bb       
    JR  CTRETN                          ;4599  18 b6       
                  ;
STREXZ: LD  C,L                         ;459b  4d          
    LD  B,H                             ;459c  44          
STREXX: LD  HL,(INTFAC)                 ;459d  2a 4b 7a    
    LD  IY,(INTSSP)                     ;45a0  fd 2a 43 7a 
    LD  (IY+0),0                        ;45a4  fd 36 00 00 
    CALL    STEXPR                      ;45a8  cd b2 22    
    CALL    CONDMZ                      ;45ab  cd f6 6b    
    JP  CVDSAD                          ;45ae  c3 0e 17    
                  ;
CTBUF:  DEFW    $FLOAT                  ;45b1  c0 6b       
    DEFW    $EDIT                       ;45b3  1b 63       
    DEFW    ADDDEG                      ;45b5  4a 5b       ; $CONV hard coding
    DEFW    00000h                      ;45b7  00 00       ; $IOCS hard coding
    DEFW    $ERTXT                      ;45b9  b2 69       
    DEFW    VSTART                      ;45bb  3b 7a       ; $WORK hard coding 
    DEFW    LDIR1                       ;45bd  a3 73       ; $FUNC hard coding
    DEFS    242                         ;45bf              
USINGB: DEFS    26                      ;46b1              
                  ;
                  ;	CHAIN	,GRAPH
                  ;
                  ; GRAPH
                  ;
                  ;
DEFCHR: INC HL                          ;46cb  23          
    LD  A,(GMODEF)                      ;46cc  3a 06 1c    
    CP  2                               ;46cf  fe 02       
    JP  NC,IFCALL                       ;46d1  d2 36 17    
    CALL    HLFTCH                      ;46d4  cd 87 29    
    CP  028h                            ;46d7  fe 28       
    JP  NZ,SERROR                       ;46d9  c2 3a 17    
    INC HL                              ;46dc  23          
    LD  C,L                             ;46dd  4d          
    LD  B,H                             ;46de  44          
    CALL    IHLEXP                      ;46df  cd cc 22    
    CALL    CH29H                       ;46e2  cd 66 2d    
    CALL    HCHECK                      ;46e5  cd d8 22    
    CP  080h                            ;46e8  fe 80       
    JP  C,IFCALL                        ;46ea  da 36 17    
    CP  0E0h                            ;46ed  fe e0       
    JP  NC,IFCALL                       ;46ef  d2 36 17    
    AND 07Fh                            ;46f2  e6 7f       
    PUSH    AF                          ;46f4  f5          
    CALL    BCFTCH                      ;46f5  cd c4 25    
    CP  0F5h                            ;46f8  fe f5       
    JP  NZ,SERROR                       ;46fa  c2 3a 17    
    CALL    STREXX                      ;46fd  cd 9d 45    
    CP  12                              ;4700  fe 0c       
    JP  NZ,IFCALL                       ;4702  c2 36 17    
    LD  H,A                             ;4705  67          
    POP AF                              ;4706  f1          
    PUSH    BC                          ;4707  c5          
    PUSH    HL                          ;4708  e5          
    LD  L,A                             ;4709  6f          
    LD  H,0                             ;470a  26 00       
    ADD HL,HL                           ;470c  29          
    ADD HL,HL                           ;470d  29          
    ADD HL,HL                           ;470e  29          
    ADD HL,HL                           ;470f  29          
    LD  BC,01000h                       ;4710  01 00 10    
    ADD HL,BC                           ;4713  09          
    LD  C,L                             ;4714  4d          
    LD  B,H                             ;4715  44          
    POP HL                              ;4716  e1          
DEFCHL: LD  A,(DE)                      ;4717  1a          
    OUT (C),A                           ;4718  ed 79       
    INC DE                              ;471a  13          
    INC BC                              ;471b  03          
    DEC H                               ;471c  25          
    JR  NZ,DEFCHL                       ;471d  20 f8       
    POP HL                              ;471f  e1          
    DEC HL                              ;4720  2b          
    RET                                 ;4721  c9          
                  ;
                  ;
SOUND:  LD  B,H                         ;4722  44          
    LD  C,L                             ;4723  4d          
    CALL    IHLEXP                      ;4724  cd cc 22    
    CALL    CH2CH                       ;4727  cd 61 2d    
    CALL    HCHECK                      ;472a  cd d8 22    
    CP  14                              ;472d  fe 0e       
    JP  NC,IFCALL                       ;472f  d2 36 17    
    PUSH    AF                          ;4732  f5          
    CALL    IHLEXP                      ;4733  cd cc 22    
    CALL    HCHECK                      ;4736  cd d8 22    
    POP HL                              ;4739  e1          
    LD  L,A                             ;473a  6f          
    PUSH    BC                          ;473b  c5          
    LD  BC,04000h                       ;473c  01 00 40    
    OUT (C),H                           ;473f  ed 61       
    INC C                               ;4741  0c          
    OUT (C),L                           ;4742  ed 69       
    POP BC                              ;4744  c1          
    JP  RETIRQ                          ;4745  c3 39 1b    
                  ;
BEEPOP: LD  B,H                         ;4748  44          
    LD  C,L                             ;4749  4d          
    CALL    EDCEK                       ;474a  cd 6f 49    
    JR  Z,BEEP                          ;474d  28 29       
    CALL    IBYTE                       ;474f  cd df 22    
    CP  128                             ;4752  fe 80       
    JP  NC,IFCALL                       ;4754  d2 36 17    
    LD  D,A                             ;4757  57          
    LD  E,0                             ;4758  1e 00       
    DEC BC                              ;475a  0b          
    CALL    EDCEK                       ;475b  cd 6f 49    
    JR  Z,BEEPA                         ;475e  28 12       
    CP  02Ch                            ;4760  fe 2c       
    JP  NZ,SERROR                       ;4762  c2 3a 17    
    INC BC                              ;4765  03          
    PUSH    DE                          ;4766  d5          
    CALL    IBYTE                       ;4767  cd df 22    
    POP DE                              ;476a  d1          
    CP  3                               ;476b  fe 03       
    JP  NC,IFCALL                       ;476d  d2 36 17    
    DEC BC                              ;4770  0b          
    LD  E,A                             ;4771  5f          
BEEPA:  PUSH    BC                      ;4772  c5          
    CALL    SOUNDS                      ;4773  cd 99 10    ;D,E
    POP HL                              ;4776  e1          
    RET                                 ;4777  c9          
                  ;
BEEP:   PUSH    BC                      ;4778  c5          
    CALL    BELL                        ;4779  cd ca 06    
    LD  BC,04000h                       ;477c  01 00 40    
    LD  A,7                             ;477f  3e 07       
    OUT (C),A                           ;4781  ed 79       
    INC C                               ;4783  0c          
    IN  A,(C)                           ;4784  ed 78       
    OR  03Fh                            ;4786  f6 3f       
    OUT (C),A                           ;4788  ed 79       
    POP HL                              ;478a  e1          
    RET                                 ;478b  c9          
                  ;
PLAY:   LD  C,L                         ;478c  4d          
    LD  B,H                             ;478d  44          
    CALL    SETSSP                      ;478e  cd f9 21    
    LD  (IY+0),0                        ;4791  fd 36 00 00 
    CALL    EXPRSN                      ;4795  cd f2 22    
    LD  A,(IY+0)                        ;4798  fd 7e 00    
    CP  003h                            ;479b  fe 03       
    JR  NZ,TEMPO                        ;479d  20 20       
    CALL    CONDMZ                      ;479f  cd f6 6b    
    CALL    CVDSAD                      ;47a2  cd 0e 17    
    PUSH    BC                          ;47a5  c5          
    LD  B,A                             ;47a6  47          
    OR  A                               ;47a7  b7          
    JR  Z,ESCPLY                        ;47a8  28 12       
    LD  HL,KEYBUF                       ;47aa  21 4f 7a    
    PUSH    HL                          ;47ad  e5          
    LD  C,B                             ;47ae  48          
KBSTMS: LD  A,(DE)                      ;47af  1a          
    LD  (HL),A                          ;47b0  77          
    INC DE                              ;47b1  13          
    INC HL                              ;47b2  23          
    DJNZ    KBSTMS                      ;47b3  10 fa       
    LD  (HL),03Ah                       ;47b5  36 3a       
    LD  B,C                             ;47b7  41          
    POP DE                              ;47b8  d1          
    CALL    MUSIC                       ;47b9  cd cd 0e    
ESCPLY: POP HL                          ;47bc  e1          
    DEC HL                              ;47bd  2b          
    RET                                 ;47be  c9          
                  ;
TEMPO:  EX  DE,HL                       ;47bf  eb          
    LD  HL,KEYBUF                       ;47c0  21 4f 7a    
    PUSH    HL                          ;47c3  e5          
    LD  (IY+0),4                        ;47c4  fd 36 00 04 
    LD  (HL),08Dh                       ;47c8  36 8d       
    INC HL                              ;47ca  23          
    LD  (HL),06Ah                       ;47cb  36 6a       
    INC HL                              ;47cd  23          
    LD  (HL),060h                       ;47ce  36 60       
    INC HL                              ;47d0  23          
    LD  (HL),0                          ;47d1  36 00       
    POP HL                              ;47d3  e1          
    PUSH    BC                          ;47d4  c5          
    CALL    DIV                         ;47d5  cd bd 70    
    CALL    HLFLTO                      ;47d8  cd 97 2d    
    CALL    HCHECK                      ;47db  cd d8 22    
    OR  A                               ;47de  b7          
    JP  Z,IFCALL                        ;47df  ca 36 17    
    CALL    XTEMPO                      ;47e2  cd 95 10    
    POP BC                              ;47e5  c1          
    JP  RETIRQ                          ;47e6  c3 39 1b    
                  ;
                  ;
COLOR:  LD  C,L                         ;47e9  4d          
    LD  B,H                             ;47ea  44          
    CALL    IBYTE                       ;47eb  cd df 22    
    CP  9                               ;47ee  fe 09       
    JP  NC,IFCALL                       ;47f0  d2 36 17    
    LD  (COLORF),A                      ;47f3  32 80 11    
    DEC BC                              ;47f6  0b          
    LD  L,C                             ;47f7  69          
    LD  H,B                             ;47f8  60          
    RET                                 ;47f9  c9          
                  ;
                  ;
PRESET: CALL    PSETXY                  ;47fa  cd 24 49    
    XOR A                               ;47fd  af          
    LD  (GCOLOR),A                      ;47fe  32 81 11    
    JR  L33F0                           ;4801  18 03       
PSET:                                   ;                  
    CALL    PSETXY                      ;4803  cd 24 49    ;(X,Y,C)
L33F0:  PUSH    BC                      ;4806  c5          
    CALL    PSETSB                      ;4807  cd 0c 48    
    POP HL                              ;480a  e1          
    RET                                 ;480b  c9          
                  ;
                  ;
                  ;
                  ;  PSET(RESET(DE,HL)
PSETSB: CALL    CULADR                  ;480c  cd 23 48    
    RET C                               ;480f  d8          
    PUSH    HL                          ;4810  e5          
    LD  HL,CULTBL                       ;4811  21 1b 48    
    ADD HL,DE                           ;4814  19          
    LD  E,(HL)                          ;4815  5e          
    INC HL                              ;4816  23          
    LD  D,(HL)                          ;4817  56          
    EX  DE,HL                           ;4818  eb          
    EX  (SP),HL                         ;4819  e3          
    RET                                 ;481a  c9          
                  ;
CULTBL: DEFW    CULAD0                  ;481b  4e 48       ;TEXT0
    DEFW    CULAD1                      ;481d  93 48       ;TEXT1
    DEFW    CULAD3                      ;481f  da 48       ;GRAPHIC2,3
    DEFW    CULAD5                      ;4821  05 49       ;GRAPHIC4,5
                  ;
                  ;
CULADR: PUSH    HL                      ;4823  e5          
SCRNYE: LD  BC, 04764h                  ;4824  01 64 47    ;LIMIT Y
    ADD HL,BC                           ;4827  09          
    JR  C,CULERR                        ;4828  38 07       
    EX  DE,HL                           ;482a  eb          
    PUSH    HL                          ;482b  e5          
SCRNXE: LD  BC, 0472Ch                  ;482c  01 2c 47    ;LIMIT X
    ADD HL,BC                           ;482f  09          
    POP DE                              ;4830  d1          
CULERR: POP HL                          ;4831  e1          
    RET C                               ;4832  d8          
CALADR: JP  CALAD0                      ;4833  c3 36 48    
                  ;
CALAD0: LD  BC,(CHRSTA)                 ;4836  ed 4b d6 0a 
    LD  A,L                             ;483a  7d          
    RES 0,L                             ;483b  cb 85       
    ADD HL,HL                           ;483d  29          
    ADD HL,HL                           ;483e  29          
    ADD HL,HL                           ;483f  29          
    ADD HL,HL                           ;4840  29          
    AND 1                               ;4841  e6 01       
    SRL E                               ;4843  cb 3b       
    CCF                                 ;4845  3f          
    RLA                                 ;4846  17          
    ADD HL,DE                           ;4847  19          
    ADD HL,BC                           ;4848  09          
    LD  DE,00000h                       ;4849  11 00 00    
    OR  A                               ;484c  b7          
    RET                                 ;484d  c9          
                  ;
CULAD0: LD  C,L                         ;484e  4d          
    LD  B,H                             ;484f  44          
    SET 3,B                             ;4850  cb d8       ;
    LD  E,4                             ;4852  1e 04       ;
    OUT (C),E                           ;4854  ed 59       ;
    LD  E,1                             ;4856  1e 01       
    OR  A                               ;4858  b7          
    JR  Z,L344A                         ;4859  28 05       
L3445:  RLC E                           ;485b  cb 03       
    DEC A                               ;485d  3d          
    JR  NZ,L3445                        ;485e  20 fb       
L344A:  LD  A,(GCOLOR)                  ;4860  3a 81 11    
    OR  A                               ;4863  b7          
    JP  Z,PRESOK                        ;4864  ca c0 48    
    DEC A                               ;4867  3d          
    AND 7                               ;4868  e6 07       
    RLCA                                ;486a  07          
    RLCA                                ;486b  07          
    RLCA                                ;486c  07          
    RLCA                                ;486d  07          
    OR  E                               ;486e  b3          
    LD  E,A                             ;486f  5f          
    LD  D,00Fh                          ;4870  16 0f       
    JP  PSTRES                          ;4872  c3 1b 49    
                  ;
CALAD1: LD  BC,(CHRSTA)                 ;4875  ed 4b d6 0a 
    LD  A,L                             ;4879  7d          
    LD  L,0FFh                          ;487a  2e ff       
CALA21: INC L                           ;487c  2c          
    SUB 3                               ;487d  d6 03       
    JR  NC,CALA21                       ;487f  30 fb       
    ADD A,3                             ;4881  c6 03       
    SRL E                               ;4883  cb 3b       
    CCF                                 ;4885  3f          
    RLA                                 ;4886  17          
    ADD HL,HL                           ;4887  29          
    ADD HL,HL                           ;4888  29          
    ADD HL,HL                           ;4889  29          
    ADD HL,HL                           ;488a  29          
    ADD HL,HL                           ;488b  29          
    ADD HL,DE                           ;488c  19          
    ADD HL,BC                           ;488d  09          
    LD  DE,00002h                       ;488e  11 02 00    
    OR  A                               ;4891  b7          
    RET                                 ;4892  c9          
                  ;
CULAD1: LD  C,L                         ;4893  4d          
    LD  B,H                             ;4894  44          
    SET 3,B                             ;4895  cb d8       
    LD  D,00Ch                          ;4897  16 0c       
    OUT (C),D                           ;4899  ed 51       
    LD  E,1                             ;489b  1e 01       
    OR  A                               ;489d  b7          
    JR  Z,L348F                         ;489e  28 05       
L348A:  RLC E                           ;48a0  cb 03       
    DEC A                               ;48a2  3d          
    JR  NZ,L348A                        ;48a3  20 fb       
L348F:  LD  A,(GCOLOR)                  ;48a5  3a 81 11    
    OR  A                               ;48a8  b7          
    JP  Z,PRESOK                        ;48a9  ca c0 48    
    DEC A                               ;48ac  3d          
    CP  4                               ;48ad  fe 04       
    JR  C,L349F                         ;48af  38 04       
    SET 1,D                             ;48b1  cb ca       
    OUT (C),D                           ;48b3  ed 51       
L349F:  AND 003h                        ;48b5  e6 03       
    RRCA                                ;48b7  0f          
    RRCA                                ;48b8  0f          
    OR  E                               ;48b9  b3          
    LD  E,A                             ;48ba  5f          
    LD  D,03Fh                          ;48bb  16 3f       
    JP  PSTRES                          ;48bd  c3 1b 49    
                  ;
PRESOK: LD  C,L                         ;48c0  4d          
    LD  B,H                             ;48c1  44          
    IN  L,(C)                           ;48c2  ed 68       
    LD  A,E                             ;48c4  7b          
    CPL                                 ;48c5  2f          
    AND L                               ;48c6  a5          
    OUT (C),A                           ;48c7  ed 79       
    RET                                 ;48c9  c9          
                  ;
                  ;
CALAD2:                                 ;                  
CALAD3: ADD HL,HL                       ;48ca  29          
    ADD HL,HL                           ;48cb  29          
    ADD HL,HL                           ;48cc  29          
    ADD HL,HL                           ;48cd  29          
    ADD HL,HL                           ;48ce  29          
    LD  A,E                             ;48cf  7b          
    SRL E                               ;48d0  cb 3b       
    SRL E                               ;48d2  cb 3b       
    ADD HL,DE                           ;48d4  19          
    LD  DE,00004h                       ;48d5  11 04 00    
    OR  A                               ;48d8  b7          
    RET                                 ;48d9  c9          
                  ;
CULAD3: AND 003h                        ;48da  e6 03       
    INC A                               ;48dc  3c          
    LD  B,A                             ;48dd  47          
    LD  A,(GCOLOR)                      ;48de  3a 81 11    
    AND 003h                            ;48e1  e6 03       
    LD  E,A                             ;48e3  5f          
    LD  D,0FCh                          ;48e4  16 fc       
CALA31: RRC E                           ;48e6  cb 0b       
    RRC E                               ;48e8  cb 0b       
    RRC D                               ;48ea  cb 0a       
    RRC D                               ;48ec  cb 0a       
    DJNZ    CALA31                      ;48ee  10 f6       
    JP  PSTRES                          ;48f0  c3 1b 49    
                  ;
CALAD4:                                 ;                  
CALAD5: ADD HL,HL                       ;48f3  29          
    ADD HL,HL                           ;48f4  29          
    ADD HL,HL                           ;48f5  29          
    ADD HL,HL                           ;48f6  29          
    ADD HL,HL                           ;48f7  29          
    LD  A,E                             ;48f8  7b          
    SRL E                               ;48f9  cb 3b       
    SRL E                               ;48fb  cb 3b       
    SRL E                               ;48fd  cb 3b       
    ADD HL,DE                           ;48ff  19          
    LD  DE,00006H                       ;4900  11 06 00    
    OR  A                               ;4903  b7          
    RET                                 ;4904  c9          
                  ;
CULAD5: AND 7                           ;4905  e6 07       
    LD  E,080h                          ;4907  1e 80       
    OR  A                               ;4909  b7          
    JR  Z,L34FB                         ;490a  28 05       
L34F6:  RRC E                           ;490c  cb 0b       
    DEC A                               ;490e  3d          
    JR  NZ,L34F6                        ;490f  20 fb       
L34FB:  LD  A,(GCOLOR)                  ;4911  3a 81 11    
    AND 001h                            ;4914  e6 01       
    JP  Z,PRESOK                        ;4916  ca c0 48    
    LD  D,0FFh                          ;4919  16 ff       
                  ;
PSTRES: LD  C,L                         ;491b  4d          
    LD  B,H                             ;491c  44          
    IN  A,(C)                           ;491d  ed 78       
    AND D                               ;491f  a2          
    OR  E                               ;4920  b3          
    OUT (C),A                           ;4921  ed 79       
    RET                                 ;4923  c9          
                  ;
PSETXY: LD  C,L                         ;4924  4d          
    LD  B,H                             ;4925  44          
    CALL    SETXY3                      ;4926  cd 4d 49    
    CP  029h                            ;4929  fe 29       ;)
    JR  Z,COLFST                        ;492b  28 1b       
    CALL    CH2CH                       ;492d  cd 61 2d    
    PUSH    DE                          ;4930  d5          
    PUSH    HL                          ;4931  e5          
    CALL    IHLEXP                      ;4932  cd cc 22    
    CP  029h                            ;4935  fe 29       ;)
    JP  NZ,SERROR                       ;4937  c2 3a 17    
    CALL    HCHECK                      ;493a  cd d8 22    
    CP  9                               ;493d  fe 09       
    JP  NC,IFCALL                       ;493f  d2 36 17    
    POP HL                              ;4942  e1          
    POP DE                              ;4943  d1          
COLFSL: LD  (GCOLOR),A                  ;4944  32 81 11    
    RET                                 ;4947  c9          
COLFST: LD  A,(COLORF)                  ;4948  3a 80 11    
    JR  COLFSL                          ;494b  18 f7       
                  ;
SETXY3: CALL    BCFTCH                  ;494d  cd c4 25    
    CP  028h                            ;4950  fe 28       ;(
    JP  NZ,SERROR                       ;4952  c2 3a 17    
    CALL    IHLEXP                      ;4955  cd cc 22    
    PUSH    HL                          ;4958  e5          
    CALL    CH2CH                       ;4959  cd 61 2d    
    CALL    IHLEXP                      ;495c  cd cc 22    
    POP DE                              ;495f  d1          
    RET                                 ;4960  c9          
                  ;
                  ;
SETXY2: CALL    SETXY3                  ;4961  cd 4d 49    
    CALL    CH29H                       ;4964  cd 66 2d    
BCFTC2: LD  A,(BC)                      ;4967  0a          
    CP  020h                            ;4968  fe 20       
    RET NZ                              ;496a  c0          
    INC BC                              ;496b  03          
    JR  BCFTC2                          ;496c  18 f9       
                  ;
                  ;
EDCEKL: INC BC                          ;496e  03          
EDCEK:  LD  A,(BC)                      ;496f  0a          
    CP  020h                            ;4970  fe 20       
    JR  Z,EDCEKL                        ;4972  28 fa       
    OR  A                               ;4974  b7          
    RET Z                               ;4975  c8          
    CP  03Ah                            ;4976  fe 3a       
    RET                                 ;4978  c9          
                  ;
                  ;
LINE@:  CALL    COLFST                  ;4979  cd 48 49    
    DEC BC                              ;497c  0b          
    CALL    BCFTC2                      ;497d  cd 67 49    
    CP  0F9h                            ;4980  fe f9       ;-
    JR  NZ,NOMLIN                       ;4982  20 0e       
    LD  HL,(LINEXE+1)                   ;4984  2a 45 4a    
    LD  (LINEXS+1),HL                   ;4987  22 40 4a    
    LD  HL,(LINEYE+1)                   ;498a  2a 62 4a    
    LD  (LINEYS+1),HL                   ;498d  22 5d 4a    
    JR  ENDLIN                          ;4990  18 0e       
NOMLIN: CALL    SETXY2                  ;4992  cd 61 49    
    LD  (LINEXS+1),DE                   ;4995  ed 53 40 4a 
    LD  (LINEYS+1),HL                   ;4999  22 5d 4a    
    CP  0F9h                            ;499c  fe f9       
    JR  NZ,LIMODE                       ;499e  20 10       
ENDLIN: INC BC                          ;49a0  03          
    CALL    SETXY2                      ;49a1  cd 61 49    
    LD  (LINEXE+1),DE                   ;49a4  ed 53 45 4a 
    LD  (LINEYE+1),HL                   ;49a8  22 62 4a    
    CP  0F9h                            ;49ab  fe f9       ;-
    JP  Z,NINS                          ;49ad  ca fa 20    ;CONNECT
LIMODE: CP  02Ch                        ;49b0  fe 2c       ;,
    JP  NZ,SERROR                       ;49b2  c2 3a 17    
    INC BC                              ;49b5  03          
    CALL    BCFTC2                      ;49b6  cd 67 49    
    CP  0C7h                            ;49b9  fe c7       ;PSET
    JR  Z,MDST2                         ;49bb  28 16       
    CP  0C8h                            ;49bd  fe c8       ;PRESET
    LD  A,0                             ;49bf  3e 00       
    JR  Z,MDST22                        ;49c1  28 37       
CHRMD1: CALL    STREXX                  ;49c3  cd 9d 45    
    OR  A                               ;49c6  b7          
    JR  Z,L35B4                         ;49c7  28 01       
    LD  A,(DE)                          ;49c9  1a          
L35B4:  DEC BC                          ;49ca  0b          
    LD  (CHRCOD+1),A                    ;49cb  32 da 4b    
    LD  HL,TEXTSB                       ;49ce  21 c7 4b    
    JR  MDST3                           ;49d1  18 04       
MDST2:  INC BC                          ;49d3  03          
    LD  HL,PSETSB                       ;49d4  21 0c 48    
MDST3:  LD  (LINEMD+1),HL               ;49d7  22 b9 4a    
    LD  (BOXMD+1),HL                    ;49da  22 4f 4b    
    LD  DE,LINESB                       ;49dd  11 7d 4a    
    CALL    EDCEK                       ;49e0  cd 6f 49    
    JR  Z,LINE1                         ;49e3  28 3a       
    CALL    CH2CH                       ;49e5  cd 61 2d    
    INC BC                              ;49e8  03          
    CALL    BCFTC2                      ;49e9  cd 67 49    
    CP  042h                            ;49ec  fe 42       ;B/BF
    JR  Z,BBFLMD                        ;49ee  28 22       
    CALL    IBYTE                       ;49f0  cd df 22    
    CP  9                               ;49f3  fe 09       
    JP  NC,IFCALL                       ;49f5  d2 36 17    
    DEC BC                              ;49f8  0b          
    DEC BC                              ;49f9  0b          
MDST22: LD  (GCOLOR),A                  ;49fa  32 81 11    
    INC BC                              ;49fd  03          
    LD  DE,LINESB                       ;49fe  11 7d 4a    
    CALL    EDCEK                       ;4a01  cd 6f 49    
    JR  Z,LINE1                         ;4a04  28 19       
    CALL    CH2CH                       ;4a06  cd 61 2d    
    INC BC                              ;4a09  03          
    CALL    BCFTC2                      ;4a0a  cd 67 49    
    CP  042h                            ;4a0d  fe 42       ;B/BF
    JP  NZ,SERROR                       ;4a0f  c2 3a 17    
BBFLMD: LD  DE,BOX                      ;4a12  11 01 4b    
    INC BC                              ;4a15  03          
    LD  A,(BC)                          ;4a16  0a          
    CP  046h                            ;4a17  fe 46       ;F
    JR  NZ,LINE1                        ;4a19  20 04       
    INC BC                              ;4a1b  03          
    LD  DE,BOXFUL                       ;4a1c  11 5b 4b    
LINE1:  LD  (LNBOXF+1),DE               ;4a1f  ed 53 7b 4a 
    PUSH    BC                          ;4a23  c5          
    CALL    LINES1                      ;4a24  cd 2b 4a    
    POP BC                              ;4a27  c1          
    LD  L,C                             ;4a28  69          
    LD  H,B                             ;4a29  60          
    RET                                 ;4a2a  c9          
                  ;
LINES1: LD  HL,0                        ;4a2b  21 00 00    
    LD  (YINC1+1),HL                    ;4a2e  22 cb 4a    
    LD  (YINC3+1),HL                    ;4a31  22 bf 4a    
    LD  BC,08000h                       ;4a34  01 00 80    
    LD  (YMOD+1),BC                     ;4a37  ed 43 aa 4a 
    LD  (XMOD+1),BC                     ;4a3b  ed 43 a7 4a 
LINEXS: LD  HL,0                        ;4a3f  21 00 00    ;(XS
    ADD HL,BC                           ;4a42  09          
    EX  DE,HL                           ;4a43  eb          
LINEXE: LD  HL,255                      ;4a44  21 ff 00    ;-,XE
    ADD HL,BC                           ;4a47  09          
    OR  A                               ;4a48  b7          
    SBC HL,DE                           ;4a49  ed 52       
    LD  DE,1                            ;4a4b  11 01 00    
    JR  NC,LINEL0                       ;4a4e  30 06       
    EX  DE,HL                           ;4a50  eb          
    SBC HL,DE                           ;4a51  ed 52       
    LD  DE,0FFFFh                       ;4a53  11 ff ff    
LINEL0: PUSH    HL                      ;4a56  e5          
    LD  (XINC0+1),DE                    ;4a57  ed 53 d2 4a 
    LD  A,E                             ;4a5b  7b          
LINEYS: LD  HL,0                        ;4a5c  21 00 00    ;(,YS)
    ADD HL,BC                           ;4a5f  09          
    EX  DE,HL                           ;4a60  eb          
LINEYE: LD  HL,192                      ;4a61  21 c0 00    ;-,YE)
    ADD HL,BC                           ;4a64  09          
    OR  A                               ;4a65  b7          
    SBC HL,DE                           ;4a66  ed 52       
    LD  DE,1                            ;4a68  11 01 00    
    JR  NC,LINEL1                       ;4a6b  30 06       
    EX  DE,HL                           ;4a6d  eb          
    SBC HL,DE                           ;4a6e  ed 52       
    LD  DE,0FFFFh                       ;4a70  11 ff ff    
LINEL1: LD  (YINC2+1),DE                ;4a73  ed 53 c4 4a 
    LD  B,A                             ;4a77  47          
    LD  C,E                             ;4a78  4b          
    POP DE                              ;4a79  d1          
LNBOXF: JP  LINESB                      ;4a7a  c3 7d 4a    ;BOX/BOXFUL
LINESB: PUSH    HL                      ;4a7d  e5          
    SBC HL,DE                           ;4a7e  ed 52       
    POP HL                              ;4a80  e1          
    PUSH    DE                          ;4a81  d5          
    JR  Z,LINEL2                        ;4a82  28 20       
    JR  NC,LINEL3                       ;4a84  30 58       
    CALL    DIVH$D                      ;4a86  cd 90 4b    
    DEC C                               ;4a89  0d          
    LD  DE,0                            ;4a8a  11 00 00    
    JR  Z,LINEL4                        ;4a8d  28 0e       
    XOR A                               ;4a8f  af          
    EX  DE,HL                           ;4a90  eb          
    SBC HL,DE                           ;4a91  ed 52       
    LD  DE,07F7Fh                       ;4a93  11 7f 7f    
    LD  (YMOD+1),DE                     ;4a96  ed 53 aa 4a 
    LD  DE,0FFFFh                       ;4a9a  11 ff ff    
LINEL4: LD  (YINC2+1),DE                ;4a9d  ed 53 c4 4a 
    LD  (YINC3+1),HL                    ;4aa1  22 bf 4a    
LINEL2: POP BC                          ;4aa4  c1          
    EXX                                 ;4aa5  d9          
XMOD:   LD  DE,08000h                   ;4aa6  11 00 80    
YMOD:   LD  HL,08000h                   ;4aa9  21 00 80    
    EXX                                 ;4aac  d9          
    LD  DE,(LINEXS+1)                   ;4aad  ed 5b 40 4a 
    LD  HL,(LINEYS+1)                   ;4ab1  2a 5d 4a    
    INC BC                              ;4ab4  03          
LINELP: PUSH    BC                      ;4ab5  c5          
    PUSH    DE                          ;4ab6  d5          
    PUSH    HL                          ;4ab7  e5          
LINEMD: CALL    PSETSB                  ;4ab8  cd 0c 48    ;PSETTX
    POP HL                              ;4abb  e1          
    POP DE                              ;4abc  d1          
    EXX                                 ;4abd  d9          
YINC3:  LD  BC,00000h                   ;4abe  01 00 00    
    ADD HL,BC                           ;4ac1  09          
    EXX                                 ;4ac2  d9          
YINC2:  LD  BC,00001h                   ;4ac3  01 01 00    
    ADC HL,BC                           ;4ac6  ed 4a       
    EXX                                 ;4ac8  d9          
    EX  DE,HL                           ;4ac9  eb          
YINC1:  LD  BC,00000h                   ;4aca  01 00 00    
    ADD HL,BC                           ;4acd  09          
    EX  DE,HL                           ;4ace  eb          
    EXX                                 ;4acf  d9          
    EX  DE,HL                           ;4ad0  eb          
XINC0:  LD  BC,00001h                   ;4ad1  01 01 00    
    ADC HL,BC                           ;4ad4  ed 4a       
    EX  DE,HL                           ;4ad6  eb          
    POP BC                              ;4ad7  c1          
    DEC BC                              ;4ad8  0b          
    LD  A,B                             ;4ad9  78          
    OR  C                               ;4ada  b1          
    JR  NZ,LINELP                       ;4adb  20 d8       
    RET                                 ;4add  c9          
                  ;
LINEL3: LD  E,L                         ;4ade  5d          
    LD  D,H                             ;4adf  54          
    EX  (SP),HL                         ;4ae0  e3          
    CALL    DIVH$D                      ;4ae1  cd 90 4b    
    DEC B                               ;4ae4  05          
    LD  DE,0                            ;4ae5  11 00 00    
    JR  Z,LINEL5                        ;4ae8  28 0e       
    XOR A                               ;4aea  af          
    EX  DE,HL                           ;4aeb  eb          
    SBC HL,DE                           ;4aec  ed 52       
    LD  DE,07F7Fh                       ;4aee  11 7f 7f    
    LD  (XMOD+1),DE                     ;4af1  ed 53 a7 4a 
    LD  DE,0FFFFh                       ;4af5  11 ff ff    
LINEL5: LD  (XINC0+1),DE                ;4af8  ed 53 d2 4a 
    LD  (YINC1+1),HL                    ;4afc  22 cb 4a    
    JR  LINEL2                          ;4aff  18 a3       
                  ;
                  ; BOX
BOX:    PUSH    DE                      ;4b01  d5          
    PUSH    BC                          ;4b02  c5          
    LD  A,023h                          ;4b03  3e 23       
    DEC C                               ;4b05  0d          
    JR  Z,BOXYAD                        ;4b06  28 02       
    LD  A,02Bh                          ;4b08  3e 2b       
BOXYAD: LD  (XBOXAD),A                  ;4b0a  32 55 4b    
    PUSH    HL                          ;4b0d  e5          
    POP BC                              ;4b0e  c1          
    LD  DE,(LINEXS+1)                   ;4b0f  ed 5b 40 4a 
    LD  HL,(LINEYS+1)                   ;4b13  2a 5d 4a    
    PUSH    BC                          ;4b16  c5          
    PUSH    HL                          ;4b17  e5          
    CALL    LINEY                       ;4b18  cd 45 4b    
    POP HL                              ;4b1b  e1          
    POP BC                              ;4b1c  c1          
    LD  DE,(LINEXE+1)                   ;4b1d  ed 5b 45 4a 
    CALL    LINEY                       ;4b21  cd 45 4b    
    POP BC                              ;4b24  c1          
    LD  A,013h                          ;4b25  3e 13       
    DEC B                               ;4b27  05          
    JR  Z,BOXXAD                        ;4b28  28 02       
    LD  A,01Bh                          ;4b2a  3e 1b       
BOXXAD: LD  (XBOXAD),A                  ;4b2c  32 55 4b    
    POP BC                              ;4b2f  c1          
    INC BC                              ;4b30  03          
    LD  DE,(LINEXS+1)                   ;4b31  ed 5b 40 4a 
    LD  HL,(LINEYS+1)                   ;4b35  2a 5d 4a    
    PUSH    BC                          ;4b38  c5          
    PUSH    DE                          ;4b39  d5          
    CALL    LINEX                       ;4b3a  cd 56 4b    
    POP DE                              ;4b3d  d1          
    POP BC                              ;4b3e  c1          
    LD  HL,(LINEYE+1)                   ;4b3f  2a 62 4a    
    JP  LINEX                           ;4b42  c3 56 4b    
LINEY:  LD  A,B                         ;4b45  78          
    OR  C                               ;4b46  b1          
    RET Z                               ;4b47  c8          
    JP  BOXDEC                          ;4b48  c3 54 4b    
BOXLOP: PUSH    HL                      ;4b4b  e5          
    PUSH    DE                          ;4b4c  d5          
    PUSH    BC                          ;4b4d  c5          
BOXMD:  CALL    PSETSB                  ;4b4e  cd 0c 48    ;PSETTX
    POP BC                              ;4b51  c1          
    POP DE                              ;4b52  d1          
    POP HL                              ;4b53  e1          
BOXDEC: DEC BC                          ;4b54  0b          
XBOXAD: NOP                             ;4b55  00          ;INC/DEL DEL/HL
LINEX:  LD  A,B                         ;4b56  78          
    OR  C                               ;4b57  b1          
    JR  NZ,BOXLOP                       ;4b58  20 f1       
    RET                                 ;4b5a  c9          
                  ;
                  ;
                  ; BOX FU
BOXFUL: LD  A,013h                      ;4b5b  3e 13       
    DEC B                               ;4b5d  05          
    JR  Z,FULAD1                        ;4b5e  28 02       
    LD  A,01Bh                          ;4b60  3e 1b       
FULAD1: LD  (XBOXAD),A                  ;4b62  32 55 4b    
    LD  A,023h                          ;4b65  3e 23       
    DEC C                               ;4b67  0d          
    JR  Z,FULAD2                        ;4b68  28 02       
    LD  A,02Bh                          ;4b6a  3e 2b       
FULAD2: LD  (FULINC),A                  ;4b6c  32 88 4b    
    PUSH    HL                          ;4b6f  e5          
    POP BC                              ;4b70  c1          
    INC BC                              ;4b71  03          
    EX  DE,HL                           ;4b72  eb          
    INC HL                              ;4b73  23          
    LD  (LINEBC+1),HL                   ;4b74  22 81 4b    
    LD  DE,(LINEXS+1)                   ;4b77  ed 5b 40 4a 
    LD  HL,(LINEYS+1)                   ;4b7b  2a 5d 4a    
FULLOP: PUSH    DE                      ;4b7e  d5          
    PUSH    BC                          ;4b7f  c5          
LINEBC: LD  BC,00001h                   ;4b80  01 01 00    
    CALL    LINEX                       ;4b83  cd 56 4b    
    POP BC                              ;4b86  c1          
    POP DE                              ;4b87  d1          
FULINC: INC HL                          ;4b88  23          
    DEC BC                              ;4b89  0b          
    LD  A,B                             ;4b8a  78          
    OR  C                               ;4b8b  b1          
    JP  NZ,FULLOP                       ;4b8c  c2 7e 4b    
    RET                                 ;4b8f  c9          
                  ;
DIVH$D: LD  A,H                         ;4b90  7c          
    OR  L                               ;4b91  b5          
    RET Z                               ;4b92  c8          
    PUSH    BC                          ;4b93  c5          
    LD  A,17                            ;4b94  3e 11       
    EXX                                 ;4b96  d9          
    LD  HL,0                            ;4b97  21 00 00    
    LD  DE,0                            ;4b9a  11 00 00    
    EXX                                 ;4b9d  d9          
DIVLP:  PUSH    HL                      ;4b9e  e5          
    OR  A                               ;4b9f  b7          
    SBC HL,DE                           ;4ba0  ed 52       
    EXX                                 ;4ba2  d9          
    PUSH    HL                          ;4ba3  e5          
    SBC HL,DE                           ;4ba4  ed 52       
    JR  C,DIV01                         ;4ba6  38 06       
    EX  (SP),HL                         ;4ba8  e3          
    POP HL                              ;4ba9  e1          
    EXX                                 ;4baa  d9          
    EX  (SP),HL                         ;4bab  e3          
    EXX                                 ;4bac  d9          
    PUSH    HL                          ;4bad  e5          
DIV01:  POP HL                          ;4bae  e1          
    EXX                                 ;4baf  d9          
    POP HL                              ;4bb0  e1          
    CCF                                 ;4bb1  3f          
    RL  C                               ;4bb2  cb 11       
    RL  B                               ;4bb4  cb 10       
    SLA L                               ;4bb6  cb 25       
    RL  H                               ;4bb8  cb 14       
    EXX                                 ;4bba  d9          
    RL  L                               ;4bbb  cb 15       
    RL  H                               ;4bbd  cb 14       
    EXX                                 ;4bbf  d9          
    DEC A                               ;4bc0  3d          
    JR  NZ,DIVLP                        ;4bc1  20 db       
    LD  L,C                             ;4bc3  69          
    LD  H,B                             ;4bc4  60          
    POP BC                              ;4bc5  c1          
    RET                                 ;4bc6  c9          
                  ;
                  ;
TEXTSB: XOR A                           ;4bc7  af          
    CP  D                               ;4bc8  ba          
    RET NZ                              ;4bc9  c0          
    CP  H                               ;4bca  bc          
    RET NZ                              ;4bcb  c0          
    LD  D,L                             ;4bcc  55          
    LD  A,E                             ;4bcd  7b          
    CP  32                              ;4bce  fe 20       
    RET NC                              ;4bd0  d0          
    LD  A,D                             ;4bd1  7a          
    CP  16                              ;4bd2  fe 10       
    RET NC                              ;4bd4  d0          
    EX  DE,HL                           ;4bd5  eb          
    CALL    ADRCA2                      ;4bd6  cd 3b 09    
CHRCOD: LD  A,041h                      ;4bd9  3e 41       ;"A"
    JP  BCOUTA                          ;4bdb  c3 3f 0a    
                  ;
CIRCLE: LD  C,L                         ;4bde  4d          
    LD  B,H                             ;4bdf  44          
    CALL    SETXY2                      ;4be0  cd 61 49    
    CALL    CH2CH                       ;4be3  cd 61 2d    
    INC BC                              ;4be6  03          
    LD  (SINSX+1),DE                    ;4be7  ed 53 9f 4d 
    LD  (SINSY+1),HL                    ;4beb  22 a6 4d    
    LD  A,(BC)                          ;4bee  0a          
    CP  05Bh                            ;4bef  fe 5b       ;[
    JR  NZ,CIRRST                       ;4bf1  20 13       
    INC BC                              ;4bf3  03          
    CALL    IHLEXP                      ;4bf4  cd cc 22    
    CALL    CH2CH                       ;4bf7  cd 61 2d    
    PUSH    HL                          ;4bfa  e5          
    CALL    IHLEXP                      ;4bfb  cd cc 22    
    CP  05Dh                            ;4bfe  fe 5d       ;]
    JP  NZ,SERROR                       ;4c00  c2 3a 17    
    POP DE                              ;4c03  d1          
    JR  CRRROK                          ;4c04  18 06       
CIRRST: CALL    IHLEXP                  ;4c06  cd cc 22    
    DEC BC                              ;4c09  0b          
    LD  D,H                             ;4c0a  54          
    LD  E,L                             ;4c0b  5d          
CRRROK: LD  (SINRX+1),DE                ;4c0c  ed 53 cc 4d 
    LD  (SINRY+1),HL                    ;4c10  22 d2 4d    
    CALL    EDCEK                       ;4c13  cd 6f 49    
    LD  HL,10                           ;4c16  21 0a 00    
    JR  Z,POLYE1                        ;4c19  28 45       
    CALL    CH2CH                       ;4c1b  cd 61 2d    
    INC BC                              ;4c1e  03          
    CALL    IHLEXP                      ;4c1f  cd cc 22    
    LD  (SIND+1),HL                     ;4c22  22 ba 4c    
    DEC BC                              ;4c25  0b          
    CALL    EDCEK                       ;4c26  cd 6f 49    
    JR  Z,POLYE2                        ;4c29  28 38       
    INC BC                              ;4c2b  03          
    LD  A,(BC)                          ;4c2c  0a          
    CP  02Ch                            ;4c2d  fe 2c       
    LD  A,(COLORF)                      ;4c2f  3a 80 11    
    JR  Z,SKPCOL                        ;4c32  28 09       
    CALL    IBYTE                       ;4c34  cd df 22    
    CP  9                               ;4c37  fe 09       
    JP  NC,IFCALL                       ;4c39  d2 36 17    
    DEC BC                              ;4c3c  0b          
SKPCOL: LD  (GCOLOR),A                  ;4c3d  32 81 11    
    LD  A,(BC)                          ;4c40  0a          
    CALL    EDCEK                       ;4c41  cd 6f 49    
    JR  Z,POLYE3                        ;4c44  28 23       
    CALL    CH2CH                       ;4c46  cd 61 2d    
    INC BC                              ;4c49  03          
    CALL    IHLEXP                      ;4c4a  cd cc 22    
    LD  (SINSTA+1),HL                   ;4c4d  22 a6 4c    
    DEC BC                              ;4c50  0b          
    CALL    EDCEK                       ;4c51  cd 6f 49    
    JR  Z,POLYE4                        ;4c54  28 19       
    CALL    CH2CH                       ;4c56  cd 61 2d    
    INC BC                              ;4c59  03          
    CALL    IHLEXP                      ;4c5a  cd cc 22    
    DEC BC                              ;4c5d  0b          
    JR  POLYE5                          ;4c5e  18 12       
                  ;
POLYE1: LD  (SIND+1),HL                 ;4c60  22 ba 4c    
POLYE2: LD  A,(COLORF)                  ;4c63  3a 80 11    
    LD  (GCOLOR),A                      ;4c66  32 81 11    
POLYE3: LD  HL,0                        ;4c69  21 00 00    
    LD  (SINSTA+1),HL                   ;4c6c  22 a6 4c    
POLYE4: LD  HL,360                      ;4c6f  21 68 01    
POLYE5: LD  (SINEND+1),HL               ;4c72  22 c3 4c    
    PUSH    BC                          ;4c75  c5          
    LD  HL,LINESB                       ;4c76  21 7d 4a    
    LD  (LNBOXF+1),HL                   ;4c79  22 7b 4a    
    LD  HL,PSETSB                       ;4c7c  21 0c 48    
    LD  (LINEMD+1),HL                   ;4c7f  22 b9 4a    
    LD  HL,(SIND+1)                     ;4c82  2a ba 4c    
    LD  A,H                             ;4c85  7c          
    OR  L                               ;4c86  b5          
    JR  Z,POLYLN                        ;4c87  28 05       
    CALL    SINSTA                      ;4c89  cd a5 4c    
    POP HL                              ;4c8c  e1          
    RET                                 ;4c8d  c9          
POLYLN: LD  HL,(SINSX+1)                ;4c8e  2a 9f 4d    
    LD  (LINEXS+1),HL                   ;4c91  22 40 4a    
    LD  HL,(SINSY+1)                    ;4c94  2a a6 4d    
    LD  (LINEYS+1),HL                   ;4c97  22 5d 4a    
    LD  HL,(SINSTA+1)                   ;4c9a  2a a6 4c    
    CALL    SINXYS                      ;4c9d  cd d5 4c    
    CALL    LINES1                      ;4ca0  cd 2b 4a    
    POP HL                              ;4ca3  e1          
    RET                                 ;4ca4  c9          
                  ;
SINSTA: LD  HL,0                        ;4ca5  21 00 00    ;DEG START
    PUSH    HL                          ;4ca8  e5          
    CALL    SINXYS                      ;4ca9  cd d5 4c    
CIRCLP: LD  HL,(LINEXE+1)               ;4cac  2a 45 4a    
    LD  (LINEXS+1),HL                   ;4caf  22 40 4a    
    LD  HL,(LINEYE+1)                   ;4cb2  2a 62 4a    
    LD  (LINEYS+1),HL                   ;4cb5  22 5d 4a    
    POP HL                              ;4cb8  e1          
SIND:   LD  BC,00001h                   ;4cb9  01 01 00    ;DEG STEP
    ADD HL,BC                           ;4cbc  09          
    PUSH    HL                          ;4cbd  e5          
    LD  BC,08000h                       ;4cbe  01 00 80    
    ADD HL,BC                           ;4cc1  09          
SINEND: LD  DE,360                      ;4cc2  11 68 01    ;DEG END
    EX  DE,HL                           ;4cc5  eb          
    ADD HL,BC                           ;4cc6  09          
    OR  A                               ;4cc7  b7          
    SBC HL,DE                           ;4cc8  ed 52       
    POP HL                              ;4cca  e1          
    RET C                               ;4ccb  d8          
    PUSH    HL                          ;4ccc  e5          
    CALL    SINXYS                      ;4ccd  cd d5 4c    
    CALL    LINES1                      ;4cd0  cd 2b 4a    
    JR  CIRCLP                          ;4cd3  18 d7       
                  ;
SINXYS: BIT 7,H                         ;4cd5  cb 7c       ;HL=DEG
    JR  Z,SIN!                          ;4cd7  28 08       
    LD  DE,360                          ;4cd9  11 68 01    
L38C6:  ADD HL,DE                       ;4cdc  19          
    JR  NC,L38C6                        ;4cdd  30 fd       
    JR  SINOK                           ;4cdf  18 0a       
SIN!:   LD  DE,0FE98h                   ;4ce1  11 98 fe    ;-360
L38CE:  ADD HL,DE                       ;4ce4  19          
    JR  C,L38CE                         ;4ce5  38 fd       
    LD  DE,360                          ;4ce7  11 68 01    
    ADD HL,DE                           ;4cea  19          
SINOK:  LD  A,H                         ;4ceb  7c          
    OR  L                               ;4cec  b5          
    JP  Z,SIN00                         ;4ced  ca 7a 4d    
    LD  DE,1                            ;4cf0  11 01 00    
    LD  BC,90                           ;4cf3  01 5a 00    
    SBC HL,BC                           ;4cf6  ed 42       
    JP  Z,SIN90                         ;4cf8  ca 7f 4d    
    JR  C,SIN45                         ;4cfb  38 13       
    SBC HL,BC                           ;4cfd  ed 42       
    JP  Z,SIN180                        ;4cff  ca 84 4d    
    JR  C,SIN135                        ;4d02  38 14       
    SBC HL,BC                           ;4d04  ed 42       
    JP  Z,SIN270                        ;4d06  ca 89 4d    
    JR  C,SIN225                        ;4d09  38 13       
    LD  BC,00000h                       ;4d0b  01 00 00    ;X>0,Y>0
    JR  SINOK1                          ;4d0e  18 14       
SIN45:  EX  DE,HL                       ;4d10  eb          ;0-90
    SBC HL,DE                           ;4d11  ed 52       
    LD  BC,000FFh                       ;4d13  01 ff 00    ;X>0,Y<0
    JR  SINOK1                          ;4d16  18 0c       
SIN135: ADD HL,BC                       ;4d18  09          ;180-90
    LD  BC,0FFFFh                       ;4d19  01 ff ff    ;X<0,Y<0
    JR  SINOK1                          ;4d1c  18 06       
SIN225: EX  DE,HL                       ;4d1e  eb          
    SBC HL,DE                           ;4d1f  ed 52       
    LD  BC,0FF00h                       ;4d21  01 00 ff    ;X<0,Y>0
SINOK1: ADD HL,HL                       ;4d24  29          
    EX  DE,HL                           ;4d25  eb          
    LD  A,B                             ;4d26  78          
    LD  (XMULHI+1),A                    ;4d27  32 5d 4d    
    LD  A,C                             ;4d2a  79          
    LD  (YMULHI+1),A                    ;4d2b  32 6b 4d    
    LD  HL,SINTBL                       ;4d2e  21 0b 4e    
    ADD HL,DE                           ;4d31  19          
    LD  A,(HL)                          ;4d32  7e          
    INC HL                              ;4d33  23          
    LD  H,(HL)                          ;4d34  66          
    LD  L,A                             ;4d35  6f          
    INC B                               ;4d36  04          
    JR  NZ,SINXOK                       ;4d37  20 08       
    PUSH    DE                          ;4d39  d5          
    LD  DE,0                            ;4d3a  11 00 00    
    EX  DE,HL                           ;4d3d  eb          
    SBC HL,DE                           ;4d3e  ed 52       
    POP DE                              ;4d40  d1          
SINXOK: LD  (XMULLO+1),HL               ;4d41  22 61 4d    
    LD  HL,COSTBL                       ;4d44  21 bf 4e    
    OR  A                               ;4d47  b7          
    SBC HL,DE                           ;4d48  ed 52       
    LD  A,(HL)                          ;4d4a  7e          
    INC HL                              ;4d4b  23          
    LD  H,(HL)                          ;4d4c  66          
    LD  L,A                             ;4d4d  6f          
    INC C                               ;4d4e  0c          
    JR  NZ,SINYOK                       ;4d4f  20 08       
    PUSH    DE                          ;4d51  d5          
    LD  DE,0                            ;4d52  11 00 00    
    EX  DE,HL                           ;4d55  eb          
    SBC HL,DE                           ;4d56  ed 52       
    POP DE                              ;4d58  d1          
SINYOK: LD  (YMULLO+1),HL               ;4d59  22 6f 4d    
XMULHI: LD  L,0                         ;4d5c  2e 00       
    LD  H,L                             ;4d5e  65          
    EXX                                 ;4d5f  d9          
XMULLO: LD  HL,0                        ;4d60  21 00 00    
    EXX                                 ;4d63  d9          
    CALL    DEHLMX                      ;4d64  cd ca 4d    
    LD  (SINXAD+1),HL                   ;4d67  22 9b 4d    
YMULHI: LD  L,0                         ;4d6a  2e 00       
    LD  H,L                             ;4d6c  65          
    EXX                                 ;4d6d  d9          
YMULLO: LD  HL,0                        ;4d6e  21 00 00    
    EXX                                 ;4d71  d9          
    CALL    DEHLMY                      ;4d72  cd d0 4d    
    LD  (SINYAD+1),HL                   ;4d75  22 a9 4d    
    JR  SINXAD                          ;4d78  18 20       
SIN00:  LD  BC,00100H                   ;4d7a  01 00 01    ;X=1,Y=0
    JR  SINJST                          ;4d7d  18 0d       
SIN90:  LD  BC,000FFh                   ;4d7f  01 ff 00    ;X=0,Y=-1
    JR  SINJST                          ;4d82  18 08       
SIN180: LD  BC,0FF00h                   ;4d84  01 00 ff    ;X=0,Y=0
    JR  SINJST                          ;4d87  18 03       
SIN270: LD  BC,00001h                   ;4d89  01 01 00    ;X=0,Y=1
SINJST: LD  A,B                         ;4d8c  78          
    CALL    RMULAX                      ;4d8d  cd bb 4d    
    LD  (SINXAD+1),HL                   ;4d90  22 9b 4d    
    LD  A,C                             ;4d93  79          
    CALL    RMULAY                      ;4d94  cd b0 4d    
    LD  (SINYAD+1),HL                   ;4d97  22 a9 4d    
SINXAD: LD  HL,00000h                   ;4d9a  21 00 00    ;ADD X
WIDTH3: NOP                             ;4d9d  00          ;40/ADD HL,HL
SINSX:                                  ;                  
    LD  DE,00000h                       ;4d9e  11 00 00    ;CENTER X
    ADD HL,DE                           ;4da1  19          
    LD  (LINEXE+1),HL                   ;4da2  22 45 4a    
SINSY:  LD  HL,00000h                   ;4da5  21 00 00    ;CENTER Y
SINYAD: LD  DE,00000h                   ;4da8  11 00 00    ;ADD Y
    ADD HL,DE                           ;4dab  19          
    LD  (LINEYE+1),HL                   ;4dac  22 62 4a    
    RET                                 ;4daf  c9          
                  ;
RMULAY: LD  HL,0                        ;4db0  21 00 00    
    OR  A                               ;4db3  b7          
    RET Z                               ;4db4  c8          
    EX  DE,HL                           ;4db5  eb          
    LD  HL,(SINRY+1)                    ;4db6  2a d2 4d    
    JR  RMULXY                          ;4db9  18 09       
RMULAX: LD  HL,0                        ;4dbb  21 00 00    
    OR  A                               ;4dbe  b7          
    RET Z                               ;4dbf  c8          
    EX  DE,HL                           ;4dc0  eb          
    LD  HL,(SINRX+1)                    ;4dc1  2a cc 4d    
RMULXY: INC A                           ;4dc4  3c          
    RET NZ                              ;4dc5  c0          
    EX  DE,HL                           ;4dc6  eb          
    SBC HL,DE                           ;4dc7  ed 52       
    RET                                 ;4dc9  c9          
                  ;
DEHLMX: EXX                             ;4dca  d9          
SINRX:  LD  BC,00001h                   ;4dcb  01 01 00    ;XR
    JR  DEHLMS                          ;4dce  18 04       
DEHLMY: EXX                             ;4dd0  d9          
SINRY:  LD  BC,00001h                   ;4dd1  01 01 00    ;YR
DEHLMS: LD  DE,0                        ;4dd4  11 00 00    
    EXX                                 ;4dd7  d9          
    LD  B,16                            ;4dd8  06 10       
    LD  DE,0                            ;4dda  11 00 00    
MULOP1: EXX                             ;4ddd  d9          
    EX  DE,HL                           ;4dde  eb          
    ADD HL,HL                           ;4ddf  29          
    EX  DE,HL                           ;4de0  eb          
    EXX                                 ;4de1  d9          
    EX  DE,HL                           ;4de2  eb          
    ADC HL,HL                           ;4de3  ed 6a       
    EX  DE,HL                           ;4de5  eb          
    EXX                                 ;4de6  d9          
    SLA C                               ;4de7  cb 21       
    RL  B                               ;4de9  cb 10       
    JR  NC,MULOP2                       ;4deb  30 09       
    EX  DE,HL                           ;4ded  eb          
    ADD HL,DE                           ;4dee  19          
    EX  DE,HL                           ;4def  eb          
    EXX                                 ;4df0  d9          
    EX  DE,HL                           ;4df1  eb          
    ADC HL,DE                           ;4df2  ed 5a       
    EX  DE,HL                           ;4df4  eb          
    EXX                                 ;4df5  d9          
MULOP2: EXX                             ;4df6  d9          
    DJNZ    MULOP1                      ;4df7  10 e4       
    LD  A,080h                          ;4df9  3e 80       
    BIT 7,D                             ;4dfb  cb 7a       
    EXX                                 ;4dfd  d9          
    JR  Z,MULOP3                        ;4dfe  28 01       
    CPL                                 ;4e00  2f          
MULOP3: LD  H,A                         ;4e01  67          
    LD  L,A                             ;4e02  6f          
    ADD HL,DE                           ;4e03  19          
    EXX                                 ;4e04  d9          
    LD  HL,0                            ;4e05  21 00 00    
    ADC HL,DE                           ;4e08  ed 5a       
    RET                                 ;4e0a  c9          
                  ;
SINTBL: DEFW    0                       ;4e0b  00 00       
    DEFW    00478H                      ;4e0d  78 04       
    DEFW    008F0H                      ;4e0f  f0 08       
    DEFW    00D66H                      ;4e11  66 0d       
    DEFW    011DCH                      ;4e13  dc 11       
    DEFW    01650H                      ;4e15  50 16       
    DEFW    01AC3H                      ;4e17  c3 1a       
    DEFW    01F33H                      ;4e19  33 1f       
    DEFW    023A1H                      ;4e1b  a1 23       
    DEFW    0280CH                      ;4e1d  0c 28       
    DEFW    02C75H                      ;4e1f  75 2c       
    DEFW    030D9H                      ;4e21  d9 30       
    DEFW    0353AH                      ;4e23  3a 35       
    DEFW    03997H                      ;4e25  97 39       
    DEFW    03DEFH                      ;4e27  ef 3d       
    DEFW    04242H                      ;4e29  42 42       
    DEFW    04691H                      ;4e2b  91 46       
    DEFW    04AD9H                      ;4e2d  d9 4a       
    DEFW    04F1CH                      ;4e2f  1c 4f       
    DEFW    05359H                      ;4e31  59 53       
    DEFW    0578FH                      ;4e33  8f 57       
    DEFW    05BBEH                      ;4e35  be 5b       
    DEFW    05FE7H                      ;4e37  e7 5f       
    DEFW    06407H                      ;4e39  07 64       
    DEFW    06820H                      ;4e3b  20 68       
    DEFW    06C2FH                      ;4e3d  2f 6c       
    DEFW    07039H                      ;4e3f  39 70       
    DEFW    07439H                      ;4e41  39 74       
    DEFW    07830H                      ;4e43  30 78       
    DEFW    07C1DH                      ;4e45  1d 7c       
    DEFW    08000H                      ;4e47  00 80       
    DEFW    083DAH                      ;4e49  da 83       
    DEFW    087A9H                      ;4e4b  a9 87       
    DEFW    08B6EH                      ;4e4d  6e 8b       
    DEFW    08F28H                      ;4e4f  28 8f       
    DEFW    092D6H                      ;4e51  d6 92       
    DEFW    09679H                      ;4e53  79 96       
    DEFW    09A11H                      ;4e55  11 9a       
    DEFW    09D9CH                      ;4e57  9c 9d       
    DEFW    0A11BH                      ;4e59  1b a1       
    DEFW    0A48EH                      ;4e5b  8e a4       
    DEFW    0A7F4H                      ;4e5d  f4 a7       
    DEFW    0AB4CH                      ;4e5f  4c ab       
    DEFW    0AE98H                      ;4e61  98 ae       
    DEFW    0B1F0H                      ;4e63  f0 b1       
    DEFW    0B58BH                      ;4e65  8b b5       
    DEFW    0B840H                      ;4e67  40 b8       
    DEFW    0BB50H                      ;4e69  50 bb       
    DEFW    0BE3FH                      ;4e6b  3f be       
    DEFW    0C135H                      ;4e6d  35 c1       
    DEFW    0C41CH                      ;4e6f  1c c4       
    DEFW    0C6F3H                      ;4e71  f3 c6       
    DEFW    0C9BBH                      ;4e73  bb c9       
    DEFW    0CC74H                      ;4e75  74 cc       
    DEFW    0CF1CH                      ;4e77  1c cf       
    DEFW    0D1B4H                      ;4e79  b4 d1       
    DEFW    0D43CH                      ;4e7b  3c d4       
    DEFW    0D6B3H                      ;4e7d  b3 d6       
    DEFW    0D91AH                      ;4e7f  1a d9       
    DEFW    0DB70H                      ;4e81  70 db       
    DEFW    0DDB4H                      ;4e83  b4 dd       
    DEFW    0DF40H                      ;4e85  40 df       
    DEFW    0E1E0H                      ;4e87  e0 e1       
    DEFW    0E497H                      ;4e89  97 e4       
    DEFW    0E61BH                      ;4e8b  1b e6       
    DEFW    0E804H                      ;4e8d  04 e8       
    DEFW    0E9DEH                      ;4e8f  de e9       
    DEFW    0EBA7H                      ;4e91  a7 eb       
    DEFW    0ED5CH                      ;4e93  5c ed       
    DEFW    0EEFFH                      ;4e95  ff ee       
    DEFW    0F090H                      ;4e97  90 f0       
    DEFW    0F20EH                      ;4e99  0e f2       
    DEFW    0F379H                      ;4e9b  79 f3       
    DEFW    0F4D1H                      ;4e9d  d1 f4       
    DEFW    0F616H                      ;4e9f  16 f6       
    DEFW    0F747H                      ;4ea1  47 f7       
    DEFW    0F866H                      ;4ea3  66 f8       
    DEFW    0F971H                      ;4ea5  71 f9       
    DEFW    0FA68H                      ;4ea7  68 fa       
    DEFW    0FB4CH                      ;4ea9  4c fb       
    DEFW    0FC1DH                      ;4eab  1d fc       
    DEFW    0FCD9H                      ;4ead  d9 fc       
    DEFW    0FD83H                      ;4eaf  83 fd       
    DEFW    0FE18H                      ;4eb1  18 fe       
    DEFW    0FE99H                      ;4eb3  99 fe       
    DEFW    0FF07H                      ;4eb5  07 ff       
    DEFW    0FF61H                      ;4eb7  61 ff       
    DEFW    0FFA7H                      ;4eb9  a7 ff       
    DEFW    0FFD8H                      ;4ebb  d8 ff       
    DEFW    0FFF6H                      ;4ebd  f6 ff       
COSTBL: DEFW    0                       ;4ebf  00 00       
                  ;
PAINT:  LD  C,L                         ;4ec1  4d          
    LD  B,H                             ;4ec2  44          
    CALL    SETXY2                      ;4ec3  cd 61 49    
    PUSH    HL                          ;4ec6  e5          ;Y
    PUSH    DE                          ;4ec7  d5          ;X
    LD  HL,PACOLB                       ;4ec8  21 1f 50    
    LD  D,9                             ;4ecb  16 09       
    LD  A,(COLORF)                      ;4ecd  3a 80 11    
    LD  (HL),A                          ;4ed0  77          
    CALL    PACOLS                      ;4ed1  cd 03 4f    
    LD  HL,PACOLB                       ;4ed4  21 1f 50    
    LD  E,8                             ;4ed7  1e 08       
    LD  A,(HL)                          ;4ed9  7e          
PACINT: INC HL                          ;4eda  23          
    LD  (HL),A                          ;4edb  77          
    DEC E                               ;4edc  1d          
    JR  NZ,PACINT                       ;4edd  20 fb       
    LD  HL,PACOLB+1                     ;4edf  21 20 50    
    JR  L3AD1                           ;4ee2  18 03       
PACOSL: CALL    PACOLS                  ;4ee4  cd 03 4f    
L3AD1:  DEC D                           ;4ee7  15          
    JR  NZ,PACOSL                       ;4ee8  20 fa       
    LD  HL,PSETSB                       ;4eea  21 0c 48    
    LD  (BOXMD+1),HL                    ;4eed  22 4f 4b    
    LD  A,013h                          ;4ef0  3e 13       
    LD  (XBOXAD),A                      ;4ef2  32 55 4b    
    LD  A,(PACOLB)                      ;4ef5  3a 1f 50    
    LD  (GCOLOR),A                      ;4ef8  32 81 11    
    POP DE                              ;4efb  d1          
    POP HL                              ;4efc  e1          
    PUSH    BC                          ;4efd  c5          
    CALL    PAINTS                      ;4efe  cd 1f 4f    
    POP HL                              ;4f01  e1          
    RET                                 ;4f02  c9          
                  ;
PACOLS: CALL    EDCEK                   ;4f03  cd 6f 49    
    JR  Z,PACEND                        ;4f06  28 14       
    CALL    CH2CH                       ;4f08  cd 61 2d    
    INC BC                              ;4f0b  03          
    PUSH    DE                          ;4f0c  d5          
    PUSH    HL                          ;4f0d  e5          
    CALL    IBYTE                       ;4f0e  cd df 22    
    POP HL                              ;4f11  e1          
    POP DE                              ;4f12  d1          
    CP  9                               ;4f13  fe 09       
    JP  NC,IFCALL                       ;4f15  d2 36 17    
    LD  (HL),A                          ;4f18  77          
    INC HL                              ;4f19  23          
    DEC BC                              ;4f1a  0b          
    RET                                 ;4f1b  c9          
PACEND: LD  D,1                         ;4f1c  16 01       
    RET                                 ;4f1e  c9          
                  ;
                  ;
PAINTS: LD  BC,08000h                   ;4f1f  01 00 80    
    PUSH    BC                          ;4f22  c5          
    PUSH    HL                          ;4f23  e5          
    PUSH    DE                          ;4f24  d5          
                  ;
PAIN01: POP DE                          ;4f25  d1          
    POP HL                              ;4f26  e1          
    XOR A                               ;4f27  af          
    CP  E                               ;4f28  bb          
    JR  NZ,PAIN02                       ;4f29  20 06       
    LD  A,080h                          ;4f2b  3e 80       
    CP  D                               ;4f2d  ba          
    JR  NZ,PAIN02                       ;4f2e  20 01       
    JP  (HL)                            ;4f30  e9          
                  ;
PAIN02: CALL    POICEK                  ;4f31  cd 87 4f    
    JP  Z,PAIN01                        ;4f34  ca 25 4f    
PAIN03: DEC DE                          ;4f37  1b          ;X=X-1
    CALL    POICEK                      ;4f38  cd 87 4f    
    JR  NZ,PAIN03                       ;4f3b  20 fa       
    INC DE                              ;4f3d  13          
    LD  BC,00000h                       ;4f3e  01 00 00    ;FLG CLR
    PUSH    DE                          ;4f41  d5          
    EXX                                 ;4f42  d9          
    POP DE                              ;4f43  d1          ;DE'=STERT X (START의 오타?)
    EXX                                 ;4f44  d9          
PAIN11: CALL    POICEK                  ;4f45  cd 87 4f    
    JR  Z,PAIN04                        ;4f48  28 2d       
    DEC HL                              ;4f4a  2b          ;UP LINE CHECK
    CALL    POICEK                      ;4f4b  cd 87 4f    
    JR  Z,PAIN05                        ;4f4e  28 0c       
    DEC B                               ;4f50  05          
    JR  Z,PAIN06                        ;4f51  28 05       
    PUSH    HL                          ;4f53  e5          ;NEXT POINT SET
    PUSH    DE                          ;4f54  d5          
    CALL    MEMCHK                      ;4f55  cd b0 1e    ;SP CHK
PAIN06: LD  B,1                         ;4f58  06 01       ;UP FLAG SET
    JR  PAIN07                          ;4f5a  18 02       
PAIN05: LD  B,0                         ;4f5c  06 00       ;UP FLAG CLR
PAIN07: INC HL                          ;4f5e  23          ;
    INC HL                              ;4f5f  23          ;DOUN LINE CHECK (DOWN의 오타?)
    CALL    POICEK                      ;4f60  cd 87 4f    
    JR  Z,PAIN08                        ;4f63  28 0c       
    DEC C                               ;4f65  0d          
    JR  Z,PAIN09                        ;4f66  28 05       
    PUSH    HL                          ;4f68  e5          ;NEXT POINT SET
    PUSH    DE                          ;4f69  d5          
    CALL    MEMCHK                      ;4f6a  cd b0 1e    ;SP CHK
PAIN09: LD  C,1                         ;4f6d  0e 01       ;DOUN FLG SET
    JR  PAIN10                          ;4f6f  18 02       
PAIN08: LD  C,0                         ;4f71  0e 00       ;DOUN FLG CLR
PAIN10: DEC HL                          ;4f73  2b          
    INC DE                              ;4f74  13          ;X=X+1
    JR  PAIN11                          ;4f75  18 ce       
                  ;
PAIN04: PUSH    HL                      ;4f77  e5          
    PUSH    DE                          ;4f78  d5          
    EXX                                 ;4f79  d9          
    POP HL                              ;4f7a  e1          
    OR  A                               ;4f7b  b7          
    SBC HL,DE                           ;4f7c  ed 52       
    LD  C,L                             ;4f7e  4d          
    LD  B,H                             ;4f7f  44          
    POP HL                              ;4f80  e1          
    CALL    LINEX                       ;4f81  cd 56 4b    
    JP  PAIN01                          ;4f84  c3 25 4f    
                  ;
POICEK: PUSH    BC                      ;4f87  c5          
    PUSH    DE                          ;4f88  d5          
    PUSH    HL                          ;4f89  e5          
    CALL    CULADR                      ;4f8a  cd 23 48    
    JR  C,POIZER                        ;4f8d  38 0a       
    EX  DE,HL                           ;4f8f  eb          
    LD  BC,POITBL                       ;4f90  01 9e 4f    
    ADD HL,BC                           ;4f93  09          
    LD  C,(HL)                          ;4f94  4e          
    INC HL                              ;4f95  23          
    LD  B,(HL)                          ;4f96  46          
    PUSH    BC                          ;4f97  c5          
    RET                                 ;4f98  c9          
                  ;
POIZER: XOR A                           ;4f99  af          
POINRT: POP HL                          ;4f9a  e1          
    POP DE                              ;4f9b  d1          
    POP BC                              ;4f9c  c1          
    RET                                 ;4f9d  c9          
                  ;
POITBL: DEFW    POIST0                  ;4f9e  a6 4f       
    DEFW    POIST1                      ;4fa0  cf 4f       
    DEFW    POIST3                      ;4fa2  f4 4f       
    DEFW    POIST5                      ;4fa4  0c 50       
                  ;
POIST0: LD  C,E                         ;4fa6  4b          
    LD  B,D                             ;4fa7  42          
    IN  E,(C)                           ;4fa8  ed 58       
    RLCA                                ;4faa  07          
    RLCA                                ;4fab  07          
    RLCA                                ;4fac  07          
    AND 038h                            ;4fad  e6 38       
    ADD A,043h                          ;4faf  c6 43       
    LD  (BTTST1+1),A                    ;4fb1  32 b6 4f    
    XOR A                               ;4fb4  af          
BTTST1: BIT 0,E                         ;4fb5  cb 43       
    JR  Z,POINCK                        ;4fb7  28 08       
    LD  A,E                             ;4fb9  7b          
    RRCA                                ;4fba  0f          
    RRCA                                ;4fbb  0f          
    RRCA                                ;4fbc  0f          
    RRCA                                ;4fbd  0f          
    AND 00Fh                            ;4fbe  e6 0f       
    INC A                               ;4fc0  3c          
POINCK: LD  HL,PACOLB                   ;4fc1  21 1f 50    
    LD  B,9                             ;4fc4  06 09       
POINC1: CP  (HL)                        ;4fc6  be          
    JR  Z,POICKR                        ;4fc7  28 03       
    INC HL                              ;4fc9  23          
    DJNZ    POINC1                      ;4fca  10 fa       
POICKR: JP  POINRT                      ;4fcc  c3 9a 4f    
                  ;
POIST1: LD  C,E                         ;4fcf  4b          
    LD  B,D                             ;4fd0  42          
    IN  E,(C)                           ;4fd1  ed 58       
    RLCA                                ;4fd3  07          
    RLCA                                ;4fd4  07          
    RLCA                                ;4fd5  07          
    AND 038h                            ;4fd6  e6 38       
    ADD A,043h                          ;4fd8  c6 43       
    LD  (BTTST2+1),A                    ;4fda  32 df 4f    
    XOR A                               ;4fdd  af          
BTTST2: BIT 0,E                         ;4fde  cb 43       
    JR  Z,POINCK                        ;4fe0  28 df       
    LD  A,E                             ;4fe2  7b          
    RLCA                                ;4fe3  07          
    RLCA                                ;4fe4  07          
    AND 3                               ;4fe5  e6 03       
    INC A                               ;4fe7  3c          
    SET 3,B                             ;4fe8  cb d8       
    IN  D,(C)                           ;4fea  ed 50       
    BIT 1,D                             ;4fec  cb 4a       
    JR  Z,POINCK                        ;4fee  28 d1       
    ADD A,4                             ;4ff0  c6 04       
    JR  POINCK                          ;4ff2  18 cd       
                  ;
POIST3: LD  C,E                         ;4ff4  4b          
    LD  B,D                             ;4ff5  42          
    IN  E,(C)                           ;4ff6  ed 58       
    AND 3                               ;4ff8  e6 03       
    JR  Z,POIS33                        ;4ffa  28 07       
POIS3L: RL  E                           ;4ffc  cb 13       
    RL  E                               ;4ffe  cb 13       
    DEC A                               ;5000  3d          
    JR  NZ,POIS3L                       ;5001  20 f9       
POIS33: XOR A                           ;5003  af          
    RL  E                               ;5004  cb 13       
    RLA                                 ;5006  17          
    RL  E                               ;5007  cb 13       
    RLA                                 ;5009  17          
    JR  POINCK                          ;500a  18 b5       
                  ;
POIST5: LD  C,E                         ;500c  4b          
    LD  B,D                             ;500d  42          
    IN  E,(C)                           ;500e  ed 58       
    AND 7                               ;5010  e6 07       
    JR  Z,POIS55                        ;5012  28 05       
POIS5L: RL  E                           ;5014  cb 13       
    DEC A                               ;5016  3d          
    JR  NZ,POIS5L                       ;5017  20 fb       
POIS55: XOR A                           ;5019  af          
    RL  E                               ;501a  cb 13       
    RLA                                 ;501c  17          
    JR  POINCK                          ;501d  18 a2       
                  ;
                  ;
PACOLB: DEFS    9                       ;501f              
                  ;
PATTEN: LD  A,(GMODEF)                  ;5028  3a 06 1c    
    CP  4                               ;502b  fe 04       
    JP  C,IFCALL                        ;502d  da 36 17    
    LD  C,L                             ;5030  4d          
    LD  B,H                             ;5031  44          
    CALL    SETXY2                      ;5032  cd 61 49    
    CALL    CH2CH                       ;5035  cd 61 2d    
    LD  (PATX+1),DE                     ;5038  ed 53 73 50 
    LD  (PATY+1),HL                     ;503c  22 79 50    
    INC BC                              ;503f  03          
    CALL    IHLEXP                      ;5040  cd cc 22    
    CALL    CH2CH                       ;5043  cd 61 2d    
    LD  A,H                             ;5046  7c          
    OR  A                               ;5047  b7          
    LD  DE,0FFE0h                       ;5048  11 e0 ff    
    JR  Z,PATOK1                        ;504b  28 0c       
    CP  0FFh                            ;504d  fe ff       
    JP  NZ,IFCALL                       ;504f  c2 36 17    
    LD  DE,00020h                       ;5052  11 20 00    
    LD  A,L                             ;5055  7d          
    NEG                                 ;5056  ed 44       
    LD  L,A                             ;5058  6f          
PATOK1: LD  (PATYAD+1),DE               ;5059  ed 53 a6 50 
    LD  A,L                             ;505d  7d          
    OR  A                               ;505e  b7          
    JP  Z,IFCALL                        ;505f  ca 36 17    
    LD  (PATYLN+1),A                    ;5062  32 9d 50    
    CALL    STREXX                      ;5065  cd 9d 45    
    PUSH    BC                          ;5068  c5          
    LD  B,A                             ;5069  47          
    OR  A                               ;506a  b7          
    CALL    NZ,PATSUB                   ;506b  c4 71 50    
    POP HL                              ;506e  e1          
    DEC HL                              ;506f  2b          
    RET                                 ;5070  c9          
                  ;
PATSUB: EXX                             ;5071  d9          
PATX:   LD  DE,0                        ;5072  11 00 00    
    LD  A,D                             ;5075  7a          
    OR  A                               ;5076  b7          
    RET NZ                              ;5077  c0          
PATY:   LD  HL,0                        ;5078  21 00 00    
    LD  A,H                             ;507b  7c          
    OR  A                               ;507c  b7          
    RET NZ                              ;507d  c0          
    LD  A,L                             ;507e  7d          
    CP  192                             ;507f  fe c0       
    RET NC                              ;5081  d0          
    ADD HL,HL                           ;5082  29          
    ADD HL,HL                           ;5083  29          
    ADD HL,HL                           ;5084  29          
    ADD HL,HL                           ;5085  29          
    ADD HL,HL                           ;5086  29          
    LD  A,E                             ;5087  7b          
    SRL E                               ;5088  cb 3b       
    SRL E                               ;508a  cb 3b       
    SRL E                               ;508c  cb 3b       
    ADD HL,DE                           ;508e  19          
    LD  C,L                             ;508f  4d          
    LD  B,H                             ;5090  44          
    AND 7                               ;5091  e6 07       
    LD  D,080h                          ;5093  16 80       
    JR  Z,PATYLN                        ;5095  28 05       
L3C81:  SRL D                           ;5097  cb 3a       
    DEC A                               ;5099  3d          
    JR  NZ,L3C81                        ;509a  20 fb       
PATYLN: LD  E,1                         ;509c  1e 01       
    PUSH    BC                          ;509e  c5          
PATLP1: EXX                             ;509f  d9          
    LD  A,(DE)                          ;50a0  1a          
    EXX                                 ;50a1  d9          
    CALL    PATST                       ;50a2  cd ba 50    
PATYAD: LD  HL,00020h                   ;50a5  21 20 00    
    ADD HL,BC                           ;50a8  09          
    LD  C,L                             ;50a9  4d          
    LD  B,H                             ;50aa  44          
    EXX                                 ;50ab  d9          
    INC DE                              ;50ac  13          
    DEC B                               ;50ad  05          
    JR  Z,PATEND                        ;50ae  28 08       
    EXX                                 ;50b0  d9          
    DEC E                               ;50b1  1d          
    JR  NZ,PATLP1                       ;50b2  20 eb       
    POP BC                              ;50b4  c1          
    INC BC                              ;50b5  03          
    JR  PATYLN                          ;50b6  18 e4       
PATEND: POP BC                          ;50b8  c1          
    RET                                 ;50b9  c9          
                  ;
PATST:  PUSH    BC                      ;50ba  c5          
    PUSH    DE                          ;50bb  d5          
    LD  L,A                             ;50bc  6f          
    LD  H,8                             ;50bd  26 08       
PATSTL: RLC L                           ;50bf  cb 05       
    JR  NC,L3CB2                        ;50c1  30 05       
    IN  A,(C)                           ;50c3  ed 78       
    OR  D                               ;50c5  b2          
    OUT (C),A                           ;50c6  ed 79       
L3CB2:  RRC D                           ;50c8  cb 0a       
    JR  NC,L3CB7                        ;50ca  30 01       
    INC BC                              ;50cc  03          
L3CB7:  DEC H                           ;50cd  25          
    JR  NZ,PATSTL                       ;50ce  20 ef       
    POP DE                              ;50d0  d1          
    POP BC                              ;50d1  c1          
    RET                                 ;50d2  c9          
                  ;
                  ;
                  ;
HCOPY:  PUSH    HL                      ;50d3  e5          
    LD  A,01Bh                          ;50d4  3e 1b       ;ESC
    CALL    PRINTR                      ;50d6  cd 87 08    
    LD  A,041h                          ;50d9  3e 41       ;A
    CALL    PRINTR                      ;50db  cd 87 08    
    LD  A,007h                          ;50de  3e 07       ;7
    CALL    PRINTR                      ;50e0  cd 87 08    
    LD  A,(GMODEF)                      ;50e3  3a 06 1c    
    CP  2                               ;50e6  fe 02       
    JR  NC,COPYGM                       ;50e8  30 0c       
    LD  HL,COPYTX                       ;50ea  21 aa 51    
    LD  DE,COPYTA                       ;50ed  11 6f 51    
    LD  BC,(CHRSTA)                     ;50f0  ed 4b d6 0a 
    JR  COPYM4                          ;50f4  18 09       
COPYGM: LD  HL,COPYGR                   ;50f6  21 95 51    
    LD  DE,COPYGA                       ;50f9  11 6b 51    
    LD  BC,0                            ;50fc  01 00 00    
COPYM4: LD  (COPYM2+1),HL               ;50ff  22 10 51    
    LD  (COPYM3+1),DE                   ;5102  ed 53 4d 51 
    LD  D,0                             ;5106  16 00       
HCOPY1: CALL    PRTESC                  ;5108  cd 7e 51    
    LD  E,32                            ;510b  1e 20       
HCOPY2: PUSH    BC                      ;510d  c5          
    PUSH    DE                          ;510e  d5          
COPYM2: CALL    COPYGR                  ;510f  cd 95 51    
    LD  B,8                             ;5112  06 08       
HCOPY3: XOR A                           ;5114  af          
    RLCA                                ;5115  07          
    RLCA                                ;5116  07          
    RLC E                               ;5117  cb 03       
    JR  NC,L3D07                        ;5119  30 02       
    ADD A,3                             ;511b  c6 03       
L3D07:  RLCA                            ;511d  07          
    RLCA                                ;511e  07          
    RLC D                               ;511f  cb 02       
    JR  NC,L3D0F                        ;5121  30 02       
    ADD A,3                             ;5123  c6 03       
L3D0F:  RLCA                            ;5125  07          
    RLCA                                ;5126  07          
    RLC L                               ;5127  cb 05       
    JR  NC,L3D17                        ;5129  30 02       
    ADD A,3                             ;512b  c6 03       
L3D17:  RLCA                            ;512d  07          
    RLCA                                ;512e  07          
    RLC H                               ;512f  cb 04       
    JR  NC,L3D1F                        ;5131  30 02       
    ADD A,3                             ;5133  c6 03       
L3D1F:  EXX                             ;5135  d9          
    PUSH    AF                          ;5136  f5          
    CALL    PRINTR                      ;5137  cd 87 08    
    POP AF                              ;513a  f1          
    PUSH    AF                          ;513b  f5          
    CALL    PRINTR                      ;513c  cd 87 08    
    POP AF                              ;513f  f1          
    CALL    PRINTR                      ;5140  cd 87 08    
    EXX                                 ;5143  d9          
    DJNZ    HCOPY3                      ;5144  10 ce       
    POP DE                              ;5146  d1          
    POP BC                              ;5147  c1          
    INC BC                              ;5148  03          
    DEC E                               ;5149  1d          
    JR  NZ,HCOPY2                       ;514a  20 c1       
COPYM3: CALL    COPYGA                  ;514c  cd 6b 51    
    ADD HL,BC                           ;514f  09          
    LD  C,L                             ;5150  4d          
    LD  B,H                             ;5151  44          
    LD  A,00Ah                          ;5152  3e 0a       
    EXX                                 ;5154  d9          
    CALL    PRINTR                      ;5155  cd 87 08    
    EXX                                 ;5158  d9          
    INC D                               ;5159  14          
    LD  A,D                             ;515a  7a          
    CP  48                              ;515b  fe 30       
    JR  NZ,HCOPY1                       ;515d  20 a9       
    LD  A,01Bh                          ;515f  3e 1b       
    CALL    PRINTR                      ;5161  cd 87 08    
    LD  A,032h                          ;5164  3e 32       
    CALL    PRINTR                      ;5166  cd 87 08    
    POP HL                              ;5169  e1          
    RET                                 ;516a  c9          
                  ;
COPYGA: LD  HL,00060h                   ;516b  21 60 00    
    RET                                 ;516e  c9          
                  ;
COPYTA: LD  A,D                         ;516f  7a          
COPYTL: SUB 3                           ;5170  d6 03       
    JR  NC,COPYTL                       ;5172  30 fc       
    CP  0FFh                            ;5174  fe ff       
    LD  HL,0                            ;5176  21 00 00    
    RET Z                               ;5179  c8          
    LD  HL,0FFE0h                       ;517a  21 e0 ff    
    RET                                 ;517d  c9          
                  ;
PRTESC: EXX                             ;517e  d9          
    LD  A,01Bh                          ;517f  3e 1b       
    CALL    PRINTR                      ;5181  cd 87 08    
    LD  A,04Ch                          ;5184  3e 4c       ;L
    CALL    PRINTR                      ;5186  cd 87 08    
    LD  A,0                             ;5189  3e 00       
    CALL    PRINTR                      ;518b  cd 87 08    
    LD  A,3                             ;518e  3e 03       
    CALL    PRINTR                      ;5190  cd 87 08    
    EXX                                 ;5193  d9          
    RET                                 ;5194  c9          
                  ;
COPYGR: IN  E,(C)                       ;5195  ed 58       
    LD  A,020h                          ;5197  3e 20       
    ADD A,C                             ;5199  81          
    LD  C,A                             ;519a  4f          
    IN  D,(C)                           ;519b  ed 50       
    LD  A,020h                          ;519d  3e 20       
    ADD A,C                             ;519f  81          
    LD  C,A                             ;51a0  4f          
    IN  L,(C)                           ;51a1  ed 68       
    LD  A,020h                          ;51a3  3e 20       
    ADD A,C                             ;51a5  81          
    LD  C,A                             ;51a6  4f          
    IN  H,(C)                           ;51a7  ed 60       
    RET                                 ;51a9  c9          
                  ;
                  ;
                  ;
COPYTX: IN  H,(C)                       ;51aa  ed 60       
    SET 3,B                             ;51ac  cb d8       
    IN  A,(C)                           ;51ae  ed 78       
    AND 00Fh                            ;51b0  e6 0f       
    SUB 4                               ;51b2  d6 04       
    JR  C,ROMTX                         ;51b4  38 3f       
    SUB 4                               ;51b6  d6 04       
    JR  C,LGR22                         ;51b8  38 1d       
    SUB 4                               ;51ba  d6 04       
    JR  C,RAMTX                         ;51bc  38 53       
    LD  A,D                             ;51be  7a          
SUB3L:  SUB 3                           ;51bf  d6 03       
    JR  NC,SUB3L                        ;51c1  30 fc       
    ADD A,3                             ;51c3  c6 03       
    LD  B,A                             ;51c5  47          
    INC B                               ;51c6  04          
    JR  L3DB7                           ;51c7  18 04       
LGR23L: RRC H                           ;51c9  cb 0c       
    RRC H                               ;51cb  cb 0c       
L3DB7:  DJNZ    LGR23L                  ;51cd  10 fa       
LGR223: CALL    RRCHAS                  ;51cf  cd 3d 52    
    LD  E,A                             ;51d2  5f          
    LD  D,A                             ;51d3  57          
    LD  L,A                             ;51d4  6f          
    LD  H,A                             ;51d5  67          
    RET                                 ;51d6  c9          
                  ;
LGR22:  LD  A,D                         ;51d7  7a          
SUB3L1: SUB 3                           ;51d8  d6 03       
    JR  NC,SUB3L1                       ;51da  30 fc       
    ADD A,3                             ;51dc  c6 03       
    JR  Z,LGR223                        ;51de  28 ef       
    CP  2                               ;51e0  fe 02       
    JR  NZ,LGR232                       ;51e2  20 06       
    RRC H                               ;51e4  cb 0c       
    RRC H                               ;51e6  cb 0c       
    JR  LGR223                          ;51e8  18 e5       
LGR232: CALL    RRCHAS                  ;51ea  cd 3d 52    
    LD  E,A                             ;51ed  5f          
    LD  D,A                             ;51ee  57          
    CALL    RRCHAS                      ;51ef  cd 3d 52    
    LD  L,A                             ;51f2  6f          
    LD  H,A                             ;51f3  67          
    RET                                 ;51f4  c9          
                  ;
ROMTX:  LD  A,H                         ;51f5  7c          
    AND 07Fh                            ;51f6  e6 7f       
    SUB 020h                            ;51f8  d6 20       
    JR  NC,L3DE7                        ;51fa  30 01       
    XOR A                               ;51fc  af          
L3DE7:  LD  H,A                         ;51fd  67          
    CALL    TXCULC                      ;51fe  cd 26 52    
    LD  D,0                             ;5201  16 00       
    ADD HL,DE                           ;5203  19          
    LD  DE,CGCHR                        ;5204  11 4a 52    
    ADD HL,DE                           ;5207  19          
    LD  E,(HL)                          ;5208  5e          
    INC HL                              ;5209  23          
    LD  D,(HL)                          ;520a  56          
    INC HL                              ;520b  23          
    LD  A,(HL)                          ;520c  7e          
    INC HL                              ;520d  23          
    LD  H,(HL)                          ;520e  66          
    LD  L,A                             ;520f  6f          
    RET                                 ;5210  c9          
                  ;
RAMTX:  CALL    TXCULC                  ;5211  cd 26 52    
    ADD HL,BC                           ;5214  09          
    LD  D,010h                          ;5215  16 10       
    ADD HL,DE                           ;5217  19          
    LD  C,L                             ;5218  4d          
    LD  B,H                             ;5219  44          
    IN  E,(C)                           ;521a  ed 58       
    INC BC                              ;521c  03          
    IN  D,(C)                           ;521d  ed 50       
    INC BC                              ;521f  03          
    IN  L,(C)                           ;5220  ed 68       
    INC BC                              ;5222  03          
    IN  H,(C)                           ;5223  ed 60       
    RET                                 ;5225  c9          
                  ;
TXCULC: LD  A,D                         ;5226  7a          
SUB3L2: SUB 3                           ;5227  d6 03       
    JR  NC,SUB3L2                       ;5229  30 fc       
    ADD A,003h                          ;522b  c6 03       
    RLCA                                ;522d  07          
    RLCA                                ;522e  07          
    LD  E,A                             ;522f  5f          
    LD  A,H                             ;5230  7c          
    AND 07Fh                            ;5231  e6 7f       
    LD  L,A                             ;5233  6f          
    LD  H,0                             ;5234  26 00       
    ADD HL,HL                           ;5236  29          
    ADD HL,HL                           ;5237  29          
    LD  C,L                             ;5238  4d          
    LD  B,H                             ;5239  44          
    ADD HL,HL                           ;523a  29          
    ADD HL,BC                           ;523b  09          
    RET                                 ;523c  c9          
                  ;
RRCHAS: XOR A                           ;523d  af          
    RRC H                               ;523e  cb 0c       
    JR  NC,L3E2E                        ;5240  30 02       
    LD  A,00Fh                          ;5242  3e 0f       
L3E2E:  RRC H                           ;5244  cb 0c       
    RET NC                              ;5246  d0          
    ADD A,0F0h                          ;5247  c6 f0       
    RET                                 ;5249  c9          
                  
                  ;
                  ;	ORG	0524AH
                  ;    
CGCHR:                                  ;                  
                  ;CHR$(&H20)
    DEFB    000H                        ;524a  00          
    DEFB    000H                        ;524b  00          
    DEFB    000H                        ;524c  00          
    DEFB    000H                        ;524d  00          
    DEFB    000H                        ;524e  00          
    DEFB    000H                        ;524f  00          
    DEFB    000H                        ;5250  00          
    DEFB    000H                        ;5251  00          
    DEFB    000H                        ;5252  00          
    DEFB    000H                        ;5253  00          
    DEFB    000H                        ;5254  00          
    DEFB    000H                        ;5255  00          
                  ;
                  ;CHR$(&H21)
    DEFB    000H                        ;5256  00          
    DEFB    000H                        ;5257  00          
    DEFB    010H                        ;5258  10          
    DEFB    010H                        ;5259  10          
    DEFB    010H                        ;525a  10          
    DEFB    010H                        ;525b  10          
    DEFB    010H                        ;525c  10          
    DEFB    000H                        ;525d  00          
    DEFB    010H                        ;525e  10          
    DEFB    000H                        ;525f  00          
    DEFB    000H                        ;5260  00          
    DEFB    000H                        ;5261  00          
                  ;
                  ;CHR$(&H22)
    DEFB    000H                        ;5262  00          
    DEFB    000H                        ;5263  00          
    DEFB    028H                        ;5264  28          
    DEFB    028H                        ;5265  28          
    DEFB    028H                        ;5266  28          
    DEFB    000H                        ;5267  00          
    DEFB    000H                        ;5268  00          
    DEFB    000H                        ;5269  00          
    DEFB    000H                        ;526a  00          
    DEFB    000H                        ;526b  00          
    DEFB    000H                        ;526c  00          
    DEFB    000H                        ;526d  00          
                  ;
                  ;CHR$(&H23)
    DEFB    000H                        ;526e  00          
    DEFB    000H                        ;526f  00          
    DEFB    024H                        ;5270  24          
    DEFB    024H                        ;5271  24          
    DEFB    07EH                        ;5272  7e          
    DEFB    024H                        ;5273  24          
    DEFB    07EH                        ;5274  7e          
    DEFB    024H                        ;5275  24          
    DEFB    024H                        ;5276  24          
    DEFB    000H                        ;5277  00          
    DEFB    000H                        ;5278  00          
    DEFB    000H                        ;5279  00          
                  ;
                  ;CHR$(&H24)
    DEFB    000H                        ;527a  00          
    DEFB    000H                        ;527b  00          
    DEFB    010H                        ;527c  10          
    DEFB    03CH                        ;527d  3c          
    DEFB    050H                        ;527e  50          
    DEFB    038H                        ;527f  38          
    DEFB    014H                        ;5280  14          
    DEFB    078H                        ;5281  78          
    DEFB    010H                        ;5282  10          
    DEFB    000H                        ;5283  00          
    DEFB    000H                        ;5284  00          
    DEFB    000H                        ;5285  00          
                  ;
                  ;CHR$(&H25)
    DEFB    000H                        ;5286  00          
    DEFB    000H                        ;5287  00          
    DEFB    000H                        ;5288  00          
    DEFB    062H                        ;5289  62          
    DEFB    064H                        ;528a  64          
    DEFB    008H                        ;528b  08          
    DEFB    010H                        ;528c  10          
    DEFB    026H                        ;528d  26          
    DEFB    046H                        ;528e  46          
    DEFB    000H                        ;528f  00          
    DEFB    000H                        ;5290  00          
    DEFB    000H                        ;5291  00          
                  ;
                  ;CHR$(&H26)
    DEFB    000H                        ;5292  00          
    DEFB    000H                        ;5293  00          
    DEFB    030H                        ;5294  30          
    DEFB    048H                        ;5295  48          
    DEFB    048H                        ;5296  48          
    DEFB    030H                        ;5297  30          
    DEFB    04AH                        ;5298  4a          
    DEFB    044H                        ;5299  44          
    DEFB    03AH                        ;529a  3a          
    DEFB    000H                        ;529b  00          
    DEFB    000H                        ;529c  00          
    DEFB    000H                        ;529d  00          
                  ;
                  ;CHR$(&H27)	'
    DEFB    000H                        ;529e  00          
    DEFB    000H                        ;529f  00          
    DEFB    030H                        ;52a0  30          
    DEFB    010H                        ;52a1  10          
    DEFB    020H                        ;52a2  20          
    DEFB    000H                        ;52a3  00          
    DEFB    000H                        ;52a4  00          
    DEFB    000H                        ;52a5  00          
    DEFB    000H                        ;52a6  00          
    DEFB    000H                        ;52a7  00          
    DEFB    000H                        ;52a8  00          
    DEFB    000H                        ;52a9  00          
                  ;
                  ;CHR$(&H28)	(
    DEFB    000H                        ;52aa  00          
    DEFB    000H                        ;52ab  00          
    DEFB    008H                        ;52ac  08          
    DEFB    010H                        ;52ad  10          
    DEFB    020H                        ;52ae  20          
    DEFB    020H                        ;52af  20          
    DEFB    020H                        ;52b0  20          
    DEFB    010H                        ;52b1  10          
    DEFB    008H                        ;52b2  08          
    DEFB    000H                        ;52b3  00          
    DEFB    000H                        ;52b4  00          
    DEFB    000H                        ;52b5  00          
                  ;
                  ;CHR$(&H29)	)
    DEFB    000H                        ;52b6  00          
    DEFB    000H                        ;52b7  00          
    DEFB    020H                        ;52b8  20          
    DEFB    010H                        ;52b9  10          
    DEFB    008H                        ;52ba  08          
    DEFB    008H                        ;52bb  08          
    DEFB    008H                        ;52bc  08          
    DEFB    010H                        ;52bd  10          
    DEFB    020H                        ;52be  20          
    DEFB    000H                        ;52bf  00          
    DEFB    000H                        ;52c0  00          
    DEFB    000H                        ;52c1  00          
                  ;
                  ;CHR$(&H2A)	*
    DEFB    000H                        ;52c2  00          
    DEFB    000H                        ;52c3  00          
    DEFB    010H                        ;52c4  10          
    DEFB    054H                        ;52c5  54          
    DEFB    038H                        ;52c6  38          
    DEFB    07CH                        ;52c7  7c          
    DEFB    038H                        ;52c8  38          
    DEFB    054H                        ;52c9  54          
    DEFB    010H                        ;52ca  10          
    DEFB    000H                        ;52cb  00          
    DEFB    000H                        ;52cc  00          
    DEFB    000H                        ;52cd  00          
                  ;
                  ;CHR$(&H2B)	+
    DEFB    000H                        ;52ce  00          
    DEFB    000H                        ;52cf  00          
    DEFB    000H                        ;52d0  00          
    DEFB    010H                        ;52d1  10          
    DEFB    010H                        ;52d2  10          
    DEFB    07CH                        ;52d3  7c          
    DEFB    010H                        ;52d4  10          
    DEFB    010H                        ;52d5  10          
    DEFB    000H                        ;52d6  00          
    DEFB    000H                        ;52d7  00          
    DEFB    000H                        ;52d8  00          
    DEFB    000H                        ;52d9  00          
                  ;
                  ;CHR$(&H2C)	,
    DEFB    000H                        ;52da  00          
    DEFB    000H                        ;52db  00          
    DEFB    000H                        ;52dc  00          
    DEFB    000H                        ;52dd  00          
    DEFB    000H                        ;52de  00          
    DEFB    000H                        ;52df  00          
    DEFB    030H                        ;52e0  30          
    DEFB    010H                        ;52e1  10          
    DEFB    020H                        ;52e2  20          
    DEFB    000H                        ;52e3  00          
    DEFB    000H                        ;52e4  00          
    DEFB    000H                        ;52e5  00          
                  ;
                  ;CHR$(&H2D)	-
    DEFB    000H                        ;52e6  00          
    DEFB    000H                        ;52e7  00          
    DEFB    000H                        ;52e8  00          
    DEFB    000H                        ;52e9  00          
    DEFB    000H                        ;52ea  00          
    DEFB    07CH                        ;52eb  7c          
    DEFB    000H                        ;52ec  00          
    DEFB    000H                        ;52ed  00          
    DEFB    000H                        ;52ee  00          
    DEFB    000H                        ;52ef  00          
    DEFB    000H                        ;52f0  00          
    DEFB    000H                        ;52f1  00          
                  ;
                  ;CHR$(&H2E)	.
    DEFB    000H                        ;52f2  00          
    DEFB    000H                        ;52f3  00          
    DEFB    000H                        ;52f4  00          
    DEFB    000H                        ;52f5  00          
    DEFB    000H                        ;52f6  00          
    DEFB    000H                        ;52f7  00          
    DEFB    030H                        ;52f8  30          
    DEFB    030H                        ;52f9  30          
    DEFB    000H                        ;52fa  00          
    DEFB    000H                        ;52fb  00          
    DEFB    000H                        ;52fc  00          
    DEFB    000H                        ;52fd  00          
                  ;
                  ;CHR$(&H2F)	/
    DEFB    000H                        ;52fe  00          
    DEFB    000H                        ;52ff  00          
    DEFB    000H                        ;5300  00          
    DEFB    002H                        ;5301  02          
    DEFB    004H                        ;5302  04          
    DEFB    008H                        ;5303  08          
    DEFB    010H                        ;5304  10          
    DEFB    020H                        ;5305  20          
    DEFB    040H                        ;5306  40          
    DEFB    000H                        ;5307  00          
    DEFB    000H                        ;5308  00          
    DEFB    000H                        ;5309  00          
                  ;
                  ;CHR$(&H30)	0
    DEFB    000H                        ;530a  00          
    DEFB    000H                        ;530b  00          
    DEFB    03CH                        ;530c  3c          
    DEFB    042H                        ;530d  42          
    DEFB    046H                        ;530e  46          
    DEFB    05AH                        ;530f  5a          
    DEFB    062H                        ;5310  62          
    DEFB    042H                        ;5311  42          
    DEFB    03CH                        ;5312  3c          
    DEFB    000H                        ;5313  00          
    DEFB    000H                        ;5314  00          
    DEFB    000H                        ;5315  00          
                  ;
                  ;CHR$(&H31)	1
    DEFB    000H                        ;5316  00          
    DEFB    000H                        ;5317  00          
    DEFB    010H                        ;5318  10          
    DEFB    030H                        ;5319  30          
    DEFB    050H                        ;531a  50          
    DEFB    010H                        ;531b  10          
    DEFB    010H                        ;531c  10          
    DEFB    010H                        ;531d  10          
    DEFB    07CH                        ;531e  7c          
    DEFB    000H                        ;531f  00          
    DEFB    000H                        ;5320  00          
    DEFB    000H                        ;5321  00          
                  ;
                  ;CHR$(&H32)	2
    DEFB    000H                        ;5322  00          
    DEFB    000H                        ;5323  00          
    DEFB    03CH                        ;5324  3c          
    DEFB    042H                        ;5325  42          
    DEFB    002H                        ;5326  02          
    DEFB    00CH                        ;5327  0c          
    DEFB    030H                        ;5328  30          
    DEFB    040H                        ;5329  40          
    DEFB    07EH                        ;532a  7e          
    DEFB    000H                        ;532b  00          
    DEFB    000H                        ;532c  00          
    DEFB    000H                        ;532d  00          
                  ;
                  ;CHR$(&H33)	3
    DEFB    000H                        ;532e  00          
    DEFB    000H                        ;532f  00          
    DEFB    03CH                        ;5330  3c          
    DEFB    042H                        ;5331  42          
    DEFB    002H                        ;5332  02          
    DEFB    03CH                        ;5333  3c          
    DEFB    002H                        ;5334  02          
    DEFB    042H                        ;5335  42          
    DEFB    03CH                        ;5336  3c          
    DEFB    000H                        ;5337  00          
    DEFB    000H                        ;5338  00          
    DEFB    000H                        ;5339  00          
                  ;
                  ;CHR$(&H34)	4
    DEFB    000H                        ;533a  00          
    DEFB    000H                        ;533b  00          
    DEFB    004H                        ;533c  04          
    DEFB    00CH                        ;533d  0c          
    DEFB    014H                        ;533e  14          
    DEFB    024H                        ;533f  24          
    DEFB    07EH                        ;5340  7e          
    DEFB    004H                        ;5341  04          
    DEFB    004H                        ;5342  04          
    DEFB    000H                        ;5343  00          
    DEFB    000H                        ;5344  00          
    DEFB    000H                        ;5345  00          
                  ;
                  ;CHR$(&H35)	5
    DEFB    000H                        ;5346  00          
    DEFB    000H                        ;5347  00          
    DEFB    07EH                        ;5348  7e          
    DEFB    040H                        ;5349  40          
    DEFB    078H                        ;534a  78          
    DEFB    004H                        ;534b  04          
    DEFB    002H                        ;534c  02          
    DEFB    044H                        ;534d  44          
    DEFB    038H                        ;534e  38          
    DEFB    000H                        ;534f  00          
    DEFB    000H                        ;5350  00          
    DEFB    000H                        ;5351  00          
                  ;
                  ;CHR$(&H36)	6
    DEFB    000H                        ;5352  00          
    DEFB    000H                        ;5353  00          
    DEFB    01CH                        ;5354  1c          
    DEFB    020H                        ;5355  20          
    DEFB    040H                        ;5356  40          
    DEFB    07CH                        ;5357  7c          
    DEFB    042H                        ;5358  42          
    DEFB    042H                        ;5359  42          
    DEFB    03CH                        ;535a  3c          
    DEFB    000H                        ;535b  00          
    DEFB    000H                        ;535c  00          
    DEFB    000H                        ;535d  00          
                  ;
                  ;CHR$(&H37)	7
    DEFB    000H                        ;535e  00          
    DEFB    000H                        ;535f  00          
    DEFB    07EH                        ;5360  7e          
    DEFB    042H                        ;5361  42          
    DEFB    004H                        ;5362  04          
    DEFB    008H                        ;5363  08          
    DEFB    010H                        ;5364  10          
    DEFB    010H                        ;5365  10          
    DEFB    010H                        ;5366  10          
    DEFB    000H                        ;5367  00          
    DEFB    000H                        ;5368  00          
    DEFB    000H                        ;5369  00          
                  ;
                  ;CHR$(&H38)	8
    DEFB    000H                        ;536a  00          
    DEFB    000H                        ;536b  00          
    DEFB    03CH                        ;536c  3c          
    DEFB    042H                        ;536d  42          
    DEFB    042H                        ;536e  42          
    DEFB    03CH                        ;536f  3c          
    DEFB    042H                        ;5370  42          
    DEFB    042H                        ;5371  42          
    DEFB    03CH                        ;5372  3c          
    DEFB    000H                        ;5373  00          
    DEFB    000H                        ;5374  00          
    DEFB    000H                        ;5375  00          
                  ;
                  ;CHR$(&H39)	9
    DEFB    000H                        ;5376  00          
    DEFB    000H                        ;5377  00          
    DEFB    03CH                        ;5378  3c          
    DEFB    042H                        ;5379  42          
    DEFB    042H                        ;537a  42          
    DEFB    03EH                        ;537b  3e          
    DEFB    002H                        ;537c  02          
    DEFB    004H                        ;537d  04          
    DEFB    038H                        ;537e  38          
    DEFB    000H                        ;537f  00          
    DEFB    000H                        ;5380  00          
    DEFB    000H                        ;5381  00          
                  ;
                  ;CHR$(&H3A)	:
    DEFB    000H                        ;5382  00          
    DEFB    000H                        ;5383  00          
    DEFB    000H                        ;5384  00          
    DEFB    030H                        ;5385  30          
    DEFB    030H                        ;5386  30          
    DEFB    000H                        ;5387  00          
    DEFB    030H                        ;5388  30          
    DEFB    030H                        ;5389  30          
    DEFB    000H                        ;538a  00          
    DEFB    000H                        ;538b  00          
    DEFB    000H                        ;538c  00          
    DEFB    000H                        ;538d  00          
                  ;
                  ;CHR$(&H3B)	;
    DEFB    000H                        ;538e  00          
    DEFB    000H                        ;538f  00          
    DEFB    000H                        ;5390  00          
    DEFB    030H                        ;5391  30          
    DEFB    030H                        ;5392  30          
    DEFB    000H                        ;5393  00          
    DEFB    030H                        ;5394  30          
    DEFB    010H                        ;5395  10          
    DEFB    020H                        ;5396  20          
    DEFB    000H                        ;5397  00          
    DEFB    000H                        ;5398  00          
    DEFB    000H                        ;5399  00          
                  ;
                  ;CHR$(&H3C)	<
    DEFB    000H                        ;539a  00          
    DEFB    000H                        ;539b  00          
    DEFB    00EH                        ;539c  0e          
    DEFB    018H                        ;539d  18          
    DEFB    030H                        ;539e  30          
    DEFB    060H                        ;539f  60          
    DEFB    030H                        ;53a0  30          
    DEFB    018H                        ;53a1  18          
    DEFB    00EH                        ;53a2  0e          
    DEFB    000H                        ;53a3  00          
    DEFB    000H                        ;53a4  00          
    DEFB    000H                        ;53a5  00          
                  ;
                  ;CHR$(&H3D)	=
    DEFB    000H                        ;53a6  00          
    DEFB    000H                        ;53a7  00          
    DEFB    000H                        ;53a8  00          
    DEFB    000H                        ;53a9  00          
    DEFB    07EH                        ;53aa  7e          
    DEFB    000H                        ;53ab  00          
    DEFB    07EH                        ;53ac  7e          
    DEFB    000H                        ;53ad  00          
    DEFB    000H                        ;53ae  00          
    DEFB    000H                        ;53af  00          
    DEFB    000H                        ;53b0  00          
    DEFB    000H                        ;53b1  00          
                  ;
                  ;CHR$(&H3E)	>
    DEFB    000H                        ;53b2  00          
    DEFB    000H                        ;53b3  00          
    DEFB    070H                        ;53b4  70          
    DEFB    018H                        ;53b5  18          
    DEFB    00CH                        ;53b6  0c          
    DEFB    006H                        ;53b7  06          
    DEFB    00CH                        ;53b8  0c          
    DEFB    018H                        ;53b9  18          
    DEFB    070H                        ;53ba  70          
    DEFB    000H                        ;53bb  00          
    DEFB    000H                        ;53bc  00          
    DEFB    000H                        ;53bd  00          
                  ;
                  ;CHR$(&H3F)	?
    DEFB    000H                        ;53be  00          
    DEFB    000H                        ;53bf  00          
    DEFB    03CH                        ;53c0  3c          
    DEFB    042H                        ;53c1  42          
    DEFB    002H                        ;53c2  02          
    DEFB    00CH                        ;53c3  0c          
    DEFB    010H                        ;53c4  10          
    DEFB    000H                        ;53c5  00          
    DEFB    010H                        ;53c6  10          
    DEFB    000H                        ;53c7  00          
    DEFB    000H                        ;53c8  00          
    DEFB    000H                        ;53c9  00          
                  ;
                  ;CHR$(&H40)	@
    DEFB    000H                        ;53ca  00          
    DEFB    000H                        ;53cb  00          
    DEFB    01CH                        ;53cc  1c          
    DEFB    022H                        ;53cd  22          
    DEFB    04AH                        ;53ce  4a          
    DEFB    056H                        ;53cf  56          
    DEFB    04CH                        ;53d0  4c          
    DEFB    020H                        ;53d1  20          
    DEFB    01EH                        ;53d2  1e          
    DEFB    000H                        ;53d3  00          
    DEFB    000H                        ;53d4  00          
    DEFB    000H                        ;53d5  00          
                  ;
                  ;CHR$(&H41)	A
    DEFB    000H                        ;53d6  00          
    DEFB    000H                        ;53d7  00          
    DEFB    018H                        ;53d8  18          
    DEFB    024H                        ;53d9  24          
    DEFB    042H                        ;53da  42          
    DEFB    07EH                        ;53db  7e          
    DEFB    042H                        ;53dc  42          
    DEFB    042H                        ;53dd  42          
    DEFB    042H                        ;53de  42          
    DEFB    000H                        ;53df  00          
    DEFB    000H                        ;53e0  00          
    DEFB    000H                        ;53e1  00          
                  ;
                  ;CHR$(&H42)	B
    DEFB    000H                        ;53e2  00          
    DEFB    000H                        ;53e3  00          
    DEFB    07CH                        ;53e4  7c          
    DEFB    042H                        ;53e5  42          
    DEFB    042H                        ;53e6  42          
    DEFB    07CH                        ;53e7  7c          
    DEFB    042H                        ;53e8  42          
    DEFB    042H                        ;53e9  42          
    DEFB    07CH                        ;53ea  7c          
    DEFB    000H                        ;53eb  00          
    DEFB    000H                        ;53ec  00          
    DEFB    000H                        ;53ed  00          
                  ;
                  ;CHR$(&H43)	C
    DEFB    000H                        ;53ee  00          
    DEFB    000H                        ;53ef  00          
    DEFB    01CH                        ;53f0  1c          
    DEFB    022H                        ;53f1  22          
    DEFB    040H                        ;53f2  40          
    DEFB    040H                        ;53f3  40          
    DEFB    040H                        ;53f4  40          
    DEFB    022H                        ;53f5  22          
    DEFB    01CH                        ;53f6  1c          
    DEFB    000H                        ;53f7  00          
    DEFB    000H                        ;53f8  00          
    DEFB    000H                        ;53f9  00          
                  ;
                  ;CHR$(&H44)	D
    DEFB    000H                        ;53fa  00          
    DEFB    000H                        ;53fb  00          
    DEFB    078H                        ;53fc  78          
    DEFB    024H                        ;53fd  24          
    DEFB    022H                        ;53fe  22          
    DEFB    022H                        ;53ff  22          
    DEFB    022H                        ;5400  22          
    DEFB    024H                        ;5401  24          
    DEFB    078H                        ;5402  78          
    DEFB    000H                        ;5403  00          
    DEFB    000H                        ;5404  00          
    DEFB    000H                        ;5405  00          
                  ;
                  ;CHR$(&H45)	E
    DEFB    000H                        ;5406  00          
    DEFB    000H                        ;5407  00          
    DEFB    07EH                        ;5408  7e          
    DEFB    040H                        ;5409  40          
    DEFB    040H                        ;540a  40          
    DEFB    078H                        ;540b  78          
    DEFB    040H                        ;540c  40          
    DEFB    040H                        ;540d  40          
    DEFB    07EH                        ;540e  7e          
    DEFB    000H                        ;540f  00          
    DEFB    000H                        ;5410  00          
    DEFB    000H                        ;5411  00          
                  ;
                  ;CHR$(&H46)	F
    DEFB    000H                        ;5412  00          
    DEFB    000H                        ;5413  00          
    DEFB    07EH                        ;5414  7e          
    DEFB    040H                        ;5415  40          
    DEFB    040H                        ;5416  40          
    DEFB    078H                        ;5417  78          
    DEFB    040H                        ;5418  40          
    DEFB    040H                        ;5419  40          
    DEFB    040H                        ;541a  40          
    DEFB    000H                        ;541b  00          
    DEFB    000H                        ;541c  00          
    DEFB    000H                        ;541d  00          
                  ;
                  ;CHR$(&H47)	G
    DEFB    000H                        ;541e  00          
    DEFB    000H                        ;541f  00          
    DEFB    01CH                        ;5420  1c          
    DEFB    022H                        ;5421  22          
    DEFB    040H                        ;5422  40          
    DEFB    04EH                        ;5423  4e          
    DEFB    042H                        ;5424  42          
    DEFB    022H                        ;5425  22          
    DEFB    01CH                        ;5426  1c          
    DEFB    000H                        ;5427  00          
    DEFB    000H                        ;5428  00          
    DEFB    000H                        ;5429  00          
                  ;
                  ;CHR$(&H48)	H
    DEFB    000H                        ;542a  00          
    DEFB    000H                        ;542b  00          
    DEFB    042H                        ;542c  42          
    DEFB    042H                        ;542d  42          
    DEFB    042H                        ;542e  42          
    DEFB    07EH                        ;542f  7e          
    DEFB    042H                        ;5430  42          
    DEFB    042H                        ;5431  42          
    DEFB    042H                        ;5432  42          
    DEFB    000H                        ;5433  00          
    DEFB    000H                        ;5434  00          
    DEFB    000H                        ;5435  00          
                  ;
                  ;CHR$(&H49)	I
    DEFB    000H                        ;5436  00          
    DEFB    000H                        ;5437  00          
    DEFB    038H                        ;5438  38          
    DEFB    010H                        ;5439  10          
    DEFB    010H                        ;543a  10          
    DEFB    010H                        ;543b  10          
    DEFB    010H                        ;543c  10          
    DEFB    010H                        ;543d  10          
    DEFB    038H                        ;543e  38          
    DEFB    000H                        ;543f  00          
    DEFB    000H                        ;5440  00          
    DEFB    000H                        ;5441  00          
                  ;
                  ;CHR$(&H4A)	J
    DEFB    000H                        ;5442  00          
    DEFB    000H                        ;5443  00          
    DEFB    00EH                        ;5444  0e          
    DEFB    004H                        ;5445  04          
    DEFB    004H                        ;5446  04          
    DEFB    004H                        ;5447  04          
    DEFB    004H                        ;5448  04          
    DEFB    044H                        ;5449  44          
    DEFB    038H                        ;544a  38          
    DEFB    000H                        ;544b  00          
    DEFB    000H                        ;544c  00          
    DEFB    000H                        ;544d  00          
                  ;
                  ;CHR$(&H4B)	K
    DEFB    000H                        ;544e  00          
    DEFB    000H                        ;544f  00          
    DEFB    042H                        ;5450  42          
    DEFB    044H                        ;5451  44          
    DEFB    048H                        ;5452  48          
    DEFB    070H                        ;5453  70          
    DEFB    048H                        ;5454  48          
    DEFB    044H                        ;5455  44          
    DEFB    042H                        ;5456  42          
    DEFB    000H                        ;5457  00          
    DEFB    000H                        ;5458  00          
    DEFB    000H                        ;5459  00          
                  ;
                  ;CHR$(&H4C)	L
    DEFB    000H                        ;545a  00          
    DEFB    000H                        ;545b  00          
    DEFB    040H                        ;545c  40          
    DEFB    040H                        ;545d  40          
    DEFB    040H                        ;545e  40          
    DEFB    040H                        ;545f  40          
    DEFB    040H                        ;5460  40          
    DEFB    040H                        ;5461  40          
    DEFB    07EH                        ;5462  7e          
    DEFB    000H                        ;5463  00          
    DEFB    000H                        ;5464  00          
    DEFB    000H                        ;5465  00          
                  ;
                  ;CHR$(&H4D)	M
    DEFB    000H                        ;5466  00          
    DEFB    000H                        ;5467  00          
    DEFB    042H                        ;5468  42          
    DEFB    066H                        ;5469  66          
    DEFB    05AH                        ;546a  5a          
    DEFB    05AH                        ;546b  5a          
    DEFB    042H                        ;546c  42          
    DEFB    042H                        ;546d  42          
    DEFB    042H                        ;546e  42          
    DEFB    000H                        ;546f  00          
    DEFB    000H                        ;5470  00          
    DEFB    000H                        ;5471  00          
                  ;
                  ;CHR$(&H4E)	N
    DEFB    000H                        ;5472  00          
    DEFB    000H                        ;5473  00          
    DEFB    042H                        ;5474  42          
    DEFB    062H                        ;5475  62          
    DEFB    052H                        ;5476  52          
    DEFB    04AH                        ;5477  4a          
    DEFB    046H                        ;5478  46          
    DEFB    042H                        ;5479  42          
    DEFB    042H                        ;547a  42          
    DEFB    000H                        ;547b  00          
    DEFB    000H                        ;547c  00          
    DEFB    000H                        ;547d  00          
                  ;
                  ;CHR$(&H4F)	O
    DEFB    000H                        ;547e  00          
    DEFB    000H                        ;547f  00          
    DEFB    018H                        ;5480  18          
    DEFB    024H                        ;5481  24          
    DEFB    042H                        ;5482  42          
    DEFB    042H                        ;5483  42          
    DEFB    042H                        ;5484  42          
    DEFB    024H                        ;5485  24          
    DEFB    018H                        ;5486  18          
    DEFB    000H                        ;5487  00          
    DEFB    000H                        ;5488  00          
    DEFB    000H                        ;5489  00          
                  ;
                  ;CHR$(&H50)	P
    DEFB    000H                        ;548a  00          
    DEFB    000H                        ;548b  00          
    DEFB    07CH                        ;548c  7c          
    DEFB    042H                        ;548d  42          
    DEFB    042H                        ;548e  42          
    DEFB    07CH                        ;548f  7c          
    DEFB    040H                        ;5490  40          
    DEFB    040H                        ;5491  40          
    DEFB    040H                        ;5492  40          
    DEFB    000H                        ;5493  00          
    DEFB    000H                        ;5494  00          
    DEFB    000H                        ;5495  00          
                  ;
                  ;CHR$(&H51)	Q
    DEFB    000H                        ;5496  00          
    DEFB    000H                        ;5497  00          
    DEFB    018H                        ;5498  18          
    DEFB    024H                        ;5499  24          
    DEFB    042H                        ;549a  42          
    DEFB    042H                        ;549b  42          
    DEFB    04AH                        ;549c  4a          
    DEFB    024H                        ;549d  24          
    DEFB    01AH                        ;549e  1a          
    DEFB    000H                        ;549f  00          
    DEFB    000H                        ;54a0  00          
    DEFB    000H                        ;54a1  00          
                  ;
                  ;CHR$(&H52)	R
    DEFB    000H                        ;54a2  00          
    DEFB    000H                        ;54a3  00          
    DEFB    07CH                        ;54a4  7c          
    DEFB    042H                        ;54a5  42          
    DEFB    042H                        ;54a6  42          
    DEFB    07CH                        ;54a7  7c          
    DEFB    048H                        ;54a8  48          
    DEFB    044H                        ;54a9  44          
    DEFB    042H                        ;54aa  42          
    DEFB    000H                        ;54ab  00          
    DEFB    000H                        ;54ac  00          
    DEFB    000H                        ;54ad  00          
                  ;
                  ;CHR$(&H53)	S
    DEFB    000H                        ;54ae  00          
    DEFB    000H                        ;54af  00          
    DEFB    03CH                        ;54b0  3c          
    DEFB    042H                        ;54b1  42          
    DEFB    040H                        ;54b2  40          
    DEFB    03CH                        ;54b3  3c          
    DEFB    002H                        ;54b4  02          
    DEFB    042H                        ;54b5  42          
    DEFB    03CH                        ;54b6  3c          
    DEFB    000H                        ;54b7  00          
    DEFB    000H                        ;54b8  00          
    DEFB    000H                        ;54b9  00          
                  ;
                  ;CHR$(&H54)	T
    DEFB    000H                        ;54ba  00          
    DEFB    000H                        ;54bb  00          
    DEFB    07CH                        ;54bc  7c          
    DEFB    010H                        ;54bd  10          
    DEFB    010H                        ;54be  10          
    DEFB    010H                        ;54bf  10          
    DEFB    010H                        ;54c0  10          
    DEFB    010H                        ;54c1  10          
    DEFB    010H                        ;54c2  10          
    DEFB    000H                        ;54c3  00          
    DEFB    000H                        ;54c4  00          
    DEFB    000H                        ;54c5  00          
                  ;
                  ;CHR$(&H55)	U
    DEFB    000H                        ;54c6  00          
    DEFB    000H                        ;54c7  00          
    DEFB    042H                        ;54c8  42          
    DEFB    042H                        ;54c9  42          
    DEFB    042H                        ;54ca  42          
    DEFB    042H                        ;54cb  42          
    DEFB    042H                        ;54cc  42          
    DEFB    042H                        ;54cd  42          
    DEFB    03CH                        ;54ce  3c          
    DEFB    000H                        ;54cf  00          
    DEFB    000H                        ;54d0  00          
    DEFB    000H                        ;54d1  00          
                  ;
                  ;CHR$(&H56)	V
    DEFB    000H                        ;54d2  00          
    DEFB    000H                        ;54d3  00          
    DEFB    042H                        ;54d4  42          
    DEFB    042H                        ;54d5  42          
    DEFB    042H                        ;54d6  42          
    DEFB    024H                        ;54d7  24          
    DEFB    024H                        ;54d8  24          
    DEFB    018H                        ;54d9  18          
    DEFB    018H                        ;54da  18          
    DEFB    000H                        ;54db  00          
    DEFB    000H                        ;54dc  00          
    DEFB    000H                        ;54dd  00          
                  ;
                  ;CHR$(&H57)	W
    DEFB    000H                        ;54de  00          
    DEFB    000H                        ;54df  00          
    DEFB    042H                        ;54e0  42          
    DEFB    042H                        ;54e1  42          
    DEFB    042H                        ;54e2  42          
    DEFB    05AH                        ;54e3  5a          
    DEFB    05AH                        ;54e4  5a          
    DEFB    066H                        ;54e5  66          
    DEFB    042H                        ;54e6  42          
    DEFB    000H                        ;54e7  00          
    DEFB    000H                        ;54e8  00          
    DEFB    000H                        ;54e9  00          
                  ;
                  ;CHR$(&H58)	X
    DEFB    000H                        ;54ea  00          
    DEFB    000H                        ;54eb  00          
    DEFB    042H                        ;54ec  42          
    DEFB    042H                        ;54ed  42          
    DEFB    024H                        ;54ee  24          
    DEFB    018H                        ;54ef  18          
    DEFB    024H                        ;54f0  24          
    DEFB    042H                        ;54f1  42          
    DEFB    042H                        ;54f2  42          
    DEFB    000H                        ;54f3  00          
    DEFB    000H                        ;54f4  00          
    DEFB    000H                        ;54f5  00          
                  ;
                  ;CHR$(&H59)	Y
    DEFB    000H                        ;54f6  00          
    DEFB    000H                        ;54f7  00          
    DEFB    044H                        ;54f8  44          
    DEFB    044H                        ;54f9  44          
    DEFB    044H                        ;54fa  44          
    DEFB    038H                        ;54fb  38          
    DEFB    010H                        ;54fc  10          
    DEFB    010H                        ;54fd  10          
    DEFB    010H                        ;54fe  10          
    DEFB    000H                        ;54ff  00          
    DEFB    000H                        ;5500  00          
    DEFB    000H                        ;5501  00          
                  ;
                  ;CHR$(&H5A)	Z
    DEFB    000H                        ;5502  00          
    DEFB    000H                        ;5503  00          
    DEFB    07EH                        ;5504  7e          
    DEFB    002H                        ;5505  02          
    DEFB    004H                        ;5506  04          
    DEFB    018H                        ;5507  18          
    DEFB    020H                        ;5508  20          
    DEFB    040H                        ;5509  40          
    DEFB    07EH                        ;550a  7e          
    DEFB    000H                        ;550b  00          
    DEFB    000H                        ;550c  00          
    DEFB    000H                        ;550d  00          
                  ;
                  ;CHR$(&H5B)	[
    DEFB    000H                        ;550e  00          
    DEFB    000H                        ;550f  00          
    DEFB    03CH                        ;5510  3c          
    DEFB    020H                        ;5511  20          
    DEFB    020H                        ;5512  20          
    DEFB    020H                        ;5513  20          
    DEFB    020H                        ;5514  20          
    DEFB    020H                        ;5515  20          
    DEFB    03CH                        ;5516  3c          
    DEFB    000H                        ;5517  00          
    DEFB    000H                        ;5518  00          
    DEFB    000H                        ;5519  00          
                  ;
                  ;CHR$(&H5C)
    DEFB    000H                        ;551a  00          
    DEFB    080H                        ;551b  80          
    DEFB    080H                        ;551c  80          
    DEFB    040H                        ;551d  40          
    DEFB    020H                        ;551e  20          
    DEFB    010H                        ;551f  10          
    DEFB    008H                        ;5520  08          
    DEFB    004H                        ;5521  04          
    DEFB    002H                        ;5522  02          
    DEFB    001H                        ;5523  01          
    DEFB    001H                        ;5524  01          
    DEFB    000H                        ;5525  00          
                  ;
                  ;CHR$(&H5D)	]
    DEFB    000H                        ;5526  00          
    DEFB    000H                        ;5527  00          
    DEFB    078H                        ;5528  78          
    DEFB    008H                        ;5529  08          
    DEFB    008H                        ;552a  08          
    DEFB    008H                        ;552b  08          
    DEFB    008H                        ;552c  08          
    DEFB    008H                        ;552d  08          
    DEFB    078H                        ;552e  78          
    DEFB    000H                        ;552f  00          
    DEFB    000H                        ;5530  00          
    DEFB    000H                        ;5531  00          
                  ;
                  ;CHR$(&H5E)	↑
    DEFB    000H                        ;5532  00          
    DEFB    000H                        ;5533  00          
    DEFB    010H                        ;5534  10          
    DEFB    028H                        ;5535  28          
    DEFB    044H                        ;5536  44          
    DEFB    010H                        ;5537  10          
    DEFB    010H                        ;5538  10          
    DEFB    010H                        ;5539  10          
    DEFB    010H                        ;553a  10          
    DEFB    000H                        ;553b  00          
    DEFB    000H                        ;553c  00          
    DEFB    000H                        ;553d  00          
                  ;
                  ;CHR$(&H5F)	←
    DEFB    000H                        ;553e  00          
    DEFB    000H                        ;553f  00          
    DEFB    020H                        ;5540  20          
    DEFB    040H                        ;5541  40          
    DEFB    0FEH                        ;5542  fe          
    DEFB    040H                        ;5543  40          
    DEFB    020H                        ;5544  20          
    DEFB    000H                        ;5545  00          
    DEFB    000H                        ;5546  00          
    DEFB    000H                        ;5547  00          
    DEFB    000H                        ;5548  00          
    DEFB    000H                        ;5549  00          
                  ;
                  ;
                  ;
$CGBUF:                                 ;                  
                  ;
                  ;CHR$(&H80)
    DEFB    000H                        ;554a  00          
    DEFB    000H                        ;554b  00          
    DEFB    000H                        ;554c  00          
    DEFB    000H                        ;554d  00          
    DEFB    000H                        ;554e  00          
    DEFB    000H                        ;554f  00          
    DEFB    000H                        ;5550  00          
    DEFB    000H                        ;5551  00          
    DEFB    000H                        ;5552  00          
    DEFB    000H                        ;5553  00          
    DEFB    000H                        ;5554  00          
    DEFB    000H                        ;5555  00          
                  ;
                  ;CHR$(&H81)
    DEFB    000H                        ;5556  00          
    DEFB    000H                        ;5557  00          
    DEFB    000H                        ;5558  00          
    DEFB    03CH                        ;5559  3c          
    DEFB    042H                        ;555a  42          
    DEFB    042H                        ;555b  42          
    DEFB    042H                        ;555c  42          
    DEFB    042H                        ;555d  42          
    DEFB    03CH                        ;555e  3c          
    DEFB    000H                        ;555f  00          
    DEFB    000H                        ;5560  00          
    DEFB    000H                        ;5561  00          
                  ;
                  ;CHR$(&H82)
    DEFB    000H                        ;5562  00          
    DEFB    000H                        ;5563  00          
    DEFB    000H                        ;5564  00          
    DEFB    03CH                        ;5565  3c          
    DEFB    07EH                        ;5566  7e          
    DEFB    07EH                        ;5567  7e          
    DEFB    07EH                        ;5568  7e          
    DEFB    07EH                        ;5569  7e          
    DEFB    03CH                        ;556a  3c          
    DEFB    000H                        ;556b  00          
    DEFB    000H                        ;556c  00          
    DEFB    000H                        ;556d  00          
                  ;
                  ;CHR$(&H83)
    DEFB    000H                        ;556e  00          
    DEFB    000H                        ;556f  00          
    DEFB    000H                        ;5570  00          
    DEFB    008H                        ;5571  08          
    DEFB    008H                        ;5572  08          
    DEFB    008H                        ;5573  08          
    DEFB    02AH                        ;5574  2a          
    DEFB    01CH                        ;5575  1c          
    DEFB    008H                        ;5576  08          
    DEFB    000H                        ;5577  00          
    DEFB    000H                        ;5578  00          
    DEFB    000H                        ;5579  00          
                  ;
                  ;CHR$(&H84)
    DEFB    000H                        ;557a  00          
    DEFB    000H                        ;557b  00          
    DEFB    000H                        ;557c  00          
    DEFB    008H                        ;557d  08          
    DEFB    004H                        ;557e  04          
    DEFB    07EH                        ;557f  7e          
    DEFB    004H                        ;5580  04          
    DEFB    008H                        ;5581  08          
    DEFB    000H                        ;5582  00          
    DEFB    000H                        ;5583  00          
    DEFB    000H                        ;5584  00          
    DEFB    000H                        ;5585  00          
                  ;
                  ;CHR$(&H85)
    DEFB    000H                        ;5586  00          
    DEFB    000H                        ;5587  00          
    DEFB    000H                        ;5588  00          
    DEFB    000H                        ;5589  00          
    DEFB    000H                        ;558a  00          
    DEFB    0F0H                        ;558b  f0          
    DEFB    010H                        ;558c  10          
    DEFB    010H                        ;558d  10          
    DEFB    010H                        ;558e  10          
    DEFB    010H                        ;558f  10          
    DEFB    010H                        ;5590  10          
    DEFB    010H                        ;5591  10          
                  ;
                  ;CHR$(&H86)
    DEFB    010H                        ;5592  10          
    DEFB    010H                        ;5593  10          
    DEFB    010H                        ;5594  10          
    DEFB    010H                        ;5595  10          
    DEFB    010H                        ;5596  10          
    DEFB    0F0H                        ;5597  f0          
    DEFB    000H                        ;5598  00          
    DEFB    000H                        ;5599  00          
    DEFB    000H                        ;559a  00          
    DEFB    000H                        ;559b  00          
    DEFB    000H                        ;559c  00          
    DEFB    000H                        ;559d  00          
                  ;
                  ;CHR$(&H87)
    DEFB    000H                        ;559e  00          
    DEFB    000H                        ;559f  00          
    DEFB    000H                        ;55a0  00          
    DEFB    000H                        ;55a1  00          
    DEFB    000H                        ;55a2  00          
    DEFB    01FH                        ;55a3  1f          
    DEFB    010H                        ;55a4  10          
    DEFB    010H                        ;55a5  10          
    DEFB    010H                        ;55a6  10          
    DEFB    010H                        ;55a7  10          
    DEFB    010H                        ;55a8  10          
    DEFB    010H                        ;55a9  10          
                  ;
                  ;CHR$(&H88)
    DEFB    010H                        ;55aa  10          
    DEFB    010H                        ;55ab  10          
    DEFB    010H                        ;55ac  10          
    DEFB    010H                        ;55ad  10          
    DEFB    010H                        ;55ae  10          
    DEFB    01FH                        ;55af  1f          
    DEFB    000H                        ;55b0  00          
    DEFB    000H                        ;55b1  00          
    DEFB    000H                        ;55b2  00          
    DEFB    000H                        ;55b3  00          
    DEFB    000H                        ;55b4  00          
    DEFB    000H                        ;55b5  00          
                  ;
                  ;CHR$(&H89)
    DEFB    010H                        ;55b6  10          
    DEFB    010H                        ;55b7  10          
    DEFB    010H                        ;55b8  10          
    DEFB    010H                        ;55b9  10          
    DEFB    010H                        ;55ba  10          
    DEFB    0FFH                        ;55bb  ff          
    DEFB    010H                        ;55bc  10          
    DEFB    010H                        ;55bd  10          
    DEFB    010H                        ;55be  10          
    DEFB    010H                        ;55bf  10          
    DEFB    010H                        ;55c0  10          
    DEFB    010H                        ;55c1  10          
                  ;
                  ;CHR$(&H8A)
    DEFB    010H                        ;55c2  10          
    DEFB    010H                        ;55c3  10          
    DEFB    010H                        ;55c4  10          
    DEFB    010H                        ;55c5  10          
    DEFB    010H                        ;55c6  10          
    DEFB    010H                        ;55c7  10          
    DEFB    010H                        ;55c8  10          
    DEFB    010H                        ;55c9  10          
    DEFB    010H                        ;55ca  10          
    DEFB    010H                        ;55cb  10          
    DEFB    010H                        ;55cc  10          
    DEFB    010H                        ;55cd  10          
                  ;
                  ;CHR$(&H8B)
    DEFB    000H                        ;55ce  00          
    DEFB    000H                        ;55cf  00          
    DEFB    000H                        ;55d0  00          
    DEFB    000H                        ;55d1  00          
    DEFB    000H                        ;55d2  00          
    DEFB    0FFH                        ;55d3  ff          
    DEFB    000H                        ;55d4  00          
    DEFB    000H                        ;55d5  00          
    DEFB    000H                        ;55d6  00          
    DEFB    000H                        ;55d7  00          
    DEFB    000H                        ;55d8  00          
    DEFB    000H                        ;55d9  00          
                  ;
                  ;CHR$(&H8C)
    DEFB    010H                        ;55da  10          
    DEFB    010H                        ;55db  10          
    DEFB    010H                        ;55dc  10          
    DEFB    010H                        ;55dd  10          
    DEFB    010H                        ;55de  10          
    DEFB    0FFH                        ;55df  ff          
    DEFB    000H                        ;55e0  00          
    DEFB    000H                        ;55e1  00          
    DEFB    000H                        ;55e2  00          
    DEFB    000H                        ;55e3  00          
    DEFB    000H                        ;55e4  00          
    DEFB    000H                        ;55e5  00          
                  ;
                  ;CHR$(&H8D)
    DEFB    000H                        ;55e6  00          
    DEFB    000H                        ;55e7  00          
    DEFB    000H                        ;55e8  00          
    DEFB    000H                        ;55e9  00          
    DEFB    000H                        ;55ea  00          
    DEFB    0FFH                        ;55eb  ff          
    DEFB    010H                        ;55ec  10          
    DEFB    010H                        ;55ed  10          
    DEFB    010H                        ;55ee  10          
    DEFB    010H                        ;55ef  10          
    DEFB    010H                        ;55f0  10          
    DEFB    010H                        ;55f1  10          
                  ;
                  ;CHR$(&H8E)
    DEFB    010H                        ;55f2  10          
    DEFB    010H                        ;55f3  10          
    DEFB    010H                        ;55f4  10          
    DEFB    010H                        ;55f5  10          
    DEFB    010H                        ;55f6  10          
    DEFB    0F0H                        ;55f7  f0          
    DEFB    010H                        ;55f8  10          
    DEFB    010H                        ;55f9  10          
    DEFB    010H                        ;55fa  10          
    DEFB    010H                        ;55fb  10          
    DEFB    010H                        ;55fc  10          
    DEFB    010H                        ;55fd  10          
                  ;
                  ;CHR$(&H8F)
    DEFB    010H                        ;55fe  10          
    DEFB    010H                        ;55ff  10          
    DEFB    010H                        ;5600  10          
    DEFB    010H                        ;5601  10          
    DEFB    010H                        ;5602  10          
    DEFB    01FH                        ;5603  1f          
    DEFB    010H                        ;5604  10          
    DEFB    010H                        ;5605  10          
    DEFB    010H                        ;5606  10          
    DEFB    010H                        ;5607  10          
    DEFB    010H                        ;5608  10          
    DEFB    010H                        ;5609  10          
                  ;
                  ;CHR$(&H90)
    DEFB    000H                        ;560a  00          
    DEFB    072H                        ;560b  72          
    DEFB    08AH                        ;560c  8a          
    DEFB    08AH                        ;560d  8a          
    DEFB    072H                        ;560e  72          
    DEFB    002H                        ;560f  02          
    DEFB    03EH                        ;5610  3e          
    DEFB    002H                        ;5611  02          
    DEFB    03EH                        ;5612  3e          
    DEFB    020H                        ;5613  20          
    DEFB    03EH                        ;5614  3e          
    DEFB    000H                        ;5615  00          
                  ;
                  ;CHR$(&H91)
    DEFB    000H                        ;5616  00          
    DEFB    072H                        ;5617  72          
    DEFB    08AH                        ;5618  8a          
    DEFB    072H                        ;5619  72          
    DEFB    0FAH                        ;561a  fa          
    DEFB    02EH                        ;561b  2e          
    DEFB    042H                        ;561c  42          
    DEFB    03EH                        ;561d  3e          
    DEFB    03EH                        ;561e  3e          
    DEFB    020H                        ;561f  20          
    DEFB    03EH                        ;5620  3e          
    DEFB    000H                        ;5621  00          
                  ;
                  ;CHR$(&H92)
    DEFB    000H                        ;5622  00          
    DEFB    022H                        ;5623  22          
    DEFB    022H                        ;5624  22          
    DEFB    0FAH                        ;5625  fa          
    DEFB    002H                        ;5626  02          
    DEFB    072H                        ;5627  72          
    DEFB    08BH                        ;5628  8b          
    DEFB    08AH                        ;5629  8a          
    DEFB    072H                        ;562a  72          
    DEFB    022H                        ;562b  22          
    DEFB    0FAH                        ;562c  fa          
    DEFB    000H                        ;562d  00          
                  ;
                  ;CHR$(&H93)
    DEFB    000H                        ;562e  00          
    DEFB    010H                        ;562f  10          
    DEFB    010H                        ;5630  10          
    DEFB    028H                        ;5631  28          
    DEFB    044H                        ;5632  44          
    DEFB    082H                        ;5633  82          
    DEFB    000H                        ;5634  00          
    DEFB    0FEH                        ;5635  fe          
    DEFB    010H                        ;5636  10          
    DEFB    010H                        ;5637  10          
    DEFB    010H                        ;5638  10          
    DEFB    010H                        ;5639  10          
                  ;
                  ;CHR$(&H94)
    DEFB    000H                        ;563a  00          
    DEFB    07CH                        ;563b  7c          
    DEFB    044H                        ;563c  44          
    DEFB    07CH                        ;563d  7c          
    DEFB    010H                        ;563e  10          
    DEFB    0FEH                        ;563f  fe          
    DEFB    000H                        ;5640  00          
    DEFB    07CH                        ;5641  7c          
    DEFB    004H                        ;5642  04          
    DEFB    004H                        ;5643  04          
    DEFB    004H                        ;5644  04          
    DEFB    000H                        ;5645  00          
                  ;
                  ;CHR$(&H95)
    DEFB    000H                        ;5646  00          
    DEFB    07CH                        ;5647  7c          
    DEFB    004H                        ;5648  04          
    DEFB    004H                        ;5649  04          
    DEFB    000H                        ;564a  00          
    DEFB    0FEH                        ;564b  fe          
    DEFB    000H                        ;564c  00          
    DEFB    07CH                        ;564d  7c          
    DEFB    044H                        ;564e  44          
    DEFB    044H                        ;564f  44          
    DEFB    07CH                        ;5650  7c          
    DEFB    000H                        ;5651  00          
                  ;
                  ;CHR$(&H96)
    DEFB    000H                        ;5652  00          
    DEFB    07CH                        ;5653  7c          
    DEFB    040H                        ;5654  40          
    DEFB    078H                        ;5655  78          
    DEFB    040H                        ;5656  40          
    DEFB    040H                        ;5657  40          
    DEFB    07CH                        ;5658  7c          
    DEFB    010H                        ;5659  10          
    DEFB    010H                        ;565a  10          
    DEFB    010H                        ;565b  10          
    DEFB    0FEH                        ;565c  fe          
    DEFB    000H                        ;565d  00          
                  ;
                  ;CHR$(&H97)
    DEFB    000H                        ;565e  00          
    DEFB    082H                        ;565f  82          
    DEFB    08EH                        ;5660  8e          
    DEFB    082H                        ;5661  82          
    DEFB    08EH                        ;5662  8e          
    DEFB    082H                        ;5663  82          
    DEFB    0FAH                        ;5664  fa          
    DEFB    002H                        ;5665  02          
    DEFB    040H                        ;5666  40          
    DEFB    040H                        ;5667  40          
    DEFB    07EH                        ;5668  7e          
    DEFB    000H                        ;5669  00          
                  ;
                  ;CHR$(&H98)
    DEFB    000H                        ;566a  00          
    DEFB    002H                        ;566b  02          
    DEFB    022H                        ;566c  22          
    DEFB    022H                        ;566d  22          
    DEFB    022H                        ;566e  22          
    DEFB    052H                        ;566f  52          
    DEFB    052H                        ;5670  52          
    DEFB    08AH                        ;5671  8a          
    DEFB    08AH                        ;5672  8a          
    DEFB    002H                        ;5673  02          
    DEFB    002H                        ;5674  02          
    DEFB    000H                        ;5675  00          
                  ;
                  ;CHR$(&H99)
    DEFB    000H                        ;5676  00          
    DEFB    044H                        ;5677  44          
    DEFB    07CH                        ;5678  7c          
    DEFB    044H                        ;5679  44          
    DEFB    07CH                        ;567a  7c          
    DEFB    000H                        ;567b  00          
    DEFB    0FEH                        ;567c  fe          
    DEFB    010H                        ;567d  10          
    DEFB    050H                        ;567e  50          
    DEFB    040H                        ;567f  40          
    DEFB    07CH                        ;5680  7c          
    DEFB    000H                        ;5681  00          
                  ;
                  ;CHR$(&H9A)
    DEFB    000H                        ;5682  00          
    DEFB    010H                        ;5683  10          
    DEFB    010H                        ;5684  10          
    DEFB    0FEH                        ;5685  fe          
    DEFB    028H                        ;5686  28          
    DEFB    044H                        ;5687  44          
    DEFB    082H                        ;5688  82          
    DEFB    010H                        ;5689  10          
    DEFB    010H                        ;568a  10          
    DEFB    010H                        ;568b  10          
    DEFB    0FEH                        ;568c  fe          
    DEFB    000H                        ;568d  00          
                  ;
                  ;CHR$(&H9B)
    DEFB    000H                        ;568e  00          
    DEFB    001H                        ;568f  01          
    DEFB    005H                        ;5690  05          
    DEFB    0F5H                        ;5691  f5          
    DEFB    015H                        ;5692  15          
    DEFB    015H                        ;5693  15          
    DEFB    017H                        ;5694  17          
    DEFB    025H                        ;5695  25          
    DEFB    045H                        ;5696  45          
    DEFB    085H                        ;5697  85          
    DEFB    005H                        ;5698  05          
    DEFB    000H                        ;5699  00          
                  ;
                  ;CHR$(&H9C)
    DEFB    000H                        ;569a  00          
    DEFB    001H                        ;569b  01          
    DEFB    005H                        ;569c  05          
    DEFB    0F5H                        ;569d  f5          
    DEFB    085H                        ;569e  85          
    DEFB    085H                        ;569f  85          
    DEFB    087H                        ;56a0  87          
    DEFB    085H                        ;56a1  85          
    DEFB    0F5H                        ;56a2  f5          
    DEFB    005H                        ;56a3  05          
    DEFB    005H                        ;56a4  05          
    DEFB    000H                        ;56a5  00          
                  ;
                  ;CHR$(&H9D)
    DEFB    000H                        ;56a6  00          
    DEFB    002H                        ;56a7  02          
    DEFB    072H                        ;56a8  72          
    DEFB    08AH                        ;56a9  8a          
    DEFB    08AH                        ;56aa  8a          
    DEFB    08AH                        ;56ab  8a          
    DEFB    072H                        ;56ac  72          
    DEFB    002H                        ;56ad  02          
    DEFB    042H                        ;56ae  42          
    DEFB    040H                        ;56af  40          
    DEFB    07EH                        ;56b0  7e          
    DEFB    000H                        ;56b1  00          
                  ;
                  ;CHR$(&H9E)
    DEFB    000H                        ;56b2  00          
    DEFB    000H                        ;56b3  00          
    DEFB    07CH                        ;56b4  7c          
    DEFB    040H                        ;56b5  40          
    DEFB    040H                        ;56b6  40          
    DEFB    040H                        ;56b7  40          
    DEFB    07CH                        ;56b8  7c          
    DEFB    010H                        ;56b9  10          
    DEFB    010H                        ;56ba  10          
    DEFB    010H                        ;56bb  10          
    DEFB    0FEH                        ;56bc  fe          
    DEFB    000H                        ;56bd  00          
                  ;
                  ;CHR$(&H9F)
    DEFB    000H                        ;56be  00          
    DEFB    002H                        ;56bf  02          
    DEFB    072H                        ;56c0  72          
    DEFB    08AH                        ;56c1  8a          
    DEFB    072H                        ;56c2  72          
    DEFB    0FAH                        ;56c3  fa          
    DEFB    02EH                        ;56c4  2e          
    DEFB    042H                        ;56c5  42          
    DEFB    022H                        ;56c6  22          
    DEFB    020H                        ;56c7  20          
    DEFB    03EH                        ;56c8  3e          
    DEFB    000H                        ;56c9  00          
                  ;
                  ;CHR$(&HA0)
    DEFB    000H                        ;56ca  00          
    DEFB    000H                        ;56cb  00          
    DEFB    000H                        ;56cc  00          
    DEFB    03EH                        ;56cd  3e          
    DEFB    022H                        ;56ce  22          
    DEFB    03EH                        ;56cf  3e          
    DEFB    022H                        ;56d0  22          
    DEFB    03EH                        ;56d1  3e          
    DEFB    000H                        ;56d2  00          
    DEFB    000H                        ;56d3  00          
    DEFB    000H                        ;56d4  00          
    DEFB    000H                        ;56d5  00          
                  ;
                  ;CHR$(&HA1)
    DEFB    000H                        ;56d6  00          
    DEFB    000H                        ;56d7  00          
    DEFB    03EH                        ;56d8  3e          
    DEFB    022H                        ;56d9  22          
    DEFB    03EH                        ;56da  3e          
    DEFB    022H                        ;56db  22          
    DEFB    03EH                        ;56dc  3e          
    DEFB    022H                        ;56dd  22          
    DEFB    042H                        ;56de  42          
    DEFB    000H                        ;56df  00          
    DEFB    000H                        ;56e0  00          
    DEFB    000H                        ;56e1  00          
                  ;
                  ;CHR$(&HA2)
    DEFB    000H                        ;56e2  00          
    DEFB    000H                        ;56e3  00          
    DEFB    010H                        ;56e4  10          
    DEFB    054H                        ;56e5  54          
    DEFB    054H                        ;56e6  54          
    DEFB    010H                        ;56e7  10          
    DEFB    028H                        ;56e8  28          
    DEFB    044H                        ;56e9  44          
    DEFB    082H                        ;56ea  82          
    DEFB    000H                        ;56eb  00          
    DEFB    000H                        ;56ec  00          
    DEFB    000H                        ;56ed  00          
                  ;
                  ;CHR$(&HA3)
    DEFB    000H                        ;56ee  00          
    DEFB    000H                        ;56ef  00          
    DEFB    010H                        ;56f0  10          
    DEFB    012H                        ;56f1  12          
    DEFB    0FCH                        ;56f2  fc          
    DEFB    038H                        ;56f3  38          
    DEFB    034H                        ;56f4  34          
    DEFB    052H                        ;56f5  52          
    DEFB    091H                        ;56f6  91          
    DEFB    000H                        ;56f7  00          
    DEFB    000H                        ;56f8  00          
    DEFB    000H                        ;56f9  00          
                  ;
                  ;CHR$(&HA4)
    DEFB    000H                        ;56fa  00          
    DEFB    000H                        ;56fb  00          
    DEFB    010H                        ;56fc  10          
    DEFB    010H                        ;56fd  10          
    DEFB    0FEH                        ;56fe  fe          
    DEFB    010H                        ;56ff  10          
    DEFB    038H                        ;5700  38          
    DEFB    054H                        ;5701  54          
    DEFB    092H                        ;5702  92          
    DEFB    000H                        ;5703  00          
    DEFB    000H                        ;5704  00          
    DEFB    000H                        ;5705  00          
                  ;
                  ;CHR$(&HA5)
    DEFB    000H                        ;5706  00          
    DEFB    000H                        ;5707  00          
    DEFB    010H                        ;5708  10          
    DEFB    028H                        ;5709  28          
    DEFB    07CH                        ;570a  7c          
    DEFB    092H                        ;570b  92          
    DEFB    07CH                        ;570c  7c          
    DEFB    054H                        ;570d  54          
    DEFB    0FEH                        ;570e  fe          
    DEFB    000H                        ;570f  00          
    DEFB    000H                        ;5710  00          
    DEFB    000H                        ;5711  00          
                  ;
                  ;CHR$(&HA6)
    DEFB    000H                        ;5712  00          
    DEFB    000H                        ;5713  00          
    DEFB    010H                        ;5714  10          
    DEFB    010H                        ;5715  10          
    DEFB    010H                        ;5716  10          
    DEFB    07CH                        ;5717  7c          
    DEFB    010H                        ;5718  10          
    DEFB    010H                        ;5719  10          
    DEFB    0FEH                        ;571a  fe          
    DEFB    000H                        ;571b  00          
    DEFB    000H                        ;571c  00          
    DEFB    000H                        ;571d  00          
                  ;
                  ;CHR$(&HA7)
    DEFB    000H                        ;571e  00          
    DEFB    000H                        ;571f  00          
    DEFB    020H                        ;5720  20          
    DEFB    07EH                        ;5721  7e          
    DEFB    080H                        ;5722  80          
    DEFB    07CH                        ;5723  7c          
    DEFB    050H                        ;5724  50          
    DEFB    0FEH                        ;5725  fe          
    DEFB    010H                        ;5726  10          
    DEFB    000H                        ;5727  00          
    DEFB    000H                        ;5728  00          
    DEFB    000H                        ;5729  00          
                  ;
                  ;CHR$(&HA8)
    DEFB    000H                        ;572a  00          
    DEFB    000H                        ;572b  00          
    DEFB    008H                        ;572c  08          
    DEFB    0FCH                        ;572d  fc          
    DEFB    0A8H                        ;572e  a8          
    DEFB    0FEH                        ;572f  fe          
    DEFB    0A4H                        ;5730  a4          
    DEFB    0FEH                        ;5731  fe          
    DEFB    014H                        ;5732  14          
    DEFB    004H                        ;5733  04          
    DEFB    000H                        ;5734  00          
    DEFB    000H                        ;5735  00          
                  ;
                  ;CHR$(&HA9)
    DEFB    000H                        ;5736  00          
    DEFB    000H                        ;5737  00          
    DEFB    010H                        ;5738  10          
    DEFB    028H                        ;5739  28          
    DEFB    044H                        ;573a  44          
    DEFB    0FEH                        ;573b  fe          
    DEFB    014H                        ;573c  14          
    DEFB    024H                        ;573d  24          
    DEFB    048H                        ;573e  48          
    DEFB    000H                        ;573f  00          
    DEFB    000H                        ;5740  00          
    DEFB    000H                        ;5741  00          
                  ;
                  ;CHR$(&HAA)
    DEFB    000H                        ;5742  00          
    DEFB    000H                        ;5743  00          
    DEFB    074H                        ;5744  74          
    DEFB    024H                        ;5745  24          
    DEFB    0F5H                        ;5746  f5          
    DEFB    065H                        ;5747  65          
    DEFB    0B2H                        ;5748  b2          
    DEFB    0A4H                        ;5749  a4          
    DEFB    028H                        ;574a  28          
    DEFB    000H                        ;574b  00          
    DEFB    000H                        ;574c  00          
    DEFB    000H                        ;574d  00          
                  ;
                  ;CHR$(&HAB)
    DEFB    000H                        ;574e  00          
    DEFB    000H                        ;574f  00          
    DEFB    010H                        ;5750  10          
    DEFB    010H                        ;5751  10          
    DEFB    010H                        ;5752  10          
    DEFB    054H                        ;5753  54          
    DEFB    092H                        ;5754  92          
    DEFB    030H                        ;5755  30          
    DEFB    010H                        ;5756  10          
    DEFB    000H                        ;5757  00          
    DEFB    000H                        ;5758  00          
    DEFB    000H                        ;5759  00          
                  ;
                  ;CHR$(&HAC)
    DEFB    000H                        ;575a  00          
    DEFB    000H                        ;575b  00          
    DEFB    010H                        ;575c  10          
    DEFB    010H                        ;575d  10          
    DEFB    0FEH                        ;575e  fe          
    DEFB    010H                        ;575f  10          
    DEFB    028H                        ;5760  28          
    DEFB    044H                        ;5761  44          
    DEFB    082H                        ;5762  82          
    DEFB    000H                        ;5763  00          
    DEFB    000H                        ;5764  00          
    DEFB    000H                        ;5765  00          
                  ;
                  ;CHR$(&HAD)
    DEFB    000H                        ;5766  00          
    DEFB    000H                        ;5767  00          
    DEFB    000H                        ;5768  00          
    DEFB    010H                        ;5769  10          
    DEFB    010H                        ;576a  10          
    DEFB    010H                        ;576b  10          
    DEFB    028H                        ;576c  28          
    DEFB    044H                        ;576d  44          
    DEFB    082H                        ;576e  82          
    DEFB    000H                        ;576f  00          
    DEFB    000H                        ;5770  00          
    DEFB    000H                        ;5771  00          
                  ;
                  ;CHR$(&HAE)
    DEFB    000H                        ;5772  00          
    DEFB    000H                        ;5773  00          
    DEFB    010H                        ;5774  10          
    DEFB    028H                        ;5775  28          
    DEFB    07CH                        ;5776  7c          
    DEFB    082H                        ;5777  82          
    DEFB    07CH                        ;5778  7c          
    DEFB    044H                        ;5779  44          
    DEFB    07CH                        ;577a  7c          
    DEFB    000H                        ;577b  00          
    DEFB    000H                        ;577c  00          
    DEFB    000H                        ;577d  00          
                  ;
                  ;CHR$(&HAF)
    DEFB    000H                        ;577e  00          
    DEFB    000H                        ;577f  00          
    DEFB    03CH                        ;5780  3c          
    DEFB    044H                        ;5781  44          
    DEFB    0A8H                        ;5782  a8          
    DEFB    010H                        ;5783  10          
    DEFB    03EH                        ;5784  3e          
    DEFB    0E2H                        ;5785  e2          
    DEFB    03EH                        ;5786  3e          
    DEFB    000H                        ;5787  00          
    DEFB    000H                        ;5788  00          
    DEFB    000H                        ;5789  00          
                  ;
                  ;CHR$(&H90)
    DEFB    000H                        ;578a  00          
    DEFB    000H                        ;578b  00          
    DEFB    000H                        ;578c  00          
    DEFB    008H                        ;578d  08          
    DEFB    07FH                        ;578e  7f          
    DEFB    008H                        ;578f  08          
    DEFB    07FH                        ;5790  7f          
    DEFB    008H                        ;5791  08          
    DEFB    000H                        ;5792  00          
    DEFB    000H                        ;5793  00          
    DEFB    000H                        ;5794  00          
    DEFB    000H                        ;5795  00          
                  ;
                  ;CHR$(&HB1)
    DEFB    000H                        ;5796  00          
    DEFB    000H                        ;5797  00          
    DEFB    006H                        ;5798  06          
    DEFB    018H                        ;5799  18          
    DEFB    020H                        ;579a  20          
    DEFB    018H                        ;579b  18          
    DEFB    006H                        ;579c  06          
    DEFB    000H                        ;579d  00          
    DEFB    03EH                        ;579e  3e          
    DEFB    000H                        ;579f  00          
    DEFB    000H                        ;57a0  00          
    DEFB    000H                        ;57a1  00          
                  ;
                  ;CHR$(&HB2)
    DEFB    000H                        ;57a2  00          
    DEFB    000H                        ;57a3  00          
    DEFB    030H                        ;57a4  30          
    DEFB    00CH                        ;57a5  0c          
    DEFB    002H                        ;57a6  02          
    DEFB    00CH                        ;57a7  0c          
    DEFB    030H                        ;57a8  30          
    DEFB    000H                        ;57a9  00          
    DEFB    03EH                        ;57aa  3e          
    DEFB    000H                        ;57ab  00          
    DEFB    000H                        ;57ac  00          
    DEFB    000H                        ;57ad  00          
                  ;
                  ;CHR$(&HB3)
    DEFB    000H                        ;57ae  00          
    DEFB    000H                        ;57af  00          
    DEFB    008H                        ;57b0  08          
    DEFB    008H                        ;57b1  08          
    DEFB    03EH                        ;57b2  3e          
    DEFB    008H                        ;57b3  08          
    DEFB    008H                        ;57b4  08          
    DEFB    000H                        ;57b5  00          
    DEFB    03EH                        ;57b6  3e          
    DEFB    000H                        ;57b7  00          
    DEFB    000H                        ;57b8  00          
    DEFB    000H                        ;57b9  00          
                  ;
                  ;CHR$(&HB4)
    DEFB    000H                        ;57ba  00          
    DEFB    000H                        ;57bb  00          
    DEFB    000H                        ;57bc  00          
    DEFB    022H                        ;57bd  22          
    DEFB    014H                        ;57be  14          
    DEFB    008H                        ;57bf  08          
    DEFB    014H                        ;57c0  14          
    DEFB    022H                        ;57c1  22          
    DEFB    000H                        ;57c2  00          
    DEFB    000H                        ;57c3  00          
    DEFB    000H                        ;57c4  00          
    DEFB    000H                        ;57c5  00          
                  ;
                  ;CHR$(&HB5)
    DEFB    000H                        ;57c6  00          
    DEFB    000H                        ;57c7  00          
    DEFB    000H                        ;57c8  00          
    DEFB    03EH                        ;57c9  3e          
    DEFB    049H                        ;57ca  49          
    DEFB    07FH                        ;57cb  7f          
    DEFB    049H                        ;57cc  49          
    DEFB    03EH                        ;57cd  3e          
    DEFB    000H                        ;57ce  00          
    DEFB    000H                        ;57cf  00          
    DEFB    000H                        ;57d0  00          
    DEFB    000H                        ;57d1  00          
                  ;
                  ;CHR$(&HB6)
    DEFB    000H                        ;57d2  00          
    DEFB    000H                        ;57d3  00          
    DEFB    000H                        ;57d4  00          
    DEFB    000H                        ;57d5  00          
    DEFB    000H                        ;57d6  00          
    DEFB    008H                        ;57d7  08          
    DEFB    000H                        ;57d8  00          
    DEFB    000H                        ;57d9  00          
    DEFB    000H                        ;57da  00          
    DEFB    000H                        ;57db  00          
    DEFB    000H                        ;57dc  00          
    DEFB    000H                        ;57dd  00          
                  ;
                  ;CHR$(&HB7)
    DEFB    000H                        ;57de  00          
    DEFB    000H                        ;57df  00          
    DEFB    000H                        ;57e0  00          
    DEFB    000H                        ;57e1  00          
    DEFB    008H                        ;57e2  08          
    DEFB    014H                        ;57e3  14          
    DEFB    022H                        ;57e4  22          
    DEFB    07FH                        ;57e5  7f          
    DEFB    000H                        ;57e6  00          
    DEFB    000H                        ;57e7  00          
    DEFB    000H                        ;57e8  00          
    DEFB    000H                        ;57e9  00          
                  ;
                  ;CHR$(&HB8)
    DEFB    000H                        ;57ea  00          
    DEFB    000H                        ;57eb  00          
    DEFB    000H                        ;57ec  00          
    DEFB    000H                        ;57ed  00          
    DEFB    07FH                        ;57ee  7f          
    DEFB    022H                        ;57ef  22          
    DEFB    014H                        ;57f0  14          
    DEFB    008H                        ;57f1  08          
    DEFB    000H                        ;57f2  00          
    DEFB    000H                        ;57f3  00          
    DEFB    000H                        ;57f4  00          
    DEFB    000H                        ;57f5  00          
                  ;
                  ;CHR$(&HB9)
    DEFB    000H                        ;57f6  00          
    DEFB    000H                        ;57f7  00          
    DEFB    000H                        ;57f8  00          
    DEFB    000H                        ;57f9  00          
    DEFB    000H                        ;57fa  00          
    DEFB    008H                        ;57fb  08          
    DEFB    000H                        ;57fc  00          
    DEFB    000H                        ;57fd  00          
    DEFB    022H                        ;57fe  22          
    DEFB    000H                        ;57ff  00          
    DEFB    000H                        ;5800  00          
    DEFB    000H                        ;5801  00          
                  ;
                  ;CHR$(&HBA)
    DEFB    000H                        ;5802  00          
    DEFB    000H                        ;5803  00          
    DEFB    008H                        ;5804  08          
    DEFB    000H                        ;5805  00          
    DEFB    008H                        ;5806  08          
    DEFB    008H                        ;5807  08          
    DEFB    008H                        ;5808  08          
    DEFB    008H                        ;5809  08          
    DEFB    008H                        ;580a  08          
    DEFB    000H                        ;580b  00          
    DEFB    000H                        ;580c  00          
    DEFB    000H                        ;580d  00          
                  ;
                  ;CHR$(&HBB)
    DEFB    000H                        ;580e  00          
    DEFB    000H                        ;580f  00          
    DEFB    000H                        ;5810  00          
    DEFB    000H                        ;5811  00          
    DEFB    000H                        ;5812  00          
    DEFB    022H                        ;5813  22          
    DEFB    000H                        ;5814  00          
    DEFB    000H                        ;5815  00          
    DEFB    008H                        ;5816  08          
    DEFB    000H                        ;5817  00          
    DEFB    000H                        ;5818  00          
    DEFB    000H                        ;5819  00          
                  ;
                  ;CHR$(&HBC)
    DEFB    00CH                        ;581a  0c          
    DEFB    010H                        ;581b  10          
    DEFB    010H                        ;581c  10          
    DEFB    010H                        ;581d  10          
    DEFB    010H                        ;581e  10          
    DEFB    010H                        ;581f  10          
    DEFB    010H                        ;5820  10          
    DEFB    010H                        ;5821  10          
    DEFB    010H                        ;5822  10          
    DEFB    010H                        ;5823  10          
    DEFB    010H                        ;5824  10          
    DEFB    060H                        ;5825  60          
                  ;
                  ;CHR$(&HBD)
    DEFB    000H                        ;5826  00          
    DEFB    00FH                        ;5827  0f          
    DEFB    008H                        ;5828  08          
    DEFB    008H                        ;5829  08          
    DEFB    008H                        ;582a  08          
    DEFB    048H                        ;582b  48          
    DEFB    0A8H                        ;582c  a8          
    DEFB    018H                        ;582d  18          
    DEFB    008H                        ;582e  08          
    DEFB    000H                        ;582f  00          
    DEFB    000H                        ;5830  00          
    DEFB    000H                        ;5831  00          
                  ;
                  ;CHR$(&HBE)
    DEFB    000H                        ;5832  00          
    DEFB    000H                        ;5833  00          
    DEFB    000H                        ;5834  00          
    DEFB    07EH                        ;5835  7e          
    DEFB    020H                        ;5836  20          
    DEFB    010H                        ;5837  10          
    DEFB    020H                        ;5838  20          
    DEFB    07EH                        ;5839  7e          
    DEFB    000H                        ;583a  00          
    DEFB    000H                        ;583b  00          
    DEFB    000H                        ;583c  00          
    DEFB    000H                        ;583d  00          
                  ;
                  ;CHR$(&HBF)
    DEFB    000H                        ;583e  00          
    DEFB    000H                        ;583f  00          
    DEFB    000H                        ;5840  00          
    DEFB    03EH                        ;5841  3e          
    DEFB    014H                        ;5842  14          
    DEFB    014H                        ;5843  14          
    DEFB    014H                        ;5844  14          
    DEFB    014H                        ;5845  14          
    DEFB    000H                        ;5846  00          
    DEFB    000H                        ;5847  00          
    DEFB    000H                        ;5848  00          
    DEFB    000H                        ;5849  00          
                  ;
                  ;CHR$(&HC0)
    DEFB    000H                        ;584a  00          
    DEFB    060H                        ;584b  60          
    DEFB    090H                        ;584c  90          
    DEFB    090H                        ;584d  90          
    DEFB    090H                        ;584e  90          
    DEFB    060H                        ;584f  60          
    DEFB    000H                        ;5850  00          
    DEFB    000H                        ;5851  00          
    DEFB    000H                        ;5852  00          
    DEFB    000H                        ;5853  00          
    DEFB    000H                        ;5854  00          
    DEFB    000H                        ;5855  00          
                  ;
                  ;CHR$(&HC1)
    DEFB    000H                        ;5856  00          
    DEFB    020H                        ;5857  20          
    DEFB    060H                        ;5858  60          
    DEFB    020H                        ;5859  20          
    DEFB    020H                        ;585a  20          
    DEFB    020H                        ;585b  20          
    DEFB    000H                        ;585c  00          
    DEFB    000H                        ;585d  00          
    DEFB    000H                        ;585e  00          
    DEFB    000H                        ;585f  00          
    DEFB    000H                        ;5860  00          
    DEFB    000H                        ;5861  00          
                  ;
                  ;CHR$(&HC2)
    DEFB    000H                        ;5862  00          
    DEFB    060H                        ;5863  60          
    DEFB    090H                        ;5864  90          
    DEFB    020H                        ;5865  20          
    DEFB    040H                        ;5866  40          
    DEFB    0F0H                        ;5867  f0          
    DEFB    000H                        ;5868  00          
    DEFB    000H                        ;5869  00          
    DEFB    000H                        ;586a  00          
    DEFB    000H                        ;586b  00          
    DEFB    000H                        ;586c  00          
    DEFB    000H                        ;586d  00          
                  ;
                  ;CHR$(&HC3)
    DEFB    000H                        ;586e  00          
    DEFB    060H                        ;586f  60          
    DEFB    090H                        ;5870  90          
    DEFB    020H                        ;5871  20          
    DEFB    090H                        ;5872  90          
    DEFB    060H                        ;5873  60          
    DEFB    000H                        ;5874  00          
    DEFB    000H                        ;5875  00          
    DEFB    000H                        ;5876  00          
    DEFB    000H                        ;5877  00          
    DEFB    000H                        ;5878  00          
    DEFB    000H                        ;5879  00          
                  ;
                  ;CHR$(&HC4)
    DEFB    000H                        ;587a  00          
    DEFB    060H                        ;587b  60          
    DEFB    0A0H                        ;587c  a0          
    DEFB    0A0H                        ;587d  a0          
    DEFB    0F0H                        ;587e  f0          
    DEFB    020H                        ;587f  20          
    DEFB    000H                        ;5880  00          
    DEFB    000H                        ;5881  00          
    DEFB    000H                        ;5882  00          
    DEFB    000H                        ;5883  00          
    DEFB    000H                        ;5884  00          
    DEFB    000H                        ;5885  00          
                  ;
                  ;CHR$(&HC5)
    DEFB    000H                        ;5886  00          
    DEFB    0F0H                        ;5887  f0          
    DEFB    080H                        ;5888  80          
    DEFB    0F0H                        ;5889  f0          
    DEFB    010H                        ;588a  10          
    DEFB    0E0H                        ;588b  e0          
    DEFB    000H                        ;588c  00          
    DEFB    000H                        ;588d  00          
    DEFB    000H                        ;588e  00          
    DEFB    000H                        ;588f  00          
    DEFB    000H                        ;5890  00          
    DEFB    000H                        ;5891  00          
                  ;
                  ;CHR$(&HC6)
    DEFB    000H                        ;5892  00          
    DEFB    060H                        ;5893  60          
    DEFB    080H                        ;5894  80          
    DEFB    0F0H                        ;5895  f0          
    DEFB    090H                        ;5896  90          
    DEFB    060H                        ;5897  60          
    DEFB    000H                        ;5898  00          
    DEFB    000H                        ;5899  00          
    DEFB    000H                        ;589a  00          
    DEFB    000H                        ;589b  00          
    DEFB    000H                        ;589c  00          
    DEFB    000H                        ;589d  00          
                  ;
                  ;CHR$(&HC7)
    DEFB    000H                        ;589e  00          
    DEFB    0F0H                        ;589f  f0          
    DEFB    010H                        ;58a0  10          
    DEFB    020H                        ;58a1  20          
    DEFB    020H                        ;58a2  20          
    DEFB    020H                        ;58a3  20          
    DEFB    000H                        ;58a4  00          
    DEFB    000H                        ;58a5  00          
    DEFB    000H                        ;58a6  00          
    DEFB    000H                        ;58a7  00          
    DEFB    000H                        ;58a8  00          
    DEFB    000H                        ;58a9  00          
                  ;
                  ;CHR$(&HC8)
    DEFB    000H                        ;58aa  00          
    DEFB    060H                        ;58ab  60          
    DEFB    090H                        ;58ac  90          
    DEFB    060H                        ;58ad  60          
    DEFB    090H                        ;58ae  90          
    DEFB    060H                        ;58af  60          
    DEFB    000H                        ;58b0  00          
    DEFB    000H                        ;58b1  00          
    DEFB    000H                        ;58b2  00          
    DEFB    000H                        ;58b3  00          
    DEFB    000H                        ;58b4  00          
    DEFB    000H                        ;58b5  00          
                  ;
                  ;CHR$(&HC9)
    DEFB    000H                        ;58b6  00          
    DEFB    060H                        ;58b7  60          
    DEFB    090H                        ;58b8  90          
    DEFB    0F0H                        ;58b9  f0          
    DEFB    010H                        ;58ba  10          
    DEFB    060H                        ;58bb  60          
    DEFB    000H                        ;58bc  00          
    DEFB    000H                        ;58bd  00          
    DEFB    000H                        ;58be  00          
    DEFB    000H                        ;58bf  00          
    DEFB    000H                        ;58c0  00          
    DEFB    000H                        ;58c1  00          
                  ;
                  ;CHR$(&HCA)
    DEFB    000H                        ;58c2  00          
    DEFB    000H                        ;58c3  00          
    DEFB    000H                        ;58c4  00          
    DEFB    000H                        ;58c5  00          
    DEFB    002H                        ;58c6  02          
    DEFB    034H                        ;58c7  34          
    DEFB    048H                        ;58c8  48          
    DEFB    048H                        ;58c9  48          
    DEFB    036H                        ;58ca  36          
    DEFB    000H                        ;58cb  00          
    DEFB    000H                        ;58cc  00          
    DEFB    000H                        ;58cd  00          
                  ;
                  ;CHR$(&HCB)
    DEFB    000H                        ;58ce  00          
    DEFB    000H                        ;58cf  00          
    DEFB    018H                        ;58d0  18          
    DEFB    024H                        ;58d1  24          
    DEFB    038H                        ;58d2  38          
    DEFB    024H                        ;58d3  24          
    DEFB    024H                        ;58d4  24          
    DEFB    038H                        ;58d5  38          
    DEFB    020H                        ;58d6  20          
    DEFB    000H                        ;58d7  00          
    DEFB    000H                        ;58d8  00          
    DEFB    000H                        ;58d9  00          
                  ;
                  ;CHR$(&HCC)
    DEFB    000H                        ;58da  00          
    DEFB    000H                        ;58db  00          
    DEFB    000H                        ;58dc  00          
    DEFB    000H                        ;58dd  00          
    DEFB    04EH                        ;58de  4e          
    DEFB    030H                        ;58df  30          
    DEFB    020H                        ;58e0  20          
    DEFB    020H                        ;58e1  20          
    DEFB    020H                        ;58e2  20          
    DEFB    000H                        ;58e3  00          
    DEFB    000H                        ;58e4  00          
    DEFB    000H                        ;58e5  00          
                  ;
                  ;CHR$(&HCD)
    DEFB    000H                        ;58e6  00          
    DEFB    000H                        ;58e7  00          
    DEFB    018H                        ;58e8  18          
    DEFB    024H                        ;58e9  24          
    DEFB    024H                        ;58ea  24          
    DEFB    03CH                        ;58eb  3c          
    DEFB    024H                        ;58ec  24          
    DEFB    024H                        ;58ed  24          
    DEFB    018H                        ;58ee  18          
    DEFB    000H                        ;58ef  00          
    DEFB    000H                        ;58f0  00          
    DEFB    000H                        ;58f1  00          
                  ;
                  ;CHR$(&HCE)
    DEFB    000H                        ;58f2  00          
    DEFB    000H                        ;58f3  00          
    DEFB    01CH                        ;58f4  1c          
    DEFB    020H                        ;58f5  20          
    DEFB    020H                        ;58f6  20          
    DEFB    018H                        ;58f7  18          
    DEFB    024H                        ;58f8  24          
    DEFB    024H                        ;58f9  24          
    DEFB    018H                        ;58fa  18          
    DEFB    000H                        ;58fb  00          
    DEFB    000H                        ;58fc  00          
    DEFB    000H                        ;58fd  00          
                  ;
                  ;CHR$(&HCF)
    DEFB    000H                        ;58fe  00          
    DEFB    000H                        ;58ff  00          
    DEFB    000H                        ;5900  00          
    DEFB    008H                        ;5901  08          
    DEFB    01CH                        ;5902  1c          
    DEFB    02AH                        ;5903  2a          
    DEFB    02AH                        ;5904  2a          
    DEFB    01CH                        ;5905  1c          
    DEFB    008H                        ;5906  08          
    DEFB    000H                        ;5907  00          
    DEFB    000H                        ;5908  00          
    DEFB    000H                        ;5909  00          
                  ;
                  ;CHR$(&HD0)
    DEFB    080H                        ;590a  80          
    DEFB    040H                        ;590b  40          
    DEFB    040H                        ;590c  40          
    DEFB    020H                        ;590d  20          
    DEFB    010H                        ;590e  10          
    DEFB    010H                        ;590f  10          
    DEFB    008H                        ;5910  08          
    DEFB    004H                        ;5911  04          
    DEFB    004H                        ;5912  04          
    DEFB    002H                        ;5913  02          
    DEFB    001H                        ;5914  01          
    DEFB    001H                        ;5915  01          
                  ;
                  ;CHR$(&HD1)
    DEFB    000H                        ;5916  00          
    DEFB    000H                        ;5917  00          
    DEFB    000H                        ;5918  00          
    DEFB    000H                        ;5919  00          
    DEFB    000H                        ;591a  00          
    DEFB    000H                        ;591b  00          
    DEFB    0FEH                        ;591c  fe          
    DEFB    000H                        ;591d  00          
    DEFB    000H                        ;591e  00          
    DEFB    000H                        ;591f  00          
    DEFB    000H                        ;5920  00          
    DEFB    000H                        ;5921  00          
                  ;
                  ;CHR$(&HD2)
    DEFB    000H                        ;5922  00          
    DEFB    000H                        ;5923  00          
    DEFB    000H                        ;5924  00          
    DEFB    000H                        ;5925  00          
    DEFB    000H                        ;5926  00          
    DEFB    07CH                        ;5927  7c          
    DEFB    000H                        ;5928  00          
    DEFB    000H                        ;5929  00          
    DEFB    0FEH                        ;592a  fe          
    DEFB    000H                        ;592b  00          
    DEFB    000H                        ;592c  00          
    DEFB    000H                        ;592d  00          
                  ;
                  ;CHR$(&HD3)
    DEFB    000H                        ;592e  00          
    DEFB    000H                        ;592f  00          
    DEFB    000H                        ;5930  00          
    DEFB    000H                        ;5931  00          
    DEFB    07CH                        ;5932  7c          
    DEFB    000H                        ;5933  00          
    DEFB    07CH                        ;5934  7c          
    DEFB    000H                        ;5935  00          
    DEFB    0FEH                        ;5936  fe          
    DEFB    000H                        ;5937  00          
    DEFB    000H                        ;5938  00          
    DEFB    000H                        ;5939  00          
                  ;
                  ;CHR$(&HD4)
    DEFB    000H                        ;593a  00          
    DEFB    000H                        ;593b  00          
    DEFB    000H                        ;593c  00          
    DEFB    000H                        ;593d  00          
    DEFB    0FEH                        ;593e  fe          
    DEFB    0AAH                        ;593f  aa          
    DEFB    0AAH                        ;5940  aa          
    DEFB    0AAH                        ;5941  aa          
    DEFB    0FEH                        ;5942  fe          
    DEFB    000H                        ;5943  00          
    DEFB    000H                        ;5944  00          
    DEFB    000H                        ;5945  00          
                  ;
                  ;CHR$(&HD5)
    DEFB    000H                        ;5946  00          
    DEFB    000H                        ;5947  00          
    DEFB    000H                        ;5948  00          
    DEFB    07CH                        ;5949  7c          
    DEFB    010H                        ;594a  10          
    DEFB    07CH                        ;594b  7c          
    DEFB    014H                        ;594c  14          
    DEFB    014H                        ;594d  14          
    DEFB    0FEH                        ;594e  fe          
    DEFB    000H                        ;594f  00          
    DEFB    000H                        ;5950  00          
    DEFB    000H                        ;5951  00          
                  ;
                  ;CHR$(&HD6)
    DEFB    000H                        ;5952  00          
    DEFB    000H                        ;5953  00          
    DEFB    010H                        ;5954  10          
    DEFB    010H                        ;5955  10          
    DEFB    0FEH                        ;5956  fe          
    DEFB    000H                        ;5957  00          
    DEFB    028H                        ;5958  28          
    DEFB    044H                        ;5959  44          
    DEFB    082H                        ;595a  82          
    DEFB    000H                        ;595b  00          
    DEFB    000H                        ;595c  00          
    DEFB    000H                        ;595d  00          
                  ;
                  ;CHR$(&HD7)
    DEFB    000H                        ;595e  00          
    DEFB    000H                        ;595f  00          
    DEFB    020H                        ;5960  20          
    DEFB    020H                        ;5961  20          
    DEFB    020H                        ;5962  20          
    DEFB    0FEH                        ;5963  fe          
    DEFB    020H                        ;5964  20          
    DEFB    020H                        ;5965  20          
    DEFB    03EH                        ;5966  3e          
    DEFB    000H                        ;5967  00          
    DEFB    000H                        ;5968  00          
    DEFB    000H                        ;5969  00          
                  ;
                  ;CHR$(&HD8)
    DEFB    000H                        ;596a  00          
    DEFB    000H                        ;596b  00          
    DEFB    000H                        ;596c  00          
    DEFB    000H                        ;596d  00          
    DEFB    000H                        ;596e  00          
    DEFB    028H                        ;596f  28          
    DEFB    044H                        ;5970  44          
    DEFB    082H                        ;5971  82          
    DEFB    000H                        ;5972  00          
    DEFB    000H                        ;5973  00          
    DEFB    000H                        ;5974  00          
    DEFB    000H                        ;5975  00          
                  ;
                  ;CHR$(&HD9)
    DEFB    000H                        ;5976  00          
    DEFB    000H                        ;5977  00          
    DEFB    020H                        ;5978  20          
    DEFB    020H                        ;5979  20          
    DEFB    0FCH                        ;597a  fc          
    DEFB    024H                        ;597b  24          
    DEFB    024H                        ;597c  24          
    DEFB    044H                        ;597d  44          
    DEFB    086H                        ;597e  86          
    DEFB    000H                        ;597f  00          
    DEFB    000H                        ;5980  00          
    DEFB    000H                        ;5981  00          
                  ;
                  ;CHR$(&HDA)
    DEFB    000H                        ;5982  00          
    DEFB    000H                        ;5983  00          
    DEFB    000H                        ;5984  00          
    DEFB    000H                        ;5985  00          
    DEFB    036H                        ;5986  36          
    DEFB    049H                        ;5987  49          
    DEFB    036H                        ;5988  36          
    DEFB    000H                        ;5989  00          
    DEFB    000H                        ;598a  00          
    DEFB    000H                        ;598b  00          
    DEFB    000H                        ;598c  00          
    DEFB    000H                        ;598d  00          
                  ;
                  ;CHR$(&HDB)
    DEFB    000H                        ;598e  00          
    DEFB    000H                        ;598f  00          
    DEFB    018H                        ;5990  18          
    DEFB    020H                        ;5991  20          
    DEFB    018H                        ;5992  18          
    DEFB    024H                        ;5993  24          
    DEFB    018H                        ;5994  18          
    DEFB    004H                        ;5995  04          
    DEFB    018H                        ;5996  18          
    DEFB    000H                        ;5997  00          
    DEFB    000H                        ;5998  00          
    DEFB    000H                        ;5999  00          
                  ;
                  ;CHR$(&HDC)
    DEFB    000H                        ;599a  00          
    DEFB    000H                        ;599b  00          
    DEFB    008H                        ;599c  08          
    DEFB    022H                        ;599d  22          
    DEFB    014H                        ;599e  14          
    DEFB    049H                        ;599f  49          
    DEFB    014H                        ;59a0  14          
    DEFB    022H                        ;59a1  22          
    DEFB    008H                        ;59a2  08          
    DEFB    000H                        ;59a3  00          
    DEFB    000H                        ;59a4  00          
    DEFB    000H                        ;59a5  00          
                  ;
                  ;CHR$(&HDD)
    DEFB    000H                        ;59a6  00          
    DEFB    000H                        ;59a7  00          
    DEFB    000H                        ;59a8  00          
    DEFB    038H                        ;59a9  38          
    DEFB    000H                        ;59aa  00          
    DEFB    07CH                        ;59ab  7c          
    DEFB    010H                        ;59ac  10          
    DEFB    010H                        ;59ad  10          
    DEFB    010H                        ;59ae  10          
    DEFB    000H                        ;59af  00          
    DEFB    000H                        ;59b0  00          
    DEFB    000H                        ;59b1  00          
                  ;
                  ;CHR$(&HDE)
    DEFB    000H                        ;59b2  00          
    DEFB    060H                        ;59b3  60          
    DEFB    090H                        ;59b4  90          
    DEFB    06EH                        ;59b5  6e          
    DEFB    011H                        ;59b6  11          
    DEFB    010H                        ;59b7  10          
    DEFB    010H                        ;59b8  10          
    DEFB    011H                        ;59b9  11          
    DEFB    00EH                        ;59ba  0e          
    DEFB    000H                        ;59bb  00          
    DEFB    000H                        ;59bc  00          
    DEFB    000H                        ;59bd  00          
                  ;
                  ;CHR$(&HDF)
    DEFB    001H                        ;59be  01          
    DEFB    002H                        ;59bf  02          
    DEFB    002H                        ;59c0  02          
    DEFB    004H                        ;59c1  04          
    DEFB    008H                        ;59c2  08          
    DEFB    008H                        ;59c3  08          
    DEFB    010H                        ;59c4  10          
    DEFB    020H                        ;59c5  20          
    DEFB    020H                        ;59c6  20          
    DEFB    040H                        ;59c7  40          
    DEFB    080H                        ;59c8  80          
    DEFB    080H                        ;59c9  80          
                  ;
                  ;CHR$(&HE0)
    DEFB    000H                        ;59ca  00          
    DEFB    000H                        ;59cb  00          
    DEFB    020H                        ;59cc  20          
    DEFB    010H                        ;59cd  10          
    DEFB    008H                        ;59ce  08          
    DEFB    000H                        ;59cf  00          
    DEFB    000H                        ;59d0  00          
    DEFB    000H                        ;59d1  00          
    DEFB    000H                        ;59d2  00          
    DEFB    000H                        ;59d3  00          
    DEFB    000H                        ;59d4  00          
    DEFB    000H                        ;59d5  00          
                  ;
                  ;CHR$(&HE1)
    DEFB    000H                        ;59d6  00          
    DEFB    000H                        ;59d7  00          
    DEFB    000H                        ;59d8  00          
    DEFB    000H                        ;59d9  00          
    DEFB    03CH                        ;59da  3c          
    DEFB    002H                        ;59db  02          
    DEFB    01EH                        ;59dc  1e          
    DEFB    022H                        ;59dd  22          
    DEFB    01FH                        ;59de  1f          
    DEFB    000H                        ;59df  00          
    DEFB    000H                        ;59e0  00          
    DEFB    000H                        ;59e1  00          
                  ;
                  ;CHR$(&HE2)
    DEFB    000H                        ;59e2  00          
    DEFB    000H                        ;59e3  00          
    DEFB    020H                        ;59e4  20          
    DEFB    020H                        ;59e5  20          
    DEFB    02CH                        ;59e6  2c          
    DEFB    032H                        ;59e7  32          
    DEFB    022H                        ;59e8  22          
    DEFB    032H                        ;59e9  32          
    DEFB    02CH                        ;59ea  2c          
    DEFB    000H                        ;59eb  00          
    DEFB    000H                        ;59ec  00          
    DEFB    000H                        ;59ed  00          
                  ;
                  ;CHR$(&HE3)
    DEFB    000H                        ;59ee  00          
    DEFB    000H                        ;59ef  00          
    DEFB    000H                        ;59f0  00          
    DEFB    000H                        ;59f1  00          
    DEFB    01CH                        ;59f2  1c          
    DEFB    022H                        ;59f3  22          
    DEFB    020H                        ;59f4  20          
    DEFB    022H                        ;59f5  22          
    DEFB    01CH                        ;59f6  1c          
    DEFB    000H                        ;59f7  00          
    DEFB    000H                        ;59f8  00          
    DEFB    000H                        ;59f9  00          
                  ;
                  ;CHR$(&HE4)
    DEFB    000H                        ;59fa  00          
    DEFB    000H                        ;59fb  00          
    DEFB    002H                        ;59fc  02          
    DEFB    002H                        ;59fd  02          
    DEFB    01AH                        ;59fe  1a          
    DEFB    026H                        ;59ff  26          
    DEFB    022H                        ;5a00  22          
    DEFB    026H                        ;5a01  26          
    DEFB    01AH                        ;5a02  1a          
    DEFB    000H                        ;5a03  00          
    DEFB    000H                        ;5a04  00          
    DEFB    000H                        ;5a05  00          
                  ;
                  ;CHR$(&HE5)
    DEFB    000H                        ;5a06  00          
    DEFB    000H                        ;5a07  00          
    DEFB    000H                        ;5a08  00          
    DEFB    000H                        ;5a09  00          
    DEFB    01CH                        ;5a0a  1c          
    DEFB    022H                        ;5a0b  22          
    DEFB    03EH                        ;5a0c  3e          
    DEFB    020H                        ;5a0d  20          
    DEFB    01EH                        ;5a0e  1e          
    DEFB    000H                        ;5a0f  00          
    DEFB    000H                        ;5a10  00          
    DEFB    000H                        ;5a11  00          
                  ;
                  ;CHR$(&HE6)
    DEFB    000H                        ;5a12  00          
    DEFB    000H                        ;5a13  00          
    DEFB    00CH                        ;5a14  0c          
    DEFB    010H                        ;5a15  10          
    DEFB    010H                        ;5a16  10          
    DEFB    07CH                        ;5a17  7c          
    DEFB    010H                        ;5a18  10          
    DEFB    010H                        ;5a19  10          
    DEFB    010H                        ;5a1a  10          
    DEFB    000H                        ;5a1b  00          
    DEFB    000H                        ;5a1c  00          
    DEFB    000H                        ;5a1d  00          
                  ;
                  ;CHR$(&HE7)
    DEFB    000H                        ;5a1e  00          
    DEFB    000H                        ;5a1f  00          
    DEFB    000H                        ;5a20  00          
    DEFB    000H                        ;5a21  00          
    DEFB    01AH                        ;5a22  1a          
    DEFB    026H                        ;5a23  26          
    DEFB    022H                        ;5a24  22          
    DEFB    026H                        ;5a25  26          
    DEFB    01AH                        ;5a26  1a          
    DEFB    002H                        ;5a27  02          
    DEFB    01CH                        ;5a28  1c          
    DEFB    000H                        ;5a29  00          
                  ;
                  ;CHR$(&HE8)
    DEFB    000H                        ;5a2a  00          
    DEFB    000H                        ;5a2b  00          
    DEFB    020H                        ;5a2c  20          
    DEFB    020H                        ;5a2d  20          
    DEFB    02CH                        ;5a2e  2c          
    DEFB    032H                        ;5a2f  32          
    DEFB    022H                        ;5a30  22          
    DEFB    022H                        ;5a31  22          
    DEFB    022H                        ;5a32  22          
    DEFB    000H                        ;5a33  00          
    DEFB    000H                        ;5a34  00          
    DEFB    000H                        ;5a35  00          
                  ;
                  ;CHR$(&HE9)
    DEFB    000H                        ;5a36  00          
    DEFB    000H                        ;5a37  00          
    DEFB    008H                        ;5a38  08          
    DEFB    000H                        ;5a39  00          
    DEFB    018H                        ;5a3a  18          
    DEFB    008H                        ;5a3b  08          
    DEFB    008H                        ;5a3c  08          
    DEFB    008H                        ;5a3d  08          
    DEFB    01CH                        ;5a3e  1c          
    DEFB    000H                        ;5a3f  00          
    DEFB    000H                        ;5a40  00          
    DEFB    000H                        ;5a41  00          
                  ;
                  ;CHR$(&HEA)
    DEFB    000H                        ;5a42  00          
    DEFB    000H                        ;5a43  00          
    DEFB    004H                        ;5a44  04          
    DEFB    000H                        ;5a45  00          
    DEFB    00CH                        ;5a46  0c          
    DEFB    004H                        ;5a47  04          
    DEFB    004H                        ;5a48  04          
    DEFB    004H                        ;5a49  04          
    DEFB    024H                        ;5a4a  24          
    DEFB    018H                        ;5a4b  18          
    DEFB    000H                        ;5a4c  00          
    DEFB    000H                        ;5a4d  00          
                  ;
                  ;CHR$(&HEB)
    DEFB    000H                        ;5a4e  00          
    DEFB    000H                        ;5a4f  00          
    DEFB    020H                        ;5a50  20          
    DEFB    020H                        ;5a51  20          
    DEFB    022H                        ;5a52  22          
    DEFB    024H                        ;5a53  24          
    DEFB    028H                        ;5a54  28          
    DEFB    034H                        ;5a55  34          
    DEFB    022H                        ;5a56  22          
    DEFB    000H                        ;5a57  00          
    DEFB    000H                        ;5a58  00          
    DEFB    000H                        ;5a59  00          
                  ;
                  ;CHR$(&HEC)
    DEFB    000H                        ;5a5a  00          
    DEFB    000H                        ;5a5b  00          
    DEFB    018H                        ;5a5c  18          
    DEFB    008H                        ;5a5d  08          
    DEFB    008H                        ;5a5e  08          
    DEFB    008H                        ;5a5f  08          
    DEFB    008H                        ;5a60  08          
    DEFB    008H                        ;5a61  08          
    DEFB    01CH                        ;5a62  1c          
    DEFB    000H                        ;5a63  00          
    DEFB    000H                        ;5a64  00          
    DEFB    000H                        ;5a65  00          
                  ;
                  ;CHR$(&HED)
    DEFB    000H                        ;5a66  00          
    DEFB    000H                        ;5a67  00          
    DEFB    000H                        ;5a68  00          
    DEFB    000H                        ;5a69  00          
    DEFB    076H                        ;5a6a  76          
    DEFB    049H                        ;5a6b  49          
    DEFB    049H                        ;5a6c  49          
    DEFB    049H                        ;5a6d  49          
    DEFB    049H                        ;5a6e  49          
    DEFB    000H                        ;5a6f  00          
    DEFB    000H                        ;5a70  00          
    DEFB    000H                        ;5a71  00          
                  ;
                  ;CHR$(&HEE)
    DEFB    000H                        ;5a72  00          
    DEFB    000H                        ;5a73  00          
    DEFB    000H                        ;5a74  00          
    DEFB    000H                        ;5a75  00          
    DEFB    02CH                        ;5a76  2c          
    DEFB    032H                        ;5a77  32          
    DEFB    022H                        ;5a78  22          
    DEFB    022H                        ;5a79  22          
    DEFB    022H                        ;5a7a  22          
    DEFB    000H                        ;5a7b  00          
    DEFB    000H                        ;5a7c  00          
    DEFB    000H                        ;5a7d  00          
                  ;
                  ;CHR$(&HEF)
    DEFB    000H                        ;5a7e  00          
    DEFB    000H                        ;5a7f  00          
    DEFB    000H                        ;5a80  00          
    DEFB    000H                        ;5a81  00          
    DEFB    01CH                        ;5a82  1c          
    DEFB    022H                        ;5a83  22          
    DEFB    022H                        ;5a84  22          
    DEFB    022H                        ;5a85  22          
    DEFB    01CH                        ;5a86  1c          
    DEFB    000H                        ;5a87  00          
    DEFB    000H                        ;5a88  00          
    DEFB    000H                        ;5a89  00          
                  ;
                  ;CHR$(&HF0)
    DEFB    000H                        ;5a8a  00          
    DEFB    000H                        ;5a8b  00          
    DEFB    000H                        ;5a8c  00          
    DEFB    000H                        ;5a8d  00          
    DEFB    02CH                        ;5a8e  2c          
    DEFB    032H                        ;5a8f  32          
    DEFB    022H                        ;5a90  22          
    DEFB    032H                        ;5a91  32          
    DEFB    02CH                        ;5a92  2c          
    DEFB    020H                        ;5a93  20          
    DEFB    020H                        ;5a94  20          
    DEFB    000H                        ;5a95  00          
                  ;
                  ;CHR$(&HF1)
    DEFB    000H                        ;5a96  00          
    DEFB    000H                        ;5a97  00          
    DEFB    000H                        ;5a98  00          
    DEFB    000H                        ;5a99  00          
    DEFB    01AH                        ;5a9a  1a          
    DEFB    026H                        ;5a9b  26          
    DEFB    022H                        ;5a9c  22          
    DEFB    026H                        ;5a9d  26          
    DEFB    01AH                        ;5a9e  1a          
    DEFB    002H                        ;5a9f  02          
    DEFB    002H                        ;5aa0  02          
    DEFB    000H                        ;5aa1  00          
                  ;
                  ;CHR$(&HF2)
    DEFB    000H                        ;5aa2  00          
    DEFB    000H                        ;5aa3  00          
    DEFB    000H                        ;5aa4  00          
    DEFB    000H                        ;5aa5  00          
    DEFB    02EH                        ;5aa6  2e          
    DEFB    030H                        ;5aa7  30          
    DEFB    020H                        ;5aa8  20          
    DEFB    020H                        ;5aa9  20          
    DEFB    020H                        ;5aaa  20          
    DEFB    000H                        ;5aab  00          
    DEFB    000H                        ;5aac  00          
    DEFB    000H                        ;5aad  00          
                  ;
                  ;CHR$(&HF3)
    DEFB    000H                        ;5aae  00          
    DEFB    000H                        ;5aaf  00          
    DEFB    000H                        ;5ab0  00          
    DEFB    000H                        ;5ab1  00          
    DEFB    01EH                        ;5ab2  1e          
    DEFB    020H                        ;5ab3  20          
    DEFB    01CH                        ;5ab4  1c          
    DEFB    002H                        ;5ab5  02          
    DEFB    03CH                        ;5ab6  3c          
    DEFB    000H                        ;5ab7  00          
    DEFB    000H                        ;5ab8  00          
    DEFB    000H                        ;5ab9  00          
                  ;
                  ;CHR$(&HF4)
    DEFB    000H                        ;5aba  00          
    DEFB    000H                        ;5abb  00          
    DEFB    010H                        ;5abc  10          
    DEFB    010H                        ;5abd  10          
    DEFB    038H                        ;5abe  38          
    DEFB    010H                        ;5abf  10          
    DEFB    010H                        ;5ac0  10          
    DEFB    012H                        ;5ac1  12          
    DEFB    00CH                        ;5ac2  0c          
    DEFB    000H                        ;5ac3  00          
    DEFB    000H                        ;5ac4  00          
    DEFB    000H                        ;5ac5  00          
                  ;
                  ;CHR$(&HF5)
    DEFB    000H                        ;5ac6  00          
    DEFB    000H                        ;5ac7  00          
    DEFB    000H                        ;5ac8  00          
    DEFB    000H                        ;5ac9  00          
    DEFB    022H                        ;5aca  22          
    DEFB    022H                        ;5acb  22          
    DEFB    022H                        ;5acc  22          
    DEFB    026H                        ;5acd  26          
    DEFB    01AH                        ;5ace  1a          
    DEFB    000H                        ;5acf  00          
    DEFB    000H                        ;5ad0  00          
    DEFB    000H                        ;5ad1  00          
                  ;
                  ;CHR$(&HF6)
    DEFB    000H                        ;5ad2  00          
    DEFB    000H                        ;5ad3  00          
    DEFB    000H                        ;5ad4  00          
    DEFB    000H                        ;5ad5  00          
    DEFB    022H                        ;5ad6  22          
    DEFB    022H                        ;5ad7  22          
    DEFB    022H                        ;5ad8  22          
    DEFB    014H                        ;5ad9  14          
    DEFB    008H                        ;5ada  08          
    DEFB    000H                        ;5adb  00          
    DEFB    000H                        ;5adc  00          
    DEFB    000H                        ;5add  00          
                  ;
                  ;CHR$(&HF7)
    DEFB    000H                        ;5ade  00          
    DEFB    000H                        ;5adf  00          
    DEFB    000H                        ;5ae0  00          
    DEFB    000H                        ;5ae1  00          
    DEFB    049H                        ;5ae2  49          
    DEFB    049H                        ;5ae3  49          
    DEFB    049H                        ;5ae4  49          
    DEFB    049H                        ;5ae5  49          
    DEFB    036H                        ;5ae6  36          
    DEFB    000H                        ;5ae7  00          
    DEFB    000H                        ;5ae8  00          
    DEFB    000H                        ;5ae9  00          
                  ;
                  ;CHR$(&HF8)
    DEFB    000H                        ;5aea  00          
    DEFB    000H                        ;5aeb  00          
    DEFB    000H                        ;5aec  00          
    DEFB    000H                        ;5aed  00          
    DEFB    022H                        ;5aee  22          
    DEFB    014H                        ;5aef  14          
    DEFB    008H                        ;5af0  08          
    DEFB    014H                        ;5af1  14          
    DEFB    022H                        ;5af2  22          
    DEFB    000H                        ;5af3  00          
    DEFB    000H                        ;5af4  00          
    DEFB    000H                        ;5af5  00          
                  ;
                  ;CHR$(&HF9)
    DEFB    000H                        ;5af6  00          
    DEFB    000H                        ;5af7  00          
    DEFB    000H                        ;5af8  00          
    DEFB    000H                        ;5af9  00          
    DEFB    022H                        ;5afa  22          
    DEFB    022H                        ;5afb  22          
    DEFB    022H                        ;5afc  22          
    DEFB    026H                        ;5afd  26          
    DEFB    01AH                        ;5afe  1a          
    DEFB    002H                        ;5aff  02          
    DEFB    01CH                        ;5b00  1c          
    DEFB    000H                        ;5b01  00          
                  ;
                  ;CHR$(&HFA)
    DEFB    000H                        ;5b02  00          
    DEFB    000H                        ;5b03  00          
    DEFB    000H                        ;5b04  00          
    DEFB    000H                        ;5b05  00          
    DEFB    03EH                        ;5b06  3e          
    DEFB    004H                        ;5b07  04          
    DEFB    008H                        ;5b08  08          
    DEFB    010H                        ;5b09  10          
    DEFB    03EH                        ;5b0a  3e          
    DEFB    000H                        ;5b0b  00          
    DEFB    000H                        ;5b0c  00          
    DEFB    000H                        ;5b0d  00          
                  ;
                  ;CHR$(&HFB)
    DEFB    000H                        ;5b0e  00          
    DEFB    000H                        ;5b0f  00          
    DEFB    008H                        ;5b10  08          
    DEFB    010H                        ;5b11  10          
    DEFB    010H                        ;5b12  10          
    DEFB    020H                        ;5b13  20          
    DEFB    010H                        ;5b14  10          
    DEFB    010H                        ;5b15  10          
    DEFB    008H                        ;5b16  08          
    DEFB    000H                        ;5b17  00          
    DEFB    000H                        ;5b18  00          
    DEFB    000H                        ;5b19  00          
                  ;
                  ;CHR$(&HFC)
    DEFB    000H                        ;5b1a  00          
    DEFB    000H                        ;5b1b  00          
    DEFB    000H                        ;5b1c  00          
    DEFB    054H                        ;5b1d  54          
    DEFB    0FEH                        ;5b1e  fe          
    DEFB    054H                        ;5b1f  54          
    DEFB    0FEH                        ;5b20  fe          
    DEFB    054H                        ;5b21  54          
    DEFB    028H                        ;5b22  28          
    DEFB    000H                        ;5b23  00          
    DEFB    000H                        ;5b24  00          
    DEFB    000H                        ;5b25  00          
                  ;
                  ;CHR$(&HFD)
    DEFB    000H                        ;5b26  00          
    DEFB    000H                        ;5b27  00          
    DEFB    010H                        ;5b28  10          
    DEFB    008H                        ;5b29  08          
    DEFB    008H                        ;5b2a  08          
    DEFB    004H                        ;5b2b  04          
    DEFB    008H                        ;5b2c  08          
    DEFB    008H                        ;5b2d  08          
    DEFB    010H                        ;5b2e  10          
    DEFB    000H                        ;5b2f  00          
    DEFB    000H                        ;5b30  00          
    DEFB    000H                        ;5b31  00          
                  ;
                  ;CHR$(&HFE)
    DEFB    000H                        ;5b32  00          
    DEFB    000H                        ;5b33  00          
    DEFB    000H                        ;5b34  00          
    DEFB    000H                        ;5b35  00          
    DEFB    000H                        ;5b36  00          
    DEFB    032H                        ;5b37  32          
    DEFB    04CH                        ;5b38  4c          
    DEFB    000H                        ;5b39  00          
    DEFB    000H                        ;5b3a  00          
    DEFB    000H                        ;5b3b  00          
    DEFB    000H                        ;5b3c  00          
    DEFB    000H                        ;5b3d  00          
                  ;
                  ;CHR$(&HFF)
    DEFB    000H                        ;5b3e  00          
    DEFB    000H                        ;5b3f  00          
    DEFB    000H                        ;5b40  00          
    DEFB    000H                        ;5b41  00          
    DEFB    001H                        ;5b42  01          
    DEFB    03EH                        ;5b43  3e          
    DEFB    054H                        ;5b44  54          
    DEFB    014H                        ;5b45  14          
    DEFB    014H                        ;5b46  14          
    DEFB    000H                        ;5b47  00          
    DEFB    000H                        ;5b48  00          
    DEFB    000H                        ;5b49  00          
                  
                  ;	ORG	05B4Ah
ADDDEG: PUSH    HL                      ;5b4a  e5          
    LD  HL,8                            ;5b4b  21 08 00    
    ADD HL,DE                           ;5b4e  19          
    EX  DE,HL                           ;5b4f  eb          
    POP HL                              ;5b50  e1          
    RET                                 ;5b51  c9          
                  ;
OCTLER: PUSH    HL                      ;5b52  e5          
    LD  HL,CHCKOC                       ;5b53  21 a1 5b    
    LD  (CHKVEC),HL                     ;5b56  22 7b 5b    
    LD  HL,00000h                       ;5b59  21 00 00    
    XOR A                               ;5b5c  af          
    JR  MID&OP                          ;5b5d  18 0c       
                  ;
HEXPZM: PUSH    HL                      ;5b5f  e5          
    LD  HL,CHCKHX                       ;5b60  21 a8 5b    
    LD  (CHKVEC),HL                     ;5b63  22 7b 5b    
    LD  HL,ADHLCK                       ;5b66  21 38 5d    
    LD  A,0CDh                          ;5b69  3e cd       
MID&OP: LD  (MULVEC),HL                 ;5b6b  22 89 5b    
    LD  (VECSWT),A                      ;5b6e  32 88 5b    
    LD  HL,00000h                       ;5b71  21 00 00    
LOP&OP: CALL    DEFTCH                  ;5b74  cd 51 5d    
    CALL    SMALL'                      ;5b77  cd 1c 63    
    DEFB    0CDH                        ;5b7a  cd          ;CALL
CHKVEC: DEFW    CHCKHX                  ;5b7b  a8 5b       
    JR  C,RET&OP                        ;5b7d  38 17       
    CALL    ADHLCK                      ;5b7f  cd 38 5d    
    CALL    ADHLCK                      ;5b82  cd 38 5d    
    CALL    ADHLCK                      ;5b85  cd 38 5d    
VECSWT: DEFB    0CDH                    ;5b88  cd          
MULVEC: DEFW    ADHLCK                  ;5b89  38 5d       
    ADD A,L                             ;5b8b  85          
    LD  L,A                             ;5b8c  6f          
    LD  A,0                             ;5b8d  3e 00       
    ADC A,H                             ;5b8f  8c          
    JP  C,OVERFL1                       ;5b90  da e4 6e    
    LD  H,A                             ;5b93  67          
    JR  LOP&OP                          ;5b94  18 de       
                  ;
RET&OP: DEC DE                          ;5b96  1b          
    LD  C,E                             ;5b97  4b          
    LD  B,D                             ;5b98  42          
    EX  DE,HL                           ;5b99  eb          
    POP HL                              ;5b9a  e1          
    CALL    FLTHEX                      ;5b9b  cd 02 29    
    LD  E,C                             ;5b9e  59          
    LD  D,B                             ;5b9f  50          
    RET                                 ;5ba0  c9          
                  ;
CHCKOC: SUB 030h                        ;5ba1  d6 30       
    RET C                               ;5ba3  d8          
    CP  008h                            ;5ba4  fe 08       
    CCF                                 ;5ba6  3f          
    RET                                 ;5ba7  c9          
                  ;
CHCKHX: SUB 030h                        ;5ba8  d6 30       
    RET C                               ;5baa  d8          
    CP  00Ah                            ;5bab  fe 0a       
    CCF                                 ;5bad  3f          
    RET NC                              ;5bae  d0          
    CP  011h                            ;5baf  fe 11       
    RET C                               ;5bb1  d8          
    SUB 007h                            ;5bb2  d6 07       
    CP  010h                            ;5bb4  fe 10       
    CCF                                 ;5bb6  3f          
    RET                                 ;5bb7  c9          
                  ;
OVFLAG: LD  (IY+0),8                    ;5bb8  fd 36 00 08 
    XOR A                               ;5bbc  af          
    LD  (IY-1),A                        ;5bbd  fd 77 ff    
    LD  C,A                             ;5bc0  4f          
    INC C                               ;5bc1  0c          
    EX  DE,HL                           ;5bc2  eb          
    LD  B,8                             ;5bc3  06 08       
    CALL    ZFILL                       ;5bc5  cd 10 62    
    EX  DE,HL                           ;5bc8  eb          
    CALL    DEFTCH                      ;5bc9  cd 51 5d    
    CP  02Bh                            ;5bcc  fe 2b       
    JR  Z,OVFLAG                        ;5bce  28 e8       
    CP  02Dh                            ;5bd0  fe 2d       
    JR  Z,SKIP2D                        ;5bd2  28 0b       
    JR  L008F                           ;5bd4  18 03       
ZRSKIP: CALL    DEFTCH                  ;5bd6  cd 51 5d    
L008F:  CP  030h                        ;5bd9  fe 30       
    JR  Z,ZRSKIP                        ;5bdb  28 f9       
    JR  CHCK26                          ;5bdd  18 06       
SKIP2D: CALL    OVFLAG                  ;5bdf  cd b8 5b    
    JP  TOGLE                           ;5be2  c3 eb 6b    
                  ;
CHCK26: CP  026h                        ;5be5  fe 26       
    JR  NZ,MDLAG                        ;5be7  20 17       
    CALL    DEFTCH                      ;5be9  cd 51 5d    
    CALL    SMALL'                      ;5bec  cd 1c 63    
    CP  048h                            ;5bef  fe 48       
    JP  Z,HEXPZM                        ;5bf1  ca 5f 5b    
    CP  04Fh                            ;5bf4  fe 4f       
    CALL    Z,DEFTCH                    ;5bf6  cc 51 5d    
    DEC DE                              ;5bf9  1b          
    JP  OCTLER                          ;5bfa  c3 52 5b    
                  ;
FTCHL:  CALL    DEFTCH                  ;5bfd  cd 51 5d    
MDLAG:  CP  02Eh                        ;5c00  fe 2e       
    JR  Z,POINTS                        ;5c02  28 23       
    CP  045h                            ;5c04  fe 45       
    JP  Z,EXPON?                        ;5c06  ca a8 5c    
    CP  044h                            ;5c09  fe 44       
    JP  Z,DEXPON                        ;5c0b  ca b6 5c    
    CP  030h                            ;5c0e  fe 30       
    JR  C,TST23H                        ;5c10  38 47       
    CP  03Ah                            ;5c12  fe 3a       
    JR  NC,TST23H                       ;5c14  30 43       
    SUB 030h                            ;5c16  d6 30       
    CALL    MULTEN                      ;5c18  cd 42 61    
    INC (IY-1)                          ;5c1b  fd 34 ff    
    SET 6,(IY-1)                        ;5c1e  fd cb ff f6 
    CALL    MULDEC                      ;5c22  cd 3d 5d    
    JR  FTCHL                           ;5c25  18 d6       
                  ;
POINTS: SET 7,(IY-1)                    ;5c27  fd cb ff fe 
POINT:  CALL    DEFTCH                  ;5c2b  cd 51 5d    
    CP  030h                            ;5c2e  fe 30       
    JR  C,PESC                          ;5c30  38 1f       
    CP  03Ah                            ;5c32  fe 3a       
    JR  NC,PESC                         ;5c34  30 1b       
    SUB 030h                            ;5c36  d6 30       
    INC C                               ;5c38  0c          
    CALL    MULTEN                      ;5c39  cd 42 61    
    BIT 6,(IY-1)                        ;5c3c  fd cb ff 76 
    JR  NZ,KMYSET                       ;5c40  20 07       
    OR  A                               ;5c42  b7          
    JR  Z,POINT                         ;5c43  28 e6       
    SET 6,(IY-1)                        ;5c45  fd cb ff f6 
KMYSET: CALL    MULDEC                  ;5c49  cd 3d 5d    
    INC (IY-1)                          ;5c4c  fd 34 ff    
    JR  POINT                           ;5c4f  18 da       
                  ;
PESC:   DEC C                           ;5c51  0d          
    JR  Z,TST23H                        ;5c52  28 05       
    CALL    DIVTEN                      ;5c54  cd 27 5d    
    JR  PESC                            ;5c57  18 f8       
                  ;
TST23H: CP  045h                        ;5c59  fe 45       
    JP  Z,EXPON!                        ;5c5b  ca af 5c    
    CP  044h                            ;5c5e  fe 44       
    JP  Z,DEXPON                        ;5c60  ca b6 5c    
    CP  023h                            ;5c63  fe 23       
    JR  NZ,TST21H                       ;5c65  20 09       
    LD  (IY+0),8                        ;5c67  fd 36 00 08 
    SET 7,(IY-1)                        ;5c6b  fd cb ff fe 
    RET                                 ;5c6f  c9          
                  ;
TST21H: CP  021h                        ;5c70  fe 21       
    JR  NZ,TST25H                       ;5c72  20 1d       
    SET 7,(IY-1)                        ;5c74  fd cb ff fe 
DGTUPQ: PUSH    DE                      ;5c78  d5          
    PUSH    BC                          ;5c79  c5          
    CALL    CSNG                        ;5c7a  cd 26 2b    
    PUSH    HL                          ;5c7d  e5          
    INC HL                              ;5c7e  23          
    INC HL                              ;5c7f  23          
    INC HL                              ;5c80  23          
    INC HL                              ;5c81  23          
    LD  B,4                             ;5c82  06 04       
SNGCL1: LD  (HL),0                      ;5c84  36 00       
    INC HL                              ;5c86  23          
    DJNZ    SNGCL1                      ;5c87  10 fb       
    POP HL                              ;5c89  e1          
    POP BC                              ;5c8a  c1          
    POP DE                              ;5c8b  d1          
    LD  (IY+0),4                        ;5c8c  fd 36 00 04 
    RET                                 ;5c90  c9          
                  ;
TST25H: CP  025h                        ;5c91  fe 25       
    JR  NZ,TSTPRC                       ;5c93  20 08       
    CALL    INT                         ;5c95  cd 10 60    
    RES 7,(IY-1)                        ;5c98  fd cb ff be 
    RET                                 ;5c9c  c9          
                  ;
TSTPRC: DEC DE                          ;5c9d  1b          
    LD  A,(IY-1)                        ;5c9e  fd 7e ff    
    AND 03Fh                            ;5ca1  e6 3f       
    CP  008h                            ;5ca3  fe 08       
    RET NC                              ;5ca5  d0          
    JR  DGTUPQ                          ;5ca6  18 d0       
                  ;
EXPON?: LD  A,(DE)                      ;5ca8  1a          
    CP  04Ch                            ;5ca9  fe 4c       
    JR  NZ,EXPON                        ;5cab  20 0f       
    JR  TSTPRC                          ;5cad  18 ee       
                  ;
EXPON!: LD  A,(DE)                      ;5caf  1a          
    CP  04Ch                            ;5cb0  fe 4c       
    JR  NZ,EXPON                        ;5cb2  20 08       
    JR  TSTPRC                          ;5cb4  18 e7       
                  ;
DEXPON: LD  (IY+0),8                    ;5cb6  fd 36 00 08 
    JR  EXPCLM                          ;5cba  18 04       
EXPON:  LD  (IY+0),4                    ;5cbc  fd 36 00 04 
EXPCLM: SET 7,(IY-1)                    ;5cc0  fd cb ff fe 
    PUSH    HL                          ;5cc4  e5          
    LD  HL,MUL                          ;5cc5  21 e0 6f    
    LD  (EXJPVC),HL                     ;5cc8  22 22 5d    
    LD  HL,00000h                       ;5ccb  21 00 00    
FTREPT: CALL    DEFTCH                  ;5cce  cd 51 5d    
    CP  02Bh                            ;5cd1  fe 2b       
    JR  Z,CBEGIN                        ;5cd3  28 0c       
    CP  02Dh                            ;5cd5  fe 2d       
    JR  NZ,CLMIDL                       ;5cd7  20 0b       
    PUSH    HL                          ;5cd9  e5          
    LD  HL,DIV                          ;5cda  21 bd 70    
    LD  (EXJPVC),HL                     ;5cdd  22 22 5d    
    POP HL                              ;5ce0  e1          
CBEGIN: CALL    DEFTCH                  ;5ce1  cd 51 5d    
CLMIDL: SUB 030h                        ;5ce4  d6 30       
    JR  C,ESCPER                        ;5ce6  38 1c       
    CP  00Ah                            ;5ce8  fe 0a       
    JR  NC,ESCPER                       ;5cea  30 18       
    PUSH    DE                          ;5cec  d5          
    CALL    ADHLCK                      ;5ced  cd 38 5d    
    LD  E,L                             ;5cf0  5d          
    LD  D,H                             ;5cf1  54          
    CALL    ADHLCK                      ;5cf2  cd 38 5d    
    CALL    ADHLCK                      ;5cf5  cd 38 5d    
    CALL    ADDECK                      ;5cf8  cd 34 5d    
    LD  E,A                             ;5cfb  5f          
    LD  D,000h                          ;5cfc  16 00       
    CALL    ADDECK                      ;5cfe  cd 34 5d    
    POP DE                              ;5d01  d1          
    JR  CBEGIN                          ;5d02  18 dd       
ESCPER: DEC DE                          ;5d04  1b          
    LD  A,H                             ;5d05  7c          
    OR  A                               ;5d06  b7          
    JR  NZ,OVERF'                       ;5d07  20 31       
    LD  A,L                             ;5d09  7d          
    POP HL                              ;5d0a  e1          
    PUSH    DE                          ;5d0b  d5          
    PUSH    BC                          ;5d0c  c5          
    PUSH    HL                          ;5d0d  e5          
    LD  DE,ZFAC1                        ;5d0e  11 fa 62    
    PUSH    DE                          ;5d11  d5          
    CALL    LDIR1                       ;5d12  cd a3 73    
    POP HL                              ;5d15  e1          
    LD  B,A                             ;5d16  47          
    INC B                               ;5d17  04          
    JR  MULLKM                          ;5d18  18 03       
EMLLPO: CALL    MULTEN                  ;5d1a  cd 42 61    
MULLKM: DJNZ    EMLLPO                  ;5d1d  10 fb       
    EX  DE,HL                           ;5d1f  eb          
    POP HL                              ;5d20  e1          
    DEFB    0CDH                        ;5d21  cd          ;CALL
EXJPVC: DEFS    2                       ;5d22              
    POP BC                              ;5d24  c1          
    POP DE                              ;5d25  d1          
    RET                                 ;5d26  c9          
                  ;
DIVTEN: PUSH    AF                      ;5d27  f5          
    PUSH    BC                          ;5d28  c5          
    PUSH    DE                          ;5d29  d5          
    LD  DE,FLTEN                        ;5d2a  11 90 62    
    CALL    DIV                         ;5d2d  cd bd 70    
    POP DE                              ;5d30  d1          
    POP BC                              ;5d31  c1          
    POP AF                              ;5d32  f1          
    RET                                 ;5d33  c9          
                  ;
ADDECK: ADD HL,DE                       ;5d34  19          
    RET NC                              ;5d35  d0          
    JR  OVERF'                          ;5d36  18 02       
                  ;
ADHLCK: ADD HL,HL                       ;5d38  29          
    RET NC                              ;5d39  d0          
OVERF': JP  OVERFL1                     ;5d3a  c3 e4 6e    
                  ;
MULDEC: PUSH    DE                      ;5d3d  d5          
    PUSH    HL                          ;5d3e  e5          
    LD  HL,ZFAC1                        ;5d3f  21 fa 62    
    LD  E,A                             ;5d42  5f          
    LD  D,0                             ;5d43  16 00       
    CALL    FLTHEX                      ;5d45  cd 02 29    
    EX  DE,HL                           ;5d48  eb          
    POP HL                              ;5d49  e1          
    PUSH    BC                          ;5d4a  c5          
    CALL    ADD                         ;5d4b  cd a6 6c    
    POP BC                              ;5d4e  c1          
    POP DE                              ;5d4f  d1          
    RET                                 ;5d50  c9          
                  ;
DEFTCH: LD  A,(DE)                      ;5d51  1a          
    CP  020h                            ;5d52  fe 20       
    INC DE                              ;5d54  13          
    JR  Z,DEFTCH                        ;5d55  28 fa       
    RET                                 ;5d57  c9          
                  ;
CVNMFL: LD  A,(HL)                      ;5d58  7e          
    OR  A                               ;5d59  b7          
    JR  Z,ONLYZ#                        ;5d5a  28 06       
    INC HL                              ;5d5c  23          
    LD  A,(HL)                          ;5d5d  7e          
    RES 7,(HL)                          ;5d5e  cb be       
    DEC HL                              ;5d60  2b          
    RLCA                                ;5d61  07          
ONLYZ#: LD  A,020h                      ;5d62  3e 20       
    JR  NC,PLUS                         ;5d64  30 02       
    LD  A,02Dh                          ;5d66  3e 2d       
PLUS:   PUSH    AF                      ;5d68  f5          
    CALL    CVASFL                      ;5d69  cd 1a 5e    
    POP AF                              ;5d6c  f1          
    INC B                               ;5d6d  04          
    DEC DE                              ;5d6e  1b          
    LD  (DE),A                          ;5d6f  12          
    RET                                 ;5d70  c9          
                  ;
ENORLP: LD  BC,0                        ;5d71  01 00 00    
ENORL': CALL    CMP                     ;5d74  cd d6 61    
    JR  NC,NORRES                       ;5d77  30 06       
    CALL    MULTEN                      ;5d79  cd 42 61    
    DEC BC                              ;5d7c  0b          
    JR  ENORL'                          ;5d7d  18 f5       
NORRES: PUSH    HL                      ;5d7f  e5          
    LD  HL,0FFF8h                       ;5d80  21 f8 ff    
    ADD HL,DE                           ;5d83  19          
    EX  DE,HL                           ;5d84  eb          
    POP HL                              ;5d85  e1          
NORRE': CALL    CMP                     ;5d86  cd d6 61    
    RET C                               ;5d89  d8          
    CALL    DIVTEN                      ;5d8a  cd 27 5d    
    INC BC                              ;5d8d  03          
    JR  NORRE'                          ;5d8e  18 f6       
                  ;
OKOMTR: LD  A,044h                      ;5d90  3e 44       
    BIT 3,(IY+0)                        ;5d92  fd cb 00 5e 
    JR  NZ,PUTEMK                       ;5d96  20 01       
    INC A                               ;5d98  3c          
PUTEMK: LD  (DE),A                      ;5d99  12          
    INC DE                              ;5d9a  13          
    LD  A,H                             ;5d9b  7c          
    OR  A                               ;5d9c  b7          
    LD  A,02Bh                          ;5d9d  3e 2b       
    JR  Z,EXPPLS                        ;5d9f  28 09       
    LD  A,L                             ;5da1  7d          
    CPL                                 ;5da2  2f          
    LD  L,A                             ;5da3  6f          
    LD  A,H                             ;5da4  7c          
    CPL                                 ;5da5  2f          
    LD  H,A                             ;5da6  67          
    INC HL                              ;5da7  23          
    LD  A,02Dh                          ;5da8  3e 2d       
EXPPLS: LD  (DE),A                      ;5daa  12          
    INC DE                              ;5dab  13          
    PUSH    DE                          ;5dac  d5          
    LD  DE,ZFAC                         ;5dad  11 f2 62    
    CALL    ASCHL                       ;5db0  cd a8 62    
    POP DE                              ;5db3  d1          
    LD  A,(ZFAC+3)                      ;5db4  3a f5 62    
    LD  (DE),A                          ;5db7  12          
    INC DE                              ;5db8  13          
    LD  A,(ZFAC+4)                      ;5db9  3a f6 62    
    LD  (DE),A                          ;5dbc  12          
    RET                                 ;5dbd  c9          
                  ;
EXPASC: PUSH    HL                      ;5dbe  e5          
    LD  DE,ZFAC                         ;5dbf  11 f2 62    
    PUSH    DE                          ;5dc2  d5          
    CALL    LDIR8                       ;5dc3  cd a6 73    
    POP HL                              ;5dc6  e1          
    LD  DE,FLONE                        ;5dc7  11 98 62    
    CALL    ENORLP                      ;5dca  cd 71 5d    
    PUSH    BC                          ;5dcd  c5          
    CALL    CVASFL                      ;5dce  cd 1a 5e    
    POP HL                              ;5dd1  e1          
    PUSH    DE                          ;5dd2  d5          
    PUSH    BC                          ;5dd3  c5          
    LD  A,E                             ;5dd4  7b          
    ADD A,B                             ;5dd5  80          
    LD  E,A                             ;5dd6  5f          
    LD  A,000h                          ;5dd7  3e 00       
    ADC A,D                             ;5dd9  8a          
    LD  D,A                             ;5dda  57          
    DEC DE                              ;5ddb  1b          
    LD  A,(DE)                          ;5ddc  1a          
    CP  030h                            ;5ddd  fe 30       
    INC DE                              ;5ddf  13          
    JR  NZ,PUTEXP                       ;5de0  20 05       
    DEC DE                              ;5de2  1b          
    POP BC                              ;5de3  c1          
    DEC B                               ;5de4  05          
    PUSH    BC                          ;5de5  c5          
    INC HL                              ;5de6  23          
PUTEXP: CALL    OKOMTR                  ;5de7  cd 90 5d    
    POP BC                              ;5dea  c1          
    POP DE                              ;5deb  d1          
    INC B                               ;5dec  04          
    INC B                               ;5ded  04          
    INC B                               ;5dee  04          
    INC B                               ;5def  04          
    POP HL                              ;5df0  e1          
    RET                                 ;5df1  c9          
                  ;
INTPAR: PUSH    HL                      ;5df2  e5          
    CALL    DLTEN                       ;5df3  cd 67 61    
    LD  DE,DGBUF+3                      ;5df6  11 07 63    
    CALL    ASCHL                       ;5df9  cd a8 62    
    EX  DE,HL                           ;5dfc  eb          
    LD  B,5                             ;5dfd  06 05       
FRSTCH: LD  A,(HL)                      ;5dff  7e          
    CP  030h                            ;5e00  fe 30       
    JR  NZ,BEGTRS                       ;5e02  20 03       
    INC HL                              ;5e04  23          
    DJNZ    FRSTCH                      ;5e05  10 f8       
BEGTRS: LD  C,B                         ;5e07  48          
MIDTRS: LD  A,(HL)                      ;5e08  7e          
    INC IX                              ;5e09  dd 23       
    LD  (IX+0),A                        ;5e0b  dd 77 00    
    INC HL                              ;5e0e  23          
    DJNZ    MIDTRS                      ;5e0f  10 f7       
    POP HL                              ;5e11  e1          
    CALL    FRAC                        ;5e12  cd 95 60    
    LD  DE,FLLAST                       ;5e15  11 a0 62    
    JR  ESTST'                          ;5e18  18 57       
                  ;
CVASFL: XOR A                           ;5e1a  af          
    CP  (HL)                            ;5e1b  be          
    JP  Z,ASZERO                        ;5e1c  ca b4 5e    
    LD  A,(IY+0)                        ;5e1f  fd 7e 00    
    CP  008h                            ;5e22  fe 08       
    JR  Z,DBLLCH                        ;5e24  28 0b       
    LD  DE,SHLMT                        ;5e26  11 ee 62    
    CALL    CMP                         ;5e29  cd d6 61    
    JP  NC,EXPASC                       ;5e2c  d2 be 5d    
    JR  NOEXP                           ;5e2f  18 09       
DBLLCH: LD  DE,DHLMT                    ;5e31  11 e6 62    
    CALL    CMP                         ;5e34  cd d6 61    
    JP  NC,EXPASC                       ;5e37  d2 be 5d    
NOEXP:  LD  DE,FLLAST                   ;5e3a  11 a0 62    
    CALL    CMP                         ;5e3d  cd d6 61    
    JP  C,EXPASC                        ;5e40  da be 5d    
    PUSH    HL                          ;5e43  e5          
    LD  DE,ZFAC1                        ;5e44  11 fa 62    
    PUSH    DE                          ;5e47  d5          
    CALL    LDIR8                       ;5e48  cd a6 73    
    POP HL                              ;5e4b  e1          
    CALL    CONDDG                      ;5e4c  cd fa 5f    
    LD  IX,DGBUF                        ;5e4f  dd 21 04 63 
    LD  (IX+0),030h                     ;5e53  dd 36 00 30 
    LD  A,(HL)                          ;5e57  7e          
    CP  081h                            ;5e58  fe 81       
    JR  C,FRACDG                        ;5e5a  38 1e       
    CP  091h                            ;5e5c  fe 91       
    JP  C,INTPAR                        ;5e5e  da f2 5d    
    LD  DE,CONTBL                       ;5e61  11 20 62    
    CALL    CONDSF                      ;5e64  cd ec 5f    
CVCONT: CALL    CMP                     ;5e67  cd d6 61    
    JR  NC,DWNERC                       ;5e6a  30 0b       
    CALL    ADDDEG                      ;5e6c  cd 4a 5b    
    JR  CVCONT                          ;5e6f  18 f6       
                  ;
ESTST': CALL    CONDDG                  ;5e71  cd fa 5f    
    LD  A,B                             ;5e74  78          
    SUB C                               ;5e75  91          
    LD  B,A                             ;5e76  47          
DWNERC: CALL    MIDSGN                  ;5e77  cd c0 5f    
FRACDG: INC IX                          ;5e7a  dd 23       
    LD  (IX+0),02Eh                     ;5e7c  dd 36 00 2e 
FRCAGN: LD  DE,FLMAX                    ;5e80  11 18 62    
    CALL    CONDSF                      ;5e83  cd ec 5f    
    PUSH    BC                          ;5e86  c5          
    PUSH    IX                          ;5e87  dd e5       
    CALL    MUL                         ;5e89  cd e0 6f    
    POP IX                              ;5e8c  dd e1       
    POP BC                              ;5e8e  c1          
    CALL    GNXDGT                      ;5e8f  cd bd 5f    
    LD  A,B                             ;5e92  78          
    OR  A                               ;5e93  b7          
    JR  NZ,FRCAGN                       ;5e94  20 ea       
    CALL    FRCADM                      ;5e96  cd bd 5e    
BCKSER: DEC HL                          ;5e99  2b          
    LD  A,(HL)                          ;5e9a  7e          
    CP  02Eh                            ;5e9b  fe 2e       
    DEC HL                              ;5e9d  2b          
    JR  Z,INTDIS                        ;5e9e  28 05       
    INC HL                              ;5ea0  23          
    CP  030h                            ;5ea1  fe 30       
    JR  Z,BCKSER                        ;5ea3  28 f4       
INTDIS: LD  DE,DGBUF                    ;5ea5  11 04 63    
    LD  A,(DE)                          ;5ea8  1a          
    CP  030h                            ;5ea9  fe 30       
    JR  NZ,LSTASA                       ;5eab  20 01       
    INC DE                              ;5ead  13          
LSTASA: SBC HL,DE                       ;5eae  ed 52       
    LD  B,L                             ;5eb0  45          
    INC B                               ;5eb1  04          
    POP HL                              ;5eb2  e1          
    RET                                 ;5eb3  c9          
                  ;
ASZERO: LD  DE,DGBUF                    ;5eb4  11 04 63    
    LD  A,030h                          ;5eb7  3e 30       
    LD  (DE),A                          ;5eb9  12          
ASCONE: LD  B,1                         ;5eba  06 01       
    RET                                 ;5ebc  c9          
                  ;
FRCADM: PUSH    IX                      ;5ebd  dd e5       
    POP HL                              ;5ebf  e1          
    LD  A,(HL)                          ;5ec0  7e          
    PUSH    HL                          ;5ec1  e5          
FRCASL: LD  (HL),030h                   ;5ec2  36 30       
    CP  035h                            ;5ec4  fe 35       
    JR  C,ESCADD                        ;5ec6  38 0c       
ADDLOP: DEC HL                          ;5ec8  2b          
    LD  A,(HL)                          ;5ec9  7e          
    CP  02Eh                            ;5eca  fe 2e       
    JR  Z,ADDLOP                        ;5ecc  28 fa       
    INC A                               ;5ece  3c          
    LD  (HL),A                          ;5ecf  77          
    CP  03Ah                            ;5ed0  fe 3a       
    JR  Z,FRCASL                        ;5ed2  28 ee       
ESCADD: POP HL                          ;5ed4  e1          
    RET                                 ;5ed5  c9          
                  ;
USGNCV:                                 ;                  
                  ;
                  ; ACC <- 1 EXP ON
                  ; ACC <- 0 EXP OFF
                  ; B <- INT PAR
                  ; C <- FRAC PAR
                  ;
                  ; OUT:HL <- LASTPO
                  ; KEYBUF+1 <- RESULT
                  ;
    PUSH    BC                          ;5ed6  c5          
    CALL    USGCV'                      ;5ed7  cd 4a 5f    
    POP BC                              ;5eda  c1          
    LD  A,B                             ;5edb  78          
    CP  2                               ;5edc  fe 02       
    RET C                               ;5ede  d8          
    DEC B                               ;5edf  05          
    LD  DE,KEYBUF                       ;5ee0  11 4f 7a    
RPSPAC: INC DE                          ;5ee3  13          
    LD  A,(DE)                          ;5ee4  1a          
    CP  030h                            ;5ee5  fe 30       
    RET NZ                              ;5ee7  c0          
    LD  A,020h                          ;5ee8  3e 20       
    LD  (DE),A                          ;5eea  12          
    DJNZ    RPSPAC                      ;5eeb  10 f6       
    RET                                 ;5eed  c9          
                  ;
EXPUSG: PUSH    BC                      ;5eee  c5          
    LD  A,B                             ;5eef  78          
    CP  011h                            ;5ef0  fe 11       
    JP  NC,FOVER                        ;5ef2  d2 a6 5f    
    OR  A                               ;5ef5  b7          
    JR  Z,USNRIW                        ;5ef6  28 01       
    DEC A                               ;5ef8  3d          
USNRIW: CALL    CPSHIF                  ;5ef9  cd dd 5f    
    LD  A,(HL)                          ;5efc  7e          
    OR  A                               ;5efd  b7          
    LD  BC,0                            ;5efe  01 00 00    
    CALL    NZ,ENORLP                   ;5f01  c4 71 5d    
    LD  E,C                             ;5f04  59          
    LD  D,B                             ;5f05  50          
    POP BC                              ;5f06  c1          
    LD  (EXPUBC),BC                     ;5f07  ed 43 2d 5f 
    LD  (EXPUHL),HL                     ;5f0b  22 30 5f    
AGNEXP: PUSH    DE                      ;5f0e  d5          
    PUSH    BC                          ;5f0f  c5          
    LD  DE,ZFAC                         ;5f10  11 f2 62    
    PUSH    DE                          ;5f13  d5          
    CALL    LDIR8                       ;5f14  cd a6 73    
    POP HL                              ;5f17  e1          
    POP BC                              ;5f18  c1          
    CALL    USGC''                      ;5f19  cd 46 5f    
    LD  DE,KEYBUF                       ;5f1c  11 4f 7a    
    LD  A,(DE)                          ;5f1f  1a          
    CP  02Fh                            ;5f20  fe 2f       
    JR  NZ,NGPUDS                       ;5f22  20 06       
    INC DE                              ;5f24  13          
    LD  A,(DE)                          ;5f25  1a          
    CP  031h                            ;5f26  fe 31       
    JR  NZ,WRITEL1                      ;5f28  20 0d       
NGPUDS: POP DE                          ;5f2a  d1          
    INC DE                              ;5f2b  13          
    DEFB    001H                        ;5f2c  01          ; LD BC,?
EXPUBC: DEFS    2                       ;5f2d              
    DEFB    021H                        ;5f2f  21          ; LD HL,?
EXPUHL: DEFS    2                       ;5f30              
    CALL    DIVTEN                      ;5f32  cd 27 5d    
    JR  AGNEXP                          ;5f35  18 d7       
                  ;
WRITEL1: CP 02Eh                        ;5f37  fe 2e       
    JR  Z,NTPT2E                        ;5f39  28 03       
    LD  A,020h                          ;5f3b  3e 20       
    LD  (DE),A                          ;5f3d  12          
NTPT2E: POP DE                          ;5f3e  d1          
    EX  DE,HL                           ;5f3f  eb          
    CALL    OKOMTR                      ;5f40  cd 90 5d    
    INC DE                              ;5f43  13          
    EX  DE,HL                           ;5f44  eb          
    RET                                 ;5f45  c9          
                  ;
USGC'': LD  A,02Fh                      ;5f46  3e 2f       
    JR  USG'''                          ;5f48  18 05       
                  ;
USGCV': OR  A                           ;5f4a  b7          
    JR  NZ,EXPUSG                       ;5f4b  20 a1       
    LD  A,030h                          ;5f4d  3e 30       
USG''': LD  IX,KEYBUF                   ;5f4f  dd 21 4f 7a 
    LD  (IX+0),A                        ;5f53  dd 77 00    
    LD  A,B                             ;5f56  78          
    OR  A                               ;5f57  b7          
    JR  Z,FRACUS                        ;5f58  28 1d       
    CP  17                              ;5f5a  fe 11       
    JR  C,STDGUS                        ;5f5c  38 0b       
STFLBL: INC IX                          ;5f5e  dd 23       
    LD  (IX+0),030h                     ;5f60  dd 36 00 30 
    DEC A                               ;5f64  3d          
    CP  16                              ;5f65  fe 10       
    JR  NZ,STFLBL                       ;5f67  20 f5       
STDGUS: INC A                           ;5f69  3c          
    CALL    CPSHIF                      ;5f6a  cd dd 5f    
    CALL    CMP                         ;5f6d  cd d6 61    
    JR  NC,FOVER                        ;5f70  30 34       
    LD  B,0                             ;5f72  06 00       
    CALL    GTESTB                      ;5f74  cd bb 5f    
FRACUS: CALL    ONECMP                  ;5f77  cd d3 61    
    JR  NC,FOVER                        ;5f7a  30 2a       
    LD  A,C                             ;5f7c  79          
    OR  A                               ;5f7d  b7          
    JR  Z,NOFRAC                        ;5f7e  28 2b       
    INC IX                              ;5f80  dd 23       
    LD  (IX+0),02Eh                     ;5f82  dd 36 00 2e 
    LD  B,C                             ;5f86  41          
AGINFR: PUSH    BC                      ;5f87  c5          
    PUSH    IX                          ;5f88  dd e5       
    LD  DE,FLMAX                        ;5f8a  11 18 62    
    CALL    CONDSF                      ;5f8d  cd ec 5f    
    CALL    MUL                         ;5f90  cd e0 6f    
    POP IX                              ;5f93  dd e1       
    POP BC                              ;5f95  c1          
    CALL    GNXDGT                      ;5f96  cd bd 5f    
    LD  A,B                             ;5f99  78          
    OR  A                               ;5f9a  b7          
    JR  NZ,AGINFR                       ;5f9b  20 ea       
OVERRD: CALL    FRCADM                  ;5f9d  cd bd 5e    
    LD  A,(KEYBUF)                      ;5fa0  3a 4f 7a    
    CP  031h                            ;5fa3  fe 31       
    RET C                               ;5fa5  d8          
FOVER:  LD  A,21                        ;5fa6  3e 15       
    JP  ERROR                           ;5fa8  c3 96 21    
                  ;
NOFRAC: INC (HL)                        ;5fab  34          
    CALL    ONECMP                      ;5fac  cd d3 61    
    INC IX                              ;5faf  dd 23       
    PUSH    IX                          ;5fb1  dd e5       
    POP HL                              ;5fb3  e1          
    RET C                               ;5fb4  d8          
    LD  (IX+0),039h                     ;5fb5  dd 36 00 39 
    JR  OVERRD                          ;5fb9  18 e2       
                  ;
GTESTB: DEC B                           ;5fbb  05          
    RET Z                               ;5fbc  c8          
GNXDGT: CALL    ADDDEG                  ;5fbd  cd 4a 5b    
MIDSGN: LD  A,(DE)                      ;5fc0  1a          
    CP  07Dh                            ;5fc1  fe 7d       
    RET Z                               ;5fc3  c8          
    INC IX                              ;5fc4  dd 23       
    LD  (IX+0),030h                     ;5fc6  dd 36 00 30 
INTGDL: CALL    CMP                     ;5fca  cd d6 61    
    JR  C,GTESTB                        ;5fcd  38 ec       
    INC (IX+0)                          ;5fcf  dd 34 00    
    PUSH    IX                          ;5fd2  dd e5       
    PUSH    BC                          ;5fd4  c5          
    CALL    SUB                         ;5fd5  cd d1 6b    
    POP BC                              ;5fd8  c1          
    POP IX                              ;5fd9  dd e1       
    JR  INTGDL                          ;5fdb  18 ed       
                  ;
CPSHIF: ADD A,A                         ;5fdd  87          
    ADD A,A                             ;5fde  87          
    ADD A,A                             ;5fdf  87          
    LD  B,A                             ;5fe0  47          
    LD  DE,FLLAST                       ;5fe1  11 a0 62    
    LD  A,E                             ;5fe4  7b          
    SUB B                               ;5fe5  90          
    LD  E,A                             ;5fe6  5f          
    LD  A,D                             ;5fe7  7a          
    SBC A,0                             ;5fe8  de 00       
    LD  D,A                             ;5fea  57          
    RET                                 ;5feb  c9          
                  ;
CONDSF: LD  A,(IY+0)                    ;5fec  fd 7e 00    
    CP  008h                            ;5fef  fe 08       
    RET Z                               ;5ff1  c8          
    PUSH    HL                          ;5ff2  e5          
    LD  HL,72                           ;5ff3  21 48 00    
    ADD HL,DE                           ;5ff6  19          
    EX  DE,HL                           ;5ff7  eb          
    POP HL                              ;5ff8  e1          
    RET                                 ;5ff9  c9          
                  ;
CONDDG: LD  A,(IY+0)                    ;5ffa  fd 7e 00    
    LD  B,17                            ;5ffd  06 11       
    CP  008h                            ;5fff  fe 08       
    RET Z                               ;6001  c8          
    LD  B,7                             ;6002  06 07       
    RET                                 ;6004  c9          
                  ;
INTZRR: LD  B,(IY+0)                    ;6005  fd 46 00    
    EX  DE,HL                           ;6008  eb          
    CALL    ZFILL                       ;6009  cd 10 62    
INTBCK: POP DE                          ;600c  d1          
    POP HL                              ;600d  e1          
    POP BC                              ;600e  c1          
    RET                                 ;600f  c9          
                  ;
B_FIX:                                  ;                  
INT:    PUSH    BC                      ;6010  c5          
    PUSH    HL                          ;6011  e5          
    PUSH    DE                          ;6012  d5          
    LD  A,(HL)                          ;6013  7e          
    CP  081h                            ;6014  fe 81       
    JR  C,INTZRR                        ;6016  38 ed       
    BIT 3,(IY+0)                        ;6018  fd cb 00 5e 
    JR  NZ,INTDBL                       ;601c  20 24       
    CP  098h                            ;601e  fe 98       
    JR  NC,INTBCK                       ;6020  30 ea       
    INC HL                              ;6022  23          
    CALL    RCHLBC                      ;6023  cd 8e 60    
    DEC HL                              ;6026  2b          
    LD  B,0                             ;6027  06 00       
INTSFL: SRL E                           ;6029  cb 3b       
    RR  D                               ;602b  cb 1a       
    RR  C                               ;602d  cb 19       
    INC A                               ;602f  3c          
    INC B                               ;6030  04          
    CP  098h                            ;6031  fe 98       
    JR  NZ,INTSFL                       ;6033  20 f4       
INTSBL: SLA C                           ;6035  cb 21       
    RL  D                               ;6037  cb 12       
    RL  E                               ;6039  cb 13       
    DJNZ    INTSBL                      ;603b  10 f8       
INTBC': CALL    STHLBC                  ;603d  cd 88 60    
    JR  INTBCK                          ;6040  18 ca       
                  ;
INTDBL: CP  0B8h                        ;6042  fe b8       
    JR  NC,INTBCK                       ;6044  30 c6       
    INC HL                              ;6046  23          
    CALL    RCHLBC                      ;6047  cd 8e 60    
    PUSH    HL                          ;604a  e5          
    EXX                                 ;604b  d9          
    POP HL                              ;604c  e1          
    CALL    RCHLBC                      ;604d  cd 8e 60    
    LD  B,(HL)                          ;6050  46          
    EXX                                 ;6051  d9          
    LD  B,000h                          ;6052  06 00       
INDSFL: SRL E                           ;6054  cb 3b       
    RR  D                               ;6056  cb 1a       
    RR  C                               ;6058  cb 19       
    EXX                                 ;605a  d9          
    RR  E                               ;605b  cb 1b       
    RR  D                               ;605d  cb 1a       
    RR  C                               ;605f  cb 19       
    RR  B                               ;6061  cb 18       
    EXX                                 ;6063  d9          
    INC B                               ;6064  04          
    INC A                               ;6065  3c          
    CP  0B8h                            ;6066  fe b8       
    JR  NZ,INDSFL                       ;6068  20 ea       
IDSFBL: EXX                             ;606a  d9          
    SLA B                               ;606b  cb 20       
    RL  C                               ;606d  cb 11       
    RL  D                               ;606f  cb 12       
    RL  E                               ;6071  cb 13       
    EXX                                 ;6073  d9          
    RL  C                               ;6074  cb 11       
    RL  D                               ;6076  cb 12       
    RL  E                               ;6078  cb 13       
    DJNZ    IDSFBL                      ;607a  10 ee       
    EXX                                 ;607c  d9          
    LD  (HL),B                          ;607d  70          
    DEC HL                              ;607e  2b          
MIDERF: CALL    STHLBC                  ;607f  cd 88 60    
    DEC HL                              ;6082  2b          
    PUSH    HL                          ;6083  e5          
    EXX                                 ;6084  d9          
    POP HL                              ;6085  e1          
    JR  INTBC'                          ;6086  18 b5       
                  ;
STHLBC: LD  (HL),C                      ;6088  71          
    DEC HL                              ;6089  2b          
    LD  (HL),D                          ;608a  72          
    DEC HL                              ;608b  2b          
    LD  (HL),E                          ;608c  73          
    RET                                 ;608d  c9          
                  ;
RCHLBC: LD  E,(HL)                      ;608e  5e          
    INC HL                              ;608f  23          
    LD  D,(HL)                          ;6090  56          
    INC HL                              ;6091  23          
    LD  C,(HL)                          ;6092  4e          
    INC HL                              ;6093  23          
    RET                                 ;6094  c9          
                  ;
FRAC:   LD  A,(HL)                      ;6095  7e          
    OR  A                               ;6096  b7          
    RET Z                               ;6097  c8          
    INC HL                              ;6098  23          
    LD  A,(HL)                          ;6099  7e          
    SET 7,(HL)                          ;609a  cb fe       
    DEC HL                              ;609c  2b          
    PUSH    AF                          ;609d  f5          
    CALL    FRAC'                       ;609e  cd a7 60    
    POP AF                              ;60a1  f1          
    RLCA                                ;60a2  07          
    RET C                               ;60a3  d8          
    JP  RESNHL                          ;60a4  c3 c0 6b    
                  ;
FRAC':  PUSH    BC                      ;60a7  c5          
    PUSH    HL                          ;60a8  e5          
    PUSH    DE                          ;60a9  d5          
    LD  A,(HL)                          ;60aa  7e          
    CP  081h                            ;60ab  fe 81       
    JP  C,INTBCK                        ;60ad  da 0c 60    
    BIT 3,(IY+0)                        ;60b0  fd cb 00 5e 
    JR  NZ,FRCDBL                       ;60b4  20 31       
    CP  098h                            ;60b6  fe 98       
    JP  NC,INTZRR                       ;60b8  d2 05 60    
    INC HL                              ;60bb  23          
    CALL    RCHLBC                      ;60bc  cd 8e 60    
    DEC HL                              ;60bf  2b          
FRCSBL: SLA C                           ;60c0  cb 21       
    RL  D                               ;60c2  cb 12       
    RL  E                               ;60c4  cb 13       
    DEC A                               ;60c6  3d          
    CP  080h                            ;60c7  fe 80       
    JR  NZ,FRCSBL                       ;60c9  20 f5       
    EX  AF,AF'                          ;60cb  08          
    LD  A,E                             ;60cc  7b          
    OR  D                               ;60cd  b2          
    OR  C                               ;60ce  b1          
    JR  Z,ENDSFR                        ;60cf  28 0e       
    EX  AF,AF'                          ;60d1  08          
FRCSB': BIT 7,E                         ;60d2  cb 7b       
    JR  NZ,ENDSFR                       ;60d4  20 09       
    SLA C                               ;60d6  cb 21       
    RL  D                               ;60d8  cb 12       
    RL  E                               ;60da  cb 13       
    DEC A                               ;60dc  3d          
    JR  FRCSB'                          ;60dd  18 f3       
                  ;
ENDSFR: CALL    STHLBC                  ;60df  cd 88 60    
    DEC HL                              ;60e2  2b          
    LD  (HL),A                          ;60e3  77          
    JP  INTBCK                          ;60e4  c3 0c 60    
                  ;
FRCDBL: CP  0B8h                        ;60e7  fe b8       
    JP  NC,INTZRR                       ;60e9  d2 05 60    
    INC HL                              ;60ec  23          
    CALL    RCHLBC                      ;60ed  cd 8e 60    
    PUSH    HL                          ;60f0  e5          
    EXX                                 ;60f1  d9          
    POP HL                              ;60f2  e1          
    CALL    RCHLBC                      ;60f3  cd 8e 60    
    LD  B,(HL)                          ;60f6  46          
IDFRBL: SLA B                           ;60f7  cb 20       
    RL  C                               ;60f9  cb 11       
    RL  D                               ;60fb  cb 12       
    RL  E                               ;60fd  cb 13       
    EXX                                 ;60ff  d9          
    RL  C                               ;6100  cb 11       
    RL  D                               ;6102  cb 12       
    RL  E                               ;6104  cb 13       
    EXX                                 ;6106  d9          
    DEC A                               ;6107  3d          
    CP  080h                            ;6108  fe 80       
    JR  NZ,IDFRBL                       ;610a  20 eb       
    EX  AF,AF'                          ;610c  08          
    LD  A,B                             ;610d  78          
    OR  C                               ;610e  b1          
    OR  D                               ;610f  b2          
    OR  E                               ;6110  b3          
    EXX                                 ;6111  d9          
    OR  C                               ;6112  b1          
    OR  D                               ;6113  b2          
    OR  E                               ;6114  b3          
    EXX                                 ;6115  d9          
    JR  Z,ESCDFS                        ;6116  28 19       
    EX  AF,AF'                          ;6118  08          
    EXX                                 ;6119  d9          
DSFL1': BIT 7,E                         ;611a  cb 7b       
    EXX                                 ;611c  d9          
    JR  NZ,ESCDFS                       ;611d  20 12       
    SLA B                               ;611f  cb 20       
    RL  C                               ;6121  cb 11       
    RL  D                               ;6123  cb 12       
    RL  E                               ;6125  cb 13       
    EXX                                 ;6127  d9          
    RL  C                               ;6128  cb 11       
    RL  D                               ;612a  cb 12       
    RL  E                               ;612c  cb 13       
    DEC A                               ;612e  3d          
    JR  DSFL1'                          ;612f  18 e9       
ESCDFS: LD  (HL),B                      ;6131  70          
    DEC HL                              ;6132  2b          
    CALL    STHLBC                      ;6133  cd 88 60    
    DEC HL                              ;6136  2b          
    PUSH    HL                          ;6137  e5          
    EXX                                 ;6138  d9          
    POP HL                              ;6139  e1          
    CALL    STHLBC                      ;613a  cd 88 60    
    DEC HL                              ;613d  2b          
    LD  (HL),A                          ;613e  77          
    JP  INTBCK                          ;613f  c3 0c 60    
                  ;
MULTEN: PUSH    AF                      ;6142  f5          
    PUSH    BC                          ;6143  c5          
    PUSH    DE                          ;6144  d5          
    LD  DE,FLTEN                        ;6145  11 90 62    
    CALL    MUL                         ;6148  cd e0 6f    
    POP DE                              ;614b  d1          
    POP BC                              ;614c  c1          
    POP AF                              ;614d  f1          
    RET                                 ;614e  c9          
                  ;
MOD:    PUSH    HL                      ;614f  e5          
    PUSH    DE                          ;6150  d5          
    CALL    DIV                         ;6151  cd bd 70    
    CALL    FRAC                        ;6154  cd 95 60    
    CALL    MUL                         ;6157  cd e0 6f    
    POP DE                              ;615a  d1          
    POP HL                              ;615b  e1          
    RET                                 ;615c  c9          
                  
HEXFLT: LD  A,(HL)                      ;615d  7e          
    CP  091h                            ;615e  fe 91       
    JR  C,HLFLT                         ;6160  38 05       
HXZRRT: CCF                             ;6162  3f          
    LD  HL,00000h                       ;6163  21 00 00    
    RET                                 ;6166  c9          
                  ;
DLTEN:                                  ;                  
HLFLT:  INC HL                          ;6167  23          
    BIT 7,(HL)                          ;6168  cb 7e       
    JR  Z,NORHLC                        ;616a  28 0b       
    CALL    NORHLC                      ;616c  cd 77 61    
    LD  A,H                             ;616f  7c          
    CPL                                 ;6170  2f          
    LD  H,A                             ;6171  67          
    LD  A,L                             ;6172  7d          
    CPL                                 ;6173  2f          
    LD  L,A                             ;6174  6f          
    INC HL                              ;6175  23          
    RET                                 ;6176  c9          
                  ;
NORHLC: DEC HL                          ;6177  2b          
    LD  A,(HL)                          ;6178  7e          
    CP  091h                            ;6179  fe 91       
    JP  NC,OVERFL1                      ;617b  d2 e4 6e    
TSTRNG: CP  081h                        ;617e  fe 81       
    JR  C,HXZRRT                        ;6180  38 e0       
    PUSH    AF                          ;6182  f5          
    INC HL                              ;6183  23          
    LD  A,(HL)                          ;6184  7e          
    INC HL                              ;6185  23          
    LD  L,(HL)                          ;6186  6e          
    LD  H,A                             ;6187  67          
    POP AF                              ;6188  f1          
    SET 7,H                             ;6189  cb fc       
HXFLSL: CP  090h                        ;618b  fe 90       
    RET Z                               ;618d  c8          
    INC A                               ;618e  3c          
    SRL H                               ;618f  cb 3c       
    RR  L                               ;6191  cb 1d       
    JR  HXFLSL                          ;6193  18 f6       
                  ;
STRCMP: LD  (IY+0),4                    ;6195  fd 36 00 04 
    CALL    CONDMZ                      ;6199  cd f6 6b    
    EX  DE,HL                           ;619c  eb          
    CALL    CONDMZ                      ;619d  cd f6 6b    
    EX  DE,HL                           ;61a0  eb          
    LD  E,(HL)                          ;61a1  5e          
    INC HL                              ;61a2  23          
    LD  D,(HL)                          ;61a3  56          
    POP HL                              ;61a4  e1          
    PUSH    HL                          ;61a5  e5          
    LD  A,(HL)                          ;61a6  7e          
    INC HL                              ;61a7  23          
    LD  H,(HL)                          ;61a8  66          
    LD  L,A                             ;61a9  6f          
    EX  DE,HL                           ;61aa  eb          
    PUSH    HL                          ;61ab  e5          
    PUSH    DE                          ;61ac  d5          
    LD  A,(DE)                          ;61ad  1a          
    CP  (HL)                            ;61ae  be          
    JR  C,NOIV0                         ;61af  38 01       
    LD  A,(HL)                          ;61b1  7e          
NOIV0:  LD  B,A                         ;61b2  47          
    OR  A                               ;61b3  b7          
    JR  Z,SCMPLN                        ;61b4  28 13       
    INC HL                              ;61b6  23          
    INC DE                              ;61b7  13          
    PUSH    DE                          ;61b8  d5          
    LD  E,(HL)                          ;61b9  5e          
    INC HL                              ;61ba  23          
    LD  D,(HL)                          ;61bb  56          
    POP HL                              ;61bc  e1          
    LD  A,(HL)                          ;61bd  7e          
    INC HL                              ;61be  23          
    LD  H,(HL)                          ;61bf  66          
    LD  L,A                             ;61c0  6f          
SCMPLP: LD  A,(DE)                      ;61c1  1a          
    CP  (HL)                            ;61c2  be          
    INC HL                              ;61c3  23          
    INC DE                              ;61c4  13          
    JR  NZ,PCMPRT                       ;61c5  20 08       
    DJNZ    SCMPLP                      ;61c7  10 f8       
SCMPLN: POP HL                          ;61c9  e1          
    POP DE                              ;61ca  d1          
    LD  A,(DE)                          ;61cb  1a          
    CP  (HL)                            ;61cc  be          
    JR  CMPRET                          ;61cd  18 2b       
                  ;
PCMPRT: POP HL                          ;61cf  e1          
    POP DE                              ;61d0  d1          
    JR  CMPRET                          ;61d1  18 27       
                  ;
ONECMP: LD  DE,FLONE                    ;61d3  11 98 62    
CMP:    PUSH    BC                      ;61d6  c5          
    PUSH    HL                          ;61d7  e5          
    PUSH    DE                          ;61d8  d5          
    LD  A,(IY+0)                        ;61d9  fd 7e 00    
    CP  003h                            ;61dc  fe 03       
    JR  Z,STRCMP                        ;61de  28 b5       
    INC HL                              ;61e0  23          
    INC DE                              ;61e1  13          
    BIT 7,(HL)                          ;61e2  cb 7e       
    JR  NZ,HMISN                        ;61e4  20 18       
TSTCMP2:                                ;                  
    LD  A,(DE)                          ;61e6  1a          
    RLCA                                ;61e7  07          
    JR  C,CMPR''                        ;61e8  38 22       
    DEC HL                              ;61ea  2b          
    DEC DE                              ;61eb  1b          
TSTCMP: LD  C,0                         ;61ec  0e 00       
    LD  B,(IY+0)                        ;61ee  fd 46 00    
    EX  DE,HL                           ;61f1  eb          
DCMPLO: LD  A,(DE)                      ;61f2  1a          
    CP  (HL)                            ;61f3  be          
    JR  NZ,CMPRET                       ;61f4  20 04       
    INC HL                              ;61f6  23          
    INC DE                              ;61f7  13          
    DJNZ    DCMPLO                      ;61f8  10 f8       
CMPRET: POP DE                          ;61fa  d1          
    POP HL                              ;61fb  e1          
    POP BC                              ;61fc  c1          
    RET                                 ;61fd  c9          
                  ;
HMISN:  LD  A,(DE)                      ;61fe  1a          
    RLCA                                ;61ff  07          
    JR  NC,CMPRE'                       ;6200  30 05       
    DEC HL                              ;6202  2b          
    DEC DE                              ;6203  1b          
    EX  DE,HL                           ;6204  eb          
    JR  TSTCMP                          ;6205  18 e5       
                  ;
CMPRE': XOR A                           ;6207  af          
    INC A                               ;6208  3c          
    SCF                                 ;6209  37          
    JR  CMPRET                          ;620a  18 ee       
                  ;
CMPR'': XOR A                           ;620c  af          
    INC A                               ;620d  3c          
    JR  CMPRET                          ;620e  18 ea       
                  ;
ZFILL:  XOR A                           ;6210  af          
FILL:   PUSH    DE                      ;6211  d5          
FILLOP: LD  (DE),A                      ;6212  12          
    INC DE                              ;6213  13          
    DJNZ    FILLOP                      ;6214  10 fc       
    POP DE                              ;6216  d1          
    RET                                 ;6217  c9          
                  ;
FLMAX:  DEFB    0B6H                    ;6218  b6          
    DEFB    00EH                        ;6219  0e          
    DEFB    01BH                        ;621a  1b          
    DEFB    0C9H                        ;621b  c9          
    DEFB    0BFH                        ;621c  bf          
    DEFB    004H                        ;621d  04          
    DEFB    000H                        ;621e  00          
    DEFB    000H                        ;621f  00          
                  ;
CONTBL: DEFB    0B2H                    ;6220  b2          
    DEFB    063H                        ;6221  63          
    DEFB    05FH                        ;6222  5f          
    DEFB    0A9H                        ;6223  a9          
    DEFB    031H                        ;6224  31          
    DEFB    0A0H                        ;6225  a0          
    DEFB    000H                        ;6226  00          
    DEFB    000H                        ;6227  00          
                  ;
    DEFB    0AFH                        ;6228  af          
    DEFB    035H                        ;6229  35          
    DEFB    0E6H                        ;622a  e6          
    DEFB    020H                        ;622b  20          
    DEFB    0F4H                        ;622c  f4          
    DEFB    080H                        ;622d  80          
    DEFB    000H                        ;622e  00          
    DEFB    000H                        ;622f  00          
                  ;
    DEFB    0ACH                        ;6230  ac          
    DEFB    011H                        ;6231  11          
    DEFB    084H                        ;6232  84          
    DEFB    0E7H                        ;6233  e7          
    DEFB    02AH                        ;6234  2a          
    DEFB    000H                        ;6235  00          
    DEFB    000H                        ;6236  00          
    DEFB    000H                        ;6237  00          
                  ;
    DEFB    0A8H                        ;6238  a8          
    DEFB    068H                        ;6239  68          
    DEFB    0D4H                        ;623a  d4          
    DEFB    0A5H                        ;623b  a5          
    DEFB    010H                        ;623c  10          
    DEFB    000H                        ;623d  00          
    DEFB    000H                        ;623e  00          
    DEFB    000H                        ;623f  00          
                  ;
    DEFB    0A5H                        ;6240  a5          
    DEFB    03AH                        ;6241  3a          
    DEFB    043H                        ;6242  43          
    DEFB    0B7H                        ;6243  b7          
    DEFB    040H                        ;6244  40          
    DEFB    000H                        ;6245  00          
    DEFB    000H                        ;6246  00          
    DEFB    000H                        ;6247  00          
                  ;
    DEFB    0A2H                        ;6248  a2          
    DEFB    015H                        ;6249  15          
    DEFB    002H                        ;624a  02          
    DEFB    0F9H                        ;624b  f9          
    DEFB    000H                        ;624c  00          
    DEFB    000H                        ;624d  00          
    DEFB    000H                        ;624e  00          
    DEFB    000H                        ;624f  00          
                  ;
    DEFB    09EH                        ;6250  9e          
    DEFB    06EH                        ;6251  6e          
    DEFB    06BH                        ;6252  6b          
    DEFB    028H                        ;6253  28          
    DEFB    000H                        ;6254  00          
    DEFB    000H                        ;6255  00          
    DEFB    000H                        ;6256  00          
    DEFB    000H                        ;6257  00          
                  ;
    DEFB    09BH                        ;6258  9b          
    DEFB    03EH                        ;6259  3e          
    DEFB    0BCH                        ;625a  bc          
    DEFB    020H                        ;625b  20          
    DEFB    000H                        ;625c  00          
    DEFB    000H                        ;625d  00          
    DEFB    000H                        ;625e  00          
    DEFB    000H                        ;625f  00          
                  ;
    DEFB    098H                        ;6260  98          
    DEFB    018H                        ;6261  18          
    DEFB    096H                        ;6262  96          
    DEFB    080H                        ;6263  80          
    DEFB    000H                        ;6264  00          
    DEFB    000H                        ;6265  00          
    DEFB    000H                        ;6266  00          
    DEFB    000H                        ;6267  00          
                  ;
SNGMXO: DEFB    094H                    ;6268  94          
    DEFB    074H                        ;6269  74          
    DEFB    024H                        ;626a  24          
    DEFB    000H                        ;626b  00          
    DEFB    000H                        ;626c  00          
    DEFB    000H                        ;626d  00          
    DEFB    000H                        ;626e  00          
    DEFB    000H                        ;626f  00          
                  ;
    DEFB    091H                        ;6270  91          
    DEFB    043H                        ;6271  43          
    DEFB    050H                        ;6272  50          
    DEFB    000H                        ;6273  00          
    DEFB    000H                        ;6274  00          
    DEFB    000H                        ;6275  00          
    DEFB    000H                        ;6276  00          
    DEFB    000H                        ;6277  00          
                  ;
    DEFB    08EH                        ;6278  8e          
    DEFB    01CH                        ;6279  1c          
    DEFB    040H                        ;627a  40          
    DEFB    000H                        ;627b  00          
    DEFB    000H                        ;627c  00          
    DEFB    000H                        ;627d  00          
    DEFB    000H                        ;627e  00          
    DEFB    000H                        ;627f  00          
                  ;
    DEFB    08AH                        ;6280  8a          
    DEFB    07AH                        ;6281  7a          
    DEFB    000H                        ;6282  00          
    DEFB    000H                        ;6283  00          
    DEFB    000H                        ;6284  00          
    DEFB    000H                        ;6285  00          
    DEFB    000H                        ;6286  00          
    DEFB    000H                        ;6287  00          
                  ;
    DEFB    087H                        ;6288  87          
    DEFB    048H                        ;6289  48          
    DEFB    000H                        ;628a  00          
    DEFB    000H                        ;628b  00          
    DEFB    000H                        ;628c  00          
    DEFB    000H                        ;628d  00          
    DEFB    000H                        ;628e  00          
    DEFB    000H                        ;628f  00          
                  ;
FLTEN:                                  ;                  
    DEFB    084H                        ;6290  84          
    DEFB    020H                        ;6291  20          
    DEFB    000H                        ;6292  00          
    DEFB    000H                        ;6293  00          
    DEFB    000H                        ;6294  00          
    DEFB    000H                        ;6295  00          
    DEFB    000H                        ;6296  00          
    DEFB    000H                        ;6297  00          
FLONE:                                  ;                  
    DEFB    081H                        ;6298  81          
    DEFB    000H                        ;6299  00          
    DEFB    000H                        ;629a  00          
    DEFB    000H                        ;629b  00          
    DEFB    000H                        ;629c  00          
    DEFB    000H                        ;629d  00          
    DEFB    000H                        ;629e  00          
    DEFB    000H                        ;629f  00          
FLLAST:                                 ;                  
    DEFB    07DH                        ;62a0  7d          
    DEFB    04CH                        ;62a1  4c          
    DEFB    0CCH                        ;62a2  cc          
    DEFB    0CCH                        ;62a3  cc          
    DEFB    0CCH                        ;62a4  cc          
    DEFB    0CCH                        ;62a5  cc          
    DEFB    0CCH                        ;62a6  cc          
    DEFB    0CDH                        ;62a7  cd          
ASCHL:                                  ;                  
    PUSH    HL                          ;62a8  e5          
    PUSH    DE                          ;62a9  d5          
    PUSH    BC                          ;62aa  c5          
    LD  C,0H                            ;62ab  0e 00       
    PUSH    DE                          ;62ad  d5          
    LD  B,0                             ;62ae  06 00       
    LD  DE,02710H                       ;62b0  11 10 27    
    CALL    CONV1                       ;62b3  cd d1 62    
    LD  DE,003E8H                       ;62b6  11 e8 03    
    CALL    CONV1                       ;62b9  cd d1 62    
    LD  DE,00064H                       ;62bc  11 64 00    
    CALL    CONV1                       ;62bf  cd d1 62    
    LD  DE,0000AH                       ;62c2  11 0a 00    
    CALL    CONV1                       ;62c5  cd d1 62    
    LD  A,L                             ;62c8  7d          
    POP DE                              ;62c9  d1          
    OR  030H                            ;62ca  f6 30       
    LD  (DE),A                          ;62cc  12          
    POP BC                              ;62cd  c1          
    POP DE                              ;62ce  d1          
    POP HL                              ;62cf  e1          
    RET                                 ;62d0  c9          
                  ;
CONV1:  LD  A,0FFH                      ;62d1  3e ff       
CONV2:  INC A                           ;62d3  3c          
    OR  A                               ;62d4  b7          
    SBC HL,DE                           ;62d5  ed 52       
    JR  NC,CONV2                        ;62d7  30 fa       
    ADD HL,DE                           ;62d9  19          
    OR  A                               ;62da  b7          
    INC B                               ;62db  04          
    DEFB    0F6H                        ;62dc  f6          ;OR ?
    DEFB    030H                        ;62dd  30          
    POP DE                              ;62de  d1          
    EX  (SP),HL                         ;62df  e3          
    LD  (HL),A                          ;62e0  77          
    INC HL                              ;62e1  23          
    EX  (SP),HL                         ;62e2  e3          
    PUSH    DE                          ;62e3  d5          
    INC C                               ;62e4  0c          
    RET                                 ;62e5  c9          
                  ;
DHLMT:                                  ;                  
    DEFB    0B6H                        ;62e6  b6          
    DEFB    00EH                        ;62e7  0e          
    DEFB    01BH                        ;62e8  1b          
    DEFB    0C9H                        ;62e9  c9          
    DEFB    0BFH                        ;62ea  bf          
    DEFB    003H                        ;62eb  03          
    DEFB    0FFH                        ;62ec  ff          
    DEFB    0FEH                        ;62ed  fe          
                  ;
SHLMT:                                  ;                  
    DEFB    094H                        ;62ee  94          
    DEFB    074H                        ;62ef  74          
    DEFB    023H                        ;62f0  23          
    DEFB    0F8H                        ;62f1  f8          
ZFAC:                                   ;                  
    DEFS    8                           ;62f2              
ZFAC1:  DEFS    8                       ;62fa              
    DEFS    2                           ;6302              
DGBUF:  DEFS    18                      ;6304              
    DEFS    5                           ;6316              
                  
                  ;	ORG	0631Bh
                  
$EDIT:                                  ;                  
SMALL:  LD  A,(DE)                      ;631b  1a          
SMALL': CP  061h                        ;631c  fe 61       
    RET C                               ;631e  d8          
    CP  07Bh                            ;631f  fe 7b       
    RET NC                              ;6321  d0          
    SUB 020h                            ;6322  d6 20       
    RET                                 ;6324  c9          
                  ;
CVIMTX:                                 ;                  
    PUSH    BC                          ;6325  c5          
    PUSH    DE                          ;6326  d5          
CPILLP: CALL    SPSTRE                  ;6327  cd ad 64    
    OR  A                               ;632a  b7          
    JR  Z,TREND                         ;632b  28 2f       
    INC DE                              ;632d  13          
    CP  080h                            ;632e  fe 80       ;80H 이상은 BASIC에 무시
    JR  NC,CPILLP                       ;6330  30 f5       
    CP  020h                            ;6332  fe 20       ;20H 이하도 무시
    JR  C,CPILLP                        ;6334  38 f1       
    DEC DE                              ;6336  1b          
    CP  03Fh                            ;6337  fe 3f       
    JR  Z,PRTCDE                        ;6339  28 1a       
    CP  022h                            ;633b  fe 22       
    JR  Z,STRING1                       ;633d  28 21       
    CP  027h                            ;633f  fe 27       
    JR  Z,REMOPR                        ;6341  28 24       
    CP  02Eh                            ;6343  fe 2e       
    JR  Z,NUMJMP                        ;6345  28 09       
    CP  026h                            ;6347  fe 26       
    JR  Z,NUMJMP                        ;6349  28 05       
    CALL    TSTNAC                      ;634b  cd 2e 65    
    JR  C,STATE                         ;634e  38 45       
NUMJMP: CALL    NUMBER                  ;6350  cd b6 64    
    JR  CPILLP                          ;6353  18 d2       
PRTCDE: LD  (HL),08Ch                   ;6355  36 8c       
BACKLP: INC HL                          ;6357  23          
    INC DE                              ;6358  13          
    JR  CPILLP                          ;6359  18 cc       
TREND': EX  DE,HL                       ;635b  eb          
TREND:  LD  (HL),A                      ;635c  77          
    POP DE                              ;635d  d1          
    POP BC                              ;635e  c1          
    RET                                 ;635f  c9          
                  ;
STRING1: CALL   DQTSTR                  ;6360  cd 9d 64    
    JR  Z,TREND                         ;6363  28 f7       
    JR  CPILLP                          ;6365  18 c0       
                  ;
REMOPR: LD  (HL),03Ah                   ;6367  36 3a       
    INC HL                              ;6369  23          
RMTRLP: LD  (HL),A                      ;636a  77          
    INC DE                              ;636b  13          
    INC HL                              ;636c  23          
RMTRMD: LD  A,(DE)                      ;636d  1a          
    OR  A                               ;636e  b7          
    JR  NZ,RMTRLP                       ;636f  20 f9       
BACK:   JP  CPILLP                      ;6371  c3 27 63    
STORE': INC HL                          ;6374  23          
STORE:  CALL    SMALL                   ;6375  cd 1b 63    
    LD  (HL),A                          ;6378  77          
    INC DE                              ;6379  13          
    CP  041h                            ;637a  fe 41       ;대문자 체크
    JR  C,BACK1                         ;637c  38 14       
    CP  05Bh                            ;637e  fe 5b       
    JR  NC,BACK1                        ;6380  30 10       
NOSLOP: CALL    SMALL                   ;6382  cd 1b 63    
    CP  030h                            ;6385  fe 30       ;숫자 체크
    JR  C,BACK1                         ;6387  38 09       
    CP  03Ah                            ;6389  fe 3a       
    JR  NC,BACK1                        ;638b  30 05       
    INC HL                              ;638d  23          
    LD  (HL),A                          ;638e  77          
    INC DE                              ;638f  13          
    JR  NOSLOP                          ;6390  18 f0       
BACK1:  INC HL                          ;6392  23          
    JR  BACK                            ;6393  18 dc       
                  ;
STATE:  LD  BC,CTBL1                    ;6395  01 37 67    ;예약어가 저장된 곳
    CALL    MATCH                       ;6398  cd 61 64    
    JR  NC,GETHX                        ;639b  30 21       
    LD  BC,CTBL2                        ;639d  01 d3 68    
    CALL    MATCH                       ;63a0  cd 61 64    
    JR  C,STORE                         ;63a3  38 d0       
    DEC HL                              ;63a5  2b          
    LD  A,(HL)                          ;63a6  7e          
    LD  (HL),0FFh                       ;63a7  36 ff       
    INC HL                              ;63a9  23          
    LD  (HL),A                          ;63aa  77          
    CP  0C0h                            ;63ab  fe c0       
    JR  NZ,BACK1                        ;63ad  20 e3       
    INC HL                              ;63af  23          
    CALL    SPSTRE                      ;63b0  cd ad 64    
    CP  03Dh                            ;63b3  fe 3d       
    JP  NZ,BACK                         ;63b5  c2 71 63    
    LD  (HL),0F5h                       ;63b8  36 f5       
    INC HL                              ;63ba  23          
    INC DE                              ;63bb  13          
    JR  LNOSLP1                         ;63bc  18 25       
                  ;
GETHX:  LD  A,B                         ;63be  78          
    CP  092h                            ;63bf  fe 92       
    JR  Z,RMTRMD                        ;63c1  28 aa       
    CP  08Fh                            ;63c3  fe 8f       
    JP  Z,DATAST1                       ;63c5  ca 3c 64    
    CP  0B8h                            ;63c8  fe b8       
    JR  Z,ELSEST                        ;63ca  28 68       
    CP  0E1h                            ;63cc  fe e1       
    JR  Z,LNOSLP1                       ;63ce  28 13       
    CP  0B6h                            ;63d0  fe b6       
    JR  Z,LNOSLP1                       ;63d2  28 0f       
    CP  093h                            ;63d4  fe 93       
    JR  Z,LISTER                        ;63d6  28 3a       
    CP  08Ah                            ;63d8  fe 8a       
    JP  NC,BACK                         ;63da  d2 71 63    
    CP  086h                            ;63dd  fe 86       
    JR  Z,LSIT#?                        ;63df  28 74       
    JR  NC,LISTER                       ;63e1  30 2f       
LNOSLP1: CALL   SPSTRE                  ;63e3  cd ad 64    
    CP  02Ch                            ;63e6  fe 2c       
    JR  Z,COMSTR                        ;63e8  28 0d       
    CALL    TSTNAC                      ;63ea  cd 2e 65    
    JR  C,LBLGOT1                       ;63ed  38 0d       
    CALL    CVBCAS                      ;63ef  cd bd 30    
    CALL    HEX2                        ;63f2  cd 0c 65    
    JR  LNOSLP1                         ;63f5  18 ec       
COMSTR: LD  (HL),A                      ;63f7  77          
    INC HL                              ;63f8  23          
    INC DE                              ;63f9  13          
    JR  LNOSLP1                         ;63fa  18 e7       
                  ;
LBLGOT1: CP 03Ah                        ;63fc  fe 3a       
    JP  Z,BACK                          ;63fe  ca 71 63    
    OR  A                               ;6401  b7          
    JP  Z,BACK                          ;6402  ca 71 63    
    CP  022h                            ;6405  fe 22       
    JP  NZ,BACK                         ;6407  c2 71 63    
    CALL    DQTSTR                      ;640a  cd 9d 64    
    JP  Z,TREND                         ;640d  ca 5c 63    
    JR  LNOSLP1                         ;6410  18 d1       
                  ;
LISTER: CALL    SPSTRE                  ;6412  cd ad 64    
LISTRM: CP  02Eh                        ;6415  fe 2e       
    JR  Z,AFNUM                         ;6417  28 16       
    CP  02Dh                            ;6419  fe 2d       
    JR  Z,AFNUM                         ;641b  28 12       
    CP  02Ch                            ;641d  fe 2c       
    JR  Z,AFNUM                         ;641f  28 0e       
    CALL    TSTNAC                      ;6421  cd 2e 65    
    JP  C,BACK                          ;6424  da 71 63    
    CALL    CVBCAS                      ;6427  cd bd 30    
    CALL    HEX2                        ;642a  cd 0c 65    
    JR  LISTER                          ;642d  18 e3       
                  ;
AFNUM:  LD  (HL),A                      ;642f  77          
    INC HL                              ;6430  23          
    INC DE                              ;6431  13          
    JR  LISTER                          ;6432  18 de       
                  ;
ELSEST: DEC HL                          ;6434  2b          
    LD  (HL),03Ah                       ;6435  36 3a       
    INC HL                              ;6437  23          
    LD  (HL),A                          ;6438  77          
    INC HL                              ;6439  23          
    JR  LNOSLP1                         ;643a  18 a7       
                  ;
DATAST1: LD A,(DE)                      ;643c  1a          
    OR  A                               ;643d  b7          
    JP  Z,TREND                         ;643e  ca 5c 63    
    LD  (HL),A                          ;6441  77          
    INC HL                              ;6442  23          
    INC DE                              ;6443  13          
DATAS: CP   03Ah                        ;6444  fe 3a       
    JP  Z,CPILLP                        ;6446  ca 27 63    
    CP  022h                            ;6449  fe 22       
    JR  NZ,DATAST1                      ;644b  20 ef       
DQSTL:  CALL    DQTST'                  ;644d  cd a0 64    
    JP  Z,TREND                         ;6450  ca 5c 63    
    JR  DATAST1                         ;6453  18 e7       ;DATAS'?
                  ;
LSIT#?: LD  A,(DE)                      ;6455  1a          
    CP  023h                            ;6456  fe 23       
    JR  NZ,LISTER                       ;6458  20 b8       
    DEC HL                              ;645a  2b          
    INC (HL)                            ;645b  34          
    INC HL                              ;645c  23          
    INC DE                              ;645d  13          
    INC DE                              ;645e  13          
    JR  LISTER                          ;645f  18 b1       
                  ;
MATCH:  PUSH    HL                      ;6461  e5          
    PUSH    DE                          ;6462  d5          
    LD  L,C                             ;6463  69          
    LD  H,B                             ;6464  60          
    LD  B,080h                          ;6465  06 80       
MSTART: POP DE                          ;6467  d1          
    PUSH    DE                          ;6468  d5          
    INC B                               ;6469  04          
    LD  A,(HL)                          ;646a  7e          
    INC A                               ;646b  3c          
    JR  Z,NOMTCH1                       ;646c  28 1e       
                  ;
TESTMT: CALL    SMALL                   ;646e  cd 1b 63    
    LD  C,(HL)                          ;6471  4e          
    INC HL                              ;6472  23          
    INC DE                              ;6473  13          
    CP  02Eh                            ;6474  fe 2e       ;생략형 명령 처리
    JR  Z,SHORTN1                       ;6476  28 18       
    SUB C                               ;6478  91          
    JR  Z,TESTMT                        ;6479  28 f3       
    CP  080h                            ;647b  fe 80       
    JR  Z,MTCHOK                        ;647d  28 08       
    DEC HL                              ;647f  2b          
SKIPTB: LD  A,(HL)                      ;6480  7e          
    RLCA                                ;6481  07          
    INC HL                              ;6482  23          
    JR  NC,SKIPTB                       ;6483  30 fb       
    JR  MSTART                          ;6485  18 e0       
MTCHOK: POP HL                          ;6487  e1          
    POP HL                              ;6488  e1          
    LD  (HL),B                          ;6489  70          
    INC HL                              ;648a  23          
    RET                                 ;648b  c9          
                  ;
NOMTCH1: POP    DE                      ;648c  d1          
    POP HL                              ;648d  e1          
    SCF                                 ;648e  37          
    RET                                 ;648f  c9          
                  ;
SHORTN1: EX AF,AF'                      ;6490  08          
    LD  A,B                             ;6491  78          
    CP  0EEh                            ;6492  fe ee       
    JR  NC,NO2EH                        ;6494  30 03       
    EX  AF,AF'                          ;6496  08          
    JR  MTCHOK                          ;6497  18 ee       
                  ;
NO2EH:  EX  AF,AF'                      ;6499  08          
    DEC HL                              ;649a  2b          
    JR  SKIPTB                          ;649b  18 e3       
                  ;
DQTSTR: LD  (HL),A                      ;649d  77          
    INC DE                              ;649e  13          
    INC HL                              ;649f  23          
DQTST': LD  A,(DE)                      ;64a0  1a          
    OR  A                               ;64a1  b7          
    RET Z                               ;64a2  c8          
    CP  022h                            ;64a3  fe 22       
    JR  NZ,DQTSTR                       ;64a5  20 f6       
    LD  (HL),A                          ;64a7  77          
    INC DE                              ;64a8  13          
    INC HL                              ;64a9  23          
    INC A                               ;64aa  3c          
    DEC A                               ;64ab  3d          
    RET                                 ;64ac  c9          
                  ;
SPSTRE: LD  A,(DE)                      ;64ad  1a          
    CP  020h                            ;64ae  fe 20       
    RET NZ                              ;64b0  c0          
    LD  (HL),A                          ;64b1  77          
    INC DE                              ;64b2  13          
    INC HL                              ;64b3  23          
    JR  SPSTRE                          ;64b4  18 f7       
                  ;
NUMBER: LD  A,(DE)                      ;64b6  1a          
    CP  026h                            ;64b7  fe 26       
    PUSH    HL                          ;64b9  e5          
    INC HL                              ;64ba  23          
    JR  NZ,NOT26H                       ;64bb  20 23       
    PUSH    DE                          ;64bd  d5          
    INC DE                              ;64be  13          
    CALL    DEFTCH                      ;64bf  cd 51 5d    
    CALL    SMALL'                      ;64c2  cd 1c 63    
    POP DE                              ;64c5  d1          ;이 줄은 책에서 빠져있네요.
    PUSH    AF                          ;64c6  f5          
    CALL    OVFLAG                      ;64c7  cd b8 5b    
    CALL    HEXFLT                      ;64ca  cd 5d 61    
    POP AF                              ;64cd  f1          
    CP  048h                            ;64ce  fe 48       
    LD  A,011h                          ;64d0  3e 11       
    JR  Z,SKIPHX                        ;64d2  28 01       
    DEC A                               ;64d4  3d          
SKIPHX: LD  C,L                         ;64d5  4d          
    LD  B,H                             ;64d6  44          
    POP HL                              ;64d7  e1          
    LD  (HL),A                          ;64d8  77          
    INC HL                              ;64d9  23          
    LD  (HL),C                          ;64da  71          
    INC HL                              ;64db  23          
    LD  (HL),B                          ;64dc  70          
    INC HL                              ;64dd  23          
    JR  BCKSPS                          ;64de  18 24       
                  ;
NOT26H: CALL    OVFLAG                  ;64e0  cd b8 5b    
    BIT 7,(IY-1)                        ;64e3  fd cb ff 7e 
    JR  NZ,FLOAT                        ;64e7  20 32       
    LD  A,(HL)                          ;64e9  7e          
    CP  090h                            ;64ea  fe 90       
    JR  NC,FLOAT                        ;64ec  30 2d       
    CALL    HEXFLT                      ;64ee  cd 5d 61    
    PUSH    DE                          ;64f1  d5          
    EX  DE,HL                           ;64f2  eb          
    LD  HL,00009H                       ;64f3  21 09 00    
    OR  A                               ;64f6  b7          
    SBC HL,DE                           ;64f7  ed 52       
    EX  DE,HL                           ;64f9  eb          
    POP DE                              ;64fa  d1          
    LD  A,012h                          ;64fb  3e 12       
    JR  C,HEX1                          ;64fd  38 11       
    LD  A,L                             ;64ff  7d          
    INC A                               ;6500  3c          
    POP HL                              ;6501  e1          
    LD  (HL),A                          ;6502  77          
    INC HL                              ;6503  23          
BCKSPS: DEC DE                          ;6504  1b          
    LD  A,(DE)                          ;6505  1a          
    CP  020h                            ;6506  fe 20       
    JR  Z,BCKSPS                        ;6508  28 fa       
    INC DE                              ;650a  13          
    RET                                 ;650b  c9          
                  ;
HEX2:   LD  A,00Bh                      ;650c  3e 0b       
    JR  PPOLNO                          ;650e  18 03       
                  ;
HEX1:   LD  C,L                         ;6510  4d          
    LD  B,H                             ;6511  44          
    POP HL                              ;6512  e1          
PPOLNO: LD  (HL),A                      ;6513  77          
    INC HL                              ;6514  23          
    LD  (HL),C                          ;6515  71          
    INC HL                              ;6516  23          
    LD  (HL),B                          ;6517  70          
    INC HL                              ;6518  23          
    JR  BCKSPS                          ;6519  18 e9       
                  ;
FLOAT:  LD  A,(IY+0)                    ;651b  fd 7e 00    
    AND 00Fh                            ;651e  e6 0f       
    OR  010h                            ;6520  f6 10       
    POP HL                              ;6522  e1          
    LD  (HL),A                          ;6523  77          
    INC HL                              ;6524  23          
    LD  C,(IY+0)                        ;6525  fd 4e 00    
    LD  B,0                             ;6528  06 00       
    ADD HL,BC                           ;652a  09          
    JR  BCKSPS                          ;652b  18 d7       
                  ;
TSTNDE: LD  A,(DE)                      ;652d  1a          
TSTNAC: CP  030h                        ;652e  fe 30       
    RET C                               ;6530  d8          
    CP  03Ah                            ;6531  fe 3a       
    CCF                                 ;6533  3f          
    RET                                 ;6534  c9          
                  ;
TREN':  LD  (DE),A                      ;6535  12          
    POP BC                              ;6536  c1          
    POP DE                              ;6537  d1          
    POP HL                              ;6538  e1          
    RET                                 ;6539  c9          
                  ;
CVTXIM: PUSH    HL                      ;653a  e5          
    PUSH    DE                          ;653b  d5          
    PUSH    BC                          ;653c  c5          
    LD  (CVCPPT),DE                     ;653d  ed 53 4a 65 
CVTMLP: PUSH    HL                      ;6541  e5          
    PUSH    DE                          ;6542  d5          
    EX  DE,HL                           ;6543  eb          
    DEC H                               ;6544  25          
    LD  DE,26                           ;6545  11 1a 00    
    ADD HL,DE                           ;6548  19          
    DEFB    011H                        ;6549  11          ; LD DE,?
CVCPPT: DEFS    2                       ;654a              
    XOR A                               ;654c  af          
    SBC HL,DE                           ;654d  ed 52       
    POP DE                              ;654f  d1          
    POP HL                              ;6550  e1          
    JP  NC,TREN'                        ;6551  d2 35 65    
    LD  A,(HL)                          ;6554  7e          
    OR  A                               ;6555  b7          
    JP  Z,TREN'                         ;6556  ca 35 65    
    CP  081h                            ;6559  fe 81       ;FUNCTION의 TOKEN
    JR  NC,TRASIM                       ;655b  30 13       
    CP  020h                            ;655d  fe 20       
    JR  C,TRNUMB                        ;655f  38 32       
    CP  022h                            ;6561  fe 22       
    JP  Z,DQUAT                         ;6563  ca 5d 66    
    CP  03Ah                            ;6566  fe 3a       
    JP  Z,CORON                         ;6568  ca 74 66    
BCEG:   LD  (DE),A                      ;656b  12          
    INC DE                              ;656c  13          
MDLBK:  INC HL                          ;656d  23          
    JR  CVTMLP                          ;656e  18 d1       
TRASIM: CP  0FFh                        ;6570  fe ff       ;함수 앞에 FF가 붙으므로
    JR  Z,FUNCTR                        ;6572  28 15       
    LD  BC,CTBL1                        ;6574  01 37 67    
    PUSH    AF                          ;6577  f5          
    CALL    INVS                        ;6578  cd 84 66    
    POP AF                              ;657b  f1          
    INC HL                              ;657c  23          
    CP  092h                            ;657d  fe 92       
    JP  Z,REM1                          ;657f  ca 70 66    
    CP  08Fh                            ;6582  fe 8f       
    JP  Z,DTARCL                        ;6584  ca 3d 66    
    JR  CVTMLP                          ;6587  18 b8       
                  ;
FUNCTR: INC HL                          ;6589  23          
    LD  A,(HL)                          ;658a  7e          
    LD  BC,CTBL2                        ;658b  01 d3 68    
    CALL    INVS                        ;658e  cd 84 66    
    JR  MDLBK                           ;6591  18 da       
                  ;
TRNUMB: CP  010h                        ;6593  fe 10       
    JR  NC,RFLOAT                       ;6595  30 41       
    CP  00Bh                            ;6597  fe 0b       
    JR  NC,IMHORN                       ;6599  30 05       
    DEC A                               ;659b  3d          
    OR  030h                            ;659c  f6 30       
    JR  BCEG                            ;659e  18 cb       
                  ;
IMHORN: CP  00Ch                        ;65a0  fe 0c       
    JP  Z,IMLNO                         ;65a2  ca 2d 66    
IMHEX:  PUSH    DE                      ;65a5  d5          
    INC HL                              ;65a6  23          
    LD  E,(HL)                          ;65a7  5e          
    INC HL                              ;65a8  23          
    LD  D,(HL)                          ;65a9  56          
    INC HL                              ;65aa  23          
    PUSH    HL                          ;65ab  e5          
    CP  010h                            ;65ac  fe 10       
    JR  C,IMMID                         ;65ae  38 05       
    CP  012h                            ;65b0  fe 12       
    JP  C,HEXOCT                        ;65b2  da ae 66    
IMMID:  EX  DE,HL                       ;65b5  eb          
    LD  DE,FIVEBF                       ;65b6  11 ab 69    
    CALL    ASCHL                       ;65b9  cd a8 62    
    XOR A                               ;65bc  af          
    LD  (FIVEBF+5),A                    ;65bd  32 b0 69    
    LD  B,4                             ;65c0  06 04       
SKZRLP: LD  A,(DE)                      ;65c2  1a          
    CP  030h                            ;65c3  fe 30       
    JR  NZ,ESSKZR                       ;65c5  20 03       
    INC DE                              ;65c7  13          
    DJNZ    SKZRLP                      ;65c8  10 f8       
ESSKZR: LD  C,E                         ;65ca  4b          
    LD  B,D                             ;65cb  42          
    POP HL                              ;65cc  e1          
    POP DE                              ;65cd  d1          
ZTRLW:  LD  A,(BC)                      ;65ce  0a          
    OR  A                               ;65cf  b7          
    JP  Z,CVTMLP                        ;65d0  ca 41 65    
    LD  (DE),A                          ;65d3  12          
    INC DE                              ;65d4  13          
    INC BC                              ;65d5  03          
    JR  ZTRLW                           ;65d6  18 f6       
RFLOAT: CP  013h                        ;65d8  fe 13       
    JR  C,IMHEX                         ;65da  38 c9       
    AND 00Fh                            ;65dc  e6 0f       
    LD  (IY+0),A                        ;65de  fd 77 00    
    INC HL                              ;65e1  23          
    PUSH    HL                          ;65e2  e5          
    PUSH    DE                          ;65e3  d5          
    CALL    CVASFL                      ;65e4  cd 1a 5e    
    EX  DE,HL                           ;65e7  eb          
    POP DE                              ;65e8  d1          
FLTRDL: LD  A,(HL)                      ;65e9  7e          
    LD  (DE),A                          ;65ea  12          
    CP  02Eh                            ;65eb  fe 2e       
    JR  Z,NTPT21                        ;65ed  28 29       
    CP  045h                            ;65ef  fe 45       
    JR  Z,NTPT21                        ;65f1  28 25       
    CP  044h                            ;65f3  fe 44       
    JR  Z,NTPT23                        ;65f5  28 30       
    INC HL                              ;65f7  23          
    INC DE                              ;65f8  13          
    DJNZ    FLTRDL                      ;65f9  10 ee       
    LD  A,(IY+0)                        ;65fb  fd 7e 00    
    CP  008h                            ;65fe  fe 08       
    LD  A,021h                          ;6600  3e 21       
    JR  NZ,PUT21H                       ;6602  20 02       
PUT23H: LD  A,023h                      ;6604  3e 23       
PUT21H: LD  (DE),A                      ;6606  12          
    INC DE                              ;6607  13          
TSTED:  LD  C,(IY+0)                    ;6608  fd 4e 00    
    LD  B,0                             ;660b  06 00       
    POP HL                              ;660d  e1          
    ADD HL,BC                           ;660e  09          
    JP  CVTMLP                          ;660f  c3 41 65    
                  ;
FLTRP': LD  A,(HL)                      ;6612  7e          
    LD  (DE),A                          ;6613  12          
    CP  044h                            ;6614  fe 44       
    JR  Z,NTPT23                        ;6616  28 0f       
NTPT21: INC HL                          ;6618  23          
    INC DE                              ;6619  13          
    DJNZ    FLTRP'                      ;661a  10 f6       
    LD  A,(IY+0)                        ;661c  fd 7e 00    
    CP  008h                            ;661f  fe 08       
    JR  Z,PUT23H                        ;6621  28 e1       
    JR  TSTED                           ;6623  18 e3       
                  ;
FLTR'': LD  A,(HL)                      ;6625  7e          
    LD  (DE),A                          ;6626  12          
NTPT23: INC HL                          ;6627  23          
    INC DE                              ;6628  13          
    DJNZ    FLTR''                      ;6629  10 fa       
    JR  TSTED                           ;662b  18 db       
                  ;
IMLNO:  PUSH    DE                      ;662d  d5          
    INC HL                              ;662e  23          
    LD  E,(HL)                          ;662f  5e          
    INC HL                              ;6630  23          
    LD  D,(HL)                          ;6631  56          
    INC HL                              ;6632  23          
    PUSH    HL                          ;6633  e5          
    EX  DE,HL                           ;6634  eb          
    INC HL                              ;6635  23          
    INC HL                              ;6636  23          
    LD  E,(HL)                          ;6637  5e          
    INC HL                              ;6638  23          
    LD  D,(HL)                          ;6639  56          
    JP  IMMID                           ;663a  c3 b5 65    
                  ;
DTARCL: LD  A,(HL)                      ;663d  7e          
    CP  022h                            ;663e  fe 22       
    JR  Z,DTA22S                        ;6640  28 0e       
MIDDST: LD  (DE),A                      ;6642  12          
    CP  03Ah                            ;6643  fe 3a       
    INC HL                              ;6645  23          
    INC DE                              ;6646  13          
    JP  Z,CVTMLP                        ;6647  ca 41 65    
    OR  A                               ;664a  b7          
    JP  Z,TREN'                         ;664b  ca 35 65    
    JR  DTARCL                          ;664e  18 ed       
                  ;
DTA22S: LD  (DE),A                      ;6650  12          
    INC HL                              ;6651  23          
    INC DE                              ;6652  13          
    LD  A,(HL)                          ;6653  7e          
    CP  022h                            ;6654  fe 22       
    JR  Z,MIDDST                        ;6656  28 ea       
    OR  A                               ;6658  b7          
    JR  Z,MIDDST                        ;6659  28 e7       
    JR  DTA22S                          ;665b  18 f3       
                  ;
DQUAT:  LD  B,022h                      ;665d  06 22       
    LD  (DE),A                          ;665f  12          
    INC HL                              ;6660  23          
    INC DE                              ;6661  13          
DQUATL: LD  A,(HL)                      ;6662  7e          
    LD  (DE),A                          ;6663  12          
    OR  A                               ;6664  b7          
    JP  Z,TREN'                         ;6665  ca 35 65    
    CP  B                               ;6668  b8          
    INC HL                              ;6669  23          
    INC DE                              ;666a  13          
    JP  Z,CVTMLP                        ;666b  ca 41 65    
    JR  DQUATL                          ;666e  18 f2       
                  ;
REM1:   LD  B,0                         ;6670  06 00       
    JR  DQUATL                          ;6672  18 ee       
                  ;
CORON:  LD  (DE),A                      ;6674  12          
    INC HL                              ;6675  23          
    LD  A,(HL)                          ;6676  7e          
    CP  027h                            ;6677  fe 27       
    JR  Z,REM1                          ;6679  28 f5       
    CP  0B8h                            ;667b  fe b8       
    JP  Z,CVTMLP                        ;667d  ca 41 65    
    INC DE                              ;6680  13          
    JP  CVTMLP                          ;6681  c3 41 65    
                  ;
INVS:   DEC A                           ;6684  3d          
    CP  080h                            ;6685  fe 80       
    JR  Z,ASSTR#                        ;6687  28 0b       
    EX  AF,AF'                          ;6689  08          
SKIPTR: LD  A,(BC)                      ;668a  0a          
    RLCA                                ;668b  07          
    INC BC                              ;668c  03          
    JP  NC,SKIPTR                       ;668d  d2 8a 66    
    EX  AF,AF'                          ;6690  08          
    JP  INVS                            ;6691  c3 84 66    
ASSTR#: LD  A,(BC)                      ;6694  0a          
    PUSH    AF                          ;6695  f5          
    AND 07Fh                            ;6696  e6 7f       
    LD  (DE),A                          ;6698  12          
    POP AF                              ;6699  f1          
    INC DE                              ;669a  13          
    INC BC                              ;669b  03          
    RLCA                                ;669c  07          
    JR  NC,ASSTR#                       ;669d  30 f5       
    RET                                 ;669f  c9          
                  ;
OCTALD: LD  A,04Fh                      ;66a0  3e 4f       
    EX  AF,AF'                          ;66a2  08          
    EX  DE,HL                           ;66a3  eb          
    LD  DE,FIVEBF                       ;66a4  11 ab 69    
    CALL    OCTHL                       ;66a7  cd db 66    
    LD  B,005h                          ;66aa  06 05       
    JR  SKHEXP                          ;66ac  18 10       
                  ;
HEXOCT: CP  011h                        ;66ae  fe 11       
    JR  NZ,OCTALD                       ;66b0  20 ee       
    LD  A,048h                          ;66b2  3e 48       
    EX  AF,AF'                          ;66b4  08          
    EX  DE,HL                           ;66b5  eb          
    LD  DE,FIVEBF                       ;66b6  11 ab 69    
    CALL    HEXHL                       ;66b9  cd 12 67    
    LD  B,3                             ;66bc  06 03       
SKHEXP: LD  A,(DE)                      ;66be  1a          
    CP  030h                            ;66bf  fe 30       
    JR  NZ,ESHEXR                       ;66c1  20 03       
    INC DE                              ;66c3  13          
    DJNZ    SKHEXP                      ;66c4  10 f8       
ESHEXR: LD  C,E                         ;66c6  4b          
    LD  B,D                             ;66c7  42          
    POP HL                              ;66c8  e1          
    POP DE                              ;66c9  d1          
    LD  A,026h                          ;66ca  3e 26       
    LD  (DE),A                          ;66cc  12          
    INC DE                              ;66cd  13          
    EX  AF,AF'                          ;66ce  08          
    LD  (DE),A                          ;66cf  12          
    INC DE                              ;66d0  13          
ZTRLWH: LD  A,(BC)                      ;66d1  0a          
    OR  A                               ;66d2  b7          
    JP  Z,CVTMLP                        ;66d3  ca 41 65    
    LD  (DE),A                          ;66d6  12          
    INC DE                              ;66d7  13          
    INC BC                              ;66d8  03          
    JR  ZTRLWH                          ;66d9  18 f6       
                  ;
OCTHL:  PUSH    DE                      ;66db  d5          
    CALL    OCTCOV                      ;66dc  cd e1 66    
    POP DE                              ;66df  d1          
    RET                                 ;66e0  c9          
                  ;
OCTCOV: LD  A,H                         ;66e1  7c          
    RLA                                 ;66e2  17          
    LD  A,0                             ;66e3  3e 00       
    ADC A,030h                          ;66e5  ce 30       
    LD  (DE),A                          ;66e7  12          
    INC DE                              ;66e8  13          
    LD  A,H                             ;66e9  7c          
    RRCA                                ;66ea  0f          
    RRCA                                ;66eb  0f          
    RRCA                                ;66ec  0f          
    RRCA                                ;66ed  0f          
    CALL    OCTSTO                      ;66ee  cd 0b 67    
    LD  A,H                             ;66f1  7c          
    RRCA                                ;66f2  0f          
    CALL    OCTSTO                      ;66f3  cd 0b 67    
    LD  A,H                             ;66f6  7c          
    AND 001h                            ;66f7  e6 01       
    LD  H,L                             ;66f9  65          
    RL  H                               ;66fa  cb 14       
    RLA                                 ;66fc  17          
    RL  H                               ;66fd  cb 14       
    RLA                                 ;66ff  17          
    CALL    OCTSTO                      ;6700  cd 0b 67    
    LD  A,L                             ;6703  7d          
    RRCA                                ;6704  0f          
    RRCA                                ;6705  0f          
    RRCA                                ;6706  0f          
    CALL    OCTSTO                      ;6707  cd 0b 67    
    LD  A,L                             ;670a  7d          
OCTSTO: AND 007h                        ;670b  e6 07       
    ADD A,030h                          ;670d  c6 30       
    LD  (DE),A                          ;670f  12          
    INC DE                              ;6710  13          
    RET                                 ;6711  c9          
                  ;
HEXHL:  PUSH    DE                      ;6712  d5          
    CALL    HEXCOV                      ;6713  cd 1a 67    
    XOR A                               ;6716  af          
    LD  (DE),A                          ;6717  12          
    POP DE                              ;6718  d1          
    RET                                 ;6719  c9          
                  ;
HEXCOV: LD  A,H                         ;671a  7c          
    CALL    HEXACC                      ;671b  cd 1f 67    
    LD  A,L                             ;671e  7d          
HEXACC: PUSH    AF                      ;671f  f5          
    RRCA                                ;6720  0f          
    RRCA                                ;6721  0f          
    RRCA                                ;6722  0f          
    RRCA                                ;6723  0f          
    AND 00Fh                            ;6724  e6 0f       
    CALL    HEXHLF                      ;6726  cd 2c 67    
    POP AF                              ;6729  f1          
    AND 00Fh                            ;672a  e6 0f       
HEXHLF: ADD A,030h                      ;672c  c6 30       
    CP  03Ah                            ;672e  fe 3a       
    JR  C,SKIUTO                        ;6730  38 02       
    ADD A,007h                          ;6732  c6 07       
SKIUTO: LD  (DE),A                      ;6734  12          
    INC DE                              ;6735  13          
    RET                                 ;6736  c9          
                  ;
CTBL1:  DEFM    'GOT'                   ;6737  47 4f 54    ;GOTO		81H
    DEFB    'O'+080H                    ;673a  cf          
    DEFM    'GOSU'                      ;673b  47 4f 53 55 ;GOSUB
    DEFB    'B'+080H                    ;673f  c2          
    DEFM    'RU'                        ;6740  52 55       ;RUN
    DEFB    'N'+080H                    ;6742  ce          
    DEFM    'RETUR'                     ;6743  52 45 54 55 ;RETURN
                                        ;6747  52           17126  17146
    DEFB    'N'+080H                    ;6748  ce          
    DEFM    'RESTOR'                    ;6749  52 45 53 54 ;RESTORE
                                        ;674d  4f 52        17128  17149
    DEFB    'E'+080H                    ;674f  c5          
    DEFM    'LIS'                       ;6750  4c 49 53    ;LIST
    DEFB    'T'+080H                    ;6753  d4          
    DEFM    'LIST#'                     ;6754  4c 49 53 54 ;LIST#1
                                        ;6758  23           17132  17154
    DEFB    '1'+080H                    ;6759  b1          
    DEFM    'AUT'                       ;675a  41 55 54    ;AUTO
    DEFB    'O'+080H                    ;675d  cf          
    DEFM    'DELET'                     ;675e  44 45 4c 45 ;DELETE
                                        ;6762  54           17136  17159
    DEFB    'E'+080H                    ;6763  c5          
    DEFM    'FO'                        ;6764  46 4f       ;FOR
    DEFB    'R'+080H                    ;6766  d2          
    DEFM    'NEX'                       ;6767  4e 45 58    ;NEXT
    DEFB    'T'+080H                    ;676a  d4          
    DEFM    'PRIN'                      ;676b  50 52 49 4e ;PRINT
    DEFB    'T'+080H                    ;676f  d4          
    DEFM    'INPU'                      ;6770  49 4e 50 55 ;INPUT
    DEFB    'T'+080H                    ;6774  d4          
    DEFM    'I'                         ;6775  49          ;IF
    DEFB    'F'+080H                    ;6776  c6          
    DEFM    'DAT'                       ;6777  44 41 54    ;DATA
    DEFB    'A'+080H                    ;677a  c1          
    DEFM    'REA'                       ;677b  52 45 41    ;READ		90H
    DEFB    'D'+080H                    ;677e  c4          
    DEFM    'DI'                        ;677f  44 49       ;DIM
    DEFB    'M'+080H                    ;6781  cd          
    DEFM    'RE'                        ;6782  52 45       ;REM
    DEFB    'M'+080H                    ;6784  cd          
    DEFM    'EDI'                       ;6785  45 44 49    ;EDIT
    DEFB    'T'+080H                    ;6788  d4          
    DEFM    'STO'                       ;6789  53 54 4f    ;STOP
    DEFB    'P'+080H                    ;678c  d0          
    DEFM    'CON'                       ;678d  43 4f 4e    ;CONT
    DEFB    'T'+080H                    ;6790  d4          
    DEFM    'CL'                        ;6791  43 4c       ;CLS
    DEFB    'S'+080H                    ;6793  d3          
    DEFM    'CLEA'                      ;6794  43 4c 45 41 ;CLEAR
    DEFB    'R'+080H                    ;6798  d2          
    DEFM    'O'                         ;6799  4f          ;ON
    DEFB    'N'+080H                    ;679a  ce          
    DEFM    'LE'                        ;679b  4c 45       ;LET
    DEFB    'T'+080H                    ;679d  d4          
    DEFM    'NE'                        ;679e  4e 45       ;NEW
    DEFB    'W'+080H                    ;67a0  d7          
    DEFM    'POK'                       ;67a1  50 4f 4b    ;POKE
    DEFB    'E'+080H                    ;67a4  c5          
    DEFM    'OF'                        ;67a5  4f 46       ;OFF
    DEFB    'F'+080H                    ;67a7  c6          
    DEFM    'WHIL'                      ;67a8  57 48 49 4c ;WHILE
    DEFB    'E'+080H                    ;67ac  c5          
    DEFM    'WEN'                       ;67ad  57 45 4e    ;WEND
    DEFB    'D'+080H                    ;67b0  c4          
    DEFM    'REPEA'                     ;67b1  52 45 50 45 ;REPEAT
                                        ;67b5  41           17180  17204
    DEFB    'T'+080H                    ;67b6  d4          
    DEFM    'UNTI'                      ;67b7  55 4e 54 49 ;UNTIL		A0
    DEFB    'L'+080H                    ;67bb  cc          
    DEFM    'TRAC'                      ;67bc  54 52 41 43 ;TRACE
    DEFB    'E'+080H                    ;67c0  c5          
    DEFM    'EN'                        ;67c1  45 4e       ;END
    DEFB    'D'+080H                    ;67c3  c4          
    DEFM    'PLA'                       ;67c4  50 4c 41    ;PLAY
    DEFB    'Y'+080H                    ;67c7  d9          
    DEFM    'BEE'                       ;67c8  42 45 45    ;BEEP
    DEFB    'P'+080H                    ;67cb  d0          
    DEFM    'DEFIN'                     ;67cc  44 45 46 49 ;DEFINT
                                        ;67d0  4e           17192  17217
    DEFB    'T'+080H                    ;67d1  d4          
    DEFM    'DEFSN'                     ;67d2  44 45 46 53 ;DEFSNG
                                        ;67d6  4e           17194  17220
    DEFB    'G'+080H                    ;67d7  c7          
    DEFM    'DEFDB'                     ;67d8  44 45 46 44 ;DEFDBL
                                        ;67dc  42           17196  17223
    DEFB    'L'+080H                    ;67dd  cc          
    DEFM    'DEFST'                     ;67de  44 45 46 53 ;DEFST
                                        ;67e2  54           17198  17226
    DEFB    'R'+080H                    ;67e3  d2          
    DEFM    'DE'                        ;67e4  44 45       ;DEF
    DEFB    'F'+080H                    ;67e6  c6          
    DEFM    'DUM'                       ;67e7  44 55 4d    ;DUMP
    DEFB    'P'+080H                    ;67ea  d0          
    DEFM    'LOA'                       ;67eb  4c 4f 41    ;LOAD
    DEFB    'D'+080H                    ;67ee  c4          
    DEFM    'SAV'                       ;67ef  53 41 56    ;SAVE
    DEFB    'E'+080H                    ;67f2  c5          
    DEFM    'MERG'                      ;67f3  4d 45 52 47 ;MERGE
    DEFB    'E'+080H                    ;67f7  c5          
    DEFB    080H                        ;67f8  80          ;DEFM 'CONSO'
                                        ;                  ;DEFB	'L'+080H
    DEFM    'OU'                        ;67f9  4f 55       ;OUT
    DEFB    'T'+080H                    ;67fb  d4          
    DEFM    'SEARC'                     ;67fc  53 45 41 52 ;SEARCH 	B0
                                        ;6800  43           17214  17243
    DEFB    'H'+080H                    ;6801  c8          
    DEFM    'SOUN'                      ;6802  53 4f 55 4e ;SOUND
    DEFB    'D'+080H                    ;6806  c4          
    DEFB    080H                        ;6807  80          
    DEFM    'SWA'                       ;6808  53 57 41    ;SWAP
    DEFB    'P'+080H                    ;680b  d0          
    DEFB    080H                        ;680c  80          ;DEFM 'ERAS'
    DEFM    'ERRO'                      ;680d  45 52 52 4f ;ERROR
    DEFB    'R'+080H                    ;6811  d2          
    DEFM    'RESUM'                     ;6812  52 45 53 55 ;RESUME
                                        ;6816  4d           17224  17254
    DEFB    'E'+080H                    ;6817  c5          
    DEFM    'RENU'                      ;6818  52 45 4e 55 ;RENUM
    DEFB    'M'+080H                    ;681c  cd          
    DEFM    'ELS'                       ;681d  45 4c 53    ;ELSE
    DEFB    'E'+080H                    ;6820  c5          
    DEFM    'CAL'                       ;6821  43 41 4c    ;CALL
    DEFB    'L'+080H                    ;6824  cc          
    DEFM    'LOCAT'                     ;6825  4c 4f 43 41 ;LOCATE
                                        ;6829  54           17232  17263
    DEFB    'E'+080H                    ;682a  c5          
    DEFB    080H                        ;682b  80          ;DEFM 'MA'	;MAT
                                        ;                  ;DEFB	'T'+080H
    DEFM    'MO'                        ;682c  4d 4f       ;MON
    DEFB    'N'+080H                    ;682e  ce          
    DEFM    'HCOP'                      ;682f  48 43 4f 50 ;HCOPY
    DEFB    'Y'+080H                    ;6833  d9          
    DEFM    'KE'                        ;6834  4b 45       ;KEY
    DEFB    'Y'+080H                    ;6836  d9          
    DEFM    'PUS'                       ;6837  50 55 53    ;PUSH
    DEFB    'H'+080H                    ;683a  c8          
    DEFM    'PO'                        ;683b  50 4f       ;POP		C0
    DEFB    'P'+080H                    ;683d  d0          
    DEFB    080H                        ;683e  80          ;DEFM	'BAS'
    DEFM    'LABE'                      ;683f  4c 41 42 45 ;LABEL
    DEFB    'L'+080H                    ;6843  cc          
    DEFB    080H                        ;6844  80          ;DEFM	'RANDOMIZ'
    DEFM    'SCREE'                     ;6845  53 43 52 45 ;SCREEN
                                        ;6849  45           17250  17282
    DEFB    'N'+080H                    ;684a  ce          
    DEFM    'LIN'                       ;684b  4c 49 4e    ;LINE
    DEFB    'E'+080H                    ;684e  c5          
    DEFM    'COLO'                      ;684f  43 4f 4c 4f ;COLOR
    DEFB    'R'+080H                    ;6853  d2          
    DEFM    'PSE'                       ;6854  50 53 45    ;PSET
    DEFB    'T'+080H                    ;6857  d4          
    DEFM    'PRESE'                     ;6858  50 52 45 53 ;PRESET
                                        ;685c  45           17258  17291
    DEFB    'T'+080H                    ;685d  d4          
    DEFM    'CGINI'                     ;685e  43 47 49 4e ;CGINIT
                                        ;6862  49           17260  17294
    DEFB    'T'+080H                    ;6863  d4          
    DEFM    'PATTER'                    ;6864  50 41 54 54 ;PATTERN
                                        ;6868  45 52        17262  17297
    DEFB    'N'+080H                    ;686a  ce          
    DEFM    'CIRCL'                     ;686b  43 49 52 43 ;CIRCLE
                                        ;686f  4c           17264  17300
    DEFB    'E'+080H                    ;6870  c5          
    DEFM    'PAIN'                      ;6871  50 41 49 4e ;PAINT
    DEFB    'T'+080H                    ;6875  d4          
    DEFM    'ROPE'                      ;6876  52 4f 50 45 ;ROPEN
    DEFB    'N'+080H                    ;687a  ce          
    DEFM    'WOPE'                      ;687b  57 4f 50 45 ;WOPEN
    DEFB    'N'+080H                    ;687f  ce          
    DEFM    'CLOS'                      ;6880  43 4c 4f 53 ;CLOSE
    DEFB    'E'+080H                    ;6884  c5          
    DEFB    080H                        ;6885  80          ;DEFM	'FILED'
    DEFB    080H                        ;6886  80          ;DEFM	'GET'
    DEFB    080H                        ;6887  80          ;DEFM	'PUT'
    DEFB    080H                        ;6888  80          ;DEFM	'SET'
    DEFB    080H                        ;6889  80          ;DEFM	'FILES'
    DEFB    080H                        ;688a  80          ;DEFM	'RENAME'
    DEFB    080H                        ;688b  80          ;DEFM	'KILL'
    DEFB    080H                        ;688c  80          ;DEFM	'LSET'
    DEFB    080H                        ;688d  80          ;DEFM	'RSET'
    DEFB    080H                        ;688e  80          ;DEFM	'FORMAT
    DEFB    080H                        ;688f  80          ;DEFM	'INIT'
    DEFB    080H                        ;6890  80          ;EDFM	'CHAIN
    DEFB    080H                        ;6891  80          ;DEFM	'PEN'
    DEFB    080H                        ;6892  80          ;DEFM	'COM'
    DEFB    080H                        ;6893  80          ;DEFM	'PAUSE'
    DEFM    'T'                         ;6894  54          ;TO
    DEFB    'O'+080H                    ;6895  cf          
    DEFM    'STE'                       ;6896  53 54 45    ;STEP
    DEFB    'P'+080H                    ;6899  d0          
    DEFM    'THE'                       ;689a  54 48 45    ;THEN
    DEFB    'N'+080H                    ;689d  ce          
    DEFM    'USIN'                      ;689e  55 53 49 4e ;USING
    DEFB    'G'+080H                    ;68a2  c7          
    DEFB    080H                        ;68a3  80          
    DEFB    080H                        ;68a4  80          
    DEFB    080H                        ;68a5  80          
    DEFB    080H                        ;68a6  80          
    DEFM    'TA'                        ;68a7  54 41       ;TAB
    DEFB    'B'+080H                    ;68a9  c2          
    DEFM    'SP'                        ;68aa  53 50       ;SPC
    DEFB    'C'+080H                    ;68ac  c3          
    DEFB    080H                        ;68ad  80          
    DEFB    080H                        ;68ae  80          
    DEFM    'XO'                        ;68af  58 4f       ;XOR
    DEFB    'R'+080H                    ;68b1  d2          
    DEFM    'O'                         ;68b2  4f          ;OR
    DEFB    'R'+080H                    ;68b3  d2          
    DEFM    'AN'                        ;68b4  41 4e       ;AND
    DEFB    'D'+080H                    ;68b6  c4          
    DEFM    'NO'                        ;68b7  4e 4f       ;NOT
    DEFB    'T'+080H                    ;68b9  d4          
    DEFB    '>'                         ;68ba  3e          ;><
    DEFB    '<'+080H                    ;68bb  bc          
    DEFB    '<'                         ;68bc  3c          ;<>
    DEFB    '>'+080H                    ;68bd  be          
    DEFM    '='                         ;68be  3d          ;=<
    DEFB    '<'+080H                    ;68bf  bc          
    DEFM    '='                         ;68c0  3d          ;=>
    DEFB    '>'+080H                    ;68c1  be          
    DEFB    '<'                         ;68c2  3c          ;<=
    DEFB    '='+080H                    ;68c3  bd          
    DEFB    '>'                         ;68c4  3e          ;><
    DEFB    '='+080H                    ;68c5  bd          ;=    
    DEFB    '='+080H                    ;68c6  bd          ;=
    DEFB    '>'+080H                    ;68c7  be          ;>
    DEFB    '<'+080H                    ;68c8  bc          ;<
    DEFB    '+'+080H                    ;68c9  ab          ;+
    DEFB    '-'+080H                    ;68ca  ad          ;-
    DEFM    'MO'                        ;68cb  4d 4f       ;MOD
    DEFB    'D'+080H                    ;68cd  c4          
    DEFB    0FCH                        ;68ce  fc          ;\
    DEFB    '/'+080H                    ;68cf  af          ;/
    DEFB    '*'+080H                    ;68d0  aa          ;*
    DEFB    '^'+080H                    ;68d1  de          ;^
    DEFB    0FFH                        ;68d2  ff          ;예약어 끝을 의미하는 DELIMETER
                  
CTBL2:                                  ;                  
    DEFM    'IN'                        ;68d3  49 4e       ;81H INT
    DEFB    'T'+080H                    ;68d5  d4          
    DEFM    'AB'                        ;68d6  41 42       ;ABS
    DEFB    'S'+080H                    ;68d8  d3          
    DEFM    'SI'                        ;68d9  53 49       ;SIN
    DEFB    'N'+080H                    ;68db  ce          
    DEFM    'CO'                        ;68dc  43 4f       ;COS
    DEFB    'S'+080H                    ;68de  d3          
    DEFM    'TA'                        ;68df  54 41       ;TAN
    DEFB    'N'+080H                    ;68e1  ce          
    DEFM    'LO'                        ;68e2  4c 4f       ;LOG
    DEFB    'G'+080H                    ;68e4  c7          
    DEFM    'EX'                        ;68e5  45 58       ;EXP
    DEFB    'P'+080H                    ;68e7  d0          
    DEFM    'SQ'                        ;68e8  53 51       ;SQR
    DEFB    'R'+080H                    ;68ea  d2          
    DEFM    'RN'                        ;68eb  52 4e       ;RND
    DEFB    'D'+080H                    ;68ed  c4          
    DEFM    'PEE'                       ;68ee  50 45 45    ;PEEK
    DEFB    'K'+080H                    ;68f1  cb          
    DEFM    'AT'                        ;68f2  41 54       ;ATN
    DEFB    'N'+080H                    ;68f4  ce          
    DEFM    'SG'                        ;68f5  53 47       ;SGN
    DEFB    'N'+080H                    ;68f7  ce          
    DEFM    'FRA'                       ;68f8  46 52 41    ;FRAC
    DEFB    'C'+080H                    ;68fb  c3          
    DEFM    'FI'                        ;68fc  46 49       ;FIX
    DEFB    'X'+080H                    ;68fe  d8          
    DEFM    'PA'                        ;68ff  50 41       ;PAI
    DEFB    'I'+080H                    ;6901  c9          
    DEFM    'RA'                        ;6902  52 41       ;RAD	90H
    DEFB    'D'+080H                    ;6904  c4          
    DEFM    'IN'                        ;6905  49 4e       ;INP
    DEFB    'P'+080H                    ;6907  d0          
    DEFM    'CDB'                       ;6908  43 44 42    ;CDBL
    DEFB    'L'+080H                    ;690b  cc          
    DEFM    'CSN'                       ;690c  43 53 4e    ;CSNG
    DEFB    'G'+080H                    ;690f  c7          
    DEFM    'CIN'                       ;6910  43 49 4e    ;CINT
    DEFB    'T'+080H                    ;6913  d4          
    DEFB    080H                        ;6914  80          ;DEFM	'DSK'	;DSKF
    DEFB    080H                        ;6915  80          ;DEFM	'EO'	;EOF
    DEFB    080H                        ;6916  80          ;DEFM	'FPO'	;FPOS
    DEFB    080H                        ;6917  80          ;DEFM	'LO'	;LOC
    DEFB    080H                        ;6918  80          ;DEFM	'LO'	;LOF
    DEFM    'PO'                        ;6919  50 4f       ;POS
    DEFB    'S'+080H                    ;691b  d3          
    DEFM    'LPO'                       ;691c  4c 50 4f    ;LPOS
    DEFB    'S'+080H                    ;691f  d3          
    DEFM    'FA'                        ;6920  46 41       ;FAC
    DEFB    'C'+080H                    ;6922  c3          
    DEFM    'SU'                        ;6923  53 55       ;SUM
    DEFB    'M'+080H                    ;6925  cd          
    DEFB    080H                        ;6926  80          ;DEFM	'RE'	;REV
    DEFB    080H                        ;6927  80          ;DUMMY
    DEFM    'CHR'                       ;6928  43 48 52    ;CHR$	A0
    DEFB    '$'+080H                    ;692b  a4          
    DEFM    'STR'                       ;692c  53 54 52    ;STR$
    DEFB    '$'+080H                    ;692f  a4          
    DEFM    'HEX'                       ;6930  48 45 58    ;HEX$
    DEFB    '$'+080H                    ;6933  a4          
    DEFM    'OCT'                       ;6934  4f 43 54    ;OCT$
    DEFB    '$'+080H                    ;6937  a4          
    DEFM    'MKI'                       ;6938  4d 4b 49    ;MKI$
    DEFB    '$'+080H                    ;693b  a4          
    DEFM    'MKS'                       ;693c  4d 4b 53    ;MKS$
    DEFB    '$'+080H                    ;693f  a4          
    DEFM    'MKD'                       ;6940  4d 4b 44    ;MKD$
    DEFB    '$'+080H                    ;6943  a4          
    DEFM    'SPACE'                     ;6944  53 50 41 43 ;SPACE$
                                        ;6948  45           17410  17447
    DEFB    '$'+080H                    ;6949  a4          
    DEFB    080H                        ;694a  80          ;DUMMY
    DEFM    'AS'                        ;694b  41 53       ;ASC	A9
    DEFB    'C'+080H                    ;694d  c3          
    DEFM    'LE'                        ;694e  4c 45       ;LEN
    DEFB    'N'+080H                    ;6950  ce          
    DEFM    'VA'                        ;6951  56 41       ;VAL
    DEFB    'L'+080H                    ;6953  cc          
    DEFM    'CV'                        ;6954  43 56       ;CVS
    DEFB    'S'+080H                    ;6956  d3          
    DEFM    'CV'                        ;6957  43 56       ;CVD
    DEFB    'D'+080H                    ;6959  c4          
    DEFM    'CV'                        ;695a  43 56       ;CVI
    DEFB    'I'+080H                    ;695c  c9          
    DEFM    'STA'                       ;695d  53 54 41    ;STAT
    DEFB    'T'+080H                    ;6960  d4          
    DEFM    'PA'                        ;6961  50 41       ;PAR(ITY)	B0H
    DEFB    'R'+080H                    ;6963  d2          
    DEFB    080H                        ;6964  80          ;DUMMY B1H
    DEFM    'LEFT'                      ;6965  4c 45 46 54 ;LEFT$
    DEFB    '$'+080H                    ;6969  a4          
    DEFM    'RIGHT'                     ;696a  52 49 47 48 ;RIGHT$
                                        ;696e  54           17432  17470
    DEFB    '$'+080H                    ;696f  a4          
    DEFM    'MID'                       ;6970  4d 49 44    ;MID$
    DEFB    '$'+080H                    ;6973  a4          
    DEFM    'INKEY'                     ;6974  49 4e 4b 45 ;INKEY$
                                        ;6978  59           17436  17475
    DEFB    '$'+080H                    ;6979  a4          
    DEFM    'INST'                      ;697a  49 4e 53 54 ;INSTR
    DEFB    'R'+080H                    ;697e  d2          
    DEFM    'FR'                        ;697f  46 52       ;FRE
    DEFB    'E'+080H                    ;6981  c5          
    DEFM    'MEM'                       ;6982  4d 45 4d    ;MEM$
    DEFB    '$'+080H                    ;6985  a4          
    DEFM    'SCRN'                      ;6986  53 43 52 4e ;SCRN$
    DEFB    '$'+080H                    ;698a  a4          
    DEFM    'VARPT'                     ;698b  56 41 52 50 ;VARPTR
                                        ;698f  54           17446  17486
    DEFB    'R'+080H                    ;6990  d2          
    DEFM    'STRING'                    ;6991  53 54 52 49 ;STRING$
                                        ;6995  4e 47        17448  17489
    DEFB    '$'+080H                    ;6997  a4          
    DEFB    080H                        ;6998  80          ;DEFM	'TIME'
    DEFM    'F'                         ;6999  46          ;FN
    DEFB    'N'+080H                    ;699a  ce          
    DEFM    'US'                        ;699b  55 53       ;USR
    DEFB    'R'+080H                    ;699d  d2          
    DEFM    'ER'                        ;699e  45 52       ;ERR
    DEFB    'R'+080H                    ;69a0  d2          
    DEFM    'ER'                        ;69a1  45 52       ;ERL
    DEFB    'L'+080H                    ;69a3  cc          
    DEFM    'CSRLI'                     ;69a4  43 53 52 4c ;CSRLIN
                                        ;69a8  49           17459  17501
    DEFB    'N'+080H                    ;69a9  ce          
    DEFB    0FFH                        ;69aa  ff          
                  ;
FIVEBF: DEFS    6                       ;69ab              
    DEFB    000H                        ;69b1  00          
                  ;
                  ;	ORG	069B2H
$ERTXT:                                 ;                  
ERRTXT:                                 ;                  
    DEFB    000H                        ;69b2  00          
    DEFM    'NEXT WITHOUT FOR'          ;69b3  4e 45 58 54 
                                        ;69b7  20 57 49 54  17470  17513
                                        ;69bb  48 4f 55 54  17470  17514
                                        ;69bf  20 46 4f 52  17470  17515
                  
    DEFB    000H                        ;69c3  00          
    DEFM    'SYNTAX ERROR'              ;69c4  53 59 4e 54 
                                        ;69c8  41 58 20 45  17473  17519
                                        ;69cc  52 52 4f 52  17473  17520
                  
    DEFB    000H                        ;69d0  00          
    DEFM    'RETURN WITHOUT GOSUB'      ;69d1  52 45 54 55 
                                        ;69d5  52 4e 20 57  17476  17524
                                        ;69d9  49 54 48 4f  17476  17525
                                        ;69dd  55 54 20 47  17476  17526
                                        ;69e1  4f 53 55 42  17476  17527
                  
    DEFB    000H                        ;69e5  00          
    DEFM    'OUT OF DATA'               ;69e6  4f 55 54 20 
                                        ;69ea  4f 46 20 44  17479  17531
                                        ;69ee  41 54 41     17479  17532
                  
    DEFB    000H                        ;69f1  00          
    DEFM    'ILLEGAL FUNCTION CALL'     ;69f2  49 4c 4c 45 
                                        ;69f6  47 41 4c 20  17482  17536
                                        ;69fa  46 55 4e 43  17482  17537
                                        ;69fe  54 49 4f 4e  17482  17538
                                        ;6a02  20 43 41 4c  17482  17539
                                        ;6a06  4c           17482  17540
                  
    DEFB    000H                        ;6a07  00          
    DEFM    'OVERFLOW'                  ;6a08  4f 56 45 52 
                                        ;6a0c  46 4c 4f 57  17485  17544
                  
    DEFB    000H                        ;6a10  00          
    DEFM    'OUT OF MEMORY'             ;6a11  4f 55 54 20 
                                        ;6a15  4f 46 20 4d  17488  17548
                                        ;6a19  45 4d 4f 52  17488  17549
                                        ;6a1d  59           17488  17550
                  
    DEFB    000H                        ;6a1e  00          
UDLMES:                                 ;                  
    DEFM    'UNDEFINED LINE NUMBER'     ;6a1f  55 4e 44 45 
                                        ;6a23  46 49 4e 45  17492  17555
                                        ;6a27  44 20 4c 49  17492  17556
                                        ;6a2b  4e 45 20 4e  17492  17557
                                        ;6a2f  55 4d 42 45  17492  17558
                                        ;6a33  52           17492  17559
                  
    DEFB    000H                        ;6a34  00          
    DEFM    'SUBSCRIPT OUT OF RANGE'    ;6a35  53 55 42 53 
                                        ;6a39  43 52 49 50  17495  17563
                                        ;6a3d  54 20 4f 55  17495  17564
                                        ;6a41  54 20 4f 46  17495  17565
                                        ;6a45  20 52 41 4e  17495  17566
                                        ;6a49  47 45        17495  17567
                  
    DEFB    000H                        ;6a4b  00          
    DEFM    'DUPLICATE DEFINITION'      ;6a4c  44 55 50 4c 
                                        ;6a50  49 43 41 54  17498  17571
                                        ;6a54  45 20 44 45  17498  17572
                                        ;6a58  46 49 4e 49  17498  17573
                                        ;6a5c  54 49 4f 4e  17498  17574
                  
    DEFB    000H                        ;6a60  00          
    DEFM    'DIVISION BY ZERO'          ;6a61  44 49 56 49 
                                        ;6a65  53 49 4f 4e  17501  17578
                                        ;6a69  20 42 59 20  17501  17579
                                        ;6a6d  5a 45 52 4f  17501  17580
                  
    DEFB    000H                        ;6a71  00          
    DEFM    'ILLEGAL DIRECT'            ;6a72  49 4c 4c 45 
                                        ;6a76  47 41 4c 20  17504  17584
                                        ;6a7a  44 49 52 45  17504  17585
                                        ;6a7e  43 54        17504  17586
                  
    DEFB    000H                        ;6a80  00          
    DEFM    'TYPE MISMATCH'             ;6a81  54 59 50 45 
                                        ;6a85  20 4d 49 53  17507  17590
                                        ;6a89  4d 41 54 43  17507  17591
                                        ;6a8d  48           17507  17592
                  
    DEFB    000H                        ;6a8e  00          
    DEFM    'HUBASIC'                   ;6a8f  48 55 42 41 
                                        ;6a93  53 49 43     17510  17596
                  
    DEFB    000H                        ;6a96  00          
    DEFM    'STRING TOO LONG'           ;6a97  53 54 52 49 
                                        ;6a9b  4e 47 20 54  17513  17600
                                        ;6a9f  4f 4f 20 4c  17513  17601
                                        ;6aa3  4f 4e 47     17513  17602
                  
    DEFB    000H                        ;6aa6  00          
    DEFM    'EXPRESSION TOO COMPLEX'    ;6aa7  45 58 50 52 
                                        ;6aab  45 53 53 49  17516  17606
                                        ;6aaf  4f 4e 20 54  17516  17607
                                        ;6ab3  4f 4f 20 43  17516  17608
                                        ;6ab7  4f 4d 50 4c  17516  17609
                                        ;6abb  45 58        17516  17610
                                        ;                  
    DEFB    000H                        ;6abd  00          
    DEFM    'CAN\'T CONTINUE'           ;6abe  43 41 4e 27 
                                        ;6ac2  54 20 43 4f  17519  17614
                                        ;6ac6  4e 54 49 4e  17519  17615
                                        ;6aca  55 45        17519  17616
                  
    DEFB    000H                        ;6acc  00          
    DEFM    'UNDEFINED USER FUNCTION'   ;6acd  55 4e 44 45 
                                        ;6ad1  46 49 4e 45  17522  17620
                                        ;6ad5  44 20 55 53  17522  17621
                                        ;6ad9  45 52 20 46  17522  17622
                                        ;6add  55 4e 43 54  17522  17623
                                        ;6ae1  49 4f 4e     17522  17624
                  
    DEFB    000H                        ;6ae4  00          
    DEFM    'NO RESUME'                 ;6ae5  4e 4f 20 52 
                                        ;6ae9  45 53 55 4d  17525  17628
                                        ;6aed  45           17525  17629
                  
    DEFB    000H                        ;6aee  00          
    DEFM    'RESUME WITHOUT ERROR'      ;6aef  52 45 53 55 
                                        ;6af3  4d 45 20 57  17528  17633
                                        ;6af7  49 54 48 4f  17528  17634
                                        ;6afb  55 54 20 45  17528  17635
                                        ;6aff  52 52 4f 52  17528  17636
                  
    DEFB    000H                        ;6b03  00          
    DEFM    'FORMAT OVER'               ;6b04  46 4f 52 4d 
                                        ;6b08  41 54 20 4f  17531  17640
                                        ;6b0c  56 45 52     17531  17641
                  
    DEFB    000H                        ;6b0f  00          
    DEFM    'MISSING OPERAND'           ;6b10  4d 49 53 53 
                                        ;6b14  49 4e 47 20  17534  17645
                                        ;6b18  4f 50 45 52  17534  17646
                                        ;6b1c  41 4e 44     17534  17647
                  
    DEFB    000H                        ;6b1f  00          
    DEFM    'REPEAT WITHOUT UNTIL'      ;6b20  52 45 50 45 
                                        ;6b24  41 54 20 57  17537  17651
                                        ;6b28  49 54 48 4f  17537  17652
                                        ;6b2c  55 54 20 55  17537  17653
                                        ;6b30  4e 54 49 4c  17537  17654
                  
    DEFB    000H                        ;6b34  00          
    DEFM    'UNTIL WITHOUT REPEAT'      ;6b35  55 4e 54 49 
                                        ;6b39  4c 20 57 49  17540  17658
                                        ;6b3d  54 48 4f 55  17540  17659
                                        ;6b41  54 20 52 45  17540  17660
                                        ;6b45  50 45 41 54  17540  17661
                  
    DEFB    000H                        ;6b49  00          
    DEFM    'WHILE WITHOUT WEND'        ;6b4a  57 48 49 4c 
                                        ;6b4e  45 20 57 49  17543  17665
                                        ;6b52  54 48 4f 55  17543  17666
                                        ;6b56  54 20 57 45  17543  17667
                                        ;6b5a  4e 44        17543  17668
                  
    DEFB    000H                        ;6b5c  00          
    DEFM    'WEND WITHOUT WHILE'        ;6b5d  57 45 4e 44 
                                        ;6b61  20 57 49 54  17546  17672
                                        ;6b65  48 4f 55 54  17546  17673
                                        ;6b69  20 57 48 49  17546  17674
                                        ;6b6d  4c 45        17546  17675
                  
    DEFB    000H                        ;6b6f  00          
    DEFM    'TAPE READ ERROR'           ;6b70  54 41 50 45 
                                        ;6b74  20 52 45 41  17549  17679
                                        ;6b78  44 20 45 52  17549  17680
                                        ;6b7c  52 4f 52     17549  17681
                  
    DEFB    000H                        ;6b7f  00          
    DEFM    'DEVICE UNAVAILABLE'        ;6b80  44 45 56 49 
                                        ;6b84  43 45 20 55  17552  17685
                                        ;6b88  4e 41 56 41  17552  17686
                                        ;6b8c  49 4c 41 42  17552  17687
                                        ;6b90  4c 45        17552  17688
                  
    DEFB    000H                        ;6b92  00          
    DEFM    'STATEMENT NOT INSTALL'     ;6b93  53 54 41 54 
                                        ;6b97  45 4d 45 4e  17555  17692
                                        ;6b9b  54 20 4e 4f  17555  17693
                                        ;6b9f  54 20 49 4e  17555  17694
                                        ;6ba3  53 54 41 4c  17555  17695
                                        ;6ba7  4c           17555  17696
                  
    DEFB    000H                        ;6ba8  00          
    DEFM    'STACK EMPTY'               ;6ba9  53 54 41 43 
                                        ;6bad  4b 20 45 4d  17558  17700
                                        ;6bb1  50 54 59     17558  17701
                  
    DEFB    000H                        ;6bb4  00          
    DEFM    'FILE ERROR'                ;6bb5  46 49 4c 45 
                                        ;6bb9  20 45 52 52  17561  17705
                                        ;6bbd  4f 52        17561  17706
                  
    DEFB    000H                        ;6bbf  00          
                  
                  ;	ORG	06BC0h
$FLOAT:                                 ;                  
B_ABS:                                  ;                  
RESNHL: INC HL                          ;6bc0  23          
    RES 7,(HL)                          ;6bc1  cb be       
    DEC HL                              ;6bc3  2b          
    RET                                 ;6bc4  c9          
                  ;
STROMT: LD  A,(IY+0)                    ;6bc5  fd 7e 00    
    CP  003h                            ;6bc8  fe 03       
    JP  Z,TYPEMS                        ;6bca  ca 32 17    
    RET                                 ;6bcd  c9          
                  ;
ONESUB: LD  DE,FLONE                    ;6bce  11 98 62    
SUB:    CALL    STROMT                  ;6bd1  cd c5 6b    
    CALL    TOGLE                       ;6bd4  cd eb 6b    
    CALL    ADD                         ;6bd7  cd a6 6c    
    PUSH    AF                          ;6bda  f5          
    CALL    TOGLE                       ;6bdb  cd eb 6b    
    XOR A                               ;6bde  af          
    CP  (HL)                            ;6bdf  be          
    JR  Z,ZERO3                         ;6be0  28 03       
    POP AF                              ;6be2  f1          
    CCF                                 ;6be3  3f          
    RET                                 ;6be4  c9          
                  ;
ZERO3:  POP AF                          ;6be5  f1          
    XOR A                               ;6be6  af          
    INC HL                              ;6be7  23          
    LD  (HL),A                          ;6be8  77          
    DEC HL                              ;6be9  2b          
    RET                                 ;6bea  c9          
                  
TOGLE:  INC HL                          ;6beb  23          
    LD  A,(HL)                          ;6bec  7e          
    XOR 080h                            ;6bed  ee 80       
    LD  (HL),A                          ;6bef  77          
    DEC HL                              ;6bf0  2b          
    RET                                 ;6bf1  c9          
                  ;
CONDM': PUSH    HL                      ;6bf2  e5          
    PUSH    DE                          ;6bf3  d5          
    JR  MIDCMZ                          ;6bf4  18 0f       
                  ;
CONDMZ: PUSH    HL                      ;6bf6  e5          
    PUSH    DE                          ;6bf7  d5          
    LD  E,(HL)                          ;6bf8  5e          
    INC HL                              ;6bf9  23          
    LD  D,(HL)                          ;6bfa  56          
    INC HL                              ;6bfb  23          
    OR  A                               ;6bfc  b7          
    SBC HL,DE                           ;6bfd  ed 52       
    JR  Z,MTCHPO                        ;6bff  28 03       
RTCDMZ: POP DE                          ;6c01  d1          
    POP HL                              ;6c02  e1          
    RET                                 ;6c03  c9          
                  ;
MTCHPO: EX  DE,HL                       ;6c04  eb          
MIDCMZ: LD  A,(HL)                      ;6c05  7e          
    OR  A                               ;6c06  b7          
    JR  Z,RTCDMZ                        ;6c07  28 f8       
    INC HL                              ;6c09  23          
    LD  E,(HL)                          ;6c0a  5e          
    INC HL                              ;6c0b  23          
    LD  D,(HL)                          ;6c0c  56          
    LD  HL,(STRTOP)                     ;6c0d  2a 41 7a    
    SBC HL,DE                           ;6c10  ed 52       
    JR  NC,RTCDMZ                       ;6c12  30 ed       
    EX  DE,HL                           ;6c14  eb          
    DEC HL                              ;6c15  2b          
    LD  (HL),0                          ;6c16  36 00       
    DEC HL                              ;6c18  2b          
    LD  (HL),A                          ;6c19  77          
    POP DE                              ;6c1a  d1          
    POP HL                              ;6c1b  e1          
    RET                                 ;6c1c  c9          
                  ;
STROVF: LD  A,15                        ;6c1d  3e 0f       
    JP  ERROR                           ;6c1f  c3 96 21    
                  ;
STRADE: POP DE                          ;6c22  d1          
    POP HL                              ;6c23  e1          
    CALL    CONDMZ                      ;6c24  cd f6 6b    
    PUSH    HL                          ;6c27  e5          
    PUSH    DE                          ;6c28  d5          
    LD  HL,ZFAC                         ;6c29  21 f2 62    
    CALL    LDIR8                       ;6c2c  cd a6 73    
    POP HL                              ;6c2f  e1          
    PUSH    HL                          ;6c30  e5          
    LD  E,L                             ;6c31  5d          
    LD  D,H                             ;6c32  54          
    INC DE                              ;6c33  13          
    INC DE                              ;6c34  13          
    LD  (HL),E                          ;6c35  73          
    INC HL                              ;6c36  23          
    LD  (HL),D                          ;6c37  72          
    EX  DE,HL                           ;6c38  eb          
    INC HL                              ;6c39  23          
    LD  E,(HL)                          ;6c3a  5e          
    INC HL                              ;6c3b  23          
    LD  D,(HL)                          ;6c3c  56          
    DEC HL                              ;6c3d  2b          
    DEC HL                              ;6c3e  2b          
    EX  DE,HL                           ;6c3f  eb          
    DEC HL                              ;6c40  2b          
    LD  (HL),D                          ;6c41  72          
    DEC HL                              ;6c42  2b          
    LD  (HL),E                          ;6c43  73          
SRADE': POP HL                          ;6c44  e1          
    POP DE                              ;6c45  d1          
    RET                                 ;6c46  c9          
                  ;
STRADD: PUSH    DE                      ;6c47  d5          
    PUSH    HL                          ;6c48  e5          
    LD  C,(HL)                          ;6c49  4e          
    INC HL                              ;6c4a  23          
    LD  B,(HL)                          ;6c4b  46          
    EX  DE,HL                           ;6c4c  eb          
    LD  E,(HL)                          ;6c4d  5e          
    INC HL                              ;6c4e  23          
    LD  D,(HL)                          ;6c4f  56          
    LD  L,C                             ;6c50  69          
    LD  H,B                             ;6c51  60          
    LD  A,(HL)                          ;6c52  7e          
    EX  AF,AF'                          ;6c53  08          
    LD  A,(DE)                          ;6c54  1a          
    ADD A,(HL)                          ;6c55  86          
    JR  C,STROVF                        ;6c56  38 c5       
    JR  Z,SRADE'                        ;6c58  28 ea       
    LD  HL,ZFAC                         ;6c5a  21 f2 62    
    CALL    CLRFAC                      ;6c5d  cd a9 28    
    PUSH    HL                          ;6c60  e5          
    PUSH    DE                          ;6c61  d5          
    LD  E,L                             ;6c62  5d          
    LD  D,H                             ;6c63  54          
    INC HL                              ;6c64  23          
    INC HL                              ;6c65  23          
    EX  DE,HL                           ;6c66  eb          
    LD  (HL),E                          ;6c67  73          
    INC HL                              ;6c68  23          
    LD  (HL),D                          ;6c69  72          
    EX  DE,HL                           ;6c6a  eb          
    LD  (HL),A                          ;6c6b  77          
    LD  E,L                             ;6c6c  5d          
    LD  D,H                             ;6c6d  54          
    EX  AF,AF'                          ;6c6e  08          
    PUSH    AF                          ;6c6f  f5          
    CALL    GETSTR                      ;6c70  cd 9e 2d    
    INC HL                              ;6c73  23          
    LD  A,(HL)                          ;6c74  7e          
    INC HL                              ;6c75  23          
    LD  H,(HL)                          ;6c76  66          
    LD  L,A                             ;6c77  6f          
    INC BC                              ;6c78  03          
    LD  A,(BC)                          ;6c79  0a          
    LD  E,A                             ;6c7a  5f          
    INC BC                              ;6c7b  03          
    LD  A,(BC)                          ;6c7c  0a          
    LD  D,A                             ;6c7d  57          
    POP AF                              ;6c7e  f1          
    OR  A                               ;6c7f  b7          
    JR  Z,NXTADS                        ;6c80  28 07       
    LD  B,A                             ;6c82  47          
FSTTRL: LD  A,(DE)                      ;6c83  1a          
    LD  (HL),A                          ;6c84  77          
    INC HL                              ;6c85  23          
    INC DE                              ;6c86  13          
    DJNZ    FSTTRL                      ;6c87  10 fa       
NXTADS: POP BC                          ;6c89  c1          
    LD  A,(BC)                          ;6c8a  0a          
    EX  AF,AF'                          ;6c8b  08          
    INC BC                              ;6c8c  03          
    LD  A,(BC)                          ;6c8d  0a          
    LD  E,A                             ;6c8e  5f          
    INC BC                              ;6c8f  03          
    LD  A,(BC)                          ;6c90  0a          
    LD  D,A                             ;6c91  57          
    EX  AF,AF'                          ;6c92  08          
    OR  A                               ;6c93  b7          
    JR  Z,STRADS                        ;6c94  28 07       
    LD  B,A                             ;6c96  47          
SNDTRL: LD  A,(DE)                      ;6c97  1a          
    LD  (HL),A                          ;6c98  77          
    INC HL                              ;6c99  23          
    INC DE                              ;6c9a  13          
    DJNZ    SNDTRL                      ;6c9b  10 fa       
STRADS: POP DE                          ;6c9d  d1          
    POP HL                              ;6c9e  e1          
    PUSH    HL                          ;6c9f  e5          
    CALL    CONDMZ                      ;6ca0  cd f6 6b    
    JP  STRADE                          ;6ca3  c3 22 6c    
                  ;
ADD:    LD  A,(IY+0)                    ;6ca6  fd 7e 00    
    CP  003h                            ;6ca9  fe 03       
    JR  Z,STRADD                        ;6cab  28 9a       
    PUSH    DE                          ;6cad  d5          
    PUSH    HL                          ;6cae  e5          
    INC HL                              ;6caf  23          
    LD  A,(HL)                          ;6cb0  7e          
    RLCA                                ;6cb1  07          
    JR  C,HMINS                         ;6cb2  38 0f       
    INC DE                              ;6cb4  13          
    LD  A,(DE)                          ;6cb5  1a          
    RLCA                                ;6cb6  07          
    JR  C,DMINS                         ;6cb7  38 2e       
    DEC DE                              ;6cb9  1b          
    DEC HL                              ;6cba  2b          
    CALL    FADD                        ;6cbb  cd fc 6c    
    POP HL                              ;6cbe  e1          
    POP DE                              ;6cbf  d1          
    JP  RESNHL                          ;6cc0  c3 c0 6b    
                  ;
HMINS:  LD  A,(DE)                      ;6cc3  1a          
    OR  A                               ;6cc4  b7          
    JR  Z,MINCR                         ;6cc5  28 0a       
    INC DE                              ;6cc7  13          
    LD  A,(DE)                          ;6cc8  1a          
    RLCA                                ;6cc9  07          
    JR  NC,HMDP                         ;6cca  30 0f       
    DEC DE                              ;6ccc  1b          
    DEC HL                              ;6ccd  2b          
    CALL    FADD                        ;6cce  cd fc 6c    
MINCR:  POP HL                          ;6cd1  e1          
    INC HL                              ;6cd2  23          
    LD  A,(HL)                          ;6cd3  7e          
    DEC HL                              ;6cd4  2b          
    OR  A                               ;6cd5  b7          
    JR  Z,MZRT                          ;6cd6  28 01       
    SCF                                 ;6cd8  37          
MZRT:   POP DE                          ;6cd9  d1          
    RET                                 ;6cda  c9          
                  ;
HMDP:   DEC DE                          ;6cdb  1b          
    DEC HL                              ;6cdc  2b          
    CALL    FSUB                        ;6cdd  cd 04 6e    
    POP HL                              ;6ce0  e1          
    JR  C,MZRT                          ;6ce1  38 f6       
    POP DE                              ;6ce3  d1          
    JP  RESNHL                          ;6ce4  c3 c0 6b    
                  ;
DMINS:  DEC DE                          ;6ce7  1b          
    DEC HL                              ;6ce8  2b          
    CALL    FSUB                        ;6ce9  cd 04 6e    
    POP HL                              ;6cec  e1          
    JR  NC,OKM                          ;6ced  30 06       
    CALL    RESNHL                      ;6cef  cd c0 6b    
ZRO:    POP DE                          ;6cf2  d1          
    OR  A                               ;6cf3  b7          
    RET                                 ;6cf4  c9          
                  
OKM:    XOR A                           ;6cf5  af          
    CP  (HL)                            ;6cf6  be          
    JR  Z,ZRO                           ;6cf7  28 f9       
    POP DE                              ;6cf9  d1          
    SCF                                 ;6cfa  37          
    RET                                 ;6cfb  c9          
                  ;
FADD:   LD  A,0B7h                      ;6cfc  3e b7       
    LD  (INST1),A                       ;6cfe  32 7c 6d    
    BIT 2,(IY+0)                        ;6d01  fd cb 00 56 
    JP  NZ,SFADD                        ;6d05  c2 ea 6e    
    XOR A                               ;6d08  af          
    CP  (HL)                            ;6d09  be          
    JP  Z,TRANS                         ;6d0a  ca cf 6e    
    LD  A,(DE)                          ;6d0d  1a          
    OR  A                               ;6d0e  b7          
    RET Z                               ;6d0f  c8          
    SUB (HL)                            ;6d10  96          
    JR  NC,ANSHIF                       ;6d11  30 0b       
    NEG                                 ;6d13  ed 44       
    CP  56                              ;6d15  fe 38       
    RET NC                              ;6d17  d0          
    LD  (HLBUF),HL                      ;6d18  22 6a 6d    
    EX  DE,HL                           ;6d1b  eb          
    JR  FADDS                           ;6d1c  18 08       
ANSHIF: CP  56                          ;6d1e  fe 38       
    JP  NC,TRANS                        ;6d20  d2 cf 6e    
    LD  (HLBUF),HL                      ;6d23  22 6a 6d    
FADDS:  CALL    FADD1                   ;6d26  cd 7f 6d    
    PUSH    IX                          ;6d29  dd e5       
    EX  (SP),HL                         ;6d2b  e3          
    LD  A,D                             ;6d2c  7a          
    ADD A,H                             ;6d2d  84          
    LD  D,A                             ;6d2e  57          
    LD  A,L                             ;6d2f  7d          
    ADC A,E                             ;6d30  8b          
    LD  E,A                             ;6d31  5f          
    POP HL                              ;6d32  e1          
    LD  A,B                             ;6d33  78          
    EXX                                 ;6d34  d9          
    ADC A,B                             ;6d35  88          
    EXX                                 ;6d36  d9          
    LD  B,A                             ;6d37  47          
    LD  A,C                             ;6d38  79          
    EXX                                 ;6d39  d9          
    ADC A,C                             ;6d3a  89          
    EXX                                 ;6d3b  d9          
    LD  C,A                             ;6d3c  4f          
    LD  A,H                             ;6d3d  7c          
    EXX                                 ;6d3e  d9          
    ADC A,H                             ;6d3f  8c          
    EXX                                 ;6d40  d9          
    LD  H,A                             ;6d41  67          
    LD  A,L                             ;6d42  7d          
    EXX                                 ;6d43  d9          
    ADC A,L                             ;6d44  8d          
    EXX                                 ;6d45  d9          
    LD  L,A                             ;6d46  6f          
    EXX                                 ;6d47  d9          
    EX  AF,AF'                          ;6d48  08          
    LD  B,A                             ;6d49  47          
    EX  AF,AF'                          ;6d4a  08          
    LD  A,B                             ;6d4b  78          
    ADC A,D                             ;6d4c  8a          
    LD  D,A                             ;6d4d  57          
    JP  NC,STORE1                       ;6d4e  d2 66 6d    
    INC E                               ;6d51  1c          
    JP  Z,OVERFL1                       ;6d52  ca e4 6e    
    EXX                                 ;6d55  d9          
    SCF                                 ;6d56  37          
    RRA                                 ;6d57  1f          
    RR  L                               ;6d58  cb 1d       
    RR  H                               ;6d5a  cb 1c       
    RR  C                               ;6d5c  cb 19       
    RR  B                               ;6d5e  cb 18       
    RR  E                               ;6d60  cb 1b       
    RR  D                               ;6d62  cb 1a       
    EXX                                 ;6d64  d9          
    LD  D,A                             ;6d65  57          
STORE1: LD  BC,00008h                   ;6d66  01 08 00    
    DEFB    021H                        ;6d69  21          ;LD HL,?
HLBUF:  DEFS    2                       ;6d6a              
    ADD HL,BC                           ;6d6c  09          
    LD  (SPBF),SP                       ;6d6d  ed 73 5b 70 
    LD  SP,HL                           ;6d71  f9          
    EXX                                 ;6d72  d9          
    PUSH    DE                          ;6d73  d5          
    PUSH    BC                          ;6d74  c5          
    PUSH    HL                          ;6d75  e5          
    EXX                                 ;6d76  d9          
    PUSH    DE                          ;6d77  d5          
FLEXIT: LD  SP,(SPBF)                   ;6d78  ed 7b 5b 70 
INST1:  DEFS    1                       ;6d7c              
    EI                                  ;6d7d  fb          
    RET                                 ;6d7e  c9          
                  ;
FADD1:  DI                              ;6d7f  f3          
    LD  (SPBF),SP                       ;6d80  ed 73 5b 70 
    LD  C,A                             ;6d84  4f          
    AND 007h                            ;6d85  e6 07       
    INC A                               ;6d87  3c          
    LD  B,A                             ;6d88  47          
    LD  A,C                             ;6d89  79          
    AND 038h                            ;6d8a  e6 38       
    LD  (JPVEC),A                       ;6d8c  32 99 6d    
    LD  SP,HL                           ;6d8f  f9          
    EX  AF,AF'                          ;6d90  08          
    EXX                                 ;6d91  d9          
    POP AF                              ;6d92  f1          
    SET 7,A                             ;6d93  cb ff       
    POP HL                              ;6d95  e1          
    POP BC                              ;6d96  c1          
    POP DE                              ;6d97  d1          
    DEFB    018H                        ;6d98  18          ;JR ?
JPVEC:  DEFS    1                       ;6d99              
    JP  CLR1                            ;6d9a  c3 d1 6d    
FADDL1: XOR A                           ;6d9d  af          
    JP  CLR1                            ;6d9e  c3 d1 6d    
    DEFB    000H                        ;6da1  00          
    LD  D,E                             ;6da2  53          
    LD  E,B                             ;6da3  58          
    LD  B,C                             ;6da4  41          
    LD  C,H                             ;6da5  4c          
    LD  H,L                             ;6da6  65          
    LD  L,A                             ;6da7  6f          
    JR  FADDL1                          ;6da8  18 f3       
    LD  D,B                             ;6daa  50          
    LD  E,C                             ;6dab  59          
    LD  B,H                             ;6dac  44          
    LD  C,L                             ;6dad  4d          
    LD  H,A                             ;6dae  67          
    XOR A                               ;6daf  af          
    JR  CLR2$                           ;6db0  18 1e       
    LD  D,C                             ;6db2  51          
    LD  E,H                             ;6db3  5c          
    LD  B,L                             ;6db4  45          
    LD  C,A                             ;6db5  4f          
    XOR A                               ;6db6  af          
    JP  CLR3                            ;6db7  c3 cf 6d    
    LD  D,H                             ;6dba  54          
    LD  E,L                             ;6dbb  5d          
    LD  B,A                             ;6dbc  47          
    XOR A                               ;6dbd  af          
    JP  CLR4                            ;6dbe  c3 ce 6d    
    DEFB    000H                        ;6dc1  00          
    LD  D,L                             ;6dc2  55          
    LD  E,A                             ;6dc3  5f          
    XOR A                               ;6dc4  af          
    JP  CLR5                            ;6dc5  c3 cd 6d    
    DEFW    0                           ;6dc8  00 00       
    LD  D,A                             ;6dca  57          
    XOR A                               ;6dcb  af          
    LD  E,A                             ;6dcc  5f          
CLR5:   LD  B,A                         ;6dcd  47          
CLR4:   LD  C,A                         ;6dce  4f          
CLR3:   LD  H,A                         ;6dcf  67          
CLR2$:  LD  L,A                         ;6dd0  6f          
CLR1:   EX  AF,AF'                      ;6dd1  08          
    RRCA                                ;6dd2  0f          
    RRCA                                ;6dd3  0f          
    ADD A,0EBh                          ;6dd4  c6 eb       
    LD  (JPVEC2),A                      ;6dd6  32 f1 6d    
    EX  AF,AF'                          ;6dd9  08          
    JP  SHIFST                          ;6dda  c3 eb 6d    
    OR  A                               ;6ddd  b7          
    RRA                                 ;6dde  1f          
    RR  L                               ;6ddf  cb 1d       
    RR  H                               ;6de1  cb 1c       
    RR  C                               ;6de3  cb 19       
    RR  B                               ;6de5  cb 18       
    RR  E                               ;6de7  cb 1b       
    RR  D                               ;6de9  cb 1a       
SHIFST: EXX                             ;6deb  d9          
    SCF                                 ;6dec  37          
    CCF                                 ;6ded  3f          
    DEC B                               ;6dee  05          
    EXX                                 ;6def  d9          
    DEFB    020H                        ;6df0  20          ;JR NZ,?
JPVEC2: DEFS    1                       ;6df1              
    EXX                                 ;6df2  d9          
    EX  DE,HL                           ;6df3  eb          
    LD  SP,HL                           ;6df4  f9          
    POP DE                              ;6df5  d1          
    SET 7,D                             ;6df6  cb fa       
    POP HL                              ;6df8  e1          
    POP BC                              ;6df9  c1          
    POP IX                              ;6dfa  dd e1       
    LD  SP,(SPBF)                       ;6dfc  ed 7b 5b 70 
    EXX                                 ;6e00  d9          
    SCF                                 ;6e01  37          
    EX  AF,AF'                          ;6e02  08          
    RET                                 ;6e03  c9          
                  ;
FSUB:   BIT 3,(IY+0)                    ;6e04  fd cb 00 5e 
    JP  Z,SSUB                          ;6e08  ca 83 6f    
FSUB1:  XOR A                           ;6e0b  af          
    CP  (HL)                            ;6e0c  be          
    JP  Z,NEGTIV                        ;6e0d  ca ce 6e    
    LD  A,(DE)                          ;6e10  1a          
    OR  A                               ;6e11  b7          
    RET Z                               ;6e12  c8          
    SUB (HL)                            ;6e13  96          
    JR  NC,SNSHIF                       ;6e14  30 0f       
    NEG                                 ;6e16  ed 44       
    CP  56                              ;6e18  fe 38       
    CCF                                 ;6e1a  3f          
    RET C                               ;6e1b  d8          
    LD  (HLBUF),HL                      ;6e1c  22 6a 6d    
    EX  DE,HL                           ;6e1f  eb          
    CALL    DSUB1                       ;6e20  cd 2d 6e    
    CCF                                 ;6e23  3f          
    RET                                 ;6e24  c9          
                  ;
SNSHIF: CP  56                          ;6e25  fe 38       
    JP  NC,NEGTIV                       ;6e27  d2 ce 6e    
    LD  (HLBUF),HL                      ;6e2a  22 6a 6d    
DSUB1:  PUSH    AF                      ;6e2d  f5          
    PUSH    HL                          ;6e2e  e5          
    PUSH    DE                          ;6e2f  d5          
    LD  A,(DE)                          ;6e30  1a          
    CP  (HL)                            ;6e31  be          
    JR  NZ,NE                           ;6e32  20 1d       
    INC DE                              ;6e34  13          
    INC HL                              ;6e35  23          
    LD  A,(DE)                          ;6e36  1a          
    SET 7,A                             ;6e37  cb ff       
    CP  (HL)                            ;6e39  be          
    JR  Z,CMPCON                        ;6e3a  28 05       
    RES 7,A                             ;6e3c  cb bf       
    CP  (HL)                            ;6e3e  be          
    JR  NZ,NE                           ;6e3f  20 10       
CMPCON: INC HL                          ;6e41  23          
    INC DE                              ;6e42  13          
    LD  B,6                             ;6e43  06 06       
CMPL:   LD  A,(DE)                      ;6e45  1a          
    CP  (HL)                            ;6e46  be          
    JP  NZ,NE                           ;6e47  c2 51 6e    
    INC HL                              ;6e4a  23          
    INC DE                              ;6e4b  13          
    DJNZ    CMPL                        ;6e4c  10 f7       
    JP  ZERO                            ;6e4e  c3 d8 6e    
NE: POP DE                              ;6e51  d1          
    POP HL                              ;6e52  e1          
    POP AF                              ;6e53  f1          
    CALL    FADD1                       ;6e54  cd 7f 6d    
    PUSH    IX                          ;6e57  dd e5       
    EX  (SP),HL                         ;6e59  e3          
    LD  A,H                             ;6e5a  7c          
    SUB D                               ;6e5b  92          
    LD  D,A                             ;6e5c  57          
    LD  A,L                             ;6e5d  7d          
    SBC A,E                             ;6e5e  9b          
    LD  E,A                             ;6e5f  5f          
    POP HL                              ;6e60  e1          
    EXX                                 ;6e61  d9          
    LD  A,B                             ;6e62  78          
    EXX                                 ;6e63  d9          
    SBC A,B                             ;6e64  98          
    LD  B,A                             ;6e65  47          
    EXX                                 ;6e66  d9          
    LD  A,C                             ;6e67  79          
    EXX                                 ;6e68  d9          
    SBC A,C                             ;6e69  99          
    LD  C,A                             ;6e6a  4f          
    EXX                                 ;6e6b  d9          
    LD  A,H                             ;6e6c  7c          
    EXX                                 ;6e6d  d9          
    SBC A,H                             ;6e6e  9c          
    LD  H,A                             ;6e6f  67          
    EXX                                 ;6e70  d9          
    LD  A,L                             ;6e71  7d          
    EXX                                 ;6e72  d9          
    SBC A,L                             ;6e73  9d          
    LD  L,A                             ;6e74  6f          
    EXX                                 ;6e75  d9          
    EX  AF,AF'                          ;6e76  08          
    LD  B,A                             ;6e77  47          
    EX  AF,AF'                          ;6e78  08          
    LD  A,D                             ;6e79  7a          
    SBC A,B                             ;6e7a  98          
    LD  D,A                             ;6e7b  57          
    LD  A,0B7h                          ;6e7c  3e b7       
    LD  (INST1),A                       ;6e7e  32 7c 6d    
    EXX                                 ;6e81  d9          
    CALL    C,MINUS                     ;6e82  dc a2 6e    
    EXX                                 ;6e85  d9          
DSSFL2: BIT 7,D                         ;6e86  cb 7a       
    JP  NZ,STORE1                       ;6e88  c2 66 6d    
    EXX                                 ;6e8b  d9          
    OR  A                               ;6e8c  b7          
    RL  D                               ;6e8d  cb 12       
    RL  E                               ;6e8f  cb 13       
    RL  B                               ;6e91  cb 10       
    RL  C                               ;6e93  cb 11       
    RL  H                               ;6e95  cb 14       
    RL  L                               ;6e97  cb 15       
    EXX                                 ;6e99  d9          
    RL  D                               ;6e9a  cb 12       
    DEC E                               ;6e9c  1d          
    JR  NZ,DSSFL2                       ;6e9d  20 e7       
    JP  STORE1                          ;6e9f  c3 66 6d    
                  ;
MINUS:  EXX                             ;6ea2  d9          
    LD  A,03Fh                          ;6ea3  3e 3f       
    LD  (INST1),A                       ;6ea5  32 7c 6d    
    LD  A,D                             ;6ea8  7a          
    CPL                                 ;6ea9  2f          
    LD  D,A                             ;6eaa  57          
    EXX                                 ;6eab  d9          
    LD  A,D                             ;6eac  7a          
    CPL                                 ;6ead  2f          
    LD  D,A                             ;6eae  57          
    LD  A,E                             ;6eaf  7b          
    CPL                                 ;6eb0  2f          
    LD  E,A                             ;6eb1  5f          
    LD  A,B                             ;6eb2  78          
    CPL                                 ;6eb3  2f          
    LD  B,A                             ;6eb4  47          
    LD  A,C                             ;6eb5  79          
    CPL                                 ;6eb6  2f          
    LD  C,A                             ;6eb7  4f          
    LD  A,H                             ;6eb8  7c          
    CPL                                 ;6eb9  2f          
    LD  H,A                             ;6eba  67          
    LD  A,L                             ;6ebb  7d          
    CPL                                 ;6ebc  2f          
    LD  L,A                             ;6ebd  6f          
    INC D                               ;6ebe  14          
    RET NZ                              ;6ebf  c0          
    INC E                               ;6ec0  1c          
    RET NZ                              ;6ec1  c0          
    INC B                               ;6ec2  04          
    RET NZ                              ;6ec3  c0          
    INC C                               ;6ec4  0c          
    RET NZ                              ;6ec5  c0          
    INC H                               ;6ec6  24          
    RET NZ                              ;6ec7  c0          
    INC L                               ;6ec8  2c          
    RET NZ                              ;6ec9  c0          
    EXX                                 ;6eca  d9          
    INC D                               ;6ecb  14          
    EXX                                 ;6ecc  d9          
    RET                                 ;6ecd  c9          
                  ;
NEGTIV: OR  A                           ;6ece  b7          
TRANS:  LD  C,(IY+0)                    ;6ecf  fd 4e 00    
    LD  B,0                             ;6ed2  06 00       
    EX  DE,HL                           ;6ed4  eb          
    LDIR                                ;6ed5  ed b0       
    RET                                 ;6ed7  c9          
                  ;
ZERO:   POP DE                          ;6ed8  d1          
    POP HL                              ;6ed9  e1          
    POP AF                              ;6eda  f1          
ZERO':  LD  B,(IY+0)                    ;6edb  fd 46 00    
    XOR A                               ;6ede  af          
ZFILL0: LD  (HL),A                      ;6edf  77          
    INC HL                              ;6ee0  23          
    DJNZ    ZFILL0                      ;6ee1  10 fc       
    RET                                 ;6ee3  c9          
                  ;
OVERFL1: LD A,6                         ;6ee4  3e 06       
    EI                                  ;6ee6  fb          
    JP  ERROR                           ;6ee7  c3 96 21    
                  ;
SFADD:  XOR A                           ;6eea  af          
    CP  (HL)                            ;6eeb  be          
    JP  Z,TRANS                         ;6eec  ca cf 6e    
    LD  A,(DE)                          ;6eef  1a          
    OR  A                               ;6ef0  b7          
    RET Z                               ;6ef1  c8          
    SUB (HL)                            ;6ef2  96          
    JR  NC,SNSH                         ;6ef3  30 0c       
    NEG                                 ;6ef5  ed 44       
    CP  24                              ;6ef7  fe 18       
    RET NC                              ;6ef9  d0          
    LD  (SHLBUF),HL                     ;6efa  22 79 6f    
    EX  DE,HL                           ;6efd  eb          
    JP  SADD1                           ;6efe  c3 09 6f    
SNSH:   CP  24                          ;6f01  fe 18       
    JP  NC,TRANS                        ;6f03  d2 cf 6e    
    LD  (SHLBUF),HL                     ;6f06  22 79 6f    
SADD1:  LD  (SPBF),SP                   ;6f09  ed 73 5b 70 
    DI                                  ;6f0d  f3          
    LD  C,A                             ;6f0e  4f          
    AND 007h                            ;6f0f  e6 07       
    INC A                               ;6f11  3c          
    LD  B,A                             ;6f12  47          
    LD  A,C                             ;6f13  79          
    AND 038h                            ;6f14  e6 38       
    LD  C,A                             ;6f16  4f          
    LD  (SJVEC),A                       ;6f17  32 21 6f    
    LD  SP,HL                           ;6f1a  f9          
    EXX                                 ;6f1b  d9          
    POP DE                              ;6f1c  d1          
    SET 7,D                             ;6f1d  cb fa       
    POP HL                              ;6f1f  e1          
    DEFB    018H                        ;6f20  18          ;JR ?
SJVEC:  DEFS    1                       ;6f21              
    LD  C,0                             ;6f22  0e 00       
    JP  SCL0                            ;6f24  c3 37 6f    
    DEFS    3                           ;6f27              
    LD  C,H                             ;6f2a  4c          
    LD  H,L                             ;6f2b  65          
    LD  L,D                             ;6f2c  6a          
    XOR A                               ;6f2d  af          
    JP  SCL1                            ;6f2e  c3 36 6f    
    DEFS    1                           ;6f31              
    LD  C,L                             ;6f32  4d          
    LD  H,D                             ;6f33  62          
    XOR A                               ;6f34  af          
    LD  L,A                             ;6f35  6f          
SCL1:   LD  D,A                         ;6f36  57          
SCL0:   EXX                             ;6f37  d9          
    LD  A,C                             ;6f38  79          
    RRCA                                ;6f39  0f          
    RRCA                                ;6f3a  0f          
    ADD A,0F5h                          ;6f3b  c6 f5       
    LD  (SJVEC2),A                      ;6f3d  32 50 6f    
    LD  A,B                             ;6f40  78          
    EXX                                 ;6f41  d9          
    LD  B,A                             ;6f42  47          
    JP  SSIFST                          ;6f43  c3 4e 6f    
    RR  D                               ;6f46  cb 1a       
    RR  L                               ;6f48  cb 1d       
    RR  H                               ;6f4a  cb 1c       
    RR  C                               ;6f4c  cb 19       
SSIFST: OR  A                           ;6f4e  b7          
    DEFB    010H                        ;6f4f  10          ;DJNZ ?
SJVEC2: DEFS    1                       ;6f50              
    RL  C                               ;6f51  cb 11       
    EXX                                 ;6f53  d9          
    EX  DE,HL                           ;6f54  eb          
    LD  SP,HL                           ;6f55  f9          
    POP DE                              ;6f56  d1          
    SET 7,D                             ;6f57  cb fa       
    EXX                                 ;6f59  d9          
    POP BC                              ;6f5a  c1          
    LD  A,H                             ;6f5b  7c          
    ADC A,B                             ;6f5c  88          
    LD  H,A                             ;6f5d  67          
    LD  A,C                             ;6f5e  79          
    ADC A,L                             ;6f5f  8d          
    LD  L,A                             ;6f60  6f          
    EXX                                 ;6f61  d9          
    LD  A,D                             ;6f62  7a          
    EXX                                 ;6f63  d9          
    ADC A,D                             ;6f64  8a          
    LD  D,A                             ;6f65  57          
    EXX                                 ;6f66  d9          
    LD  A,E                             ;6f67  7b          
    EXX                                 ;6f68  d9          
    LD  E,A                             ;6f69  5f          
    JP  NC,SSTRE                        ;6f6a  d2 74 6f    
    RR  D                               ;6f6d  cb 1a       
    RR  L                               ;6f6f  cb 1d       
    RR  H                               ;6f71  cb 1c       
    INC E                               ;6f73  1c          
SSTRE:  EXX                             ;6f74  d9          
    LD  BC,00004h                       ;6f75  01 04 00    
    DEFB    021H                        ;6f78  21          ;LD HL,?
SHLBUF: DEFS    2                       ;6f79              
    ADD HL,BC                           ;6f7b  09          
    LD  SP,HL                           ;6f7c  f9          
    EXX                                 ;6f7d  d9          
    PUSH    HL                          ;6f7e  e5          
    PUSH    DE                          ;6f7f  d5          
    JP  FLEXIT                          ;6f80  c3 78 6d    
                  ;
SSUB:   PUSH    HL                      ;6f83  e5          
    PUSH    DE                          ;6f84  d5          
    LD  A,(DE)                          ;6f85  1a          
    CP  (HL)                            ;6f86  be          
    JR  C,NSSUB0                        ;6f87  38 01       
    LD  A,(HL)                          ;6f89  7e          
NSSUB0: CP  080h                        ;6f8a  fe 80       
    LD  A,000h                          ;6f8c  3e 00       
    JR  NC,OSETER                       ;6f8e  30 10       
    PUSH    HL                          ;6f90  e5          
    INC HL                              ;6f91  23          
    INC HL                              ;6f92  23          
    INC HL                              ;6f93  23          
    LD  C,(HL)                          ;6f94  4e          
    POP HL                              ;6f95  e1          
    EX  DE,HL                           ;6f96  eb          
    INC HL                              ;6f97  23          
    INC HL                              ;6f98  23          
    INC HL                              ;6f99  23          
    LD  A,(HL)                          ;6f9a  7e          
    EX  DE,HL                           ;6f9b  eb          
    CP  C                               ;6f9c  b9          
    JR  C,OSETER                        ;6f9d  38 01       
    LD  A,C                             ;6f9f  79          
OSETER: LD  DE,WRKFC                    ;6fa0  11 93 73    
    LD  BC,00004h                       ;6fa3  01 04 00    
    LDIR                                ;6fa6  ed b0       
    LD  B,4                             ;6fa8  06 04       
ZFSSUB: LD  (DE),A                      ;6faa  12          
    INC DE                              ;6fab  13          
    DJNZ    ZFSSUB                      ;6fac  10 fc       
    POP DE                              ;6fae  d1          
    PUSH    DE                          ;6faf  d5          
    EX  DE,HL                           ;6fb0  eb          
    LD  DE,WRKFC1                       ;6fb1  11 9b 73    
    LD  BC,00004h                       ;6fb4  01 04 00    
    LDIR                                ;6fb7  ed b0       
    LD  B,4                             ;6fb9  06 04       
ZFSSU1: LD  (DE),A                      ;6fbb  12          
    INC DE                              ;6fbc  13          
    DJNZ    ZFSSU1                      ;6fbd  10 fc       
    LD  HL,WRKFC                        ;6fbf  21 93 73    
    LD  DE,WRKFC1                       ;6fc2  11 9b 73    
    DEC IY                              ;6fc5  fd 2b       
    LD  (IY+0),008h                     ;6fc7  fd 36 00 08 
    CALL    FSUB1                       ;6fcb  cd 0b 6e    
    INC IY                              ;6fce  fd 23       
    POP DE                              ;6fd0  d1          
    POP HL                              ;6fd1  e1          
    PUSH    HL                          ;6fd2  e5          
    PUSH    DE                          ;6fd3  d5          
    EX  DE,HL                           ;6fd4  eb          
    LD  HL,WRKFC                        ;6fd5  21 93 73    
    LD  BC,00004h                       ;6fd8  01 04 00    
    LDIR                                ;6fdb  ed b0       
    POP DE                              ;6fdd  d1          
    POP HL                              ;6fde  e1          
    RET                                 ;6fdf  c9          
                  ;
MUL:    CALL    STROMT                  ;6fe0  cd c5 6b    
    DI                                  ;6fe3  f3          
    PUSH    DE                          ;6fe4  d5          
    PUSH    HL                          ;6fe5  e5          
    LD  (SPBF),SP                       ;6fe6  ed 73 5b 70 
    BIT 3,(IY+0)                        ;6fea  fd cb 00 5e 
    JP  NZ,DMUL                         ;6fee  c2 8e 71    
    LD  SP,HL                           ;6ff1  f9          
    LD  A,(DE)                          ;6ff2  1a          
    OR  A                               ;6ff3  b7          
    JP  Z,UNDRFL                        ;6ff4  ca ab 70    
    XOR A                               ;6ff7  af          
    EXX                                 ;6ff8  d9          
    POP DE                              ;6ff9  d1          
    SET 7,D                             ;6ffa  cb fa       
    CP  E                               ;6ffc  bb          
    JP  Z,UNDRFL                        ;6ffd  ca ab 70    
    POP HL                              ;7000  e1          
    EXX                                 ;7001  d9          
    EX  DE,HL                           ;7002  eb          
    LD  SP,HL                           ;7003  f9          
    POP DE                              ;7004  d1          
    SET 7,D                             ;7005  cb fa       
    CP  E                               ;7007  bb          
    JP  Z,UNDRFL                        ;7008  ca ab 70    
    POP HL                              ;700b  e1          
    LD  BC,05F00h                       ;700c  01 00 5f    
    LD  SP,WRKFC+6                      ;700f  31 99 73    
    PUSH    BC                          ;7012  c5          
    PUSH    BC                          ;7013  c5          
    LD  C,A                             ;7014  4f          
    LD  B,A                             ;7015  47          
    PUSH    BC                          ;7016  c5          
    EXX                                 ;7017  d9          
    PUSH    DE                          ;7018  d5          
    LD  E,A                             ;7019  5f          
    EXX                                 ;701a  d9          
    CP  H                               ;701b  bc          
    LD  IX,WRKFC+4                      ;701c  dd 21 97 73 
    JR  Z,SML1                          ;7020  28 04       
    LD  C,H                             ;7022  4c          
    CALL    SMULTS                      ;7023  cd 77 70    
SML1:   DEC IX                          ;7026  dd 2b       
    CP  L                               ;7028  bd          
    JR  Z,SML2                          ;7029  28 04       
    LD  C,L                             ;702b  4d          
    CALL    SMULTS                      ;702c  cd 77 70    
SML2:   DEC IX                          ;702f  dd 2b       
    LD  C,D                             ;7031  4a          
    CALL    SMULTS                      ;7032  cd 77 70    
    POP HL                              ;7035  e1          
    LD  A,E                             ;7036  7b          
    ADD A,L                             ;7037  85          
    LD  L,A                             ;7038  6f          
    LD  A,000h                          ;7039  3e 00       
    ADC A,A                             ;703b  8f          
    LD  H,A                             ;703c  67          
    POP BC                              ;703d  c1          
    POP DE                              ;703e  d1          
SMSF:   BIT 7,C                         ;703f  cb 79       
    JR  NZ,EXPCUL                       ;7041  20 09       
    RL  D                               ;7043  cb 12       
    RL  E                               ;7045  cb 13       
    RL  B                               ;7047  cb 10       
    RL  C                               ;7049  cb 11       
    DEC HL                              ;704b  2b          
EXPCUL: LD  A,L                         ;704c  7d          
    SUB 080h                            ;704d  d6 80       
    LD  L,A                             ;704f  6f          
    LD  A,H                             ;7050  7c          
    SBC A,000h                          ;7051  de 00       
    JP  C,UNDRFL                        ;7053  da ab 70    
    JP  NZ,OVERFL1                      ;7056  c2 e4 6e    
    LD  A,L                             ;7059  7d          
    DEFB    031H                        ;705a  31          ;LD SP,?
SPBF:   DEFS    2                       ;705b              
    POP HL                              ;705d  e1          
    LD  (HL),A                          ;705e  77          
    INC HL                              ;705f  23          
    LD  A,(HL)                          ;7060  7e          
    EX  (SP),HL                         ;7061  e3          
    INC HL                              ;7062  23          
    XOR (HL)                            ;7063  ae          
    DEC HL                              ;7064  2b          
    EX  (SP),HL                         ;7065  e3          
    DEC HL                              ;7066  2b          
    PUSH    HL                          ;7067  e5          
    INC HL                              ;7068  23          
    RLCA                                ;7069  07          
    JR  C,SMSTS                         ;706a  38 02       
    RES 7,C                             ;706c  cb b9       
SMSTS:  LD  (HL),C                      ;706e  71          
    INC HL                              ;706f  23          
    LD  (HL),B                          ;7070  70          
    INC HL                              ;7071  23          
    LD  (HL),E                          ;7072  73          
    POP HL                              ;7073  e1          
    POP DE                              ;7074  d1          
    EI                                  ;7075  fb          
    RET                                 ;7076  c9          
                  ;
SMULTS: LD  B,8                         ;7077  06 08       
SMULTP: RR  C                           ;7079  cb 19       
    EXX                                 ;707b  d9          
    JP  NC,SMLP1                        ;707c  d2 94 70    
    LD  SP,IX                           ;707f  dd f9       
    POP BC                              ;7081  c1          
    PUSH    HL                          ;7082  e5          
    LD  A,H                             ;7083  7c          
    ADD A,B                             ;7084  80          
    LD  H,A                             ;7085  67          
    LD  A,L                             ;7086  7d          
    ADC A,C                             ;7087  89          
    LD  L,A                             ;7088  6f          
    EX  (SP),HL                         ;7089  e3          
    DEC SP                              ;708a  3b          
    DEC SP                              ;708b  3b          
    EX  (SP),HL                         ;708c  e3          
    LD  A,H                             ;708d  7c          
    ADC A,D                             ;708e  8a          
    LD  H,A                             ;708f  67          
    LD  A,L                             ;7090  7d          
    ADC A,E                             ;7091  8b          
    LD  L,A                             ;7092  6f          
    EX  (SP),HL                         ;7093  e3          
SMLP1:  OR  A                           ;7094  b7          
    RL  H                               ;7095  cb 14       
    RL  L                               ;7097  cb 15       
    RL  D                               ;7099  cb 12       
    RL  E                               ;709b  cb 13       
    EXX                                 ;709d  d9          
    DJNZ    SMULTP                      ;709e  10 d9       
    EXX                                 ;70a0  d9          
    LD  H,L                             ;70a1  65          
    LD  L,D                             ;70a2  6a          
    LD  D,E                             ;70a3  53          
    XOR A                               ;70a4  af          
    LD  E,A                             ;70a5  5f          
    EXX                                 ;70a6  d9          
    LD  SP,WRKFC-4                      ;70a7  31 8f 73    
    RET                                 ;70aa  c9          
                  ;
UNDRFL: LD  SP,(SPBF)                   ;70ab  ed 7b 5b 70 
    POP HL                              ;70af  e1          
    PUSH    HL                          ;70b0  e5          
    CALL    ZERO'                       ;70b1  cd db 6e    
    POP HL                              ;70b4  e1          
    POP DE                              ;70b5  d1          
    EI                                  ;70b6  fb          
    RET                                 ;70b7  c9          
                  ;
DVBYZR: LD  A,11                        ;70b8  3e 0b       
    JP  ERROR                           ;70ba  c3 96 21    
                  ;
DIV:    CALL    STROMT                  ;70bd  cd c5 6b    
    DI                                  ;70c0  f3          
    XOR A                               ;70c1  af          
    PUSH    DE                          ;70c2  d5          
    PUSH    HL                          ;70c3  e5          
    LD  (SPBF),SP                       ;70c4  ed 73 5b 70 
    BIT 3,(IY+0)                        ;70c8  fd cb 00 5e 
    JP  NZ,DDIV                         ;70cc  c2 89 72    
    LD  SP,HL                           ;70cf  f9          
    EXX                                 ;70d0  d9          
    POP DE                              ;70d1  d1          
    SET 7,D                             ;70d2  cb fa       
    CP  E                               ;70d4  bb          
    JR  Z,UNDRFL                        ;70d5  28 d4       
    LD  E,A                             ;70d7  5f          
    POP HL                              ;70d8  e1          
    EXX                                 ;70d9  d9          
    EX  DE,HL                           ;70da  eb          
    LD  SP,HL                           ;70db  f9          
    POP DE                              ;70dc  d1          
    SET 7,D                             ;70dd  cb fa       
    CP  E                               ;70df  bb          
    JR  Z,DVBYZR                        ;70e0  28 d6       
    LD  E,A                             ;70e2  5f          
    POP HL                              ;70e3  e1          
    LD  SP,(SPBF)                       ;70e4  ed 7b 5b 70 
    LD  IX,WRKFC-1                      ;70e8  dd 21 92 73 
    LD  C,4                             ;70ec  0e 04       
SDLOP2: INC IX                          ;70ee  dd 23       
    LD  B,8                             ;70f0  06 08       
SDLOP1: EXX                             ;70f2  d9          
    RL  (IX+0)                          ;70f3  dd cb 00 16 
    LD  A,H                             ;70f7  7c          
    EXX                                 ;70f8  d9          
    SUB H                               ;70f9  94          
    EXX                                 ;70fa  d9          
    LD  H,A                             ;70fb  67          
    LD  A,L                             ;70fc  7d          
    EXX                                 ;70fd  d9          
    SBC A,L                             ;70fe  9d          
    EXX                                 ;70ff  d9          
    LD  L,A                             ;7100  6f          
    LD  A,D                             ;7101  7a          
    EXX                                 ;7102  d9          
    SBC A,D                             ;7103  9a          
    EXX                                 ;7104  d9          
    LD  D,A                             ;7105  57          
    LD  A,E                             ;7106  7b          
    EXX                                 ;7107  d9          
    SBC A,E                             ;7108  9b          
    EXX                                 ;7109  d9          
    LD  E,A                             ;710a  5f          
    SET 0,(IX+0)                        ;710b  dd cb 00 c6 
    JR  NC,SDCNT                        ;710f  30 18       
    RES 0,(IX+0)                        ;7111  dd cb 00 86 
    EXX                                 ;7115  d9          
    LD  A,H                             ;7116  7c          
    EXX                                 ;7117  d9          
    ADD A,H                             ;7118  84          
    LD  H,A                             ;7119  67          
    EXX                                 ;711a  d9          
    LD  A,L                             ;711b  7d          
    EXX                                 ;711c  d9          
    ADC A,L                             ;711d  8d          
    LD  L,A                             ;711e  6f          
    EXX                                 ;711f  d9          
    LD  A,D                             ;7120  7a          
    EXX                                 ;7121  d9          
    ADC A,D                             ;7122  8a          
    LD  D,A                             ;7123  57          
    EXX                                 ;7124  d9          
    LD  A,E                             ;7125  7b          
    EXX                                 ;7126  d9          
    ADC A,E                             ;7127  8b          
    LD  E,A                             ;7128  5f          
SDCNT:  SLA H                           ;7129  cb 24       
    RL  L                               ;712b  cb 15       
    RL  D                               ;712d  cb 12       
    RL  E                               ;712f  cb 13       
    EXX                                 ;7131  d9          
    DJNZ    SDLOP1                      ;7132  10 be       
    DEC C                               ;7134  0d          
    JR  NZ,SDLOP2                       ;7135  20 b7       
    LD  HL,WRKFC+3                      ;7137  21 96 73    
    LD  A,067h                          ;713a  3e 67       
    ADD A,(HL)                          ;713c  86          
    LD  (HL),A                          ;713d  77          
    LD  B,3                             ;713e  06 03       
ADLP:   DEC HL                          ;7140  2b          
    LD  A,0                             ;7141  3e 00       
    ADC A,(HL)                          ;7143  8e          
    LD  (HL),A                          ;7144  77          
    DJNZ    ADLP                        ;7145  10 f9       
    XOR A                               ;7147  af          
    BIT 7,(HL)                          ;7148  cb 7e       
    JR  NZ,SDEXPC                       ;714a  20 0d       
    LD  HL,WRKFC+3                      ;714c  21 96 73    
    RL  (HL)                            ;714f  cb 16       
    LD  B,003h                          ;7151  06 03       
NOSDLP: DEC HL                          ;7153  2b          
    RL  (HL)                            ;7154  cb 16       
    DJNZ    NOSDLP                      ;7156  10 fb       
    SCF                                 ;7158  37          
SDEXPC: POP HL                          ;7159  e1          
    POP DE                              ;715a  d1          
    PUSH    DE                          ;715b  d5          
    PUSH    HL                          ;715c  e5          
    LD  A,(HL)                          ;715d  7e          
    CCF                                 ;715e  3f          
    ADC A,080h                          ;715f  ce 80       
    LD  C,A                             ;7161  4f          
    LD  A,0                             ;7162  3e 00       
    ADC A,A                             ;7164  8f          
    LD  B,A                             ;7165  47          
    EX  DE,HL                           ;7166  eb          
    LD  A,C                             ;7167  79          
    SUB (HL)                            ;7168  96          
    EX  DE,HL                           ;7169  eb          
    LD  C,A                             ;716a  4f          
    LD  A,B                             ;716b  78          
    SBC A,0                             ;716c  de 00       
    JP  C,UNDRFL                        ;716e  da ab 70    
    JP  NZ,OVERFL1                      ;7171  c2 e4 6e    
    LD  (HL),C                          ;7174  71          
    INC HL                              ;7175  23          
    INC DE                              ;7176  13          
    LD  A,(DE)                          ;7177  1a          
    XOR (HL)                            ;7178  ae          
    RLCA                                ;7179  07          
    LD  B,3                             ;717a  06 03       
DDTRL:  LD  DE,WRKFC                    ;717c  11 93 73    
SDTRL:  LD  A,(DE)                      ;717f  1a          
    LD  (HL),A                          ;7180  77          
    INC HL                              ;7181  23          
    INC DE                              ;7182  13          
    DJNZ    SDTRL                       ;7183  10 fa       
    POP HL                              ;7185  e1          
    JR  C,SDMIN                         ;7186  38 03       
    CALL    RESNHL                      ;7188  cd c0 6b    
SDMIN:  POP DE                          ;718b  d1          
    EI                                  ;718c  fb          
    RET                                 ;718d  c9          
                  ;
DMUL:   LD  SP,HL                       ;718e  f9          
    LD  A,(DE)                          ;718f  1a          
    OR  A                               ;7190  b7          
    JP  Z,UNDRFL                        ;7191  ca ab 70    
    XOR A                               ;7194  af          
    EXX                                 ;7195  d9          
    POP DE                              ;7196  d1          
    SET 7,D                             ;7197  cb fa       
    CP  E                               ;7199  bb          
    JP  Z,UNDRFL                        ;719a  ca ab 70    
    LD  E,A                             ;719d  5f          
    POP BC                              ;719e  c1          
    POP HL                              ;719f  e1          
    POP IX                              ;71a0  dd e1       
    EXX                                 ;71a2  d9          
    LD  SP,WRKFC+14                     ;71a3  31 a1 73    
    LD  BC,05F00h                       ;71a6  01 00 5f    
    PUSH    BC                          ;71a9  c5          
    PUSH    BC                          ;71aa  c5          
    PUSH    BC                          ;71ab  c5          
    PUSH    BC                          ;71ac  c5          
    LD  B,A                             ;71ad  47          
    PUSH    BC                          ;71ae  c5          
    PUSH    BC                          ;71af  c5          
    PUSH    BC                          ;71b0  c5          
    LD  SP,(SPBF)                       ;71b1  ed 7b 5b 70 
    EX  DE,HL                           ;71b5  eb          
    LD  B,6                             ;71b6  06 06       
    LD  DE,00007h                       ;71b8  11 07 00    
    ADD HL,DE                           ;71bb  19          
    LD  DE,WRKFC+13                     ;71bc  11 a0 73    
DMULLP: CALL    BLCKAD                  ;71bf  cd 13 72    
    DEC DE                              ;71c2  1b          
    DEC HL                              ;71c3  2b          
    DJNZ    DMULLP                      ;71c4  10 f9       
    LD  A,(HL)                          ;71c6  7e          
    SET 7,A                             ;71c7  cb ff       
    CALL    BLCKA1                      ;71c9  cd 16 72    
    LD  HL,WRKFC                        ;71cc  21 93 73    
    BIT 7,(HL)                          ;71cf  cb 7e       
    SCF                                 ;71d1  37          
    JR  NZ,DMNOSH                       ;71d2  20 0b       
    LD  HL,WRKFC+7                      ;71d4  21 9a 73    
    LD  B,008h                          ;71d7  06 08       
DMSFL:  RL  (HL)                        ;71d9  cb 16       
    DEC HL                              ;71db  2b          
    DJNZ    DMSFL                       ;71dc  10 fb       
    OR  A                               ;71de  b7          
DMNOSH: POP HL                          ;71df  e1          
    POP DE                              ;71e0  d1          
    PUSH    DE                          ;71e1  d5          
    PUSH    HL                          ;71e2  e5          
    LD  A,(DE)                          ;71e3  1a          
    LD  C,A                             ;71e4  4f          
    ADC A,(HL)                          ;71e5  8e          
    LD  C,A                             ;71e6  4f          
    LD  A,0                             ;71e7  3e 00       
    ADC A,A                             ;71e9  8f          
    LD  B,A                             ;71ea  47          
    LD  A,C                             ;71eb  79          
    SUB 081h                            ;71ec  d6 81       
    LD  C,A                             ;71ee  4f          
    LD  A,B                             ;71ef  78          
    SBC A,0                             ;71f0  de 00       
    JP  M,UNDRFL                        ;71f2  fa ab 70    
    JP  NZ,OVERFL1                      ;71f5  c2 e4 6e    
    LD  (HL),C                          ;71f8  71          
    INC DE                              ;71f9  13          
    INC HL                              ;71fa  23          
    LD  A,(DE)                          ;71fb  1a          
    XOR (HL)                            ;71fc  ae          
    RLCA                                ;71fd  07          
    LD  DE,WRKFC                        ;71fe  11 93 73    
    JR  C,SMSKP1                        ;7201  38 04       
    EX  DE,HL                           ;7203  eb          
    RES 7,(HL)                          ;7204  cb be       
    EX  DE,HL                           ;7206  eb          
SMSKP1: LD  B,007h                      ;7207  06 07       
DMTRL:  LD  A,(DE)                      ;7209  1a          
    LD  (HL),A                          ;720a  77          
    INC DE                              ;720b  13          
    INC HL                              ;720c  23          
    DJNZ    DMTRL                       ;720d  10 fa       
    POP HL                              ;720f  e1          
    POP DE                              ;7210  d1          
    EI                                  ;7211  fb          
    RET                                 ;7212  c9          
                  ;
BLCKAD: LD  A,(HL)                      ;7213  7e          
    OR  A                               ;7214  b7          
    RET Z                               ;7215  c8          
BLCKA1: PUSH    HL                      ;7216  e5          
    PUSH    BC                          ;7217  c5          
    PUSH    DE                          ;7218  d5          
    LD  B,8                             ;7219  06 08       
BLADLP: RRCA                            ;721b  0f          
    PUSH    AF                          ;721c  f5          
    JP  NC,DMSKIP                       ;721d  d2 54 72    
    LD  A,(DE)                          ;7220  1a          
    PUSH    IX                          ;7221  dd e5       
    EX  (SP),HL                         ;7223  e3          
    ADD A,H                             ;7224  84          
    LD  (DE),A                          ;7225  12          
    DEC DE                              ;7226  1b          
    LD  A,(DE)                          ;7227  1a          
    ADC A,L                             ;7228  8d          
    LD  (DE),A                          ;7229  12          
    POP HL                              ;722a  e1          
    DEC DE                              ;722b  1b          
    LD  A,(DE)                          ;722c  1a          
    EXX                                 ;722d  d9          
    ADC A,H                             ;722e  8c          
    EXX                                 ;722f  d9          
    LD  (DE),A                          ;7230  12          
    DEC DE                              ;7231  1b          
    LD  A,(DE)                          ;7232  1a          
    EXX                                 ;7233  d9          
    ADC A,L                             ;7234  8d          
    EXX                                 ;7235  d9          
    LD  (DE),A                          ;7236  12          
    DEC DE                              ;7237  1b          
    LD  A,(DE)                          ;7238  1a          
    EXX                                 ;7239  d9          
    ADC A,B                             ;723a  88          
    EXX                                 ;723b  d9          
    LD  (DE),A                          ;723c  12          
    DEC DE                              ;723d  1b          
    LD  A,(DE)                          ;723e  1a          
    EXX                                 ;723f  d9          
    ADC A,C                             ;7240  89          
    EXX                                 ;7241  d9          
    LD  (DE),A                          ;7242  12          
    DEC DE                              ;7243  1b          
    LD  A,(DE)                          ;7244  1a          
    EXX                                 ;7245  d9          
    ADC A,D                             ;7246  8a          
    EXX                                 ;7247  d9          
    LD  (DE),A                          ;7248  12          
    DEC DE                              ;7249  1b          
    LD  A,(DE)                          ;724a  1a          
    EXX                                 ;724b  d9          
    ADC A,E                             ;724c  8b          
    EXX                                 ;724d  d9          
    LD  (DE),A                          ;724e  12          
    DEC DE                              ;724f  1b          
    LD  A,(DE)                          ;7250  1a          
    ADC A,0                             ;7251  ce 00       
    LD  (DE),A                          ;7253  12          
                  ;
DMSKIP: EXX                             ;7254  d9          
    PUSH    IX                          ;7255  dd e5       
    EX  (SP),HL                         ;7257  e3          
    LD  A,H                             ;7258  7c          
    ADD A,A                             ;7259  87          
    LD  H,A                             ;725a  67          
    LD  A,L                             ;725b  7d          
    RLA                                 ;725c  17          
    LD  L,A                             ;725d  6f          
    EX  (SP),HL                         ;725e  e3          
    POP IX                              ;725f  dd e1       
    RL  H                               ;7261  cb 14       
    RL  L                               ;7263  cb 15       
    RL  B                               ;7265  cb 10       
    RL  C                               ;7267  cb 11       
    RL  D                               ;7269  cb 12       
    RL  E                               ;726b  cb 13       
    EXX                                 ;726d  d9          
    POP AF                              ;726e  f1          
    POP DE                              ;726f  d1          
    PUSH    DE                          ;7270  d5          
    DJNZ    BLADLP                      ;7271  10 a8       
    EXX                                 ;7273  d9          
    LD  A,H                             ;7274  7c          
    PUSH    IX                          ;7275  dd e5       
    EX  (SP),HL                         ;7277  e3          
    LD  H,L                             ;7278  65          
    LD  L,A                             ;7279  6f          
    EX  (SP),HL                         ;727a  e3          
    POP IX                              ;727b  dd e1       
    LD  H,L                             ;727d  65          
    LD  L,B                             ;727e  68          
    LD  B,C                             ;727f  41          
    LD  C,D                             ;7280  4a          
    LD  D,E                             ;7281  53          
    LD  E,0                             ;7282  1e 00       
    EXX                                 ;7284  d9          
    POP DE                              ;7285  d1          
    POP BC                              ;7286  c1          
    POP HL                              ;7287  e1          
    RET                                 ;7288  c9          
                  ;
DDIV:   LD  SP,HL                       ;7289  f9          
    EXX                                 ;728a  d9          
    POP DE                              ;728b  d1          
    SET 7,D                             ;728c  cb fa       
    CP  E                               ;728e  bb          
    JP  Z,UNDRFL                        ;728f  ca ab 70    
    LD  E,A                             ;7292  5f          
    POP BC                              ;7293  c1          
    POP HL                              ;7294  e1          
    POP IX                              ;7295  dd e1       
    EXX                                 ;7297  d9          
    EX  DE,HL                           ;7298  eb          
    LD  SP,(SPBF)                       ;7299  ed 7b 5b 70 
    CP  (HL)                            ;729d  be          
    JP  Z,DVBYZR                        ;729e  ca b8 70    
    LD  DE,00007h                       ;72a1  11 07 00    
    ADD HL,DE                           ;72a4  19          
    EX  DE,HL                           ;72a5  eb          
    LD  HL,WRKFC-1                      ;72a6  21 92 73    
    LD  C,8                             ;72a9  0e 08       
DDLOP2: INC HL                          ;72ab  23          
    LD  B,8                             ;72ac  06 08       
DDLOP1: RL  (HL)                        ;72ae  cb 16       
    PUSH    DE                          ;72b0  d5          
    EX  DE,HL                           ;72b1  eb          
    PUSH    BC                          ;72b2  c5          
    PUSH    IX                          ;72b3  dd e5       
    POP BC                              ;72b5  c1          
    LD  A,B                             ;72b6  78          
    SUB (HL)                            ;72b7  96          
    LD  B,A                             ;72b8  47          
    DEC HL                              ;72b9  2b          
    LD  A,C                             ;72ba  79          
    SBC A,(HL)                          ;72bb  9e          
    LD  C,A                             ;72bc  4f          
    PUSH    BC                          ;72bd  c5          
    POP IX                              ;72be  dd e1       
    POP BC                              ;72c0  c1          
    DEC HL                              ;72c1  2b          
    EXX                                 ;72c2  d9          
    LD  A,H                             ;72c3  7c          
    EXX                                 ;72c4  d9          
    SBC A,(HL)                          ;72c5  9e          
    EXX                                 ;72c6  d9          
    LD  H,A                             ;72c7  67          
    LD  A,L                             ;72c8  7d          
    EXX                                 ;72c9  d9          
    DEC HL                              ;72ca  2b          
    SBC A,(HL)                          ;72cb  9e          
    EXX                                 ;72cc  d9          
    LD  L,A                             ;72cd  6f          
    LD  A,B                             ;72ce  78          
    EXX                                 ;72cf  d9          
    DEC HL                              ;72d0  2b          
    SBC A,(HL)                          ;72d1  9e          
    EXX                                 ;72d2  d9          
    LD  B,A                             ;72d3  47          
    LD  A,C                             ;72d4  79          
    EXX                                 ;72d5  d9          
    DEC HL                              ;72d6  2b          
    SBC A,(HL)                          ;72d7  9e          
    EXX                                 ;72d8  d9          
    LD  C,A                             ;72d9  4f          
    LD  A,D                             ;72da  7a          
    EXX                                 ;72db  d9          
    DEC HL                              ;72dc  2b          
    PUSH    BC                          ;72dd  c5          
    LD  C,(HL)                          ;72de  4e          
    SET 7,C                             ;72df  cb f9       
    SBC A,C                             ;72e1  99          
    POP BC                              ;72e2  c1          
    EXX                                 ;72e3  d9          
    LD  D,A                             ;72e4  57          
    LD  A,E                             ;72e5  7b          
    SBC A,0                             ;72e6  de 00       
    LD  E,A                             ;72e8  5f          
    EXX                                 ;72e9  d9          
    EX  DE,HL                           ;72ea  eb          
    POP DE                              ;72eb  d1          
    PUSH    DE                          ;72ec  d5          
    SET 0,(HL)                          ;72ed  cb c6       
    JR  NC,DDCNT                        ;72ef  30 37       
    RES 0,(HL)                          ;72f1  cb 86       
    EX  DE,HL                           ;72f3  eb          
    PUSH    BC                          ;72f4  c5          
    PUSH    IX                          ;72f5  dd e5       
    POP BC                              ;72f7  c1          
    LD  A,B                             ;72f8  78          
    ADD A,(HL)                          ;72f9  86          
    LD  B,A                             ;72fa  47          
    DEC HL                              ;72fb  2b          
    LD  A,C                             ;72fc  79          
    ADC A,(HL)                          ;72fd  8e          
    LD  C,A                             ;72fe  4f          
    PUSH    BC                          ;72ff  c5          
    POP IX                              ;7300  dd e1       
    POP BC                              ;7302  c1          
    DEC HL                              ;7303  2b          
    LD  A,(HL)                          ;7304  7e          
    EXX                                 ;7305  d9          
    ADC A,H                             ;7306  8c          
    LD  H,A                             ;7307  67          
    EXX                                 ;7308  d9          
    DEC HL                              ;7309  2b          
    LD  A,(HL)                          ;730a  7e          
    EXX                                 ;730b  d9          
    ADC A,L                             ;730c  8d          
    LD  L,A                             ;730d  6f          
    EXX                                 ;730e  d9          
    DEC HL                              ;730f  2b          
    LD  A,(HL)                          ;7310  7e          
    EXX                                 ;7311  d9          
    ADC A,B                             ;7312  88          
    LD  B,A                             ;7313  47          
    EXX                                 ;7314  d9          
    DEC HL                              ;7315  2b          
    LD  A,(HL)                          ;7316  7e          
    EXX                                 ;7317  d9          
    ADC A,C                             ;7318  89          
    LD  C,A                             ;7319  4f          
    EXX                                 ;731a  d9          
    DEC HL                              ;731b  2b          
    LD  A,(HL)                          ;731c  7e          
    EXX                                 ;731d  d9          
    SET 7,A                             ;731e  cb ff       
    ADC A,D                             ;7320  8a          
    LD  D,A                             ;7321  57          
    LD  A,E                             ;7322  7b          
    ADC A,0                             ;7323  ce 00       
    LD  E,A                             ;7325  5f          
    EXX                                 ;7326  d9          
    EX  DE,HL                           ;7327  eb          
DDCNT:  POP DE                          ;7328  d1          
    PUSH    IX                          ;7329  dd e5       
    EX  (SP),HL                         ;732b  e3          
    SLA H                               ;732c  cb 24       
    RL  L                               ;732e  cb 15       
    EX  (SP),HL                         ;7330  e3          
    POP IX                              ;7331  dd e1       
    EXX                                 ;7333  d9          
    RL  H                               ;7334  cb 14       
    RL  L                               ;7336  cb 15       
    RL  B                               ;7338  cb 10       
    RL  C                               ;733a  cb 11       
    RL  D                               ;733c  cb 12       
    RL  E                               ;733e  cb 13       
    EXX                                 ;7340  d9          
    DEC B                               ;7341  05          
    JP  NZ,DDLOP1                       ;7342  c2 ae 72    
    DEC C                               ;7345  0d          
    JP  NZ,DDLOP2                       ;7346  c2 ab 72    
    LD  HL,WRKFC+7                      ;7349  21 9a 73    
    LD  A,067h                          ;734c  3e 67       
    ADD A,(HL)                          ;734e  86          
    LD  (HL),A                          ;734f  77          
    LD  B,007h                          ;7350  06 07       
DDADLP: DEC HL                          ;7352  2b          
    LD  A,000h                          ;7353  3e 00       
    ADC A,(HL)                          ;7355  8e          
    LD  (HL),A                          ;7356  77          
    DJNZ    DDADLP                      ;7357  10 f9       
    XOR A                               ;7359  af          
    BIT 7,(HL)                          ;735a  cb 7e       
    JR  NZ,DDEXPC                       ;735c  20 0b       
    LD  HL,WRKFC+8                      ;735e  21 9b 73    
    LD  B,8                             ;7361  06 08       
DDNSLP: DEC HL                          ;7363  2b          
    RL  (HL)                            ;7364  cb 16       
    DJNZ    DDNSLP                      ;7366  10 fb       
    SCF                                 ;7368  37          
DDEXPC: POP HL                          ;7369  e1          
    POP DE                              ;736a  d1          
    PUSH    DE                          ;736b  d5          
    PUSH    HL                          ;736c  e5          
    LD  A,(HL)                          ;736d  7e          
    CCF                                 ;736e  3f          
    ADC A,080h                          ;736f  ce 80       
    LD  C,A                             ;7371  4f          
    LD  A,0                             ;7372  3e 00       
    ADC A,A                             ;7374  8f          
    LD  B,A                             ;7375  47          
    EX  DE,HL                           ;7376  eb          
    LD  A,C                             ;7377  79          
    SUB (HL)                            ;7378  96          
    EX  DE,HL                           ;7379  eb          
    LD  C,A                             ;737a  4f          
    LD  A,B                             ;737b  78          
    SBC A,0                             ;737c  de 00       
    JP  C,UNDRFL                        ;737e  da ab 70    
    JP  NZ,OVERFL1                      ;7381  c2 e4 6e    
    LD  (HL),C                          ;7384  71          
    INC HL                              ;7385  23          
    INC DE                              ;7386  13          
    LD  A,(DE)                          ;7387  1a          
    XOR (HL)                            ;7388  ae          
    RLCA                                ;7389  07          
    LD  B,7                             ;738a  06 07       
    JP  DDTRL                           ;738c  c3 7c 71    
                  ;
    DEFS    4                           ;738f              
WRKFC:  DEFS    8                       ;7393              
WRKFC1: DEFS    8                       ;739b              
                  ;    ORG 073A3H
LDIR1:      LD  HL,FLONE                ;73a3  21 98 62    ;!b
LDIR8:      LD  BC,00008h               ;73a6  01 08 00    ;
            LDIR                        ;73a9  ed b0       ;
            RET                         ;73ab  c9          ;
                  
ONEADD:     LD  DE,FLONE                ;73ac  11 98 62    ;b
            JP  ADD                     ;73af  c3 a6 6c    ;l
L073B2h:    EX  DE,HL                   ;73b2  eb          ;
            LD  HL,00008h               ;73b3  21 08 00    ;!
            ADD HL,DE                   ;73b6  19          ;
            EX  DE,HL                   ;73b7  eb          ;
            RET                         ;73b8  c9          ;
                  
B_SQR:      XOR A                       ;73b9  af          ;
            CP  (HL)                    ;73ba  be          ;
            RET Z                       ;73bb  c8          ;
            INC HL                      ;73bc  23          ;#
            BIT 7,(HL)                  ;73bd  cb 7e       ;~
            DEC HL                      ;73bf  2b          ;+
            JP  NZ,IFCALL               ;73c0  c2 36 17    ;6
            PUSH    BC                  ;73c3  c5          ;
            LD  DE,00008h               ;73c4  11 08 00    ;
            PUSH    HL                  ;73c7  e5          ;
            ADD HL,DE                   ;73c8  19          ;
            LD  (L073D1h+1),HL          ;73c9  22 d2 73    ;"s
            ADD HL,DE                   ;73cc  19          ;
            LD  (L073E4h+1),HL          ;73cd  22 e5 73    ;"s
            POP HL                      ;73d0  e1          ;
L073D1h:    LD  DE,00000h               ;73d1  11 00 00    ;
            PUSH    HL                  ;73d4  e5          ;
            PUSH    DE                  ;73d5  d5          ;
            CALL    LDIR8               ;73d6  cd a6 73    ;s
            POP HL                      ;73d9  e1          ;
            LD  A,(HL)                  ;73da  7e          ;~
            CP  082h                    ;73db  fe 82       ;
            ADC A,081h                  ;73dd  ce 81       ;
            DEC A                       ;73df  3d          ;=
            RRA                         ;73e0  1f          ;
            LD  (HL),A                  ;73e1  77          ;w
L073E2h:    POP HL                      ;73e2  e1          ;
            PUSH    HL                  ;73e3  e5          ;
L073E4h:    LD  DE,00000h               ;73e4  11 00 00    ;
            PUSH    DE                  ;73e7  d5          ;
            CALL    LDIR8               ;73e8  cd a6 73    ;s
            POP HL                      ;73eb  e1          ;
            LD  DE,(L073D1h+1)          ;73ec  ed 5b d2 73 ;[s
            CALL    DIV                 ;73f0  cd bd 70    ;p
            CALL    ADD                 ;73f3  cd a6 6c    ;l
            DEC (HL)                    ;73f6  35          ;5
            CALL    CMP                 ;73f7  cd d6 61    ;a
            JR  Z,L07401h               ;73fa  28 05       ;(
            CALL    LDIR8               ;73fc  cd a6 73    ;s
            JR  L073E2h                 ;73ff  18 e1       ;
L07401h:    POP DE                      ;7401  d1          ;
            PUSH    DE                  ;7402  d5          ;
            CALL    LDIR8               ;7403  cd a6 73    ;s
            POP HL                      ;7406  e1          ;
            POP BC                      ;7407  c1          ;
            RET                         ;7408  c9          ;
                  
B_SUM:      CALL    B_FIX               ;7409  cd 10 60    ;` 7409
            LD  A,(HL)                  ;740c  7e          ;~
            OR  A                       ;740d  b7          ;
            RET Z                       ;740e  c8          ;
            INC HL                      ;740f  23          ;#
            BIT 7,(HL)                  ;7410  cb 7e       ;~
            DEC HL                      ;7412  2b          ;+
            JP  NZ,IFCALL               ;7413  c2 36 17    ;6
            PUSH    BC                  ;7416  c5          ;
            CALL    L073B2h             ;7417  cd b2 73    ;s
            PUSH    HL                  ;741a  e5          ;
            PUSH    DE                  ;741b  d5          ;
            CALL    LDIR8               ;741c  cd a6 73    ;s
            POP HL                      ;741f  e1          ;
            CALL    ONEADD              ;7420  cd ac 73    ;s
            EX  DE,HL                   ;7423  eb          ;
            POP HL                      ;7424  e1          ;
            CALL    MUL                 ;7425  cd e0 6f    ;o
            DEC (HL)                    ;7428  35          ;5
            POP BC                      ;7429  c1          ;
            RET                         ;742a  c9          ;
                  
B_FACG:     PUSH    BC                  ;742b  c5          ;
            CALL    B_FIX               ;742c  cd 10 60    ;`
            LD  A,(HL)                  ;742f  7e          ;~
            OR  A                       ;7430  b7          ;
            JR  Z,L07437h               ;7431  28 04       ;(
            CP  082h                    ;7433  fe 82       ;
            JR  NC,L0743Fh              ;7435  30 08       ;0
L07437h:    PUSH    HL                  ;7437  e5          ;
            EX  DE,HL                   ;7438  eb          ;
            CALL    LDIR1               ;7439  cd a3 73    ;s
            POP HL                      ;743c  e1          ;
            POP BC                      ;743d  c1          ;
            RET                         ;743e  c9          ;
                  
L0743Fh:    PUSH    HL                  ;743f  e5          ;
            CALL    HEXFLT              ;7440  cd 5d 61    ;]a
            XOR A                       ;7443  af          ;
            CP  H                       ;7444  bc          ;
            JP  NZ,OVERFL1              ;7445  c2 e4 6e    ;n
            LD  A,L                     ;7448  7d          ;}
            CP  022h                    ;7449  fe 22       ;"
            JP  NC,OVERFL1              ;744b  d2 e4 6e    ;n
            LD  B,L                     ;744e  45          ;E
            POP DE                      ;744f  d1          ;
            LD  HL,00008h               ;7450  21 08 00    ;!
            ADD HL,DE                   ;7453  19          ;
            PUSH    HL                  ;7454  e5          ;
            PUSH    DE                  ;7455  d5          ;
            PUSH    BC                  ;7456  c5          ;
            EX  DE,HL                   ;7457  eb          ;
            CALL    LDIR1               ;7458  cd a3 73    ;s
            POP BC                      ;745b  c1          ;
            POP DE                      ;745c  d1          ;
            POP HL                      ;745d  e1          ;
L0745Eh:    PUSH    BC                  ;745e  c5          ;
            CALL    MUL                 ;745f  cd e0 6f    ;o
            PUSH    HL                  ;7462  e5          ;
            EX  DE,HL                   ;7463  eb          ;
            CALL    ONESUB              ;7464  cd ce 6b    ;k
            EX  DE,HL                   ;7467  eb          ;
            POP HL                      ;7468  e1          ;
            POP BC                      ;7469  c1          ;
            DJNZ    L0745Eh             ;746a  10 f2       ;
            PUSH    DE                  ;746c  d5          ;
            CALL    LDIR8               ;746d  cd a6 73    ;s
            POP HL                      ;7470  e1          ;
            POP BC                      ;7471  c1          ;
            RET                         ;7472  c9          ;
                  
L07473h:    LD  A,(HL)                  ;7473  7e          ;~
            LD  C,H                     ;7474  4c          ;L
L07475h:    ADD A,B                     ;7475  80          ;
            DEC HL                      ;7476  2b          ;+
B_ATN:      PUSH    BC                  ;7477  c5          ;
            INC HL                      ;7478  23          ;#
            LD  A,(HL)                  ;7479  7e          ;~
            RES 7,(HL)                  ;747a  cb be       ;
            DEC HL                      ;747c  2b          ;+
            PUSH    AF                  ;747d  f5          ;
            CALL    L07488h             ;747e  cd 88 74    ;t
            POP AF                      ;7481  f1          ;
            POP BC                      ;7482  c1          ;
            RLCA                        ;7483  07          ;
            RET NC                      ;7484  d0          ;
            JP  TOGLE                   ;7485  c3 eb 6b    ;k
L07488h:    CALL    ONECMP              ;7488  cd d3 61    ;a
            JR  C,L074ADh               ;748b  38 20       ;8 
            CALL    L073B2h             ;748d  cd b2 73    ;s
            PUSH    DE                  ;7490  d5          ;
            PUSH    HL                  ;7491  e5          ;
            CALL    LDIR8               ;7492  cd a6 73    ;s
            POP DE                      ;7495  d1          ;
            PUSH    DE                  ;7496  d5          ;
            CALL    LDIR1               ;7497  cd a3 73    ;s
            POP HL                      ;749a  e1          ;
            POP DE                      ;749b  d1          ;
            CALL    DIV                 ;749c  cd bd 70    ;p
            CALL    L074ADh             ;749f  cd ad 74    ;t
            LD  DE,PAITBL               ;74a2  11 78 77    ;xw
            INC (HL)                    ;74a5  34          ;4
            CALL    SUB                 ;74a6  cd d1 6b    ;k
            DEC (HL)                    ;74a9  35          ;5
            JP  B_ABS                   ;74aa  c3 c0 6b    ;k
L074ADh:    LD  A,0FFh                  ;74ad  3e ff       ;>
            LD  (L07602h+1),A           ;74af  32 03 76    ;2v
            LD  DE,L07473h              ;74b2  11 73 74    ;st
            CALL    CMP                 ;74b5  cd d6 61    ;a
            JR  C,L07509h               ;74b8  38 4f       ;8O
            LD  DE,L07475h              ;74ba  11 75 74    ;ut
            CALL    CMP                 ;74bd  cd d6 61    ;a
            PUSH    AF                  ;74c0  f5          ;
            CALL    L073B2h             ;74c1  cd b2 73    ;s
            POP AF                      ;74c4  f1          ;
            PUSH    HL                  ;74c5  e5          ;
            PUSH    DE                  ;74c6  d5          ;
            CALL    LDIR8               ;74c7  cd a6 73    ;s
            POP HL                      ;74ca  e1          ;
            JR  C,L074E1h               ;74cb  38 14       ;8
            CALL    ONEADD              ;74cd  cd ac 73    ;s
            EX  (SP),HL                 ;74d0  e3          ;
            CALL    SUB                 ;74d1  cd d1 6b    ;k
            POP DE                      ;74d4  d1          ;
            CALL    DIV                 ;74d5  cd bd 70    ;p
            CALL    L07509h             ;74d8  cd 09 75    ;u
            LD  DE,SINTBL3              ;74db  11 4a 77    ;Jw
            JP  ADD                     ;74de  c3 a6 6c    ;l
L074E1h:    LD  DE,L07501h              ;74e1  11 01 75    ;u
            CALL    MUL                 ;74e4  cd e0 6f    ;o
            CALL    ONEADD              ;74e7  cd ac 73    ;s
            EX  (SP),HL                 ;74ea  e3          ;
            LD  DE,L07501h              ;74eb  11 01 75    ;u
            CALL    SUB                 ;74ee  cd d1 6b    ;k
            POP DE                      ;74f1  d1          ;
            CALL    DIV                 ;74f2  cd bd 70    ;p
            CALL    L07509h             ;74f5  cd 09 75    ;u
            INC (HL)                    ;74f8  34          ;4
            LD  DE,SINTBL3              ;74f9  11 4a 77    ;Jw
            CALL    ADD                 ;74fc  cd a6 6c    ;l
            DEC (HL)                    ;74ff  35          ;5
            RET                         ;7500  c9          ;
                  
L07501h:    LD  A,A                     ;7501  7f          ;
            LD  D,H                     ;7502  54          ;T
            INC DE                      ;7503  13          ;
L0E7CFh     EQU    0E7CFh               ;e7cf              
            CALL    Z,L0E7CFh           ;7504  cc cf e7    ;
            LD  A,C                     ;7507  79          ;y
            SUB B                       ;7508  90          ;
L07509h:    PUSH    BC                  ;7509  c5          ;
            PUSH    HL                  ;750a  e5          ;
            LD  (L075F2h+1),HL          ;750b  22 f3 75    ;"u
            LD  DE,00008h               ;750e  11 08 00    ;
            ADD HL,DE                   ;7511  19          ;
            LD  (L075E2h+1),HL          ;7512  22 e3 75    ;"u
            ADD HL,DE                   ;7515  19          ;
            LD  (L075C8h),HL            ;7516  22 c8 75    ;"u
            ADD HL,DE                   ;7519  19          ;
            LD  (L075DAh+1),HL          ;751a  22 db 75    ;"u
            EX  DE,HL                   ;751d  eb          ;
            POP HL                      ;751e  e1          ;
            PUSH    HL                  ;751f  e5          ;
            PUSH    DE                  ;7520  d5          ;
            CALL    LDIR8               ;7521  cd a6 73    ;s
            POP HL                      ;7524  e1          ;
            LD  E,L                     ;7525  5d          ;]
            LD  D,H                     ;7526  54          ;T
            CALL    MUL                 ;7527  cd e0 6f    ;o
            LD  DE,(L075C8h)            ;752a  ed 5b c8 75 ;[u
            POP HL                      ;752e  e1          ;
            PUSH    HL                  ;752f  e5          ;
            CALL    LDIR8               ;7530  cd a6 73    ;s
            LD  A,(IY+0)                ;7533  fd 7e 00    ;~
            DEC A                       ;7536  3d          ;=
            CP  003h                    ;7537  fe 03       ;
            LD  B,A                     ;7539  47          ;G
            LD  HL,L076FAh              ;753a  21 fa 76    ;!v
            JP  Z,L075D5h               ;753d  ca d5 75    ;u
            LD  B,00Ah                  ;7540  06 0a       ;
            JP  L075D5h                 ;7542  c3 d5 75    ;u
B_COS:      PUSH    BC                  ;7545  c5          ;
            LD  A,(HL)                  ;7546  7e          ;~
            OR  A                       ;7547  b7          ;
            JP  Z,L07437h               ;7548  ca 37 74    ;7t
            LD  DE,SINTBL3              ;754b  11 4a 77    ;Jw
            DEC (HL)                    ;754e  35          ;5
            CALL    SUB                 ;754f  cd d1 6b    ;k
            INC (HL)                    ;7552  34          ;4
            CALL    TOGLE               ;7553  cd eb 6b    ;k
            POP BC                      ;7556  c1          ;
B_SIN:      PUSH    BC                  ;7557  c5          ;
            PUSH    HL                  ;7558  e5          ;
            INC HL                      ;7559  23          ;#
            LD  A,(HL)                  ;755a  7e          ;~
            RES 7,(HL)                  ;755b  cb be       ;
            AND 080h                    ;755d  e6 80       ;
            CPL                         ;755f  2f          ;/
            LD  (L07602h+1),A           ;7560  32 03 76    ;2v
            DEC HL                      ;7563  2b          ;+
            CALL    L073B2h             ;7564  cd b2 73    ;s
            LD  HL,SINTBL3              ;7567  21 4a 77    ;!Jw
            PUSH    DE                  ;756a  d5          ;
            CALL    LDIR8               ;756b  cd a6 73    ;s
            POP HL                      ;756e  e1          ;
            INC (HL)                    ;756f  34          ;4
            INC (HL)                    ;7570  34          ;4
            INC (HL)                    ;7571  34          ;4
            EX  DE,HL                   ;7572  eb          ;
            POP HL                      ;7573  e1          ;
            PUSH    HL                  ;7574  e5          ;
            CALL    CMP                 ;7575  cd d6 61    ;a
            CALL    NC,MOD              ;7578  d4 4f 61    ;Oa
            EX  DE,HL                   ;757b  eb          ;
            DEC (HL)                    ;757c  35          ;5
            EX  DE,HL                   ;757d  eb          ;
            CALL    CMP                 ;757e  cd d6 61    ;a
            JR  C,L0758Eh               ;7581  38 0b       ;8
            CALL    SUB                 ;7583  cd d1 6b    ;k
            LD  A,(L07602h+1)           ;7586  3a 03 76    ;:v
            XOR 080h                    ;7589  ee 80       ;
            LD  (L07602h+1),A           ;758b  32 03 76    ;2v
L0758Eh:    EX  DE,HL                   ;758e  eb          ;
            DEC (HL)                    ;758f  35          ;5
            EX  DE,HL                   ;7590  eb          ;
            CALL    CMP                 ;7591  cd d6 61    ;a
            JR  C,L0759Eh               ;7594  38 08       ;8
            DEC (HL)                    ;7596  35          ;5
            CALL    SUB                 ;7597  cd d1 6b    ;k
            INC (HL)                    ;759a  34          ;4
            CALL    B_ABS               ;759b  cd c0 6b    ;k
L0759Eh:    LD  (L075F2h+1),HL          ;759e  22 f3 75    ;"u
            LD  DE,00008h               ;75a1  11 08 00    ;
            ADD HL,DE                   ;75a4  19          ;
            LD  (L075E2h+1),HL          ;75a5  22 e3 75    ;"u
            ADD HL,DE                   ;75a8  19          ;
            LD  (L075C8h),HL            ;75a9  22 c8 75    ;"u
            ADD HL,DE                   ;75ac  19          ;
            LD  (L075DAh+1),HL          ;75ad  22 db 75    ;"u
            EX  DE,HL                   ;75b0  eb          ;
            POP HL                      ;75b1  e1          ;
            PUSH    DE                  ;75b2  d5          ;
            LD  DE,SINTBL3              ;75b3  11 4a 77    ;Jw
            CALL    CMP                 ;75b6  cd d6 61    ;a
            JR  NC,L0761Bh              ;75b9  30 60       ;0`
            POP DE                      ;75bb  d1          ;
            PUSH    HL                  ;75bc  e5          ;
            PUSH    DE                  ;75bd  d5          ;
            CALL    LDIR8               ;75be  cd a6 73    ;s
            POP HL                      ;75c1  e1          ;
            LD  E,L                     ;75c2  5d          ;]
            LD  D,H                     ;75c3  54          ;T
            CALL    MUL                 ;75c4  cd e0 6f    ;o
            DEFB 011h                   ;75c7  11          ; LD DE, xxxx
L075C8h:                                ;                  
            DEFW 0                      ;75c8  00 00       ;
            POP HL                      ;75ca  e1          ;
            PUSH    HL                  ;75cb  e5          ;
            CALL    LDIR8               ;75cc  cd a6 73    ;s
            LD  B,(IY+0)                ;75cf  fd 46 00    ;F
            LD  HL,SINTBL1              ;75d2  21 7a 76    ;!zv
L075D5h:    PUSH    BC                  ;75d5  c5          ;
            PUSH    HL                  ;75d6  e5          ;
            LD  HL,(L075C8h)            ;75d7  2a c8 75    ;*u
L075DAh:    LD  DE,00000h               ;75da  11 00 00    ;
            CALL    MUL                 ;75dd  cd e0 6f    ;o
            POP HL                      ;75e0  e1          ;
            PUSH    HL                  ;75e1  e5          ;
L075E2h:    LD  DE,00000h               ;75e2  11 00 00    ;
            PUSH    DE                  ;75e5  d5          ;
            CALL    LDIR8               ;75e6  cd a6 73    ;s
            POP HL                      ;75e9  e1          ;
            LD  DE,(L075C8h)            ;75ea  ed 5b c8 75 ;[u
            CALL    MUL                 ;75ee  cd e0 6f    ;o
            EX  DE,HL                   ;75f1  eb          ;
L075F2h:    LD  HL,00000h               ;75f2  21 00 00    ;!
            CALL    ADD                 ;75f5  cd a6 6c    ;l
            POP HL                      ;75f8  e1          ;
            LD  DE,00008h               ;75f9  11 08 00    ;
            ADD HL,DE                   ;75fc  19          ;
            POP BC                      ;75fd  c1          ;
            DJNZ    L075D5h             ;75fe  10 d5       ;
            POP HL                      ;7600  e1          ;
            POP BC                      ;7601  c1          ;
L07602h:    LD  A,000h                  ;7602  3e 00       ;>
            INC HL                      ;7604  23          ;#
            XOR (HL)                    ;7605  ae          ;
            CPL                         ;7606  2f          ;/
            LD  (HL),A                  ;7607  77          ;w
            DEC HL                      ;7608  2b          ;+
            LD  A,(IY+0)                ;7609  fd 7e 00    ;~
            CP  008h                    ;760c  fe 08       ;
            LD  A,(HL)                  ;760e  7e          ;~
            JR  Z,L07617h               ;760f  28 06       ;(
            CP  06Ch                    ;7611  fe 6c       ;l
L07613h:    RET NC                      ;7613  d0          ;
            JP  CLRFAC                  ;7614  c3 a9 28    ;(
L07617h:    CP  04Dh                    ;7617  fe 4d       ;M
            JR  L07613h                 ;7619  18 f8       ;
L0761Bh:    DEC (HL)                    ;761b  35          ;5
            LD  DE,SINTBL3              ;761c  11 4a 77    ;Jw
            CALL    SUB                 ;761f  cd d1 6b    ;k
            INC (HL)                    ;7622  34          ;4
            CALL    B_ABS               ;7623  cd c0 6b    ;k
            POP DE                      ;7626  d1          ;
            PUSH    HL                  ;7627  e5          ;
            PUSH    DE                  ;7628  d5          ;
            CALL    LDIR8               ;7629  cd a6 73    ;s
            POP HL                      ;762c  e1          ;
            LD  E,L                     ;762d  5d          ;]
            LD  D,H                     ;762e  54          ;T
            CALL    MUL                 ;762f  cd e0 6f    ;o
            LD  DE,(L075C8h)            ;7632  ed 5b c8 75 ;[u
            CALL    LDIR1               ;7636  cd a3 73    ;s
            POP DE                      ;7639  d1          ;
            PUSH    DE                  ;763a  d5          ;
            CALL    LDIR1               ;763b  cd a3 73    ;s
            LD  B,(IY+0)                ;763e  fd 46 00    ;F
            LD  HL,SINTBL2              ;7641  21 ba 76    ;!v
L07644h:    JR  L075D5h                 ;7644  18 8f       ;
B_TAN:                                  ;                  
            PUSH    BC                  ;7646  c5          ;
            PUSH    HL                  ;7647  e5          ;
            LD  DE,00008h               ;7648  11 08 00    ;
            ADD HL,DE                   ;764b  19          ;
            LD  (L0766Dh+1),HL          ;764c  22 6e 76    ;"nv
            ADD HL,DE                   ;764f  19          ;
            LD  (L07662h+1),HL          ;7650  22 63 76    ;"cv
            EX  DE,HL                   ;7653  eb          ;
            POP HL                      ;7654  e1          ;
            PUSH    HL                  ;7655  e5          ;
            CALL    LDIR8               ;7656  cd a6 73    ;s
            LD  HL,(L0766Dh+1)          ;7659  2a 6e 76    ;*nv
            EX  DE,HL                   ;765c  eb          ;
            POP HL                      ;765d  e1          ;
            PUSH    HL                  ;765e  e5          ;
            CALL    LDIR8               ;765f  cd a6 73    ;s
L07662h:    LD  HL,00000h               ;7662  21 00 00    ;!
            CALL    B_SIN               ;7665  cd 57 75    ;Wu
            POP DE                      ;7668  d1          ;
            PUSH    DE                  ;7669  d5          ;
            CALL    LDIR8               ;766a  cd a6 73    ;s
L0766Dh:    LD  HL,00000h               ;766d  21 00 00    ;!
            CALL    B_COS               ;7670  cd 45 75    ;Eu
            EX  DE,HL                   ;7673  eb          ;
            POP HL                      ;7674  e1          ;
            CALL    DIV                 ;7675  cd bd 70    ;p
            POP BC                      ;7678  c1          ;
            RET                         ;7679  c9          ;
SINTBL1:                                ;                  
            DEFB 07Eh, 0AAh, 0AAh, 0AAh, 0AAh, 0AAh, 0AAh, 0ABh;767a  7e aa aa aa 
                                        ;767e  aa aa aa ab  19444  19590
            DEFB 07Ah, 008h, 088h, 088h, 088h, 088h, 088h, 089h;7682  7a 08 88 88 
                                        ;7686  88 88 88 89  19445  19592
            DEFB 074h, 0D0h, 00Dh, 000h, 0D0h, 00Dh, 000h, 0D0h;768a  74 d0 0d 00 
                                        ;768e  d0 0d 00 d0  19446  19594
            DEFB 06Eh, 038h, 0EFh, 01Dh, 02Ah, 0B6h, 039h, 09Ch;7692  6e 38 ef 1d 
                                        ;7696  2a b6 39 9c  19447  19596
            DEFB 067h, 0D7h, 032h, 02Bh, 03Fh, 0AAh, 027h, 01Ch;769a  67 d7 32 2b 
                                        ;769e  3f aa 27 1c  19448  19598
            DEFB 060h, 030h, 092h, 030h, 09Dh, 043h, 068h, 04Ch;76a2  60 30 92 30 
                                        ;76a6  9d 43 68 4c  19449  19600
            DEFB 058h, 0D7h, 03Fh, 09Fh, 039h, 09Dh, 0C0h, 0F9h;76aa  58 d7 3f 9f 
                                        ;76ae  39 9d c0 f9  19450  19602
            DEFB 050h, 04Ah, 096h, 03Bh, 081h, 085h, 06Ah, 053h;76b2  50 4a 96 3b 
                                        ;76b6  81 85 6a 53  19451  19604
SINTBL2:                                ;                  
            DEFB 080h, 080h, 000h, 000h, 000h, 000h, 000h, 000h;76ba  80 80 00 00 
                                        ;76be  00 00 00 00  19453  19607
            DEFB 07Ch, 02Ah, 0AAh, 0AAh, 0AAh, 0AAh, 0AAh, 0ABh;76c2  7c 2a aa aa 
                                        ;76c6  aa aa aa ab  19454  19609
            DEFB 077h, 0B6h, 00Bh, 060h, 0B6h, 00Bh, 060h, 0B7h;76ca  77 b6 0b 60 
                                        ;76ce  b6 0b 60 b7  19455  19611
            DEFB 071h, 050h, 00Dh, 000h, 0D0h, 00Dh, 000h, 0D1h;76d2  71 50 0d 00 
                                        ;76d6  d0 0d 00 d1  19456  19613
            DEFB 06Bh, 093h, 0F2h, 07Dh, 0BBh, 0C4h, 0FAh, 0E4h;76da  6b 93 f2 7d 
                                        ;76de  bb c4 fa e4  19457  19615
            DEFB 064h, 00Fh, 076h, 0C7h, 07Fh, 0C6h, 0C4h, 0BEh;76e2  64 0f 76 c7 
                                        ;76e6  7f c6 c4 be  19458  19617
            DEFB 05Ch, 0C9h, 0CBh, 0A5h, 046h, 003h, 0E4h, 0EAh;76ea  5c c9 cb a5 
                                        ;76ee  46 03 e4 ea  19459  19619
            DEFB 054h, 057h, 03Fh, 09Fh, 039h, 09Dh, 0C0h, 0F9h;76f2  54 57 3f 9f 
                                        ;76f6  39 9d c0 f9  19460  19621
L076FAh:    DEFB 07Fh, 0AAh, 0AAh, 0AAh, 0AAh, 0AAh, 0AAh, 0ABh;76fa  7f aa aa aa 
                                        ;76fe  aa aa aa ab  19461  19623
            DEFB 07Eh, 04Ch, 0CCh, 0CCh, 0CCh, 0CCh, 0CCh, 0CDh;7702  7e 4c cc cc 
                                        ;7706  cc cc cc cd  19462  19625
            DEFB 07Eh, 092h, 049h, 024h, 092h, 049h, 024h, 093h;770a  7e 92 49 24 
                                        ;770e  92 49 24 93  19463  19627
            DEFB 07Dh, 063h, 08Eh, 038h, 0E3h, 08Eh, 038h, 0E4h;7712  7d 63 8e 38 
                                        ;7716  e3 8e 38 e4  19464  19629
            DEFB 07Dh, 0BAh, 02Eh, 08Bh, 0A2h, 0E8h, 0BAh, 02Fh;771a  7d ba 2e 8b 
                                        ;771e  a2 e8 ba 2f  19465  19631
            DEFB 07Dh, 01Dh, 089h, 0D8h, 09Dh, 089h, 0D8h, 09Eh;7722  7d 1d 89 d8 
                                        ;7726  9d 89 d8 9e  19466  19633
            DEFB 07Dh, 088h, 088h, 088h, 088h, 088h, 088h, 089h;772a  7d 88 88 88 
                                        ;772e  88 88 88 89  19467  19635
            DEFB 07Ch, 070h, 0F0h, 0F0h, 0F0h, 0F0h, 0F0h, 0F1h;7732  7c 70 f0 f0 
                                        ;7736  f0 f0 f0 f1  19468  19637
            DEFB 07Ch, 0D7h, 094h, 035h, 0E5h, 00Dh, 079h, 044h;773a  7c d7 94 35 
                                        ;773e  e5 0d 79 44  19469  19639
            DEFB 07Ch, 043h, 00Ch, 030h, 0C3h, 00Ch, 030h, 0C4h;7742  7c 43 0c 30 
                                        ;7746  c3 0c 30 c4  19470  19641
SINTBL3:    DEFB 080h, 049h, 00Fh, 0DAh, 0A2h, 021h, 068h, 0C2h;774a  80 49 0f da 
                                        ;774e  a2 21 68 c2  19471  19643
                  ;    ORG 07752h
B_SGN:      LD A,(HL)                   ;7752  7e          
            OR A                        ;7753  b7          
            RET Z                       ;7754  c8          
            INC HL                      ;7755  23          ;#
            BIT 7,(HL)                  ;7756  cb 7e       ;~
            DEC HL                      ;7758  2b          ;+
            JR  NZ,L07764h              ;7759  20 09       ;     
L0775Bh:    PUSH    HL                  ;775b  e5          ;
            EX  DE,HL                   ;775c  eb          ;
            PUSH    BC                  ;775d  c5          ;
            CALL    LDIR1               ;775e  cd a3 73    ;s
            POP BC                      ;7761  c1          ;
            POP HL                      ;7762  e1          ;
            RET                         ;7763  c9          ;
                  
L07764h:    CALL    L0775Bh             ;7764  cd 5b 77    ;[w
            JP  TOGLE                   ;7767  c3 eb 6b    ;k
B_RAD:      LD  DE,07780h               ;776a  11 80 77    ;w
            JR  L07772h                 ;776d  18 03       ;h
B_PAI:      LD  DE,PAITBL               ;776f  11 78 77    ;xw
L07772h:    PUSH    BC                  ;7772  c5          ;
            CALL    MUL                 ;7773  cd e0 6f    ;o
            POP BC                      ;7776  c1          ;
            RET                         ;7777  c9          ;
PAITBL:                                 ;                  
            DEFB 082h, 049h, 00Fh, 0DAh ;7778  82 49 0f da 
            DEFB 0A2h, 021h, 068h, 0C2h ;777c  a2 21 68 c2 
            DEFB 07Bh, 00Eh, 0FAh, 035h ;7780  7b 0e fa 35 
            DEFB 012h, 094h, 0E9h, 0C9h ;7784  12 94 e9 c9 
                  
B_INP:      PUSH    HL                  ;7788  e5          ;
            PUSH    BC                  ;7789  c5          ;
            CALL    HLFLT               ;778a  cd 67 61    ;ga
            LD  B,H                     ;778d  44          ;D
            LD  C,L                     ;778e  4d          ;M
            IN  A,(C)                   ;778f  ed 78       ;x
            LD  E,A                     ;7791  5f          ;_
            LD  D,000h                  ;7792  16 00       ;
            POP BC                      ;7794  c1          ;
            POP HL                      ;7795  e1          ;
            JP  FLTHEX                  ;7796  c3 02 29    ;)
B_RND:      PUSH    BC                  ;7799  c5          ;
            LD  DE,(L077C8h)            ;779a  ed 5b c8 77 ;[w
            LD  A,R                     ;779e  ed 5f       ;_
            XOR D                       ;77a0  aa          ;
            RRC A                       ;77a1  cb 0f       ;
            RRC A                       ;77a3  cb 0f       ;
            RRC A                       ;77a5  cb 0f       ;
            LD  D,A                     ;77a7  57          ;W
            LD  A,R                     ;77a8  ed 5f       ;_
            XOR E                       ;77aa  ab          ;
            RLC A                       ;77ab  cb 07       ;
            RLC A                       ;77ad  cb 07       ;
            LD  E,D                     ;77af  5a          ;Z
            LD  D,A                     ;77b0  57          ;W
            LD  (L077C8h),DE            ;77b1  ed 53 c8 77 ;Sw
            PUSH    HL                  ;77b5  e5          ;
            INC HL                      ;77b6  23          ;#
            RES 7,D                     ;77b7  cb ba       ;
            LD  (HL),D                  ;77b9  72          ;r
            INC HL                      ;77ba  23          ;#
            LD  (HL),E                  ;77bb  73          ;s
            INC HL                      ;77bc  23          ;#
            LD  A,R                     ;77bd  ed 5f       ;_
            LD  (HL),A                  ;77bf  77          ;w
            POP HL                      ;77c0  e1          ;
            LD  (HL),081h               ;77c1  36 81       ;6
            CALL    ONESUB              ;77c3  cd ce 6b    ;k
            POP BC                      ;77c6  c1          ;
            RET                         ;77c7  c9          ;
                  
L077C8h:    DEFW 04193h                 ;77c8  93 41       ;      	SUB	E;LD	B,C         
B_EXP:      PUSH    BC                  ;77ca  c5          ;
            LD  A,(HL)                  ;77cb  7e          ;~
            OR  A                       ;77cc  b7          ;
            JP  Z,L07437h               ;77cd  ca 37 74    ;7t
            INC HL                      ;77d0  23          ;#
            LD  A,(HL)                  ;77d1  7e          ;~
            LD  (L07896h+1),A           ;77d2  32 97 78    ;2x
            RES 7,(HL)                  ;77d5  cb be       ;
            DEC HL                      ;77d7  2b          ;+
            LD  DE,07A2Fh               ;77d8  11 2f 7a    ;/z
            CALL    MUL                 ;77db  cd e0 6f    ;o
            PUSH    HL                  ;77de  e5          ;
            CALL    L073B2h             ;77df  cd b2 73    ;s
            PUSH    DE                  ;77e2  d5          ;
            CALL    LDIR8               ;77e3  cd a6 73    ;s
            POP HL                      ;77e6  e1          ;
            CALL    B_FIX               ;77e7  cd 10 60    ;`
            PUSH    HL                  ;77ea  e5          ;
            CALL    HLFLT               ;77eb  cd 67 61    ;ga
            XOR A                       ;77ee  af          ;
            CP  H                       ;77ef  bc          ;
            JP  NZ,OVERFL1              ;77f0  c2 e4 6e    ;n
            LD  A,L                     ;77f3  7d          ;}
            LD  (L0788Bh+1),A           ;77f4  32 8c 78    ;2x
            POP DE                      ;77f7  d1          ;
            POP HL                      ;77f8  e1          ;
            PUSH    HL                  ;77f9  e5          ;
            CALL    SUB                 ;77fa  cd d1 6b    ;k
            PUSH    DE                  ;77fd  d5          ;
            PUSH    HL                  ;77fe  e5          ;
            CALL    LDIR1               ;77ff  cd a3 73    ;s
            POP DE                      ;7802  d1          ;
            POP HL                      ;7803  e1          ;
            DEC (HL)                    ;7804  35          ;5
            EX  DE,HL                   ;7805  eb          ;
            XOR A                       ;7806  af          ;
            LD  B,008h                  ;7807  06 08       ;
L07809h:    PUSH    BC                  ;7809  c5          ;
            PUSH    AF                  ;780a  f5          ;
            CALL    CMP                 ;780b  cd d6 61    ;a
            JR  C,L07817h               ;780e  38 07       ;8
            CALL    SUB                 ;7810  cd d1 6b    ;k
            POP AF                      ;7813  f1          ;
            SET 7,A                     ;7814  cb ff       ;
            PUSH    AF                  ;7816  f5          ;
L07817h:    POP AF                      ;7817  f1          ;
            RLC A                       ;7818  cb 07       ;
            EX  DE,HL                   ;781a  eb          ;
            DEC (HL)                    ;781b  35          ;5
            EX  DE,HL                   ;781c  eb          ;
            POP BC                      ;781d  c1          ;
            DJNZ    L07809h             ;781e  10 e9       ;
            LD  (L07876h+1),A           ;7820  32 77 78    ;2wx
            PUSH    DE                  ;7823  d5          ;
            LD  DE,L07A27h              ;7824  11 27 7a    ;'z
            CALL    MUL                 ;7827  cd e0 6f    ;o
            POP DE                      ;782a  d1          ;
            PUSH    DE                  ;782b  d5          ;
            CALL    LDIR8               ;782c  cd a6 73    ;s
            POP HL                      ;782f  e1          ;
            BIT 3,(IY+0)                ;7830  fd cb 00 5e ;^
            JP  Z,L078ADh               ;7834  ca ad 78    ;x
            INC (HL)                    ;7837  34          ;4
            LD  DE,FLTEN                ;7838  11 90 62    ;b
            CALL    ADD                 ;783b  cd a6 6c    ;l
            DEC (HL)                    ;783e  35          ;5
            POP DE                      ;783f  d1          ;
L07840h:    PUSH    DE                  ;7840  d5          ;
            CALL    MUL                 ;7841  cd e0 6f    ;o
            LD  DE,FLTEN                ;7844  11 90 62    ;b
            DEC (HL)                    ;7847  35          ;5
            CALL    ADD                 ;7848  cd a6 6c    ;l
            INC (HL)                    ;784b  34          ;4
            POP DE                      ;784c  d1          ;
            PUSH    DE                  ;784d  d5          ;
            CALL    MUL                 ;784e  cd e0 6f    ;o
            LD  DE,L07A1Fh              ;7851  11 1f 7a    ;z
            CALL    MUL                 ;7854  cd e0 6f    ;o
            INC (HL)                    ;7857  34          ;4
            CALL    ONEADD              ;7858  cd ac 73    ;s
            DEC (HL)                    ;785b  35          ;5
            POP DE                      ;785c  d1          ;
            PUSH    DE                  ;785d  d5          ;
            CALL    MUL                 ;785e  cd e0 6f    ;o
            CALL    ONEADD              ;7861  cd ac 73    ;s
            POP DE                      ;7864  d1          ;
            PUSH    DE                  ;7865  d5          ;
            CALL    MUL                 ;7866  cd e0 6f    ;o
L07869h:    CALL    ONEADD              ;7869  cd ac 73    ;s
            EX  (SP),HL                 ;786c  e3          ;
            EX  DE,HL                   ;786d  eb          ;
            PUSH    DE                  ;786e  d5          ;
            CALL    LDIR1               ;786f  cd a3 73    ;s
            POP HL                      ;7872  e1          ;
            LD  DE,LOGTBL1              ;7873  11 9f 79    ;y
L07876h:    LD  A,000h                  ;7876  3e 00       ;>
            LD  B,008h                  ;7878  06 08       ;
L0787Ah:    RLC A                       ;787a  cb 07       ;
            JR  NC,L07885h              ;787c  30 07       ;0
            PUSH    AF                  ;787e  f5          ;
            PUSH    BC                  ;787f  c5          ;
            CALL    MUL                 ;7880  cd e0 6f    ;o
            POP BC                      ;7883  c1          ;
            POP AF                      ;7884  f1          ;
L07885h:    CALL    ADDDEG              ;7885  cd 4a 5b    ;J[
            DJNZ    L0787Ah             ;7888  10 f0       ;
            LD  A,(HL)                  ;788a  7e          ;~
L0788Bh:    ADD A,000h                  ;788b  c6 00       ;
            JP  C,OVERFL1               ;788d  da e4 6e    ;n
            LD  (HL),A                  ;7890  77          ;w
            POP DE                      ;7891  d1          ;
            CALL    MUL                 ;7892  cd e0 6f    ;o
            POP BC                      ;7895  c1          ;
L07896h:    LD  A,000h                  ;7896  3e 00       ;>
            RLC A                       ;7898  cb 07       ;
            RET NC                      ;789a  d0          ;
            PUSH    BC                  ;789b  c5          ;
            PUSH    DE                  ;789c  d5          ;
            PUSH    HL                  ;789d  e5          ;
            CALL    LDIR8               ;789e  cd a6 73    ;s
            POP DE                      ;78a1  d1          ;
            PUSH    DE                  ;78a2  d5          ;
            CALL    LDIR1               ;78a3  cd a3 73    ;s
            POP HL                      ;78a6  e1          ;
            POP DE                      ;78a7  d1          ;
            CALL    DIV                 ;78a8  cd bd 70    ;p
            POP BC                      ;78ab  c1          ;
            RET                         ;78ac  c9          ;
                  
L078ADh:    POP DE                      ;78ad  d1          ;
            PUSH    DE                  ;78ae  d5          ;
            CALL    MUL                 ;78af  cd e0 6f    ;o
            LD  A,(HL)                  ;78b2  7e          ;~
            OR  A                       ;78b3  b7          ;
            JR  Z,L078B7h               ;78b4  28 01       ;(
            DEC (HL)                    ;78b6  35          ;5
L078B7h:    CALL    ADD                 ;78b7  cd a6 6c    ;l
            JP  L07869h                 ;78ba  c3 69 78    ;ix
B_LOG:      PUSH    BC                  ;78bd  c5          ;
            INC HL                      ;78be  23          ;#
            LD  A,(HL)                  ;78bf  7e          ;~
            RLC A                       ;78c0  cb 07       ;
            JP  C,IFCALL                ;78c2  da 36 17    ;6
            DEC HL                      ;78c5  2b          ;+
            LD  A,(HL)                  ;78c6  7e          ;~
            OR  A                       ;78c7  b7          ;
            JP  Z,IFCALL                ;78c8  ca 36 17    ;6
            SUB 081h                    ;78cb  d6 81       ;
            LD  (L0790Bh+1),A           ;78cd  32 0c 79    ;2y
            LD  (HL),081h               ;78d0  36 81       ;6
            XOR A                       ;78d2  af          ;
            LD  B,008h                  ;78d3  06 08       ;
            LD  DE,LOGTBL1              ;78d5  11 9f 79    ;y
L078D8h:    PUSH    BC                  ;78d8  c5          ;
            PUSH    AF                  ;78d9  f5          ;
            CALL    CMP                 ;78da  cd d6 61    ;a
            JR  C,L078EEh               ;78dd  38 0f       ;8
            PUSH    HL                  ;78df  e5          ;
            LD  HL,00040h               ;78e0  21 40 00    ;!@
            ADD HL,DE                   ;78e3  19          ;
            EX  DE,HL                   ;78e4  eb          ;
            EX  (SP),HL                 ;78e5  e3          ;
            CALL    MUL                 ;78e6  cd e0 6f    ;o
            POP DE                      ;78e9  d1          ;
            POP AF                      ;78ea  f1          ;
            SET 7,A                     ;78eb  cb ff       ;
            PUSH    AF                  ;78ed  f5          ;
L078EEh:    POP AF                      ;78ee  f1          ;
            RLC A                       ;78ef  cb 07       ;
            CALL    ADDDEG              ;78f1  cd 4a 5b    ;J[
            POP BC                      ;78f4  c1          ;
            DJNZ    L078D8h             ;78f5  10 e1       ;
            LD  (L07943h+1),HL          ;78f7  22 44 79    ;"Dy
            LD  DE,00008h               ;78fa  11 08 00    ;
            ADD HL,DE                   ;78fd  19          ;
            LD  E,A                     ;78fe  5f          ;_
            LD  D,000h                  ;78ff  16 00       ;
            CALL    FLTHEX              ;7901  cd 02 29    ;)
            LD  A,(HL)                  ;7904  7e          ;~
            OR  A                       ;7905  b7          ;
            JR  Z,L0790Bh               ;7906  28 03       ;(
            SUB 008h                    ;7908  d6 08       ;
            LD  (HL),A                  ;790a  77          ;w
L0790Bh:    LD  A,000h                  ;790b  3e 00       ;>
            CP  080h                    ;790d  fe 80       ;
            JR  C,L07913h               ;790f  38 02       ;8
            NEG                         ;7911  ed 44       ;D
L07913h:    PUSH    HL                  ;7913  e5          ;
            LD  DE,00008h               ;7914  11 08 00    ;
            ADD HL,DE                   ;7917  19          ;
            LD  (L07940h+1),HL          ;7918  22 41 79    ;"Ay
            LD  E,A                     ;791b  5f          ;_
            LD  D,000h                  ;791c  16 00       ;
            CALL    FLTHEX              ;791e  cd 02 29    ;)
            LD  A,(L0790Bh+1)           ;7921  3a 0c 79    ;:y
            AND 080h                    ;7924  e6 80       ;
            INC HL                      ;7926  23          ;#
            OR  (HL)                    ;7927  b6          ;
            LD  (HL),A                  ;7928  77          ;w
            DEC HL                      ;7929  2b          ;+
            EX  DE,HL                   ;792a  eb          ;
            POP HL                      ;792b  e1          ;
            CALL    ADD                 ;792c  cd a6 6c    ;l
            LD  A,(IY+0)                ;792f  fd 7e 00    ;~
            LD  DE,L07A37h              ;7932  11 37 7a    ;7z
            CP  004h                    ;7935  fe 04       ;
            JR  Z,L0793Ch               ;7937  28 03       ;(
            LD  DE,L07A27h              ;7939  11 27 7a    ;'z
L0793Ch:    CALL    MUL                 ;793c  cd e0 6f    ;o
            PUSH    HL                  ;793f  e5          ;
L07940h:    LD  DE,00000h               ;7940  11 00 00    ;
L07943h:    LD  HL,00000h               ;7943  21 00 00    ;!
            PUSH    HL                  ;7946  e5          ;
            PUSH    DE                  ;7947  d5          ;
            CALL    LDIR8               ;7948  cd a6 73    ;s
            POP HL                      ;794b  e1          ;
            CALL    ONEADD              ;794c  cd ac 73    ;s
            EX  (SP),HL                 ;794f  e3          ;
            CALL    SUB                 ;7950  cd d1 6b    ;k
            POP DE                      ;7953  d1          ;
            CALL    DIV                 ;7954  cd bd 70    ;p
            PUSH    DE                  ;7957  d5          ;
            CALL    LDIR8               ;7958  cd a6 73    ;s
            POP HL                      ;795b  e1          ;
            PUSH    DE                  ;795c  d5          ;
            LD  E,L                     ;795d  5d          ;]
            LD  D,H                     ;795e  54          ;T
            CALL    MUL                 ;795f  cd e0 6f    ;o
            POP DE                      ;7962  d1          ;
            PUSH    HL                  ;7963  e5          ;
            PUSH    DE                  ;7964  d5          ;
            CALL    LDIR8               ;7965  cd a6 73    ;s
            POP HL                      ;7968  e1          ;
            LD  DE,LOGTBL0              ;7969  11 97 79    ;y
            CALL    ADD                 ;796c  cd a6 6c    ;l
            EX  DE,HL                   ;796f  eb          ;
            POP HL                      ;7970  e1          ;
            CALL    MUL                 ;7971  cd e0 6f    ;o
            LD  DE,FLTEN                ;7974  11 90 62    ;b
            INC (HL)                    ;7977  34          ;4
            CALL    ADD                 ;7978  cd a6 6c    ;l
            DEC (HL)                    ;797b  35          ;5
            EX  DE,HL                   ;797c  eb          ;
            LD  HL,(L07943h+1)          ;797d  2a 44 79    ;*Dy
            CALL    MUL                 ;7980  cd e0 6f    ;o
            LD  DE,LOGTBL               ;7983  11 8f 79    ;y
            CALL    MUL                 ;7986  cd e0 6f    ;o
            POP DE                      ;7989  d1          ;
            CALL    ADD                 ;798a  cd a6 6c    ;l
            POP BC                      ;798d  c1          ;
            RET                         ;798e  c9          ;
LOGTBL:                                 ;                  
            DEFB 07Fh, 04Ch, 0CCh, 0CCh, 0CCh, 0CCh, 0CCh, 0CDh;798f  7f 4c cc cc 
                                        ;7993  cc cc cc cd  19797  19970
LOGTBL0:    DEFB 081h, 055h, 055h, 055h, 055h, 055h, 055h, 055h;7997  81 55 55 55 
                                        ;799b  55 55 55 55  19798  19972
LOGTBL1:    DEFB 081h, 035h, 004h, 0F3h, 033h, 0F9h, 0DEh, 065h;799f  81 35 04 f3 
                                        ;79a3  33 f9 de 65  19799  19974
            DEFB 081h, 018h, 037h, 0F0h, 051h, 08Dh, 0B8h, 0AAh;79a7  81 18 37 f0 
                                        ;79ab  51 8d b8 aa  19800  19976
            DEFB 081h, 00Bh, 095h, 0C1h, 0E3h, 0EAh, 08Bh, 0D7h;79af  81 0b 95 c1 
                                        ;79b3  e3 ea 8b d7  19801  19978
            DEFB 081h, 005h, 0AAh, 0C3h, 067h, 0CCh, 048h, 07Bh;79b7  81 05 aa c3 
                                        ;79bb  67 cc 48 7b  19802  19980
            DEFB 081h, 002h, 0CDh, 086h, 098h, 0ACh, 02Bh, 0A2h;79bf  81 02 cd 86 
                                        ;79c3  98 ac 2b a2  19803  19982
            DEFB 081h, 001h, 064h, 0D1h, 0F3h, 0BCh, 003h, 008h;79c7  81 01 64 d1 
                                        ;79cb  f3 bc 03 08  19804  19984
            DEFB 081h, 000h, 0B1h, 0EDh, 04Fh, 0D9h, 099h, 0ACh;79cf  81 00 b1 ed 
                                        ;79d3  4f d9 99 ac  19805  19986
            DEFB 081h, 000h, 058h, 0D7h, 0D2h, 0D5h, 0E5h, 0F7h;79d7  81 00 58 d7 
                                        ;79db  d2 d5 e5 f7  19806  19988
            DEFB 080h, 035h, 004h, 0F3h, 033h, 0F9h, 0DEh, 065h;79df  80 35 04 f3 
                                        ;79e3  33 f9 de 65  19807  19990
            DEFB 080h, 057h, 044h, 0FCh, 0CAh, 0D6h, 09Dh, 06Bh;79e7  80 57 44 fc 
                                        ;79eb  ca d6 9d 6b  19808  19992
            DEFB 080h, 06Ah, 0C0h, 0C6h, 0E7h, 0DDh, 024h, 03Ah;79ef  80 6a c0 c6 
                                        ;79f3  e7 dd 24 3a  19809  19994
            DEFB 080h, 075h, 025h, 07Dh, 015h, 024h, 086h, 0CDh;79f7  80 75 25 7d 
                                        ;79fb  15 24 86 cd  19810  19996
            DEFB 080h, 07Ah, 083h, 0B2h, 0DBh, 072h, 02Ah, 003h;79ff  80 7a 83 b2 
                                        ;7a03  db 72 2a 03  19811  19998
            DEFB 080h, 07Dh, 03Eh, 00Ch, 00Ch, 0F4h, 086h, 0C1h;7a07  80 7d 3e 0c 
                                        ;7a0b  0c f4 86 c1  19812  20000
            DEFB 080h, 07Eh, 09Eh, 011h, 05Ch, 07Bh, 08Fh, 088h;7a0f  80 7e 9e 11 
                                        ;7a13  5c 7b 8f 88  19813  20002
            DEFB 080h, 07Fh, 04Eh, 0CBh, 059h, 051h, 01Eh, 0C9h;7a17  80 7f 4e cb 
                                        ;7a1b  59 51 1e c9  19814  20004
L07A1Fh:    DEFB 07Ah, 008h, 088h, 088h, 088h, 088h, 088h, 089h;7a1f  7a 08 88 88 
                                        ;7a23  88 88 88 89  19815  20006
L07A27h:    DEFB 080h, 031h, 072h, 017h, 0F7h, 0D1h, 0CFh, 07Ah;7a27  80 31 72 17 
                                        ;7a2b  f7 d1 cf 7a  19816  20008
            DEFB 081h, 038h, 0AAh, 03Bh, 029h, 05Ch, 017h, 0F1h;7a2f  81 38 aa 3b 
                                        ;7a33  29 5c 17 f1  19817  20010
L07A37h:    DEFB 080h, 031h, 072h, 018h ;7a37  80 31 72 18 
                  
                  ;    ORG 07A3BH
VSTART: DEFW 07C89h                     ;7a3b  89 7c       
STRPTR: DEFW 0                          ;7a3d  00 00       
STKLMT: DEFW 0                          ;7a3f  00 00       
STRTOP: DEFW 0                          ;7a41  00 00       ; EQU  07a41h
INTSSP: DEFW 0                          ;7a43  00 00       
STRBTM: DEFW 0                          ;7a45  00 00       
MEMEND: DEFW 0                          ;7a47  00 00       
MEMMAX: DEFW 0                          ;7a49  00 00       ;  EQU  07a49h
INTFAC: DEFW 0                          ;7a4b  00 00       ;  EQU  07a4bh
        DEFW 0                          ;7a4d  00 00       
IMDBUF  EQU  07b4eh                     ;7b4e              
TEXTST  EQU  07c4eh                     ;7c4e              
                  ;	ORG 07A4FH
KEYBUF: DEFB 00Ch                       ;7a4f  0c          
        DEFM 'SAMSUNG HUBASIC V1.0'     ;7a50  53 41 4d 53 
                                        ;7a54  55 4e 47 20  19835  20029
                                        ;7a58  48 55 42 41  19835  20030
                                        ;7a5c  53 49 43 20  19835  20031
                                        ;7a60  56 31 2e 30  19835  20032
        DEFB 00Dh                       ;7a64  0d          
        DEFM 'COPYRIGHT (C) 1982'       ;7a65  43 4f 50 59 
                                        ;7a69  52 49 47 48  19837  20035
                                        ;7a6d  54 20 28 43  19837  20036
                                        ;7a71  29 20 31 39  19837  20037
                                        ;7a75  38 32        19837  20038
        DEFB 00Dh                       ;7a77  0d          
        DEFM '       BY HUDSON SOFT'    ;7a78  20 20 20 20 
                                        ;7a7c  20 20 20 42  19839  20041
                                        ;7a80  59 20 48 55  19839  20042
                                        ;7a84  44 53 4f 4e  19839  20043
                                        ;7a88  20 53 4f 46  19839  20044
                                        ;7a8c  54           19839  20045
        DEFB 00Dh                       ;7a8d  0d          
        DEFS 07B00h-$                   ;7a8e              
                  
;Z80-Assembler		Release 1.6				Page 1
;Source file: spc-1000_all.asm
;Title:       Symboltable

BOOT     0000	JT1      0000	JT2      0003	JT3      0006	
JT4      0009	JT5      000c	JT6      000f	JT7      0012	
JT8      0015	JT9      0018	JT10     001b	JT11     001e	
JT12     0021	JT13     0024	JT14     0027	JT15     002a	
JT16     002d	JT17     0030	JT18     0033	TICONT   0036	
JT19     0038	JT20     003b	JT21     003e	JT22     0041	
JT23     0044	JT24     0047	MAIN     004a	INITSB   0056	
NOPRET   0061	IO20SB   0062	IO60SB   006b	COUNTR   0074	
FSAVE    0080	FSAVE0   008e	FSAVE1   00ad	MSAVE    00b6	
SAVE     00ce	SAVE1    00d3	SAVE0    00e3	SAVE2    0100	
SAVE3    0102	SAVE4    0110	FLOAD    0114	FLOAD1   0122	
MLOAD    0134	CLOAD    014c	CLOAD7   0151	CLOAD0   0158	
CLOAD1   0175	CLOAD8   019c	CLOAD4   019d	CLOAD2   01a5	
CLOAD3   01ad	CLOAD5   01b3	MVRFY    01b9	MVRFY1   01e3	
MVRFYN   01e8	MVRFY2   01ef	MVRFY3   0206	MVRFY4   0230	
EDGE     0230	MVRFY5   023b	MVRFY6   0244	MVRFY7   024f	
VBLOAD   0259	VBLOD1   0266	VBLOD2   0282	VBLOD3   028d	
MKRD     0291	MKRD1    02a0	MKRD4    02aa	MKRD5    02ad	
MKRD2    02c3	MKRD3    02dc	MOTON    02e0	MOTON1   02ef	
MOTON6   02f8	MOTON4   02f9	MOTON5   02fd	MOTON2   031f	
MOTON3   032b	MOTCH    0344	MOTCH1   0353	MOTCH2   035f	
WRITEM   0375	MBUF6    037e	MBUF6A   0383	MBUF7    038f	
CKSUM    039e	SUM1     03a4	SUM2     03b3	SUM3     03b7	
SUM4     03bb	WAITR    03c4	WAIT2    03c6	WRITES   03cb	
WRITEL   03ed	WRACC    040f	WRACC1   0415	WRMRK    0422	
WMRK1    0436	WMRK2    043e	WMRK3    0444	MONOP    0450	
MONCOM   0455	MONINP   045d	MONSTK   0483	MEMWRT   0487	
WRTLP    048a	CALLAD   049e	MEMDMP   04a3	HLSTOK   04b2	
MEMDPL   04b6	HLEND    04bb	MONDPS   04c5	DMPSUB   04c8	
LINCNT   04c9	DMPSB2   04ca	MEMLP2   04cd	SPCSTP   04d3	
MONEDT   04e1	DATAST   04ec	ACCSET   04f6	AHEXIN   0500	
HLSET    0509	HLHOLD   051d	HEX4IN   051f	HEX4ER   052a	
HEX2IN   052c	BHEXIN   0540	DESMAL   0553	HLINDS   055e	
HEX2PR   0562	ASCSET   0578	CRHLDS   0580	MONSAH   058e	
MNSHLP   05ae	HLDECK   05c2	HLDEC1   05c9	HLDEC2   05d2	
SCRNBC   05d6	SCRNS0   05f3	SCRNTB   0660	SCRN00   0668	
SCRN01   0674	SCRN02   0680	SCRN03   068c	SCRN04   0698	
INPUTF   06a4	INKYLP   06ad	BREAKI   06be	BELL     06ca	
BELL2    06d2	BELL3    06d8	L0715    0715	BELLBF   0740	
BELLTB   0744	BELLT2   0748	BRKJOB   074c	CRJOB2   0751	
INPEND   0757	ACCEND   075a	CRJOB    075f	L0770    0770	
CRJOBL   077e	L0786    0786	CRJOBP   078e	AINBC    0794	
ALPHA    07ab	AINOK    07b5	SEMI6    07b7	BCUYST   07ba	
LPBNST   07be	ECUYST   07c5	ECUYS2   07c8	CUTBHL   07d3	
ATBHL    07d6	CR1DEP   07de	PRTSDC   07e1	PRTSDL   07e8	
PRTSDE   07ef	DEPRT    07f3	DEPRTL   07f5	DEPRTR   07ff	
TABPRT   0802	TABPRL   0819	CR2      0823	CCR2     0833	
CR1      0843	CR1CTM   0858	SPPRT    0862	ACCPRT   0864	
ACCOUS   0870	PRINTR   0887	PSGST    08a9	PRTRDY   08bb	
WAITLP   08c4	ACCOUT   08d9	ACCDIS   08de	ACCOL1   08ef	
ACCOL2   08f6	CTRLM?   0902	PAGE02   0908	SCRLC1   090f	
PAGE04   0915	SCRLC2   091f	CURSE?   092b	CURSET   0934	
ADRCAL   0938	ADRCA2   093b	PAGE05   0946	GACPRT   094f	
ROMACP   095b	GACPR1   0960	GACPRL   0981	SCRLUP   0991	
PAGE11   09b2	BCLDIR   09be	BCLDL1   09c6	BCLDL2   09ce	
BCLDL3   09e1	SCRLDW   09ea	PAGE12   09ee	PAGE14   09f8	
CHRLE2   09fc	PAGE16   0a01	PAGE17   0a07	BCLDDR   0a13	
BCLDD1   0a1b	BCLDD2   0a23	BCLDD3   0a36	BCOUTA   0a3f	
BCOTOK   0a57	SEMIOT   0a63	CTRLSB   0a81	DELETE   0a8e	
DELLP1   0aa9	DELLP2   0acb	CLR2     0ad5	CHRSTA   0ad6	
CLRLP    0add	ATRSTA   0ae6	CHRLEN   0ae9	ATRCLS   0af1	
LINEFR   0afa	PAGE23   0afc	LINCLS   0afe	HOME     0b03	
INST     0b09	INSTL1   0b2a	LOCK     0b3f	LOCKST   0b41	
UNLOCK   0b45	LEFT     0b48	UPCUR    0b53	CTRLM    0b62	
RIGHT    0b6b	DOWNLB   0b76	CURST2   0b83	UP       0b87	
DOWN     0b8c	CTRLG    0b91	CTRLB    0b9c	CTRLB1   0ba5	
CTRLB2   0bab	CTRLF    0bb4	CTRLF1   0bbd	CTRLF2   0bc3	
CBFCEK   0bca	CTRLBF   0bd2	L0BEC    0bec	L0BF4    0bf4	
CTRLY    0bf7	CTRLT    0bfb	CTRLYT   0bfd	CTRLI    0c08	
CTRLE    0c1d	CTRLZ    0c25	CTRLZ1   0c2d	CTRLEZ   0c35	
CTRLZE   0c4c	BRKEY    0c5b	ASCGET   0c62	BUFCEK   0c6c	
GETRET   0c7a	BUFSET   0c7e	FLASHF   0c7f	BRKGTR   0c8b	
KEYGT    0c92	ZERORT   0ca1	ZEROR2   0ca4	FLGET    0ca7	
REPETS   0cb7	KEYBFA   0cbb	KEYBFD   0cbe	NEWKYS   0cc5	
REPTSW   0cc9	KEYST2   0ccb	SETLP1   0cd5	SETPL2   0cdc	
SETPL3   0ce5	SETPL4   0ce9	KYBFSR   0ced	FLASHS   0cf8	
FLASHG   0d14	FLASHA   0d15	FLASHD   0d18	FLASHC   0d1f	
L0D28    0d28	FLASHO   0d2a	FLASHE   0d32	FLSHGT   0d3c	
FLGTLP   0d42	REPETF   0d57	FLSHL3   0d65	FLGTL2   0d68	
FLSHRT   0d71	KEYSEN   0d7a	KEYSN0   0d7d	KEYSN1   0d7f	
KEYSN2   0d8c	KEYSN3   0d96	L0D9D    0d9d	L0DA5    0da5	
L0DB1    0db1	L0DB9    0db9	NEWCEK   0dbb	NEWPL1   0dc3	
SAMECK   0dd1	SAMELP   0dd9	NEWFLG   0de1	FLGLP1   0de9	
FLGLP2   0dff	FLGLP4   0e0c	FLGLP3   0e0e	FLGLP5   0e13	
FLGLP6   0e17	FLGLP9   0e21	FLGLP7   0e25	FLGLP8   0e2c	
KYBFST   0e35	L0E4C    0e4c	CTRLNO   0e5c	SETKY    0e69	
NONKEY   0e6c	NONKE?   0e6f	SETKY2   0e7a	FUNCTN   0e95	
FUNCLP   0ea8	BFSTSB   0eb1	NONSET   0eca	NORET    0ecc	
MUSIC    0ecd	MUSL1    0ece	MUSL2    0ed8	MUSL4    0eda	
MUSL3    0ede	MUSL6    0ee6	MUSL7    0ee9	MUSL5    0eec	
MUSLOP   0eed	SOUSET   0f2e	SOUST2   0f32	VOLST2   0f57	
VOLST    0f59	VOLOK    0f6b	OCTOK    0f7e	OCTOK2   0f81	
OCTNO    0f8d	OCTNOP   0f90	L0F9A    0f9a	OCTNOM   0f9c	
NUMOK    0fa8	OCTDVL   0fc5	OCTDIV   0fcf	SOUON    0fe6	
SOUOFF   100e	SOUOFE   1021	SOUOFS   1029	SOUSTP   103b	
BRKRET   1042	ENDCHK   1052	DELAYS   1077	DELAY1   107a	
DELAY2   107d	LENGSB   1088	XTEMPO   1095	SOUNDS   1099	
SOUND1   10a9	SOUND3   10b9	SOUND5   10cb	SOUND4   10d2	
SOUND2   10ee	MSDT32   10fe	MUSNUL   1100	LENGTB   1101	
LEN?A    110b	DATA?A   110d	OCT?A    1110	LENG?A   1111	
LEN?B    1113	DATA?B   1115	OCT?B    1118	LENG?B   1119	
LEN?C    111b	DATA?C   111d	OCT?C    1120	LENG?C   1121	
NUMTBL   1123	UPTBL    1131	CTRLTB   113f	BELLFG   117f	
COLORF   1180	GCOLOR   1181	SCRLBF   1182	LINEF    11a2	
CKSMF1   11e3	CKSMF2   11e5	MKLEN    11e7	IO6000   11e9	
IO2000   11ea	DISFLG   11eb	PRINTN   11ec	CURX     11ed	
CURY     11ee	OLDBUF   11ef	NEWBUF   11f9	NEWMOD   1202	
LOCKMD   1203	POINT1   1204	POINT2   1205	INKYBF   1206	
TABBUF   1246	FUNBUF   1266	KEYDT1   1306	KEYDT2   134e	
FILMOD   1396	FILNAM   1397	MTBYTE   13a8	MTADRS   13aa	
MTEXEC   13ac	PROTCT   13ae	COLDST   1418	$BASIC   1418	
MESOFF   141d	L0014    142a	L001E    1434	START    143d	
HOTENT   1446	OK       1462	CONTDS   147c	NMESOK   1488	
AUTOBK   148b	KEYINP   1492	MERGEV   1499	LODVEC   149d	
BLNKSK   14a2	L00A5    14bb	ONELIN   14db	SPCCUT   14df	
BREAKJ   14f7	PAUSEP   14fa	LETDA'   14ff	LETDAI   150e	
DAINUE   1514	DAINV'   151b	DAIMID   152f	DAITRS   1531	
DAIRET   1538	INTDAI   153c	DAISTR   1546	STRMDM   1552	
ESKTRS   156e	INPENT   1571	DAIMD'   158a	LININP   1593	
ZEROMK   159d	KBCLLP   15a8	ENDTXT   15af	OKFVC    15b3	
RUN      15c3	RUNBOT   160b	RUNMID   160e	NXLINE   1611	
NXTLPT   1612	TRACEF   1629	DEBUGR   1631	NXSPL0   1655	
NXSPL1   1665	NXSPL2   1679	NXSPL3   168b	DEBGHL   169f	
BREAK$   16a0	BREAK    16a2	BRDRCT   16b0	LNOPRT   16cb	
LNOBUF   16cc	FIVEPR   16e5	SKIPFZ   16ee	LSTODP   16f6	
PRTNUM   16fc	BREAKM   1705	INMES    170a	CVDSAD   170e	
STMNTS   1720	TYPEMS   1732	IFCALL   1736	SERROR   173a	
ERJUMP   173c	FUNCTN1  173f	MEMDAI   1745	MEMDSE   1747	
SKMDAI   1771	NOMDAI   177c	MIDDAI   177e	MIDRAL   17b5	
MDTLLD   17d4	RPSTSW   17ee	SKIOMR   17fc	LSTRPL   1804	
NOEFT2   181c	RETNOE   181d	NOEFT1   1821	DFLTCL   1824	
REM      183a	FILEER   183e	PRTSTR   1843	RGPRMT   1851	
PRINT    1855	PRDVSW   1874	PRTERM   188a	PRINT'   1891	
PRSCRV   1893	RGPRM'   18ca	SKIPP    18d6	PRTYUI   18d8	
SEMIS    18ea	DISCLR   18f4	CRLFR'   18fa	CRLFRT   18fc	
DECBCL   1902	TABOPR   1912	CRTTAS   192a	TSUBLS   192d	
TABPPP   1932	TABPPT   1933	NOTABO   1939	SPCOPR   1940	
CLR      1951	FOR      196f	FTSKIP   1985	NXTSFT   19a5	
FORPUS   19ad	STEPON   19db	FVTYPE   19f1	FLJPVC   19f9	
NXFVAR   19fb	NXWFOR   1a05	NEXT     1a0a	NEXTAG   1a16	
AGINCV   1a1b	SKSTKS   1a27	NXTNXT   1a4d	NXFPOR   1a5a	
DFLTNX   1a62	FPCOMP   1aa3	OMODED   1aaa	NEXTRT   1ab3	
INTFOR   1ac1	MNIFOR   1aec	INTCMP   1af4	INTCPM   1afd	
ICHMNS   1b04	CPRTMY   1b0b	NCICMT   1b10	ERTEST   1b14	
ERRTST   1b19	LET      1b1c	POKE     1b23	POKELP   1b28	
RETIRQ   1b39	CLS      1b42	CLSSB    1b4c	CLS1LP   1b51	
SCREEN   1b59	GRAPHI   1b93	GRAPH    1b95	GM2345   1bab	
GRAPOK   1bb8	GSAVES   1bea	GSAVEL   1bf3	GSAVEP   1bf5	
GMODEF   1c06	SCRTAB   1c07	LOCATE   1c25	LCTIFC   1c32	
READ     1c45	DATASK   1c5f	DATAPO   1c60	DATAS'   1c62	
MIDDAR   1c78	DATAFD   1c8a	RESLBL   1c92	RESTOR   1ca5	
RESTTT   1cc2	DATA     1cc8	DATALZ   1cc9	LINCIN   1cd4	
LINE     1ce7	LINPOL   1d05	PMTOUE   1d14	LINPNP   1d1c	
LINVEC   1d30	LINESR   1d38	ESLINE   1d40	IBREAK   1d49	
IBREKH   1d4c	CINP'#   1d51	CIRPUT   1d6c	INPUT    1d74	
PMTOUL   1da4	NPASK?   1db3	PMTASK   1dc2	PMASVC   1dc3	
LINEKB   1dc5	NOPPMT   1dcd	INPLOP   1ddf	DATAV1   1de2	
DASKIO   1de8	DATAFV   1dfc	INNMOK   1e2e	NXTIN?   1e49	
PMTERM   1e59	READVC   1e5a	INITDI   1e5c	STRINP   1e69	
SRINPL   1e79	DATAV2   1e81	ESCINS   1e87	ESCIN'   1e88	
DATA22   1e98	DATADN   1e9c	INSDC    1ea8	INPSDC   1ea9	
HMEMCK   1eab	MEMCHK   1eb0	MCHKMD   1eb6	MCHCKR   1ecf	
GETVAC   1ed3	GETVAB   1ed7	GETVAR   1eda	VARCLP   1eeb	
GVARRT   1f01	SKIPUS   1f04	SKIPVT   1f18	SKIPVU   1f19	
SKIPVV   1f1a	CRNVAR   1f23	LZFIL1   1f2e	ARRAY    1f41	
TSALOP   1f4a	TSFARY   1f6a	ASLOP    1f79	ARSKFN   1f84	
ARYATA   1f8c	MIDNAM   1f9b	NXTVR    1fa1	NXTVR1   1fa2	
ARMSN1   1fa7	ADRCL    1fca	ARBCBF   1ff1	CHALNM   1ff5	
DIM      2003	DASLOP   2020	DRSKFN   202a	DRYATA   2032	
DIDNAM   2042	DXTVR1   2047	DXTVR    2048	MOPDIM   204c	
DIMFDD   205d	ARGLOP   2063	DEFARY   2074	AREPUT   208c	
ARYCLL   20c0	OFF      20da	OFFOFF   20e7	BREAKL   20eb	
SORERR   20f5	NIERRO   20f7	NINS     20fa	VSRTST   20fe	
SKIPDM   2115	CHKTYP   211d	DFLTER   2141	IMUL     214b	
IMADL1   2154	IMNADD   215a	IMADL2   2166	IMNAD1   216c	
IMRET    2172	ERROPR   2175	CURTXT   217b	ERRORV   2183	
OMERRE   2188	OMERR    2188	ERROR    2196	ERRSML   21b7	
ERRTCO   21cb	UNPERR   21d7	ERRLOP   21da	UNPMES   21e5	
OKMES    21f7	SETSSP   21f9	CONT     2207	CONTFG   2208	
OKCONT   2211	BLNOBF   2216	BNXTLP   221c	BTEXTP   2222	
SPBUF    2225	AUTOFF   222a	AUTOVC   2237	AUTOLN   2239	
AUTOST   2245	RESUME   224f	ERRORF   2250	ERNLPT   225f	
ERRLNO   2265	THISLN   2289	RESTXT   228a	RESERR   228d	
ERRCOD   2295	FLEXPR   2299	FLEXP'   229c	MOTEST   22ac	
STEXPR   22b2	STEXP'   22b5	HLEXP    22c7	IHLEXP   22cc	
MDLHLE   22cf	BYTE     22d5	HCHECK   22d8	IBYTE    22df	
TYPECS   22e4	TOOCMP   22ed	EXPRSN   22f2	MEMFAC   22f4	
XORAGN   22ff	EXPPH3   2326	ORAGN    2329	EXPPH4   2350	
ANDAGN   2353	EXPPH5   237b	EXPPH6   239d	LOGLP    23a0	
LDGTCM   23b8	TRUE     23bc	LGBACK   23c9	FALSE    23cc	
GTTHAN   23d7	PORTRU   23dd	EQUALG   23e0	ALGLOG   23eb	
GTEQLG   2403	NOTEQU   2407	EXPR1    240e	EXPR'    2411	
EXPRBK   241d	EXPRBK1  2421	EXADD    2426	TERM     2433	
TERM'    2436	TERMBK   2446	TMDIV    244b	MFACT    245b	
MFACT'   245e	MFACBK   246e	TMMOD    2473	POWZRR   2480	
POWAGN   2489	FACT     248f	MIDFAP   2492	MPOWER   24ac	
POWER    24c6	RPOWER   24dd	IPOWER   24ef	PWCLLP   250c	
PWCLL1   252b	NEXTPL   2537	PSWAP    2542	FACT''   255f	
INUSE    2585	KAKKO    2596	CONDSB   25b1	MOCHCK   25b7	
MOPRND   25bf	BCFTCH   25c4	CONST    25cc	FLTHXB   25db	
BCKFTR   25e3	HXORFL   25e6	LDELNO   25f2	LNOCON   25fa	
FLTPNT   2603	VARFUN   2624	FUNCNS   262f	VARFNE   2637	
VARTR#   2651	RTVARI   2657	STRVAR   265c	INTVAR   2664	
FUNGVR   2673	NFCVAR   2682	EFCT1    2687	VRFLOP   2697	
CPIMDP   26ad	LSTCMP   26b7	CPIMDQ   26ba	FVRFND   26c2	
FNBCPT   26c3	FNLVRS   26d3	FVRFDD   26d6	TSTARG   26e4	
FNCGS    26ec	SNXT2C   2708	SK2C2C   2710	S2C2CL   2716	
SK2829   271e	SK2BLO   2728	SKPSBL   272d	SKSBER   2731	
HEXSKS   2745	DWNERG   274d	DQSKCM   2755	FCTION   2761	
FTRMER   276c	FLFNRT   2781	FNCCON   2789	FUNCT1   278c	
SRFNRT   2797	FUNCT2   279c	SRSRRT   27ba	OTHERF   27c5	
LENSUB   27cb	ASCSUB   27d6	MIDERL   27e8	VALSUB   27f9	
VALTRL   280e	MIDVAL   2814	ZRVALR   2820	NULSDC   2825	
INKEY    2828	NORGET   2854	LSTGET   285c	INKMID   2862	
NLINKY   2865	INKBCK   286c	CHRMIS   286f	CHRSUB   2874	
CHRMID   287c	GETFJP   289c	GETJPA   289f	CLRFAC   28a9	
CLFCLP   28ad	STRFAC   28b5	STRSL    28c3	LENOKS   28cd	
CONDSR   28d9	OKSTTH   28e5	CONDFL   28eb	STFLMK   28fd	
STDBL    28fe	FLTHEX   2902	NORFLH   2919	SFL      291b	
FLHXRT   2926	DEFINT   2930	DEFSTR   2934	DEFSNG   2938	
DEFDBL   293c	CONTDF   293e	CDEFTP   2953	STRMDM2  2968	
DFFIL1   296c	CALLUP   2974	CALUPR   2981	INCHLF   2986	
HLFTCH   2987	INTG     298d	MNINTR   29b6	STRING   29b8	
SPCSU'   29e3	SPCSUB   29e8	SPCSME   29f6	SPCFLL   29fe	
FILLCH   29ff	NULRET   2a03	FRACSB   2a0e	PEEK     2a14	
HEXD     2a26	MIDOCT   2a35	OCTD     2a42	STRSUB   2a53	
MIDHEX   2a5a	MK1      2a75	MKS      2a88	MKD      2a8e	
MKHILS   2a92	INDRCT   2aa3	CVI      2aaa	CVD      2aca	
CVS      2acf	CVMIDE   2ad2	CVTRLP   2ae9	PARI     2af5	
SKIMPL   2b0f	ENTSTR   2b1a	CDBL     2b21	CSNG     2b26	
EPREST   2b4b	CINT     2b5a	INRETY   2b7b	LEFT1    2b80	
LFTOLM   2ba9	LMIDET   2bae	NOLENE   2bc5	RIGHT1   2bd4	
NOLSRD   2bfd	MID      2c0f	MIDALL   2c52	KMIJL    2c70	
MNULIS   2c71	MIDNUL   2c74	INSTR    2c7a	SINSEX   2ca6	
INCPL1   2cd9	INSCPL   2cef	INMTCH   2cf9	INSRET   2d00	
INSZR    2d05	BCPOTR   2d11	INSZR1   2d19	INSZR2   2d1a	
INSZR3   2d1b	FRE      2d1e	FREMID   2d35	VARPTR   2d40	
CH28H    2d58	SERVED   2d5e	CH2CH    2d61	CH29H    2d66	
MEM$     2d6b	HLFLTO   2d97	GETSTR   2d9e	STRTRL   2dd0	
NULBCK   2dd7	NULSTR   2de3	MEMPUR   2de8	MEPDEB   2e1d	
PURGE    2e37	PURAGN   2e41	SPBLTF   2e50	STKBLT   2e55	
MIDMPR   2ea0	BLTAJL   2eaa	BLTRET   2ec0	BLTHLB   2ec1	
BLTDEB   2ec4	BLTBCB   2ec7	BLTRTA   2eca	STRPRG   2ecc	
FSTRTP   2ed2	FDSRTP   2ee5	SPRGLP   2ee8	ESCSPR   2efb	
SHORTN   2eff	SHRTNL   2f00	STRNST   2f14	ADRSFL   2f3d	
SREDCK   2f59	OVERST   2f64	SJPTBL   2f68	FJPTBL   3006	
DFTABL   3088	USRTBL   30a2	ADHLHL   30b6	OVERFL   30b8	
CVBCAS   30bd	CVBABS   30c6	INCRTM   30ce	HEXCUL   30d0	
LNOCLP   30d3	EDITOR   30f2	RSFGLP   310b	DELMIK   3119	
IMLSTP   312f	ENOSLP   3144	IMDENS   3148	EAPEND   315e	
RELPTR   3196	DELETE1  31a5	FSTLOP   31ae	RTDLTE   31b6	
POPDLR   31bb	FDDLST   31be	LNOTBF   31d3	SNDDLP   31dc	
DLEFD'   31f2	DLSTRT   31f4	DRNLOP   3218	SEARCH   322b	
SEARC'   323c	SERVEC   3258	MARDEB   325c	MATLEN   3262	
SERRTT   326d	SERNMT   3272	MATLIS   3277	SERDIS   3278	
SERLPP   327a	ESSRSP   3284	SER0DH   3289	SERINT   328f	
SERLEN   3290	SERDEB   3295	TRACE    329b	TRLTPR   32b9	
TRACL0   32c0	TRACL1   32c6	TRACL2   32cc	TRACL3   32d2	
TRACL4   32d8	TRACLP   32de	TRCOFF   32e4	RTTRAC   32e7	
TROFF    32ea	SWAP     32ef	SWTRL1   3312	NXTSAS   3348	
SWAPHL   3349	NXTSAW   3365	OUT      3367	OPORT    337a	
CLOSE    3382	FILEFG   3383	CLSINP   339d	CLEAR    33ab	
MEMSET   33e9	USING    3410	OKLIOP   3420	USGIFC   3423	
IUSGLP   343b	USNGLP   3442	PUTCHS   346f	USINED   3474	
PRTEDF   3475	ESPUVC   3481	URTVEC   3482	PESCCH   3484	
PSFRST   3488	CHCKRV   34a2	USGCON   34b3	MGFDXZ   34bd	
PTPURV   34c2	USGCMN   34c7	PUCHRA   34d1	PULSC#   34d7	
PUSEMR   34dd	CRRTIR   34e3	PSMIDL   34e9	COUUSP   34eb	
ESCCSP   34f9	ZRPRUS   3506	USGMDL   350b	RETIOE   3512	
PRSPNE   351c	USGMD'   3525	SPACPT   352d	ASTRSK   3534	
KIUYTJ   354e	VENUSG   3559	PLUSUS   356b	PRLEN?   3579	
PFLENG   3581	PULSLS   3589	MIDFUS   358c	PUGTFC   359f	
PUCOMP   35b1	PUAFMO   35c1	PUAFQO   35cb	PUPOIT   35d3	
PUPOFC   35da	PUCOPP   35eb	BEGUSG   35f1	CHEXPU   35f8	
NEXPPU   3609	FRCLEN   3621	PUEXPF   3624	PUCOMF   3631	
COMN3D   3643	COMSK3   3645	PURTJM   3655	ESCPUC   365c	
INTLEN   365d	COMTPU   366d	LADJS1   3674	PUAFMF   3675	
NPUSGN   3677	RPLUSF   367b	FPLUSF   3680	FPUTER   3693	
PUPTML   3694	THISLN1  369f	PTPLS1   36a2	USGSGN   36a3	
LADJS2   36ad	PUYENF   36ae	LSDQW1   36b8	LADJS3   36c4	
PUASTF   36c5	ASTFIL   36ca	LADJ4'   36d5	LADJS4   36d6	
LSDVZR   36ea	PULSTX   36ee	TST2DH   36f3	RETPU$   3701	
USGBCB   3702	USGDEB   3705	AUTO     370f	EDLINE   372a	
AUTONE   3732	AUTNER   3735	AUTOES   3743	LPOS     374a	
POS      374f	POSMID   3752	ERR      3758	MIDERS   375e	
ERL      3772	ADJERL   3778	FLMXD0   3786	DEL      378e	
RENUM    37aa	SKIRE1   37d4	SKMRNU   37e8	RNSTRT   37fa	
BEGRNS   3816	STLNO    3823	BEGREN   3830	NEWNO    3834	
REKUML   3836	ADDNO    3842	RNUMED'  384c	RENOVR   3851	
CROPEN   3865	LODIFC   388d	LDFNTR   3895	LOADST   389e	
LFDFNL   38b3	FLFPRE   38be	LOADFN   38c3	FNCMPL   38cd	
LFNLCP   38d9	LFNOK    38dd	ROPEN    38f4	VERIFY   38fc	
MERGE    3919	LOAD     392c	MRGEVC   3949	TPRDER   3969	
BLOAD    3978	RTBLOD   39a1	MLLOAD   39a4	NEW      39ac	
CVLOAD   39b9	CVLDLP   39bf	ESCCVL   39d1	CVSAVE   39de	
CVSVLP   39e4	CINPUT   39f8	CLDLP1   3a04	MIDCIP   3a09	
ABORT    3a1c	CBREAK   3a26	NRLDED   3a30	LFOUM    3a43	
LDINGM   3a49	WOPEN    3a51	CWOPEN   3a5d	NULSAV   3a7f	
WOPIFC   3a81	SAVEFT   3a92	NULFNM   3a98	SAVE$    3abb	
BSAVE    3af6	CBREA'   3b0b	CBRSHM   3b0e	SAVEM    3b13	
SVMNEA   3b3c	DEFFN    3b4d	FNSERR   3b51	DUPDEF   3b8b	
ERJVDE   3b8d	ILDRCH   3b90	UNDEFN   3b9d	GETFUN   3ba1	
GFNLP1   3bb3	SKIPN1   3bd1	SKIPN2   3be4	SKIPFN   3be6	
FNNOTF   3bee	FNOPR    3bf4	STRFNC   3c06	ARGFUN   3c09	
DFLTUF   3c3c	DEFUSR   3c40	DFLTZR   3c51	USERSE   3c71	
USRDFZ   3c74	USROPR   3c78	USRDZE   3c87	USRBCK   3cbc	
TIME$    3cc1	SCRN$    3cc4	SCRNER   3ccf	SCRIFC   3cd7	
SCRNTL   3d0e	L2900    3d16	DUMP     3d2f	STDPDV   3d3b	
DMPLOP   3d42	ARYSKP   3d54	ARDSLP   3d61	ONLYVR   3d82	
STRDMP   3da9	RALDMP   3dbb	NXTDMP   3dc9	DUMPRT   3de4	
PRDMVR   3deb	NTNULD   3df8	PTVSBL   3e0f	CONSOL   3e1b	
KLIST    3e1e	KLSTLP   3e24	KLTEN    3e30	KLTAB    3e39	
KLLP1    3e46	KLESC    3e4d	CTRLPR   3e59	KEYON    3e6f	
KEYOFF   3e72	KEY      3e75	KIFCVX   3e94	KLNLMT   3eaa	
KYPTLP   3eb6	INDRCT1  3eb9	ESCKPT   3ebc	KBUFST   3ebf	
KBUFSL   3ed0	KBUFLP   3ed2	KEYBCL   3eda	CSRLIN   3ee8	
LNOADR   3efd	RETLNR   3f07	RETLNO   3f0a	MIDRLN   3f12	
RTLLOP   3f16	RETSTL   3f24	CVRTLN   3f32	RETLNV   3f33	
RELNVC   3f35	CVLNAD   3f39	RTLSHM   3f4d	ADRNVC   3f4f	
RTRNAD   3f68	RENNTF   3f6a	UDLBUF   3f82	LNOSER   3f8e	
LNOSLP   3f97	TMPUYS   3f99	NTFRET   3fb8	NOMTCH   3fbb	
LMIDET1  3fc4	GTSTED   3fc7	FSTNUB   3fe7	GSESER   3fe9	
NX2C2D   3ff0	GTNXNM   4005	GTEDNO   4018	EDIT     4022	
EDBKLP   4046	SLIST    4050	CLIST    405e	SDXSET   406a	
LIST#    4072	LIST##   407a	LIST     407e	LIST#E   407f	
CLISTM   4091	LISTLP   409f	LISTSN   40ae	LISTL'   40b9	
LISTRT   40bb	LISTEN   40bc	LISTE'   40c5	LOKJMN   40c7	
LZSKL    40e3	LTSKZR   40eb	LIST0L   40f1	SAVEVC   40f6	
COUTCH   40f8	CRTVEC   40fd	CTIRTR   4100	ESCLOT   4103	
LSCRVC   4104	COUT0D   4106	CRTCR2   410e	LISCRC   4111	
LSTCR'   4112	LISTED   411f	ONELST   4128	ONLZLP   4131	
ONLSRT   413c	UNTIL    413e	UNWTRP   4142	UNTILM   415c	
ESCUTL   4170	RETURN   4178	RTAGPO   417a	RTWGOS   419d	
FPOPRT   41a3	WHILE    41b2	WHNLPT   41d1	WHNLBF   41d7	
WEND     41df	WENDER   41e3	SKIPWH   420b	SKWHEL   421d	
REPTON   4236	REPOFF   423b	REPTST   423e	REPEAT   4244	
GOSUB    4263	GOSNDQ   4280	GOSMID   4284	OGSJMP   429b	
LBLGOT   42ab	LBLLNO   42b7	LBLSER   42be	LBLSLP   42d2	
LBLNXT   42d3	NOTLBL   42ec	LBLLEN   42fd	LBLDEB   430c	
LBLMTL   430f	LBLNMT   4319	ONERRG   431d	OEROF'   4342	
ONERDQ   4349	CURLPT   4353	DQOENB   4360	OEROFF   4366	
ON       4372	OGOSUB   438d	ONLNOS   439e	ODATA    43ab	
GOTO     43b1	IFGOTO   43b4	MIDLAG   43b5	LNSGOT   43bc	
SERGOT   43c3	UDFLNO   43dc	ONGDQT   43e1	LNRGCK   43eb	
HLFVEC   43fb	IF       4401	ELSEMD   4412	IFALSE   4423	
IFSKIP   442d	IFSKMD   443a	IFSKSB   4440	FUNCRQ   4457	
ISKFLT   4459	IFDQSK   4464	VPUSH    446d	PUSHAG   4476	
PUTSTRL  4499	PUSHL1   44aa	RETVCP   44b0	PUSHJV   44b2	
VPOP     44b4	POPLOP   44bd	POPTRL   44da	INTPOR   44e1	
HEXCUL1  44e6	STKEMP   44f2	INTPOP   44f7	BUFCLR   4511	
CTINP    4521	ADRES    4524	LNG      4527	CTINP1   4547	
CTRETN   4551	CTRET'   4552	CTERR    4554	CTOUT    4558	
CTOUT1   457c	CTCLOS   4586	STREXZ   459b	STREXX   459d	
CTBUF    45b1	USINGB   46b1	DEFCHR   46cb	DEFCHL   4717	
SOUND    4722	BEEPOP   4748	BEEPA    4772	BEEP     4778	
PLAY     478c	KBSTMS   47af	ESCPLY   47bc	TEMPO    47bf	
COLOR    47e9	PRESET   47fa	PSET     4803	L33F0    4806	
PSETSB   480c	CULTBL   481b	CULADR   4823	SCRNYE   4824	
SCRNXE   482c	CULERR   4831	CALADR   4833	CALAD0   4836	
CULAD0   484e	L3445    485b	L344A    4860	CALAD1   4875	
CALA21   487c	CULAD1   4893	L348A    48a0	L348F    48a5	
L349F    48b5	PRESOK   48c0	CALAD2   48ca	CALAD3   48ca	
CULAD3   48da	CALA31   48e6	CALAD5   48f3	CALAD4   48f3	
CULAD5   4905	L34F6    490c	L34FB    4911	PSTRES   491b	
PSETXY   4924	COLFSL   4944	COLFST   4948	SETXY3   494d	
SETXY2   4961	BCFTC2   4967	EDCEKL   496e	EDCEK    496f	
LINE@    4979	NOMLIN   4992	ENDLIN   49a0	LIMODE   49b0	
CHRMD1   49c3	L35B4    49ca	MDST2    49d3	MDST3    49d7	
MDST22   49fa	BBFLMD   4a12	LINE1    4a1f	LINES1   4a2b	
LINEXS   4a3f	LINEXE   4a44	LINEL0   4a56	LINEYS   4a5c	
LINEYE   4a61	LINEL1   4a73	LNBOXF   4a7a	LINESB   4a7d	
LINEL4   4a9d	LINEL2   4aa4	XMOD     4aa6	YMOD     4aa9	
LINELP   4ab5	LINEMD   4ab8	YINC3    4abe	YINC2    4ac3	
YINC1    4aca	XINC0    4ad1	LINEL3   4ade	LINEL5   4af8	
BOX      4b01	BOXYAD   4b0a	BOXXAD   4b2c	LINEY    4b45	
BOXLOP   4b4b	BOXMD    4b4e	BOXDEC   4b54	XBOXAD   4b55	
LINEX    4b56	BOXFUL   4b5b	FULAD1   4b62	FULAD2   4b6c	
FULLOP   4b7e	LINEBC   4b80	FULINC   4b88	DIVH$D   4b90	
DIVLP    4b9e	DIV01    4bae	TEXTSB   4bc7	CHRCOD   4bd9	
CIRCLE   4bde	CIRRST   4c06	CRRROK   4c0c	SKPCOL   4c3d	
POLYE1   4c60	POLYE2   4c63	POLYE3   4c69	POLYE4   4c6f	
POLYE5   4c72	POLYLN   4c8e	SINSTA   4ca5	CIRCLP   4cac	
SIND     4cb9	SINEND   4cc2	SINXYS   4cd5	L38C6    4cdc	
SIN!     4ce1	L38CE    4ce4	SINOK    4ceb	SIN45    4d10	
SIN135   4d18	SIN225   4d1e	SINOK1   4d24	SINXOK   4d41	
SINYOK   4d59	XMULHI   4d5c	XMULLO   4d60	YMULHI   4d6a	
YMULLO   4d6e	SIN00    4d7a	SIN90    4d7f	SIN180   4d84	
SIN270   4d89	SINJST   4d8c	SINXAD   4d9a	WIDTH3   4d9d	
SINSX    4d9e	SINSY    4da5	SINYAD   4da8	RMULAY   4db0	
RMULAX   4dbb	RMULXY   4dc4	DEHLMX   4dca	SINRX    4dcb	
DEHLMY   4dd0	SINRY    4dd1	DEHLMS   4dd4	MULOP1   4ddd	
MULOP2   4df6	MULOP3   4e01	SINTBL   4e0b	COSTBL   4ebf	
PAINT    4ec1	PACINT   4eda	PACOSL   4ee4	L3AD1    4ee7	
PACOLS   4f03	PACEND   4f1c	PAINTS   4f1f	PAIN01   4f25	
PAIN02   4f31	PAIN03   4f37	PAIN11   4f45	PAIN06   4f58	
PAIN05   4f5c	PAIN07   4f5e	PAIN09   4f6d	PAIN08   4f71	
PAIN10   4f73	PAIN04   4f77	POICEK   4f87	POIZER   4f99	
POINRT   4f9a	POITBL   4f9e	POIST0   4fa6	BTTST1   4fb5	
POINCK   4fc1	POINC1   4fc6	POICKR   4fcc	POIST1   4fcf	
BTTST2   4fde	POIST3   4ff4	POIS3L   4ffc	POIS33   5003	
POIST5   500c	POIS5L   5014	POIS55   5019	PACOLB   501f	
PATTEN   5028	PATOK1   5059	PATSUB   5071	PATX     5072	
PATY     5078	L3C81    5097	PATYLN   509c	PATLP1   509f	
PATYAD   50a5	PATEND   50b8	PATST    50ba	PATSTL   50bf	
L3CB2    50c8	L3CB7    50cd	HCOPY    50d3	COPYGM   50f6	
COPYM4   50ff	HCOPY1   5108	HCOPY2   510d	COPYM2   510f	
HCOPY3   5114	L3D07    511d	L3D0F    5125	L3D17    512d	
L3D1F    5135	COPYM3   514c	COPYGA   516b	COPYTA   516f	
COPYTL   5170	PRTESC   517e	COPYGR   5195	COPYTX   51aa	
SUB3L    51bf	LGR23L   51c9	L3DB7    51cd	LGR223   51cf	
LGR22    51d7	SUB3L1   51d8	LGR232   51ea	ROMTX    51f5	
L3DE7    51fd	RAMTX    5211	TXCULC   5226	SUB3L2   5227	
RRCHAS   523d	L3E2E    5244	CGCHR    524a	$CGBUF   554a	
ADDDEG   5b4a	OCTLER   5b52	HEXPZM   5b5f	MID&OP   5b6b	
LOP&OP   5b74	CHKVEC   5b7b	VECSWT   5b88	MULVEC   5b89	
RET&OP   5b96	CHCKOC   5ba1	CHCKHX   5ba8	OVFLAG   5bb8	
ZRSKIP   5bd6	L008F    5bd9	SKIP2D   5bdf	CHCK26   5be5	
FTCHL    5bfd	MDLAG    5c00	POINTS   5c27	POINT    5c2b	
KMYSET   5c49	PESC     5c51	TST23H   5c59	TST21H   5c70	
DGTUPQ   5c78	SNGCL1   5c84	TST25H   5c91	TSTPRC   5c9d	
EXPON?   5ca8	EXPON!   5caf	DEXPON   5cb6	EXPON    5cbc	
EXPCLM   5cc0	FTREPT   5cce	CBEGIN   5ce1	CLMIDL   5ce4	
ESCPER   5d04	EMLLPO   5d1a	MULLKM   5d1d	EXJPVC   5d22	
DIVTEN   5d27	ADDECK   5d34	ADHLCK   5d38	OVERF'   5d3a	
MULDEC   5d3d	DEFTCH   5d51	CVNMFL   5d58	ONLYZ#   5d62	
PLUS     5d68	ENORLP   5d71	ENORL'   5d74	NORRES   5d7f	
NORRE'   5d86	OKOMTR   5d90	PUTEMK   5d99	EXPPLS   5daa	
EXPASC   5dbe	PUTEXP   5de7	INTPAR   5df2	FRSTCH   5dff	
BEGTRS   5e07	MIDTRS   5e08	CVASFL   5e1a	DBLLCH   5e31	
NOEXP    5e3a	CVCONT   5e67	ESTST'   5e71	DWNERC   5e77	
FRACDG   5e7a	FRCAGN   5e80	BCKSER   5e99	INTDIS   5ea5	
LSTASA   5eae	ASZERO   5eb4	ASCONE   5eba	FRCADM   5ebd	
FRCASL   5ec2	ADDLOP   5ec8	ESCADD   5ed4	USGNCV   5ed6	
RPSPAC   5ee3	EXPUSG   5eee	USNRIW   5ef9	AGNEXP   5f0e	
NGPUDS   5f2a	EXPUBC   5f2d	EXPUHL   5f30	WRITEL1  5f37	
NTPT2E   5f3e	USGC''   5f46	USGCV'   5f4a	USG'''   5f4f	
STFLBL   5f5e	STDGUS   5f69	FRACUS   5f77	AGINFR   5f87	
OVERRD   5f9d	FOVER    5fa6	NOFRAC   5fab	GTESTB   5fbb	
GNXDGT   5fbd	MIDSGN   5fc0	INTGDL   5fca	CPSHIF   5fdd	
CONDSF   5fec	CONDDG   5ffa	INTZRR   6005	INTBCK   600c	
B_FIX    6010	INT      6010	INTSFL   6029	INTSBL   6035	
INTBC'   603d	INTDBL   6042	INDSFL   6054	IDSFBL   606a	
MIDERF   607f	STHLBC   6088	RCHLBC   608e	FRAC     6095	
FRAC'    60a7	FRCSBL   60c0	FRCSB'   60d2	ENDSFR   60df	
FRCDBL   60e7	IDFRBL   60f7	DSFL1'   611a	ESCDFS   6131	
MULTEN   6142	MOD      614f	HEXFLT   615d	HXZRRT   6162	
DLTEN    6167	HLFLT    6167	NORHLC   6177	TSTRNG   617e	
HXFLSL   618b	STRCMP   6195	NOIV0    61b2	SCMPLP   61c1	
SCMPLN   61c9	PCMPRT   61cf	ONECMP   61d3	CMP      61d6	
TSTCMP2  61e6	TSTCMP   61ec	DCMPLO   61f2	CMPRET   61fa	
HMISN    61fe	CMPRE'   6207	CMPR''   620c	ZFILL    6210	
FILL     6211	FILLOP   6212	FLMAX    6218	CONTBL   6220	
SNGMXO   6268	FLTEN    6290	FLONE    6298	FLLAST   62a0	
ASCHL    62a8	CONV1    62d1	CONV2    62d3	DHLMT    62e6	
SHLMT    62ee	ZFAC     62f2	ZFAC1    62fa	DGBUF    6304	
SMALL    631b	$EDIT    631b	SMALL'   631c	CVIMTX   6325	
CPILLP   6327	NUMJMP   6350	PRTCDE   6355	BACKLP   6357	
TREND'   635b	TREND    635c	STRING1  6360	REMOPR   6367	
RMTRLP   636a	RMTRMD   636d	BACK     6371	STORE'   6374	
STORE    6375	NOSLOP   6382	BACK1    6392	STATE    6395	
GETHX    63be	LNOSLP1  63e3	COMSTR   63f7	LBLGOT1  63fc	
LISTER   6412	LISTRM   6415	AFNUM    642f	ELSEST   6434	
DATAST1  643c	DATAS    6444	DQSTL    644d	LSIT#?   6455	
MATCH    6461	MSTART   6467	TESTMT   646e	SKIPTB   6480	
MTCHOK   6487	NOMTCH1  648c	SHORTN1  6490	NO2EH    6499	
DQTSTR   649d	DQTST'   64a0	SPSTRE   64ad	NUMBER   64b6	
SKIPHX   64d5	NOT26H   64e0	BCKSPS   6504	HEX2     650c	
HEX1     6510	PPOLNO   6513	FLOAT    651b	TSTNDE   652d	
TSTNAC   652e	TREN'    6535	CVTXIM   653a	CVTMLP   6541	
CVCPPT   654a	BCEG     656b	MDLBK    656d	TRASIM   6570	
FUNCTR   6589	TRNUMB   6593	IMHORN   65a0	IMHEX    65a5	
IMMID    65b5	SKZRLP   65c2	ESSKZR   65ca	ZTRLW    65ce	
RFLOAT   65d8	FLTRDL   65e9	PUT23H   6604	PUT21H   6606	
TSTED    6608	FLTRP'   6612	NTPT21   6618	FLTR''   6625	
NTPT23   6627	IMLNO    662d	DTARCL   663d	MIDDST   6642	
DTA22S   6650	DQUAT    665d	DQUATL   6662	REM1     6670	
CORON    6674	INVS     6684	SKIPTR   668a	ASSTR#   6694	
OCTALD   66a0	HEXOCT   66ae	SKHEXP   66be	ESHEXR   66c6	
ZTRLWH   66d1	OCTHL    66db	OCTCOV   66e1	OCTSTO   670b	
HEXHL    6712	HEXCOV   671a	HEXACC   671f	HEXHLF   672c	
SKIUTO   6734	CTBL1    6737	CTBL2    68d3	FIVEBF   69ab	
ERRTXT   69b2	$ERTXT   69b2	UDLMES   6a1f	RESNHL   6bc0	
$FLOAT   6bc0	B_ABS    6bc0	STROMT   6bc5	ONESUB   6bce	
SUB      6bd1	ZERO3    6be5	TOGLE    6beb	CONDM'   6bf2	
CONDMZ   6bf6	RTCDMZ   6c01	MTCHPO   6c04	MIDCMZ   6c05	
STROVF   6c1d	STRADE   6c22	SRADE'   6c44	STRADD   6c47	
FSTTRL   6c83	NXTADS   6c89	SNDTRL   6c97	STRADS   6c9d	
ADD      6ca6	HMINS    6cc3	MINCR    6cd1	MZRT     6cd9	
HMDP     6cdb	DMINS    6ce7	ZRO      6cf2	OKM      6cf5	
FADD     6cfc	ANSHIF   6d1e	FADDS    6d26	STORE1   6d66	
HLBUF    6d6a	FLEXIT   6d78	INST1    6d7c	FADD1    6d7f	
JPVEC    6d99	FADDL1   6d9d	CLR5     6dcd	CLR4     6dce	
CLR3     6dcf	CLR2$    6dd0	CLR1     6dd1	SHIFST   6deb	
JPVEC2   6df1	FSUB     6e04	FSUB1    6e0b	SNSHIF   6e25	
DSUB1    6e2d	CMPCON   6e41	CMPL     6e45	NE       6e51	
DSSFL2   6e86	MINUS    6ea2	NEGTIV   6ece	TRANS    6ecf	
ZERO     6ed8	ZERO'    6edb	ZFILL0   6edf	OVERFL1  6ee4	
SFADD    6eea	SNSH     6f01	SADD1    6f09	SJVEC    6f21	
SCL1     6f36	SCL0     6f37	SSIFST   6f4e	SJVEC2   6f50	
SSTRE    6f74	SHLBUF   6f79	SSUB     6f83	NSSUB0   6f8a	
OSETER   6fa0	ZFSSUB   6faa	ZFSSU1   6fbb	MUL      6fe0	
SML1     7026	SML2     702f	SMSF     703f	EXPCUL   704c	
SPBF     705b	SMSTS    706e	SMULTS   7077	SMULTP   7079	
SMLP1    7094	UNDRFL   70ab	DVBYZR   70b8	DIV      70bd	
SDLOP2   70ee	SDLOP1   70f2	SDCNT    7129	ADLP     7140	
NOSDLP   7153	SDEXPC   7159	DDTRL    717c	SDTRL    717f	
SDMIN    718b	DMUL     718e	DMULLP   71bf	DMSFL    71d9	
DMNOSH   71df	SMSKP1   7207	DMTRL    7209	BLCKAD   7213	
BLCKA1   7216	BLADLP   721b	DMSKIP   7254	DDIV     7289	
DDLOP2   72ab	DDLOP1   72ae	DDCNT    7328	DDADLP   7352	
DDNSLP   7363	DDEXPC   7369	WRKFC    7393	WRKFC1   739b	
LDIR1    73a3	LDIR8    73a6	ONEADD   73ac	L073B2H  73b2	
B_SQR    73b9	L073D1H  73d1	L073E2H  73e2	L073E4H  73e4	
L07401H  7401	B_SUM    7409	B_FACG   742b	L07437H  7437	
L0743FH  743f	L0745EH  745e	L07473H  7473	L07475H  7475	
B_ATN    7477	L07488H  7488	L074ADH  74ad	L074E1H  74e1	
L07501H  7501	L07509H  7509	B_COS    7545	B_SIN    7557	
L0758EH  758e	L0759EH  759e	L075C8H  75c8	L075D5H  75d5	
L075DAH  75da	L075E2H  75e2	L075F2H  75f2	L07602H  7602	
L07613H  7613	L07617H  7617	L0761BH  761b	L07644H  7644	
B_TAN    7646	L07662H  7662	L0766DH  766d	SINTBL1  767a	
SINTBL2  76ba	L076FAH  76fa	SINTBL3  774a	B_SGN    7752	
L0775BH  775b	L07764H  7764	B_RAD    776a	B_PAI    776f	
L07772H  7772	PAITBL   7778	B_INP    7788	B_RND    7799	
L077C8H  77c8	B_EXP    77ca	L07809H  7809	L07817H  7817	
L07840H  7840	L07869H  7869	L07876H  7876	L0787AH  787a	
L07885H  7885	L0788BH  788b	L07896H  7896	L078ADH  78ad	
L078B7H  78b7	B_LOG    78bd	L078D8H  78d8	L078EEH  78ee	
L0790BH  790b	L07913H  7913	L0793CH  793c	L07940H  7940	
L07943H  7943	LOGTBL   798f	LOGTBL0  7997	LOGTBL1  799f	
L07A1FH  7a1f	L07A27H  7a27	L07A37H  7a37	VSTART   7a3b	
STRPTR   7a3d	STKLMT   7a3f	STRTOP   7a41	INTSSP   7a43	
STRBTM   7a45	MEMEND   7a47	MEMMAX   7a49	INTFAC   7a4b	
KEYBUF   7a4f	IMDBUF   7b4e	TEXTST   7c4e	L0E7CFH  e7cf	
ENTRY    fb00	

No undefined symbol.
